{"version":3,"sources":["geo/openlayers/Layer.js"],"names":["define","declare","lang","array","sniff","Feature","constructor","name","options","ol","olLayer","delegate","OpenLayers","Layer","this","_features","events","register","hitch","moveTo","renderFeature","f","render","getDojoMap","dojoMap","addFeature","isArray","forEach","item","push","_setLayer","removeFeature","ft","Array","slice","i","indexOf","splice","remove","removeFeatureAt","index","getFeatures","getFeatureAt","getFeatureCount","length","clear","fa","event","zoomChanged","redraw","isIE","setTimeout","added"],"mappings":";;;;;;;AAAAA,QACC,qBACA,kBACA,mBACA,mBACA,aACE,SAASC,EAASC,EAAMC,EAAOC,EAAOC,GAEvC,OAAOJ,EAAQ,6BAA8B,MAM5CK,YAAa,SAASC,EAAMC,GAQ3B,IAAIC,EAAKD,EAAUA,EAAQE,QAAU,KAEjCD,IACHA,EAAKP,EAAKS,SAAS,IAAIC,WAAWC,MAAMN,EAAMC,KAG/CM,KAAKJ,QAAUD,EACfK,KAAKC,UAAY,KACjBD,KAAKJ,QAAQM,OAAOC,SAAS,UAAWH,KAAMZ,EAAKgB,MAAMJ,KAAMA,KAAKK,UAGrEC,cAAe,SAAsBC,GAKpCA,EAAEC,UAGHC,WAAY,WACX,OAAOT,KAAKU,SAGbC,WAAY,SAASJ,GAKjBnB,EAAKwB,QAAQL,GACflB,EAAMwB,QAAQN,EAAG,SAASO,GACzBd,KAAKW,WAAWG,IACdd,OAGiB,MAAlBA,KAAKC,YACPD,KAAKC,cAEND,KAAKC,UAAUc,KAAKR,GACpBA,EAAES,UAAUhB,QAGbiB,cAAe,SAASV,GAKvB,IAAIW,EAAKlB,KAAKC,UACd,GAAS,MAANiB,EAAH,CAGA,GAAGX,aAAaY,MAKf,OAJAZ,EAAIA,EAAEa,MAAM,QACZ/B,EAAMwB,QAAQN,EAAG,SAASO,GACzBd,KAAKiB,cAAcH,IACjBd,MAGJ,IAAIqB,EAAIhC,EAAMiC,QAAQJ,EAAIX,IACjB,GAANc,GACFH,EAAGK,OAAOF,EAAG,GAEdd,EAAES,UAAU,MACZT,EAAEiB,WAGHC,gBAAiB,SAASC,GAKzB,IAAIR,EAAKlB,KAAKC,UACVM,EAAIW,EAAGQ,GACPnB,IAGJW,EAAGK,OAAOG,EAAO,GACjBnB,EAAES,UAAU,MACZT,EAAEiB,WAGHG,YAAa,WAKZ,OAAO3B,KAAKC,WAGb2B,aAAc,SAASP,GAOtB,GAAqB,MAAlBrB,KAAKC,UAGR,OAAOD,KAAKC,UAAUoB,IAGvBQ,gBAAiB,WAKhB,OAAqB,MAAlB7B,KAAKC,UACA,EAEDD,KAAKC,UAAU6B,QAGvBC,MAAO,WAGN,IAAIC,EAAKhC,KAAK2B,cACd3B,KAAKiB,cAAce,IAGpB3B,OAAQ,SAAS4B,GAKhB,GAAGA,EAAMC,YAAY,CACpB,GAAqB,MAAlBlC,KAAKC,UACP,OAEDZ,EAAMwB,QAAQb,KAAKC,UAAW,SAASM,GACtCP,KAAKM,cAAcC,IACjBP,QAILmC,OAAQ,WAGJ7C,EAAM8C,KACRC,WAAWjD,EAAKgB,MAAMJ,KAAM,WAC3BA,KAAKJ,QAAQuC,UACX,IAEHnC,KAAKJ,QAAQuC,UAIfG,MAAO","file":"../../../geo/openlayers/Layer.js","sourcesContent":["define([\r\n\t\"dojo/_base/declare\", \r\n\t\"dojo/_base/lang\", \r\n\t\"dojo/_base/array\", \r\n\t\"dojo/_base/sniff\",\r\n\t\"./Feature\"\r\n], function(declare, lang, array, sniff, Feature){\r\n\r\n\t\treturn declare(\"dojox.geo.openlayers.Layer\", null, {\r\n\t\t\t// summary:\r\n\t\t\t//\t\tBase layer class for dojox.geo.openlayers.Map specific layers extending OpenLayers.Layer class.\r\n\t\t\t//\t\tThis layer class accepts Features which encapsulates graphic objects to be added to the map.\r\n\t\t\t//\t\tThis layer class encapsulates an OpenLayers.Layer.\r\n\t\t\t//\t\tThis class provides Feature management such as add, remove and feature access.\r\n\t\t\tconstructor: function(name, options){\r\n\t\t\t\t// summary:\r\n\t\t\t\t//\t\tConstructs a new Layer.\r\n\t\t\t\t// name: String\r\n\t\t\t\t//\t\tThe name of the layer.\r\n\t\t\t\t// options: Object\r\n\t\t\t\t//\t\tOptions passed to the underlying OpenLayers.Layer object.\r\n\r\n\t\t\t\tvar ol = options ? options.olLayer : null;\r\n\r\n\t\t\t\tif(!ol){\r\n\t\t\t\t\tol = lang.delegate(new OpenLayers.Layer(name, options));\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.olLayer = ol;\r\n\t\t\t\tthis._features = null;\r\n\t\t\t\tthis.olLayer.events.register(\"moveend\", this, lang.hitch(this, this.moveTo));\r\n\t\t\t},\r\n\r\n\t\t\trenderFeature: function(/* Feature */f){\r\n\t\t\t\t// summary:\r\n\t\t\t\t//\t\tCalled when rendering a feature is necessary.\r\n\t\t\t\t// f: Feature\r\n\t\t\t\t//\t\tThe feature to draw.\r\n\t\t\t\tf.render();\r\n\t\t\t},\r\n\r\n\t\t\tgetDojoMap: function(){\r\n\t\t\t\treturn this.dojoMap;\r\n\t\t\t},\r\n\r\n\t\t\taddFeature: function(f){\r\n\t\t\t\t// summary:\r\n\t\t\t\t//\t\tAdd a feature or an array of features to the layer.\r\n\t\t\t\t// f: Feature|Feature[]\r\n\t\t\t\t//\t\tThe Feature or array of features to add.\r\n\t\t\t\tif(lang.isArray(f)){\r\n\t\t\t\t\tarray.forEach(f, function(item){\r\n\t\t\t\t\t\tthis.addFeature(item);\r\n\t\t\t\t\t}, this);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif(this._features == null){\r\n\t\t\t\t\tthis._features = [];\r\n\t\t\t\t}\r\n\t\t\t\tthis._features.push(f);\r\n\t\t\t\tf._setLayer(this);\r\n\t\t\t},\r\n\r\n\t\t\tremoveFeature: function(f){\r\n\t\t\t\t// summary:\r\n\t\t\t\t//\t\tRemoves a feature or an array of features from the layer.\r\n\t\t\t\t// f: Feature|Feature[]\r\n\t\t\t\t//\t\tThe Feature or array of features to remove.\r\n\t\t\t\tvar ft = this._features;\r\n\t\t\t\tif(ft == null){\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif(f instanceof Array){\r\n\t\t\t\t\tf = f.slice(0);\r\n\t\t\t\t\tarray.forEach(f, function(item){\r\n\t\t\t\t\t\tthis.removeFeature(item);\r\n\t\t\t\t\t}, this);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar i = array.indexOf(ft, f);\r\n\t\t\t\tif(i != -1){\r\n\t\t\t\t\tft.splice(i, 1);\r\n\t\t\t\t}\r\n\t\t\t\tf._setLayer(null);\r\n\t\t\t\tf.remove();\r\n\t\t\t},\r\n\r\n\t\t\tremoveFeatureAt: function(index){\r\n\t\t\t\t// summary:\r\n\t\t\t\t//\t\tRemove the feature at the specified index.\r\n\t\t\t\t// index: int\r\n\t\t\t\t//\t\tThe index of the feature to remove.\r\n\t\t\t\tvar ft = this._features;\r\n\t\t\t\tvar f = ft[index];\r\n\t\t\t\tif(!f){\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tft.splice(index, 1);\r\n\t\t\t\tf._setLayer(null);\r\n\t\t\t\tf.remove();\r\n\t\t\t},\r\n\r\n\t\t\tgetFeatures: function(){\r\n\t\t\t\t// summary:\r\n\t\t\t\t//\t\tReturns the feature hold by this layer.\r\n\t\t\t\t// returns:\r\n\t\t\t\t//\t\tThe untouched array of features hold by this layer.\r\n\t\t\t\treturn this._features; // Feature[]\r\n\t\t\t},\r\n\r\n\t\t\tgetFeatureAt: function(i){\r\n\t\t\t\t// summary:\r\n\t\t\t\t//\t\tReturns the i-th feature of this layer.\r\n\t\t\t\t// i: Number\r\n\t\t\t\t//\t\tThe index of the feature to return.\r\n\t\t\t\t// returns:\r\n\t\t\t\t//\t\tThe i-th feature of this layer.\r\n\t\t\t\tif(this._features == null){\r\n\t\t\t\t\treturn undefined;\r\n\t\t\t\t}\r\n\t\t\t\treturn this._features[i]; // Feature\r\n\t\t\t},\r\n\r\n\t\t\tgetFeatureCount: function(){\r\n\t\t\t\t// summary:\r\n\t\t\t\t//\t\tReturns the number of the features contained by this layer.\r\n\t\t\t\t// returns:\r\n\t\t\t\t//\t\tThe number of the features contained by this layer.\r\n\t\t\t\tif(this._features == null){\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\t}\r\n\t\t\t\treturn this._features.length; // Number\r\n\t\t\t},\r\n\r\n\t\t\tclear: function(){\r\n\t\t\t\t// summary:\r\n\t\t\t\t//\t\tRemoves all the features from this layer.\r\n\t\t\t\tvar fa = this.getFeatures();\r\n\t\t\t\tthis.removeFeature(fa);\r\n\t\t\t},\r\n\r\n\t\t\tmoveTo: function(event){\r\n\t\t\t\t// summary:\r\n\t\t\t\t//\t\tCalled when the layer is panned or zoomed.\r\n\t\t\t\t// event: MouseEvent\r\n\t\t\t\t//\t\tThe event\r\n\t\t\t\tif(event.zoomChanged){\r\n\t\t\t\t\tif(this._features == null){\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tarray.forEach(this._features, function(f){\r\n\t\t\t\t\t\tthis.renderFeature(f);\r\n\t\t\t\t\t}, this);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tredraw: function(){\r\n\t\t\t\t// summary:\r\n\t\t\t\t//\t\tRedraws this layer\r\n\t\t\t\tif(sniff.isIE){\r\n\t\t\t\t\tsetTimeout(lang.hitch(this, function(){\r\n\t\t\t\t\t\tthis.olLayer.redraw();\r\n\t\t\t\t\t}, 0));\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis.olLayer.redraw();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tadded: function(){\r\n\t\t\t\t// summary:\r\n\t\t\t\t//\t\tCalled when the layer is added to the map\r\n\t\t\t}\r\n\r\n\t\t});\r\n\t});\r\n"]}