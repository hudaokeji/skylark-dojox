{"version":3,"sources":["geo/charting/widget/Map.js"],"names":["define","dojo","lang","declare","html","domGeom","Widget","Map","shapeData","dataStore","dataBindingAttribute","dataBindingValueFunction","markerData","series","adjustMapCenterOnResize","adjustMapScaleOnResize","animateOnResize","onFeatureClick","onFeatureOver","enableMouseSupport","enableTouchSupport","enableMouseZoom","enableMousePan","enableKeyboardSupport","showTooltips","enableFeatureZoom","colorAnimationDuration","mouseClickThreshold","_mouseInteractionSupport","_touchInteractionSupport","_keyboardInteractionSupport","constructor","options","div","this","map","startup","inherited","arguments","fitToMapContents","postMixInProperties","create","params","srcNodeRef","getInnerMap","buildRendering","domNode","length","setMarkerData","setDataBindingValueFunction","setDataStore","addSeries","dojox","geo","charting","MouseInteractionSupport","Error","enablePan","enableZoom","connect","TouchInteractionSupport","KeyboardInteractionSupport","resize","b","height","box","mixin","setMarginBox","w","h"],"mappings":"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","file":"../../../../geo/charting/widget/Map.js","sourcesContent":["define([\r\n\t\"dojo/_base/kernel\",\r\n\t\"dojo/_base/lang\",\r\n\t\"dojo/_base/declare\",\r\n\t\"dojo/_base/html\",\r\n\t\"dojo/dom-geometry\",\r\n\t\"dijit/_Widget\",\r\n\t\"../Map\"\r\n], function(dojo, lang, declare, html,domGeom, Widget, Map){\r\n\r\n\treturn declare(\"dojox.geo.charting.widget.Map\", Widget, {\r\n\t\t// summary:\r\n\t\t//\t\tA map viewer widget based on the dojox.geo.charting.Map component\r\n\t\t// description:\r\n\t\t//\t\tThe `dojox.geo.charting.widget.Map` widget combines map display together with charting capabilities.\r\n\t\t//\t\tIt encapsulates  an `dojox.geo.charting.Map` object on which most operations are delegated.\r\n\t\t//\t\tParameters can be passed as argument at construction time to specify map data file (json shape format)\r\n\t\t//\t\tas well as charting data.\r\n\t\t//\r\n\t\t//\t\tThe parameters are:\r\n\t\t//\r\n\t\t//\t\t- `shapeData`: The json object containing map data or the name of the file containing map data.\r\n\t\t//\t\t- `dataStore`: the dataStore to fetch the charting data from\r\n\t\t//\t\t- `dataBindingAttribute`: property name of the dataStore items to use as value for charting\r\n\t\t//\t\t- `markerData`: tooltips to display for map features, handled as json style.\r\n\t\t//\t\t- `adjustMapCenterOnResize`: if true, the center of the map remains the same when resizing the widget\r\n\t\t//\t\t- `adjustMapScaleOnResize`: if true, the map scale is adjusted to leave the visible portion of the map identical as much as possible\r\n\t\t//\r\n\t\t// example:\r\n\t\t// |\tvar map = new dojox.geo.charting.widget.Map({\r\n\t\t// |\t\tshapeData: 'map.json',\r\n\t\t// |\t\tadjustMapCenterOnresize: true,\r\n\t\t// |\t\tadjustMapScaleOnresize: true,\r\n\t\t// |\t});\r\n\r\n\t\tshapeData: \"\",\r\n\t\tdataStore: null,\r\n\t\tdataBindingAttribute: \"\",\r\n\t\tdataBindingValueFunction: null,\r\n\t\tmarkerData: \"\",\r\n\t\tseries: \"\",\r\n\t\tadjustMapCenterOnResize: null,\r\n\t\tadjustMapScaleOnResize: null,\r\n\t\tanimateOnResize: null,\r\n\t\tonFeatureClick: null,\r\n\t\tonFeatureOver: null,\r\n\t\tenableMouseSupport: null,\r\n\t\tenableTouchSupport: null,\r\n\t\tenableMouseZoom: null,\r\n\t\tenableMousePan: null,\r\n\t\tenableKeyboardSupport: false,\r\n\t\tshowTooltips: false,\r\n\t\tenableFeatureZoom: null,\r\n\t\tcolorAnimationDuration: 0,\r\n\t\tmouseClickThreshold: 2,\r\n\t\t_mouseInteractionSupport:null,\r\n\t\t_touchInteractionSupport:null,\r\n\t\t_keyboardInteractionSupport:null,\r\n\t\tconstructor: function(/* Object */options, /* HtmlNode */div){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tConstructs a new Map widget\r\n\t\t\tthis.map = null;\r\n\t\t},\r\n\r\n\t\tstartup: function(){\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\tif(this.map){\r\n\t\t\t\tthis.map.fitToMapContents();\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tpostMixInProperties: function(){\r\n\t\t\tthis.inherited(arguments);\r\n\t\t},\r\n\r\n\t\tcreate: function(/*Object?*/params, /*DomNode|String?*/srcNodeRef){\r\n\t\t\tthis.inherited(arguments);\r\n\t\t},\r\n\r\n\t\tgetInnerMap: function(){\r\n\t\t\treturn this.map;\r\n\t\t},\r\n\r\n\r\n\t\tbuildRendering: function(){\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\tif(this.shapeData){\r\n\t\t\t\tthis.map = new Map(this.domNode, this.shapeData);\r\n\t\t\t\tif(this.markerData && (this.markerData.length > 0)){\r\n\t\t\t\t\tthis.map.setMarkerData(this.markerData);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(this.dataStore){\r\n\t\t\t\t\tif(this.dataBindingValueFunction){\r\n\t\t\t\t\t\tthis.map.setDataBindingValueFunction(this.dataBindingValueFunction);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.map.setDataStore(this.dataStore,this.dataBindingAttribute);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(this.series && (this.series.length > 0)){\r\n\t\t\t\t\tthis.map.addSeries(this.series);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(this.onFeatureClick){\r\n\t\t\t\t\tthis.map.onFeatureClick = this.onFeatureClick;\r\n\t\t\t\t}\r\n\t\t\t\tif(this.onFeatureOver){\r\n\t\t\t\t\tthis.map.onFeatureOver = this.onFeatureOver;\r\n\t\t\t\t}\r\n\t\t\t\tif(this.enableMouseSupport){\r\n\t\t\t\t\tif(!dojox.geo.charting.MouseInteractionSupport){\r\n\t\t\t\t\t\tthrow Error(\"Can't find dojox.geo.charting.MouseInteractionSupport. Didn't you forget to dojo\" + \".require() it?\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar options = {};\r\n\t\t\t\t\toptions.enablePan = this.enableMousePan;\r\n\t\t\t\t\toptions.enableZoom = this.enableMouseZoom;\r\n\t\t\t\t\toptions.mouseClickThreshold = this.mouseClickThreshold;\r\n\t\t\t\t\tthis._mouseInteractionSupport = new dojox.geo.charting.MouseInteractionSupport(this.map,options);\r\n\t\t\t\t\tthis._mouseInteractionSupport.connect();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(this.enableTouchSupport){\r\n\t\t\t\t\tif(!dojox.geo.charting.TouchInteractionSupport){\r\n\t\t\t\t\t\tthrow Error(\"Can't find dojox.geo.charting.TouchInteractionSupport. Didn't you forget to dojo\" + \".require() it?\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis._touchInteractionSupport = new dojox.geo.charting.TouchInteractionSupport(this.map,{});\r\n\t\t\t\t\tthis._touchInteractionSupport.connect();\r\n\t\t\t\t}\r\n\t\t\t\tif(this.enableKeyboardSupport){\r\n\t\t\t\t\tif(!dojox.geo.charting.KeyboardInteractionSupport){\r\n\t\t\t\t\t\tthrow Error(\"Can't find dojox.geo.charting.KeyboardInteractionSupport. Didn't you forget to dojo\" + \".require() it?\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis._keyboardInteractionSupport = new dojox.geo.charting.KeyboardInteractionSupport(this.map,{});\r\n\t\t\t\t\tthis._keyboardInteractionSupport.connect();\r\n\t\t\t\t}\r\n\t\t\t\tthis.map.showTooltips = this.showTooltips;\r\n\t\t\t\tthis.map.enableFeatureZoom = this.enableFeatureZoom;\r\n\t\t\t\tthis.map.colorAnimationDuration = this.colorAnimationDuration;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tresize : function(/*Object|Number?*/ b, /*Number?*/ height){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tResize the widget.\r\n\t\t\t// description:\r\n\t\t\t//\t\tResize the domNode and the widget to the dimensions of a box of the following form:\r\n\t\t\t//\t\t`{ l: 50, t: 200, w: 300: h: 150 }`\r\n\t\t\t// b: Object|Number?\r\n\t\t\t//\t\tAn hash with optional \"l\", \"t\", \"w\", and \"h\" properties for \"left\", \"right\", \"width\", and \"height\"\r\n\t\t\t//\t\trespectively; or a number representing the new width.\r\n\t\t\t// height: Number?\r\n\t\t\t//\t\tA number representing the new height.\r\n\r\n\t\t\tvar box;\r\n\t\t\tswitch(arguments.length){\r\n\t\t\t\tcase 0:\r\n\t\t\t\t\t// case 0, do not resize the div, just the surface\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 1:\r\n\t\t\t\t\t// argument, override node box\r\n\t\t\t\t\tbox = lang.mixin({}, b);\r\n\t\t\t\t\tdomGeom.setMarginBox(this.domNode, box);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 2:\r\n\t\t\t\t\t// two argument, width, height\r\n\t\t\t\t\tbox = {\r\n\t\t\t\t\t\tw: arguments[0],\r\n\t\t\t\t\t\th: arguments[1]\r\n\t\t\t\t\t};\r\n\t\t\t\t\tdomGeom.setMarginBox(this.domNode, box);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tif(this.map){\r\n\t\t\t\tthis.map.resize(this.adjustMapCenterOnResize,this.adjustMapScaleOnResize,this.animateOnResize);\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n});\r\n"]}