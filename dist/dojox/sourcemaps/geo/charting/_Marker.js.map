{"version":3,"sources":["geo/charting/_Marker.js"],"names":["define","lang","arr","declare","has","_needTooltipRefresh","_map","constructor","markerData","map","this","mapObj","features","show","featureId","evt","currentFeature","showTooltips","markerText","dojox","geo","charting","showTooltip","shape","hide","hideTooltip","_getGroupBoundingBox","group","shapes","children","bbox","getBoundingBox","_arround","clone","forEach","item","_bbox","x","Math","min","y","_toWindowCoords","arround","coords","containerSize","toLeft","topLeft","scale","toTop","width","height"],"mappings":";;;;;;;AAAAA,QACC,kBACA,mBACA,qBACA,mBACA,WACE,SAASC,EAAMC,EAAKC,EAASC,GAC/B,OAAOD,EAAQ,6BAA8B,MAE5CE,oBAAqB,KACrBC,KAAM,KAENC,YAAa,SAASC,EAAYC,GACjCC,KAAKJ,KAAOG,EACZ,IAAIE,EAASF,EAAIE,OACjBD,KAAKE,SAAWD,EAAOC,SACvBF,KAAKF,WAAaA,EAClBH,qBAAsB,GAGvBQ,KAAM,SAASC,EAAWC,GACzBL,KAAKM,eAAiBN,KAAKE,SAASE,GACjCJ,KAAKJ,KAAKW,cAAgBP,KAAKM,iBACjCN,KAAKQ,WAAaR,KAAKM,eAAeE,YAAcR,KAAKF,WAAWM,IAAcA,EAClFK,MAAMC,IAAIC,SAASC,YAAYZ,KAAKQ,WAAYR,KAAKM,eAAeO,OAAQ,YAE7Eb,KAAKL,qBAAsB,GAG5BmB,KAAM,WACFd,KAAKJ,KAAKW,cAAgBP,KAAKM,gBACjCG,MAAMC,IAAIC,SAASI,YAAYf,KAAKM,eAAeO,OAEpDb,KAAKL,qBAAsB,GAG5BqB,qBAAsB,SAASC,GAC9B,IAAIC,EAASD,EAAME,SAEfC,EADUF,EAAO,GACFG,iBACnBrB,KAAKsB,SAAW/B,EAAKgC,MAAMH,GAC3B5B,EAAIgC,QAAQN,EAAQ,SAASO,GAC5B,IAAIC,EAAQD,EAAKJ,iBACjBrB,KAAKsB,SAASK,EAAIC,KAAKC,IAAI7B,KAAKsB,SAASK,EAAGD,EAAMC,GAClD3B,KAAKsB,SAASQ,EAAIF,KAAKC,IAAI7B,KAAKsB,SAASQ,EAAGJ,EAAMI,IACjD9B,OAGH+B,gBAAiB,SAASC,EAASC,EAAQC,GAC1C,IAAIC,GAAUH,EAAQL,EAAI3B,KAAKoC,QAAQ,IAAMpC,KAAKqC,MAC9CC,GAASN,EAAQF,EAAI9B,KAAKoC,QAAQ,IAAMpC,KAAKqC,MACjC,KAAb3C,EAAI,OACNsC,EAAQL,EAAIM,EAAON,EACnBK,EAAQF,EAAIG,EAAOH,GACXpC,EAAI,WACZsC,EAAQL,EAAIO,EAAcP,EAAIQ,EAC9BH,EAAQF,EAAII,EAAcJ,EAAIQ,IAE9BN,EAAQL,EAAIM,EAAON,EAAIQ,EACvBH,EAAQF,EAAIG,EAAOH,EAAIQ,GAExBN,EAAQO,MAASvC,KAAKM,eAAeoB,MAAM,GAAM1B,KAAKqC,MACtDL,EAAQQ,OAAUxC,KAAKM,eAAeoB,MAAM,GAAM1B,KAAKqC,MACvDL,EAAQL,GAAKK,EAAQO,MAAQ,EAC7BP,EAAQF,GAAKE,EAAQQ,OAAS","file":"../../../geo/charting/_Marker.js","sourcesContent":["define([\r\n\t\"dojo/_base/lang\",\r\n\t\"dojo/_base/array\",\r\n\t\"dojo/_base/declare\",\r\n\t\"dojo/_base/sniff\",\r\n\t\"./_base\"\r\n], function(lang, arr, declare, has){\r\n\treturn declare(\"dojox.geo.charting._Marker\", null, {\r\n\t\t\r\n\t\t_needTooltipRefresh: null,\r\n\t\t_map: null,\r\n\t\t\r\n\t\tconstructor: function(markerData, map){\r\n\t\t\tthis._map = map;\r\n\t\t\tvar mapObj = map.mapObj;\r\n\t\t\tthis.features = mapObj.features;\r\n\t\t\tthis.markerData = markerData;\r\n\t\t\t_needTooltipRefresh = false;\r\n\t\t},\r\n\t\r\n\t\tshow: function(featureId, evt){\r\n\t\t\tthis.currentFeature = this.features[featureId];\r\n\t\t\tif(this._map.showTooltips && this.currentFeature){\r\n\t\t\t\tthis.markerText = this.currentFeature.markerText || this.markerData[featureId] || featureId;\r\n\t\t\t\tdojox.geo.charting.showTooltip(this.markerText, this.currentFeature.shape, [\"before\"]);\r\n\t\t\t}\r\n\t\t\tthis._needTooltipRefresh = false;\r\n\t\t},\r\n\t\r\n\t\thide: function(){\r\n\t\t\tif(this._map.showTooltips && this.currentFeature){\r\n\t\t\t\tdojox.geo.charting.hideTooltip(this.currentFeature.shape);\r\n\t\t\t}\r\n\t\t\tthis._needTooltipRefresh = false;\r\n\t\t},\r\n\t\r\n\t\t_getGroupBoundingBox: function(group){\r\n\t\t\tvar shapes = group.children;\r\n\t\t\tvar feature = shapes[0];\r\n\t\t\tvar bbox = feature.getBoundingBox();\r\n\t\t\tthis._arround = lang.clone(bbox);\r\n\t\t\tarr.forEach(shapes, function(item){\r\n\t\t\t\tvar _bbox = item.getBoundingBox();\r\n\t\t\t\tthis._arround.x = Math.min(this._arround.x, _bbox.x);\r\n\t\t\t\tthis._arround.y = Math.min(this._arround.y, _bbox.y);\r\n\t\t\t},this);\r\n\t\t},\r\n\t\r\n\t\t_toWindowCoords: function(arround, coords, containerSize){\r\n\t\t\tvar toLeft = (arround.x - this.topLeft[0]) * this.scale;\r\n\t\t\tvar toTop = (arround.y - this.topLeft[1]) * this.scale\r\n\t\t\tif(has(\"ff\") == 3.5){\r\n\t\t\t\tarround.x = coords.x;\r\n\t\t\t\tarround.y = coords.y;\r\n\t\t\t}else if(has(\"chrome\")){\r\n\t\t\t\tarround.x = containerSize.x + toLeft;\r\n\t\t\t\tarround.y = containerSize.y + toTop;\r\n\t\t\t}else{\r\n\t\t\t\tarround.x = coords.x + toLeft;\r\n\t\t\t\tarround.y = coords.y + toTop;\r\n\t\t\t}\r\n\t\t\tarround.width = (this.currentFeature._bbox[2]) * this.scale;\r\n\t\t\tarround.height = (this.currentFeature._bbox[3]) * this.scale;\r\n\t\t\tarround.x += arround.width / 6;\r\n\t\t\tarround.y += arround.height / 4;\r\n\t\t}\r\n\t});\r\n});\r\n"]}