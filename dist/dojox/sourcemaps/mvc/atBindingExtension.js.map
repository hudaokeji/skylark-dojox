{"version":3,"sources":["mvc/atBindingExtension.js"],"names":["define","aspect","array","lang","_WidgetBase","_atBindingMixin","w","forEach","arguments","dataBindAttr","console","warn","_mixin","mixin","before","params","srcNodeRef","this","_dbpostscript","_started","_startAtWatchHandles","_stopAtWatchHandles","around","oldWidgetBaseSet","name","value","prototype","_setBind","atsignature","_setAtWatchHandle","apply","_toArray"],"mappings":";;;;;;;AAAAA,QACC,cACA,mBACA,kBACA,oBACA,oBACA,kBACE,SAASC,EAAQC,EAAOC,EAAMC,EAAaC,GAC7C,OAAO,SAAkCC,GA8CxC,OAxCAJ,EAAMK,QAAQC,UAAW,SAASF,GAC9BA,EAAEG,aACJC,QAAQC,KAAK,0GAKdR,EAAKS,OAAON,EAAGD,EAAgBQ,OAG/BZ,EAAOa,OAAOR,EAAG,aAAc,SAAqBS,EAA2BC,GAC9EC,KAAKC,cAAcH,EAAQC,KAI5Bf,EAAOa,OAAOR,EAAG,UAAW,WACxBW,KAAKE,UAGRF,KAAKG,yBAINnB,EAAOa,OAAOR,EAAG,UAAW,WAC3BW,KAAKI,wBAINpB,EAAOqB,OAAOhB,EAAG,MAAO,SAASiB,GAChC,OAAO,SAAoBC,EAAmBC,GAC7C,OAAGD,GAAQnB,EAAgBqB,UAAUjB,aAC7BQ,KAAKU,SAASF,GACgB,iBAA5BA,OAAaG,YACfX,KAAKY,kBAAkBL,EAAMC,GAE9BF,EAAiBO,MAAMb,KAAMd,EAAK4B,SAASvB,kBAK9CA","file":"../../mvc/atBindingExtension.js","sourcesContent":["define([\r\n\t\"dojo/aspect\",\r\n\t\"dojo/_base/array\",\r\n\t\"dojo/_base/lang\",\r\n\t\"dijit/_WidgetBase\",\r\n\t\"./_atBindingMixin\",\r\n\t\"dijit/registry\"\r\n], function(aspect, array, lang, _WidgetBase, _atBindingMixin){\r\n\treturn function(/*dijit/_WidgetBase...*/ w){\r\n\t\t// summary:\r\n\t\t//\t\tMonkey-patch the given widget so that they looks at dojox/mvc/at set in them and start data binding specified there.\r\n\t\t// w: dijit/_WidgetBase...\r\n\t\t//\t\tThe widget.\r\n\r\n\t\tarray.forEach(arguments, function(w){\r\n\t\t\tif(w.dataBindAttr){\r\n\t\t\t\tconsole.warn(\"Detected a widget or a widget class that has already been applied data binding extension. Skipping...\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Apply the at binding mixin\r\n\t\t\tlang._mixin(w, _atBindingMixin.mixin);\r\n\r\n\t\t\t// Monkey patch widget.postscript to get the list of dojox/mvc/at handles before startup\r\n\t\t\taspect.before(w, \"postscript\", function(/*Object?*/ params, /*DomNode|String*/ srcNodeRef){\r\n\t\t\t\tthis._dbpostscript(params, srcNodeRef);\r\n\t\t\t});\r\n\r\n\t\t\t// Monkey patch widget.startup to get data binds set up\r\n\t\t\taspect.before(w, \"startup\", function(){\r\n\t\t\t\tif(this._started){\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tthis._startAtWatchHandles();\r\n\t\t\t});\r\n\r\n\t\t\t// Monkey patch widget.destroy to remove watches setup in _DataBindingMixin\r\n\t\t\taspect.before(w, \"destroy\", function(){\r\n\t\t\t\tthis._stopAtWatchHandles();\r\n\t\t\t});\r\n\r\n\t\t\t// Monkey patch widget.set to establish data binding if a dojox/mvc/at handle comes\r\n\t\t\taspect.around(w, \"set\", function(oldWidgetBaseSet){\r\n\t\t\t\treturn function(/*String*/ name, /*Anything*/ value){\r\n\t\t\t\t\tif(name == _atBindingMixin.prototype.dataBindAttr){\r\n\t\t\t\t\t\treturn this._setBind(value);\r\n\t\t\t\t\t}else if((value || {}).atsignature == \"dojox.mvc.at\"){\r\n\t\t\t\t\t\treturn this._setAtWatchHandle(name, value);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn oldWidgetBaseSet.apply(this, lang._toArray(arguments));\r\n\t\t\t\t};\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\treturn arguments; // dijit/_WidgetBase...\r\n\t};\r\n});\r\n"]}