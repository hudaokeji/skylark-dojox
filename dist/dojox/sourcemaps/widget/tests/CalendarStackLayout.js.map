{"version":3,"sources":["widget/tests/CalendarStackLayout.js"],"names":["dojo","provide","require","declare","dijit","_Widget","_Container","dateToPane","startup","this","_started","kids","getChildren","dates","forEach","hitch","childContainer","dateRef","domNode","getAttribute","parts","split","date","Date","setFullYear","setMonth","Number","setDate","push","getTime","sort","lastDate","length","firstDate","_this","getChildByDate","getFullYear","string","pad","String","getMonth","getDate","calendar","dojox","widget","Calendar","getClassForDate","isDisabledDate","attr","stack","layout","StackContainer","addClass","addChild","style","connect","pane","selectChild","started","inherited","arguments"],"mappings":";;;;;;;AAAAA,KAAKC,QAAQ,0CACbD,KAAKE,QAAQ,4BACbF,KAAKE,QAAQ,+BACbF,KAAKE,QAAQ,yBACbF,KAAKE,QAAQ,iBACbF,KAAKE,QAAQ,oBACbF,KAAKE,QAAQ,eAEbF,KAAKG,QAAQ,0CAA2CC,MAAMC,QAASD,MAAME,aAC5EC,cACAC,QAAS,WACR,GAAGC,KAAKC,SACP,OAAO,KAIR,IAAIC,EAAOF,KAAKG,cACZC,KAGJb,KAAKc,QAAQH,EAAMX,KAAKe,MAAMN,KAAM,SAASO,GAC5C,IAAIC,EAAUD,EAAeE,QAAQC,aAAa,WAClDV,KAAKF,WAAWU,GAAWD,EAE3B,IAAII,EAAQH,EAAQI,MAAM,KACtBC,EAAO,IAAIC,KACfD,EAAKE,YAAYJ,EAAM,IACvBE,EAAKG,SAASC,OAAON,EAAM,IAAM,GACjCE,EAAKK,QAAQP,EAAM,IACnBP,EAAMe,KAAKN,EAAKO,cAGjBhB,EAAMiB,OACN,IAAIC,EAAW,IAAIR,KAAKV,EAAMA,EAAMmB,OAAQ,IACxCC,EAAY,IAAIV,KAAKV,EAAM,IAE3BqB,EAAQzB,KAEZ,SAAS0B,EAAeb,GACvB,OAAOY,EAAM3B,WACZe,EAAKc,cACF,IAAMpC,KAAKqC,OAAOC,IAAIC,OAAOjB,EAAKkB,WAAa,GAAI,GACpD,IAAMxC,KAAKqC,OAAOC,IAAIC,OAAOjB,EAAKmB,aAqDtC,OAjDAhC,KAAKiC,SAAW,IAAIC,MAAMC,OAAOC,UAChCC,gBAAiB,SAASxB,GACzB,OAAOa,EAAeb,GAAQ,kBAAoB,kBAGhDyB,eAAgB,SAASzB,GAC3B,OAAOa,EAAeb,MAIrBb,KAAKiC,SAASM,KAAK,SAASnB,UAAYE,EAASF,UACnDpB,KAAKiC,SAASM,KAAK,QAASjB,GACpBtB,KAAKiC,SAASM,KAAK,SAASnB,UAAYI,EAAUJ,WAC1DpB,KAAKiC,SAASM,KAAK,QAASf,GAI7BxB,KAAKwC,MAAQ,IAAI7C,MAAM8C,OAAOC,eAC9BnD,KAAKoD,SAAS3C,KAAKwC,MAAM/B,QAAS,iBAGlCT,KAAK4C,SAAS5C,KAAKiC,UACnBjC,KAAK4C,SAAS5C,KAAKwC,OAGnBjD,KAAKsD,MAAM7C,KAAKwC,MAAM/B,QAAS,QAASlB,KAAKsD,MAAM7C,KAAKiC,SAASxB,QAAS,SAAW,MAErFlB,KAAKoD,SAAS3C,KAAKwC,MAAM/B,QAAS,6BAGlClB,KAAKc,QAAQH,EAAMX,KAAKe,MAAMN,KAAK,SAASO,GAC3CP,KAAKwC,MAAMI,SAASrC,MAKrBhB,KAAKuD,QAAQ9C,KAAKiC,SAAU,kBAAmB1C,KAAKe,MAAMN,KAAM,SAASa,GACxE,IAAIkC,EAAOrB,EAAeb,GAEvBkC,GACF/C,KAAKwC,MAAMQ,YAAYD,MAKzB/C,KAAKwC,MAAMQ,YAAY9C,EAAKA,EAAKqB,OAAS,IACrCvB,KAAKwC,MAAMS,SAAYjD,KAAKwC,MAAMvC,UACrCD,KAAKwC,MAAMzC,UAENC,KAAKkD,UAAUC","file":"../../../widget/tests/CalendarStackLayout.js","sourcesContent":["dojo.provide(\"dojox.widget.tests.CalendarStackLayout\");\r\ndojo.require(\"dijit.layout.ContentPane\");\r\ndojo.require(\"dijit.layout.StackContainer\");\r\ndojo.require(\"dojox.widget.Calendar\");\r\ndojo.require(\"dijit._Widget\");\r\ndojo.require(\"dijit._Container\");\r\ndojo.require(\"dojo.string\");\r\n\r\ndojo.declare(\"dojox.widget.tests.CalendarStackLayout\", [dijit._Widget, dijit._Container],{\r\n\tdateToPane: {},\r\n\tstartup: function(){\r\n\t\tif(this._started){\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\t\r\n\t\t// Get a list of the stack panes\r\n\t\tvar kids = this.getChildren();\r\n\t\tvar dates = [];\r\n\r\n\t\t// Store the dates for each pane\r\n\t\tdojo.forEach(kids, dojo.hitch(this, function(childContainer){\r\n\t\t\tvar dateRef = childContainer.domNode.getAttribute(\"dateref\");\r\n\t\t\tthis.dateToPane[dateRef] = childContainer;\r\n\t\t\t\r\n\t\t\tvar parts = dateRef.split(\"-\");\r\n\t\t\tvar date = new Date();\r\n\t\t\tdate.setFullYear(parts[0]);\r\n\t\t\tdate.setMonth(Number(parts[1]) - 1);\r\n\t\t\tdate.setDate(parts[2]);\r\n\t\t\tdates.push(date.getTime());\r\n\t\t}));\r\n\t\t\r\n\t\tdates.sort();\r\n\t\tvar lastDate = new Date(dates[dates.length -1]);\r\n\t\tvar firstDate = new Date(dates[0]);\r\n\r\n\t\tvar _this = this;\r\n\r\n\t\tfunction getChildByDate(date){\r\n\t\t\treturn _this.dateToPane[\r\n\t\t\t\tdate.getFullYear()\r\n\t\t\t\t+  \"-\" + dojo.string.pad(String(date.getMonth() + 1), 2)\r\n\t\t\t\t+ \"-\" + dojo.string.pad(String(date.getDate()))];\r\n\t\t}\r\n\r\n\t\t// Instantiate the calendar, overriding the getClassForDate and isDisabledDate functions\r\n\t\tthis.calendar = new dojox.widget.Calendar({\r\n\t\t\tgetClassForDate: function(date){\r\n\t\t\t\treturn getChildByDate(date) ? \" hasAppointment\" : \" noAppointment\";\r\n\t\t    },\r\n\r\n\t\t    isDisabledDate: function(date){\r\n\t\t\t\treturn getChildByDate(date) ? false : true;\r\n\t\t    }\r\n\t\t});\r\n\t\t\r\n\t\tif(this.calendar.attr(\"value\").getTime() > lastDate.getTime()){\r\n\t\t\tthis.calendar.attr(\"value\", lastDate);\r\n\t\t}else if(this.calendar.attr(\"value\").getTime() < firstDate.getTime()){\r\n\t\t\tthis.calendar.attr(\"value\", firstDate);\r\n\t\t}\r\n\r\n\t\t// Instantiate the stack container\r\n\t\tthis.stack = new dijit.layout.StackContainer();\r\n\t\tdojo.addClass(this.stack.domNode, \"calendarStack\");\r\n\r\n\t\t//Add the calendar and stack container to this widget\r\n\t\tthis.addChild(this.calendar);\r\n\t\tthis.addChild(this.stack);\r\n\r\n\t\t// Set up some styles on the calendar and stack container\r\n\t\tdojo.style(this.stack.domNode, \"width\", dojo.style(this.calendar.domNode, \"width\") + \"px\");\r\n\t\t\r\n\t\tdojo.addClass(this.stack.domNode, \"dijitCalendarStackDetails\");\r\n\r\n\t\t// Add all the content panes to the stack container\r\n\t\tdojo.forEach(kids, dojo.hitch(this,function(childContainer){\r\n\t\t\tthis.stack.addChild(childContainer);\r\n\t\t}));\r\n\r\n\t\t// Add a listener to the onValueSelected method of the calendar\r\n\t\t// to select the correct pane\r\n\t\tdojo.connect(this.calendar, \"onValueSelected\", dojo.hitch(this, function(date){\r\n\t\t\tvar pane = getChildByDate(date);\r\n\r\n\t\t\tif(pane){\r\n\t\t\t\tthis.stack.selectChild(pane);\r\n\t\t\t}\r\n\t\t}));\r\n\t\t\r\n\t\t// Show the last pane automatically\r\n\t\tthis.stack.selectChild(kids[kids.length - 1]);\r\n\t\t\tif(!this.stack.started && !this.stack._started){\r\n\t\t\t\tthis.stack.startup();\r\n\t\t\t}\r\n\t\treturn this.inherited(arguments);\r\n\t\t\r\n\t}\r\n});"]}