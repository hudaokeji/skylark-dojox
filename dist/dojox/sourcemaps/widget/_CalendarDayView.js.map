{"version":3,"sources":["widget/_CalendarDayView.js"],"names":["define","declare","_CalendarView","_TemplatedMixin","query","domClass","event","date","locale","template","supplemental","templateString","datePart","dayWidth","postCreate","this","cloneClass","dayNames","getNames","getLang","dayOffset","getFirstDayOfWeek","domNode","forEach","label","i","_setText","onDisplay","_addedFx","addFx","_onDayClick","e","target","displayMonth","Date","get","p","parentNode","c","d","contains","add","setDate","_date","isDisabledDate","stop","parent","_onDateSelected","_setValueAttr","value","_populateDays","currentDate","firstDay","getDay","daysInMonth","getDaysInMonth","daysInPreviousMonth","today","selected","compareDate","compare","selectedCls","oldDate","_lastDate","redrawRequired","getMonth","getFullYear","number","eachDate","clazz","adj","clazz2","getClassForDate","className","dijitDateValue","valueOf","getDate","monthNames","monthLabelNode","yearLabelNode","removeClass","filter","node","indexOf","addClass"],"mappings":"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","file":"../../widget/_CalendarDayView.js","sourcesContent":["define([\r\n\t\"dojo/_base/declare\",\r\n\t\"./_CalendarView\",\r\n\t\"dijit/_TemplatedMixin\",\r\n\t\"dojo/query\",\r\n\t\"dojo/dom-class\",\r\n\t\"dojo/_base/event\",\r\n\t\"dojo/date\",\r\n\t\"dojo/date/locale\",\r\n\t\"dojo/text!./Calendar/CalendarDay.html\",\r\n\t\"dojo/cldr/supplemental\",\r\n\t\"dojo/NodeList-dom\"\r\n], function(declare, _CalendarView, _TemplatedMixin, query, domClass, event, date, locale, template, supplemental){\r\n\treturn declare(\"dojox.widget._CalendarDayView\", [_CalendarView, _TemplatedMixin], {\r\n\t\t// summary:\r\n\t\t//\t\tView class for the dojox/widget/Calendar.\r\n\t\t//\t\tAdds a view showing every day of a single month to the calendar.\r\n\t\t//\t\tThis should not be mixed in directly with dojox/widget._CalendarBase.\r\n\t\t//\t\tInstead, use dojox/widget._CalendarDay\r\n\r\n\t\t// templateString: String\r\n\t\t//\t\tThe template to be used to construct the widget.\r\n\t\ttemplateString: template,\r\n\r\n\t\t// datePart: String\r\n\t\t//\t\tSpecifies how much to increment the displayed date when the user\r\n\t\t//\t\tclicks the array button to increment of decrement the view.\r\n\t\tdatePart: \"month\",\r\n\r\n\t\t// dayWidth: String\r\n\t\t//\t\tSpecifies the type of day name to display.\t\"narrow\" causes just one letter to be shown.\r\n\t\tdayWidth: \"narrow\",\r\n\r\n\t\tpostCreate: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tConstructs the calendar view.\r\n\t\t\tthis.cloneClass(\".dijitCalendarDayLabelTemplate\", 6);\r\n\t\t\tthis.cloneClass(\".dijitCalendarDateTemplate\", 6);\r\n\r\n\t\t\t// now make 6 week rows\r\n\t\t\tthis.cloneClass(\".dijitCalendarWeekTemplate\", 5);\r\n\r\n\t\t\t// insert localized day names in the header\r\n\t\t\tvar dayNames = locale.getNames('days', this.dayWidth, 'standAlone', this.getLang());\r\n\t\t\tvar dayOffset = supplemental.getFirstDayOfWeek(this.getLang());\r\n\r\n\t\t\t// Set the text of the day labels.\r\n\t\t\tquery(\".dijitCalendarDayLabel\", this.domNode).forEach(function(label, i){\r\n\t\t\t\tthis._setText(label, dayNames[(i + dayOffset) % 7]);\r\n\t\t\t}, this);\r\n\t\t},\r\n\r\n\t\tonDisplay: function(){\r\n\t\t\tif(!this._addedFx){\r\n\t\t\t// Add visual effects to the view, if any has been specified.\r\n\t\t\t\tthis._addedFx = true;\r\n\t\t\t\tthis.addFx(\".dijitCalendarDateTemplate div\", this.domNode);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// TODO: This method needs serious work\r\n\t\t_onDayClick: function(/*Event*/ e){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tExecuted when a day value is clicked.\r\n\r\n\t\t\t// If the user somehow clicked the TR, rather than a\r\n\t\t\t// cell, ignore it.\r\n\t\t\tif(typeof(e.target._date) == \"undefined\"){return;}\r\n\r\n\t\t\tvar displayMonth = new Date(this.get(\"displayMonth\"));\r\n\r\n\t\t\tvar p = e.target.parentNode;\r\n\t\t\tvar c = \"dijitCalendar\";\r\n\t\t\tvar d = domClass.contains(p, c + \"PreviousMonth\") ? -1 :\r\n\t\t\t\t\t\t\t\t(domClass.contains(p, c + \"NextMonth\") ? 1 : 0);\r\n\t\t\tif(d){displayMonth = date.add(displayMonth, \"month\", d);}\r\n\t\t\tdisplayMonth.setDate(e.target._date);\r\n\r\n\t\t\t// If the day is disabled, ignore it\r\n\t\t\tif(this.isDisabledDate(displayMonth)){\r\n\t\t\t\tevent.stop(e);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.parent._onDateSelected(displayMonth);\r\n\t\t},\r\n\r\n\t\t_setValueAttr: function(value){\r\n\t\t\t//Change the day values\r\n\t\t\tthis._populateDays();\r\n\t\t},\r\n\r\n\t\t_populateDays: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tFills the days of the current month.\r\n\r\n\t\t\tvar currentDate = new Date(this.get(\"displayMonth\"));\r\n\t\t\tcurrentDate.setDate(1);\r\n\t\t\tvar firstDay = currentDate.getDay();\r\n\t\t\tvar daysInMonth = date.getDaysInMonth(currentDate);\r\n\t\t\tvar daysInPreviousMonth = date.getDaysInMonth(date.add(currentDate, \"month\", -1));\r\n\t\t\tvar today = new Date();\r\n\t\t\tvar selected = this.get('value');\r\n\r\n\t\t\tvar dayOffset = supplemental.getFirstDayOfWeek(this.getLang());\r\n\t\t\tif(dayOffset > firstDay){ dayOffset -= 7; }\r\n\r\n\t\t\tvar compareDate = date.compare;\r\n\t\t\tvar templateCls = \".dijitCalendarDateTemplate\";\r\n\t\t\tvar selectedCls = \"dijitCalendarSelectedDate\";\r\n\r\n\t\t\tvar oldDate = this._lastDate;\r\n\t\t\tvar redrawRequired = oldDate == null\r\n\t\t\t\t\t|| oldDate.getMonth() != currentDate.getMonth()\r\n\t\t\t\t\t|| oldDate.getFullYear() != currentDate.getFullYear();\r\n\t\t\tthis._lastDate = currentDate;\r\n\r\n\t\t\t// If still showing the same month, it's much faster to not redraw,\r\n\t\t\t// and just change the selected date.\r\n\t\t\tif(!redrawRequired){\r\n\t\t\t\tquery(templateCls, this.domNode)\r\n\t\t\t\t\t\t.removeClass(selectedCls)\r\n\t\t\t\t\t\t.filter(function(node){\r\n\t\t\t\t\t\t\treturn node.className.indexOf(\"dijitCalendarCurrent\") > -1\r\n\t\t\t\t\t\t\t\t\t\t&& node._date == selected.getDate();\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.addClass(selectedCls);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Iterate through dates in the calendar and fill in date numbers and style info\r\n\t\t\tquery(templateCls, this.domNode).forEach(function(template, i){\r\n\t\t\t\ti += dayOffset;\r\n\t\t\t\tvar eachDate = new Date(currentDate);\r\n\t\t\t\tvar number, clazz = \"dijitCalendar\", adj = 0;\r\n\r\n\t\t\t\tif(i < firstDay){\r\n\t\t\t\t\tnumber = daysInPreviousMonth - firstDay + i + 1;\r\n\t\t\t\t\tadj = -1;\r\n\t\t\t\t\tclazz += \"Previous\";\r\n\t\t\t\t}else if(i >= (firstDay + daysInMonth)){\r\n\t\t\t\t\tnumber = i - firstDay - daysInMonth + 1;\r\n\t\t\t\t\tadj = 1;\r\n\t\t\t\t\tclazz += \"Next\";\r\n\t\t\t\t}else{\r\n\t\t\t\t\tnumber = i - firstDay + 1;\r\n\t\t\t\t\tclazz += \"Current\";\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(adj){\r\n\t\t\t\t\teachDate = date.add(eachDate, \"month\", adj);\r\n\t\t\t\t}\r\n\t\t\t\teachDate.setDate(number);\r\n\r\n\t\t\t\tif(!compareDate(eachDate, today, \"date\")){\r\n\t\t\t\t\tclazz = \"dijitCalendarCurrentDate \" + clazz;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(!compareDate(eachDate, selected, \"date\")\r\n\t\t\t\t\t\t&& !compareDate(eachDate, selected, \"month\")\r\n\t\t\t\t\t\t&& !compareDate(eachDate, selected, \"year\") ){\r\n\t\t\t\t\tclazz = selectedCls + \" \" + clazz;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(this.isDisabledDate(eachDate, this.getLang())){\r\n\t\t\t\t\tclazz = \" dijitCalendarDisabledDate \" + clazz;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar clazz2 = this.getClassForDate(eachDate, this.getLang());\r\n\t\t\t\tif(clazz2){\r\n\t\t\t\t\tclazz = clazz2 + \" \" + clazz;\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttemplate.className = clazz + \"Month dijitCalendarDateTemplate\";\r\n\t\t\t\ttemplate.dijitDateValue = eachDate.valueOf();\r\n\t\t\t\tvar label = query(\".dijitCalendarDateLabel\", template)[0];\r\n\r\n\t\t\t\tthis._setText(label, eachDate.getDate());\r\n\r\n\t\t\t\tlabel._date = label.parentNode._date = eachDate.getDate();\r\n\t\t\t}, this);\r\n\r\n\t\t\t// Fill in localized month name\r\n\t\t\tvar monthNames = locale.getNames('months', 'wide', 'standAlone', this.getLang());\r\n\t\t\tthis._setText(this.monthLabelNode, monthNames[currentDate.getMonth()]);\r\n\t\t\tthis._setText(this.yearLabelNode, currentDate.getFullYear());\r\n\t\t}\r\n\t});\r\n});"]}