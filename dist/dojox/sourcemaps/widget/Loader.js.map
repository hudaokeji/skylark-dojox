{"version":3,"sources":["widget/Loader.js"],"names":["dojo","provide","deprecated","require","declare","dijit","_Widget","_Templated","loadIcon","moduleUrl","loadMessage","hasVisuals","attachToPointer","duration","_offset","_pointerConnect","_xhrStart","_xhrEnd","templateString","postCreate","this","removeClass","loadNode","addClass","_hide","style","display","_setMessage","connect","Deferred","prototype","message","loadMessageNode","innerHTML","_putLoader","e","placeOnScreen","x","clientX","y","clientY","_show","publish","document","opacity","fadeIn","node","play","disconnect","fadeOut","onEnd","partial"],"mappings":";;;;;;;AAAAA,KAAKC,QAAQ,uBACbD,KAAKE,WAAW,sBAAuB,GAAI,OAE3CF,KAAKG,QAAQ,iBACbH,KAAKG,QAAQ,oBAEbH,KAAKI,QAAQ,uBAAwBC,MAAMC,QAAQD,MAAME,aAQxDC,SAAUR,KAAKS,UAAU,sBAAsB,qBAI/CC,YAAa,cAKbC,YAAY,EAIZC,iBAAiB,EAIjBC,SAAU,IAIVC,QAAS,GAGTC,gBAAiB,KACjBC,UAAW,KACXC,QAAS,KAETC,eAAgB,uLAIhBC,WAAY,WAIPC,KAAKT,YAGLS,KAAKR,kBACPZ,KAAKqB,YAAYD,KAAKE,SAAS,eAC/BtB,KAAKuB,SAASH,KAAKE,SAAS,uBAE7BF,KAAKI,SANLJ,KAAKE,SAASG,MAAMC,QAAU,OAQ/BN,KAAKO,YAAYP,KAAKV,aAItBU,KAAKJ,UAAYI,KAAKQ,QAAQ5B,KAAK,aAAa,SAChDoB,KAAKH,QAAUG,KAAKQ,QAAQ5B,KAAK6B,SAASC,UAAU,QAAQ,UAI7DH,YAAa,SAAsBI,GAGlCX,KAAKY,gBAAgBC,UAAYF,GAGlCG,WAAY,SAAqBC,GAGhC9B,MAAM+B,cAAchB,KAAKE,UAAWe,EAAGF,EAAEG,QAAQlB,KAAKN,QAASyB,EAAEJ,EAAEK,QAAQpB,KAAKN,UAAY,KAAK,QAGlG2B,MAAO,WAGNzC,KAAK0C,QAAQ,WAAYX,QAAS,aAC/BX,KAAKT,aACJS,KAAKR,kBACPQ,KAAKL,gBAAkBK,KAAKQ,QAAQe,SAAS,cAAc,eAE5D3C,KAAKyB,MAAML,KAAKE,UACfsB,QAAQ,EAAGlB,QAAQ,KAEpB1B,KAAK6C,QAASC,KAAM1B,KAAKE,SAAUT,SAASO,KAAKP,WAAYkC,SAI/DvB,MAAO,WAGNxB,KAAK0C,QAAQ,WAAYX,QAAS,WAC/BX,KAAKT,aACJS,KAAKR,iBACPQ,KAAK4B,WAAW5B,KAAKL,iBAEtBf,KAAKiD,SACJH,KAAM1B,KAAKE,SACXT,SAASO,KAAKP,SACdqC,MAAOlD,KAAKmD,QAAQnD,KAAKyB,MAAOL,KAAKE,SAAU,UAAW,UACxDyB","file":"../../widget/Loader.js","sourcesContent":["dojo.provide(\"dojox.widget.Loader\");\r\ndojo.deprecated(\"dojox.widget.Loader\", \"\", \"2.0\");\r\n\r\ndojo.require(\"dijit._Widget\");\r\ndojo.require(\"dijit._Templated\");\r\n\r\ndojo.declare(\"dojox.widget.Loader\", [dijit._Widget,dijit._Templated], {\r\n\t// summary:\r\n\t//\t\ta configurable global xhr-listener to display\r\n\t//\t\ta loading message during running xhr's or to simply provide\r\n\t//\t\tbase-level topic to subscribe to for custom loading messages\r\n\r\n\t// loadIcon: String\r\n\t// \t\tlocation to the icon used.\r\n\tloadIcon: dojo.moduleUrl(\"dojox.widget.Loader\",\"icons/loading.gif\"),\r\n\r\n\t// loadMessage: String\r\n\t//\t\tstring to use for progress loading\r\n\tloadMessage: 'Loading ...',\r\n\r\n\t// hasVisuals: Boolean\r\n\t//\t\ttrue to display a fixed loading message in TR cornder, false to unly provide\r\n\t//\t\t\"Loader\" topic to subscribe to for your own custom loading message.\r\n\thasVisuals: true,\r\n\r\n\t// attachToPointer\r\n\t//\t\ttrue to use visual indicator where cursor is\r\n\tattachToPointer: true,\r\n\r\n\t// duration: Integer\r\n\t//\t\ttime in ms to toggle in/out the visual load indicator\r\n\tduration: 125,\r\n\r\n\t// _offset: Integer\r\n\t//\t\tdistance in px from the mouse pointer to show attachToPointer avatar\r\n\t_offset: 16,\r\n\r\n\t// holder for mousemove connection\r\n\t_pointerConnect: null,\r\n\t_xhrStart: null,\r\n\t_xhrEnd: null,\r\n\r\n\ttemplateString: '<div dojoAttachPoint=\"loadNode\" class=\"dojoxLoader\">'\r\n\t\t+'<img src=\"${loadIcon}\" class=\"dojoxLoaderIcon\"> <span dojoAttachPoint=\"loadMessageNode\" class=\"dojoxLoaderMessage\"></span>'\r\n\t\t+'</div>',\r\n\t\r\n\tpostCreate: function(){\r\n\t\t// summary:\r\n\t\t//\t\tsetup the loader\r\n\r\n\t\tif(!this.hasVisuals){\r\n\t\t\tthis.loadNode.style.display = \"none\"; // _destroy()?\r\n\t\t}else{\r\n\t\t\tif(this.attachToPointer){\r\n\t\t\t\tdojo.removeClass(this.loadNode,\"dojoxLoader\");\r\n\t\t\t\tdojo.addClass(this.loadNode,\"dojoxLoaderPointer\");\r\n\t\t\t}\r\n\t\t\tthis._hide();\r\n\t\t}\r\n\t\tthis._setMessage(this.loadMessage);\r\n\r\n\t\t// FIXME: create our connections.  would be easier, and this might be redundant\r\n\t\t// if Deferred published something. XHR published stuff. FIXME to use that.\r\n\t\tthis._xhrStart = this.connect(dojo,\"_ioSetArgs\",\"_show\");\r\n\t\tthis._xhrEnd = this.connect(dojo.Deferred.prototype,\"_fire\",\"_hide\");\r\n\r\n\t},\r\n\r\n\t_setMessage: function(/* String */ message){\r\n\t\t// summary:\r\n\t\t//\t\tset's the message in the loader\r\n\t\tthis.loadMessageNode.innerHTML = message;\r\n\t},\r\n\r\n\t_putLoader: function(/* Event */ e){\r\n\t\t// summary:\r\n\t\t//\t\tplace the floating loading element based on mousemove connection position\r\n\t\tdijit.placeOnScreen(this.loadNode,{ x: e.clientX+this._offset, y:e.clientY+this._offset }, [\"TL\",\"BR\"]);\r\n\t},\r\n\r\n\t_show: function(){\r\n\t\t// summary:\r\n\t\t//\t\tpublish and show progress indicator\r\n\t\tdojo.publish(\"Loader\",[{ message: 'started' }]);\r\n\t\tif(this.hasVisuals){\r\n\t\t\tif(this.attachToPointer){\r\n\t\t\t\tthis._pointerConnect = this.connect(document,\"onmousemove\",\"_putLoader\");\r\n\t\t\t}\r\n\t\t\tdojo.style(this.loadNode, {\r\n\t\t\t\topacity:0, display:\"\"\r\n\t\t\t});\r\n\t\t\tdojo.fadeIn({ node: this.loadNode, duration:this.duration }).play();\r\n\t\t}\r\n\t},\r\n\r\n\t_hide: function(){\r\n\t\t// summary:\r\n\t\t//\t\tpublish \"xhr ended\" and hide progress indicator\r\n\t\tdojo.publish(\"Loader\",[{ message: 'ended' }]);\r\n\t\tif(this.hasVisuals){\r\n\t\t\tif(this.attachToPointer){\r\n\t\t\t\tthis.disconnect(this._pointerConnect);\r\n\t\t\t}\r\n\t\t\tdojo.fadeOut({\r\n\t\t\t\tnode: this.loadNode,\r\n\t\t\t\tduration:this.duration,\r\n\t\t\t\tonEnd: dojo.partial(dojo.style, this.loadNode, \"display\", \"none\")\r\n\t\t\t}).play();\r\n\t\t}\r\n\t}\r\n\r\n});\r\n"]}