{"version":3,"sources":["widget/RollingList.js"],"names":["dojo","provide","experimental","require","requireLocalization","declare","dijit","layout","ContentPane","_Templated","_Contained","templateString","parentWidget","parentPane","store","items","query","queryOptions","_focusByNode","minWidth","_setContentAndScroll","cont","isFakeContent","this","_setContent","scrollIntoView","_updateNodeWidth","n","min","style","width","marginBox","w","_onMinWidthChange","v","domNode","_setMinWidthAttr","startup","_started","getFeatures","window","setTimeout","hitch","connect","focusNode","_updateClass","inherited","arguments","_focusKey","e","charOrCode","keys","BACKSPACE","LEFT_ARROW","focus","ENTER","_onExecute","stopEvent","force","_focusedPane","_savedFocus","_onShow","refreshOnShow","isLoaded","refresh","_load","onLoadStart","_doQuery","_doLoadItems","callback","_waitCount","forEach","item","isItemLoaded","onItem","loadItem","preload","preloadItems","length","Number","onItems","onFetchStart","fetch","onComplete","onError","_onError","scope","_hasItem","myItem","i","_itemsMatch","_onSetItem","attribute","oldValue","newValue","_onNewItem","newItem","parentInfo","sel","_getSelected","push","_onDeleteItem","deletedItem","filter","loadingMessage","onFetchError","error","errorMessage","onLoadError","onLoadDeferred","cancel","Deferred","_onLoadHandler","dojox","widget","_RollingListPane","_menu","dWidth","mWidth","selectItem","child","selectMenuItem","destroyRecursive","_getMenu","_getMenuItemForItem","addChild","_setSelected","children","itemPane","_getPaneForItem","getIndexInParent","_removeAfter","_onItemClick","containerNode","innerHTML","appendChild","_checkScrollConnection","doLoad","_scrollConn","disconnect","every","_loadVisibleItems","_pendingFocus","focusWidget","focusedChild","byNode","getChildren","self","menu","Menu","parentMenu","onCancel","closeAll","_moveToPopup","evt","disabled","onItemClick","menuNode","alreadySelected","hasClass","type","p","_onScrollPane","_visibleLoadPending","clearTimeout","gpbme","m","pb","s","getComputedStyle","r","_getMarginExtents","t","_getPadBorderExtents","topOffset","h","contentBox","minOffset","scrollTop","maxOffset","menuItemsToLoad","c","cnt","offsetTop","itemsToLoad","map","idx","oItem","oIdx","removeChild","focusChild","destroy","Selected","_Widget","_Container","cache","widgetsInTemplate","className","childrenAttrs","parentAttr","value","executeOnDblClick","showButtons","okButtonLabel","cancelButtonLabel","minPaneWidth","postMixInProperties","loc","i18n","getLocalization","buttonOk","buttonCancel","_setShowButtonsAttr","doShow","needsLayout","started","toggleClass","item1","item2","_isIdentity","getIdentity","getIndexOfChild","selItem","val","_setInProgress","_setValue","insertIndex","attr","_setMinPaneWidthAttr","node","options","_declaredClasses","split","k","addClass","childWidget","_scrollingTimeout","resize","args","_LayoutWidget","prototype","call","_contentBox","bn","buttonsNode","height","html","metrics","getScrollbar","foc","_onChange","onChange","_setValueAttr","isItem","pane","fetchParentItems","id","getValue","cb","fetchItemByIdentity","identity","numCheck","parents","q","concat","setFromChain","itemChain","conn","set","fx","selOpt","stopPropagation","preventDefault","getChildItems","parentChain","onParents","pop","reverse","ns","display","visibility","_visibleItem","next","getNextSibling","ret","getPaneForItem","widgetItem","itemLoaded","childItems","undefined","getMenuItemForItem","Expanding","arrowWrapper","Single","Unloaded","label","getLabel","replace","Hover","Focus","MenuItem","iconClass","_setStore","rootPane","_onKey","ESCAPE","RIGHT_ARROW","_resetValue","_lastExecutedValue","_onCancel","get","onExecute","wasSaved","getFocus","handleKey","keyCode","DOWN_ARROW","_updateChildClasses","getParent","global","vals","getValues","_RollingListGroupPane"],"mappings":"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","file":"../../widget/RollingList.js","sourcesContent":["dojo.provide(\"dojox.widget.RollingList\");\r\ndojo.experimental(\"dojox.widget.RollingList\");\r\n\r\ndojo.require(\"dojo.window\");\r\n\r\ndojo.require(\"dijit.layout.ContentPane\");\r\ndojo.require(\"dijit._Templated\");\r\ndojo.require(\"dijit._Contained\");\r\ndojo.require(\"dijit.layout._LayoutWidget\");\r\ndojo.require(\"dijit.Menu\");\r\ndojo.require(\"dijit.form.Button\");\r\ndojo.require(\"dijit.focus\");\t\t// dijit.focus()\r\ndojo.require(\"dijit._base.focus\");\t// dijit.getFocus()\r\n\r\ndojo.require(\"dojox.html.metrics\");\r\n\r\ndojo.require(\"dojo.i18n\");\r\ndojo.requireLocalization(\"dijit\", \"common\");\r\n\r\ndojo.declare(\"dojox.widget._RollingListPane\",\r\n\t[dijit.layout.ContentPane, dijit._Templated, dijit._Contained], {\r\n\t// summary:\r\n\t//\t\ta core pane that can be attached to a RollingList.  All panes\r\n\t//\t\tshould extend this one\r\n\r\n\t// templateString: string\r\n\t//\t\tour template\r\n\ttemplateString: '<div class=\"dojoxRollingListPane\"><table><tbody><tr><td dojoAttachPoint=\"containerNode\"></td></tr></tbody></div>',\r\n\r\n\t// parentWidget: dojox.widget.RollingList\r\n\t//\t\tOur rolling list widget\r\n\tparentWidget: null,\r\n\t\r\n\t// parentPane: dojox.widget._RollingListPane\r\n\t//\t\tThe pane that immediately precedes ours\r\n\tparentPane: null,\r\n\t\t\t\r\n\t// store: store\r\n\t//\t\tthe store we must use\r\n\tstore: null,\r\n\r\n\t// items: item[]\r\n\t//\t\tan array of (possibly not-yet-loaded) items to display in this.\r\n\t//\t\tIf this array is null, then the query and query options are used to\r\n\t//\t\tget the top-level items to use.  This array is also used to watch and\r\n\t//\t\tsee if the pane needs to be reloaded (store notifications are handled)\r\n\t//\t\tby the pane\r\n\titems: null,\r\n\t\r\n\t// query: object\r\n\t//\t\ta query to pass to the datastore.  This is only used if items are null\r\n\tquery: null,\r\n\t\r\n\t// queryOptions: object\r\n\t//\t\tquery options to be passed to the datastore\r\n\tqueryOptions: null,\r\n\t\r\n\t// focusByNode: boolean\r\n\t//\t\tset to false if the subclass will handle its own node focusing\r\n\t_focusByNode: true,\r\n\t\r\n\t// minWidth: integer\r\n\t//\t\tthe width (in px) for this pane\r\n\tminWidth: 0,\r\n\t\r\n\t_setContentAndScroll: function(/*String|DomNode|Nodelist*/cont, /*Boolean?*/isFakeContent){\r\n\t\t// summary:\r\n\t\t//\t\tsets the value of the content and scrolls it into view\r\n\t\tthis._setContent(cont, isFakeContent);\r\n\t\tthis.parentWidget.scrollIntoView(this);\r\n\t},\r\n\r\n\t_updateNodeWidth: function(n, min){\r\n\t\t// summary:\r\n\t\t//\t\tupdates the min width of the pane to be minPaneWidth\r\n\t\tn.style.width = \"\";\r\n\t\tvar nWidth = dojo.marginBox(n).w;\r\n\t\tif(nWidth < min){\r\n\t\t\tdojo.marginBox(n, {w: min});\r\n\t\t}\r\n\t},\r\n\t\r\n\t_onMinWidthChange: function(v){\r\n\t\t// Called when the min width of a pane has changed\r\n\t\tthis._updateNodeWidth(this.domNode, v);\r\n\t},\r\n\t\r\n\t_setMinWidthAttr: function(v){\r\n\t\tif(v !== this.minWidth){\r\n\t\t\tthis.minWidth = v;\r\n\t\t\tthis._onMinWidthChange(v);\r\n\t\t}\r\n\t},\r\n\t\r\n\tstartup: function(){\r\n\t\tif(this._started){ return; }\r\n\t\tif(this.store && this.store.getFeatures()[\"dojo.data.api.Notification\"]){\r\n\t\t\twindow.setTimeout(dojo.hitch(this, function(){\r\n\t\t\t\t// Set connections after a slight timeout to avoid getting in the\r\n\t\t\t\t// condition where we are setting them while events are still\r\n\t\t\t\t// being fired\r\n\t\t\t\tthis.connect(this.store, \"onSet\", \"_onSetItem\");\r\n\t\t\t\tthis.connect(this.store, \"onNew\", \"_onNewItem\");\r\n\t\t\t\tthis.connect(this.store, \"onDelete\", \"_onDeleteItem\");\r\n\t\t\t}), 1);\r\n\t\t}\r\n\t\tthis.connect(this.focusNode||this.domNode, \"onkeypress\", \"_focusKey\");\r\n\t\tthis.parentWidget._updateClass(this.domNode, \"Pane\");\r\n\t\tthis.inherited(arguments);\r\n\t\tthis._onMinWidthChange(this.minWidth);\r\n\t},\r\n\r\n\t_focusKey: function(/*Event*/e){\r\n\t\t// summary:\r\n\t\t//\t\tcalled when a keypress happens on the widget\r\n\t\tif(e.charOrCode == dojo.keys.BACKSPACE){\r\n\t\t\tdojo.stopEvent(e);\r\n\t\t\treturn;\r\n\t\t}else if(e.charOrCode == dojo.keys.LEFT_ARROW && this.parentPane){\r\n\t\t\tthis.parentPane.focus();\r\n\t\t\tthis.parentWidget.scrollIntoView(this.parentPane);\r\n\t\t}else if(e.charOrCode == dojo.keys.ENTER){\r\n\t\t\tthis.parentWidget._onExecute();\r\n\t\t}\r\n\t},\r\n\t\r\n\tfocus: function(/*boolean*/force){\r\n\t\t// summary:\r\n\t\t//\t\tsets the focus to this current widget\r\n\t\tif(this.parentWidget._focusedPane != this){\r\n\t\t\tthis.parentWidget._focusedPane = this;\r\n\t\t\tthis.parentWidget.scrollIntoView(this);\r\n\t\t\tif(this._focusByNode && (!this.parentWidget._savedFocus || force)){\r\n\t\t\t\ttry{(this.focusNode||this.domNode).focus();}catch(e){}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t_onShow: function(){\r\n\t\t// summary:\r\n\t\t//\t\tchecks that the store is loaded\r\n\t\tthis.inherited(arguments);\r\n\t\tif((this.store || this.items) && ((this.refreshOnShow && this.domNode) || (!this.isLoaded && this.domNode))){\r\n\t\t\tthis.refresh();\r\n\t\t}\r\n\t},\r\n\r\n\t_load: function(){\r\n\t\t// summary:\r\n\t\t//\t\tsets the \"loading\" message and then kicks off a query asyncronously\r\n\t\tthis.isLoaded = false;\r\n\t\tif(this.items){\r\n\t\t\tthis._setContentAndScroll(this.onLoadStart(), true);\r\n\t\t\twindow.setTimeout(dojo.hitch(this, \"_doQuery\"), 1);\r\n\t\t}else{\r\n\t\t\tthis._doQuery();\r\n\t\t}\r\n\t},\r\n\t\r\n\t_doLoadItems: function(/*item[]*/items, /*function*/callback){\r\n\t\t// summary:\r\n\t\t//\t\tloads the given items, and then calls the callback when they\r\n\t\t//\t\tare finished.\r\n\t\tvar _waitCount = 0, store = this.store;\r\n\t\tdojo.forEach(items, function(item){\r\n\t\t\tif(!store.isItemLoaded(item)){ _waitCount++; }\r\n\t\t});\r\n\t\tif(_waitCount === 0){\r\n\t\t\tcallback();\r\n\t\t}else{\r\n\t\t\tvar onItem = function(item){\r\n\t\t\t\t_waitCount--;\r\n\t\t\t\tif((_waitCount) === 0){\r\n\t\t\t\t\tcallback();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tdojo.forEach(items, function(item){\r\n\t\t\t\tif(!store.isItemLoaded(item)){\r\n\t\t\t\t\tstore.loadItem({item: item, onItem: onItem});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\t\r\n\t_doQuery: function(){\r\n\t\t// summary:\r\n\t\t//\t\teither runs the query or loads potentially not-yet-loaded items.\r\n\t\tif(!this.domNode){return;}\r\n\t\tvar preload = this.parentWidget.preloadItems;\r\n\t\tpreload = (preload === true || (this.items && this.items.length <= Number(preload)));\r\n\t\tif(this.items && preload){\r\n\t\t\tthis._doLoadItems(this.items, dojo.hitch(this, \"onItems\"));\r\n\t\t}else if(this.items){\r\n\t\t\tthis.onItems();\r\n\t\t}else{\r\n\t\t\tthis._setContentAndScroll(this.onFetchStart(), true);\r\n\t\t\tthis.store.fetch({query: this.query,\r\n\t\t\t\tonComplete: function(items){\r\n\t\t\t\t\tthis.items = items;\r\n\t\t\t\t\tthis.onItems();\r\n\t\t\t\t},\r\n\t\t\t\tonError: function(e){\r\n\t\t\t\t\tthis._onError(\"Fetch\", e);\r\n\t\t\t\t},\r\n\t\t\t\tscope: this});\r\n\t\t}\r\n\t},\r\n\r\n\t_hasItem: function(/* item */ item){\r\n\t\t// summary:\r\n\t\t//\t\treturns whether or not the given item is handled by this\r\n\t\t//\t\tpane\r\n\t\tvar items = this.items || [];\r\n\t\tfor(var i = 0, myItem; (myItem = items[i]); i++){\r\n\t\t\tif(this.parentWidget._itemsMatch(myItem, item)){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t},\r\n\t\r\n\t_onSetItem: function(/* item */ item,\r\n\t\t\t\t\t/* attribute-name-string */ attribute,\r\n\t\t\t\t\t/* Object|Array */ oldValue,\r\n\t\t\t\t\t/* Object|Array */ newValue){\r\n\t\t// summary:\r\n\t\t//\t\tcalled when an item in the store has changed\r\n\t\tif(this._hasItem(item)){\r\n\t\t\tthis.refresh();\r\n\t\t}\r\n\t},\r\n\t\r\n\t_onNewItem: function(/* item */ newItem, /*object?*/ parentInfo){\r\n\t\t// summary:\r\n\t\t//\t\tcalled when an item is added to the store\r\n\t\tvar sel;\r\n\t\tif((!parentInfo && !this.parentPane) ||\r\n\t\t\t(parentInfo && this.parentPane && this.parentPane._hasItem(parentInfo.item) &&\r\n\t\t\t(sel = this.parentPane._getSelected()) && this.parentWidget._itemsMatch(sel.item, parentInfo.item))){\r\n\t\t\tthis.items.push(newItem);\r\n\t\t\tthis.refresh();\r\n\t\t}else if(parentInfo && this.parentPane && this._hasItem(parentInfo.item)){\r\n\t\t\tthis.refresh();\r\n\t\t}\r\n\t},\r\n\t\r\n\t_onDeleteItem: function(/* item */ deletedItem){\r\n\t\t// summary:\r\n\t\t//\t\tcalled when an item is removed from the store\r\n\t\tif(this._hasItem(deletedItem)){\r\n\t\t\tthis.items = dojo.filter(this.items, function(i){\r\n\t\t\t\treturn (i != deletedItem);\r\n\t\t\t});\r\n\t\t\tthis.refresh();\r\n\t\t}\r\n\t},\r\n\t\r\n\tonFetchStart: function(){\r\n\t\t// summary:\r\n\t\t//\t\tcalled before a fetch starts\r\n\t\treturn this.loadingMessage;\r\n\t},\r\n\t\r\n\tonFetchError: function(/*Error*/ error){\r\n\t\t// summary:\r\n\t\t//\t\tcalled when a fetch error occurs.\r\n\t\treturn this.errorMessage;\r\n\t},\r\n\r\n\tonLoadStart: function(){\r\n\t\t// summary:\r\n\t\t//\t\tcalled before a load starts\r\n\t\treturn this.loadingMessage;\r\n\t},\r\n\t\r\n\tonLoadError: function(/*Error*/ error){\r\n\t\t// summary:\r\n\t\t//\t\tcalled when a load error occurs.\r\n\t\treturn this.errorMessage;\r\n\t},\r\n\t\r\n\tonItems: function(){\r\n\t\t// summary:\r\n\t\t//\t\tcalled after a fetch or load - at this point, this.items should be\r\n\t\t//  \tset and loaded.  Override this function to \"do your stuff\"\r\n\t\tif(!this.onLoadDeferred){\r\n\t\t\tthis.cancel();\r\n\t\t\tthis.onLoadDeferred = new dojo.Deferred(dojo.hitch(this, \"cancel\"));\r\n\t\t}\r\n\t\tthis._onLoadHandler();\r\n\t}\r\n\t\t\t\r\n});\r\n\r\ndojo.declare(\"dojox.widget._RollingListGroupPane\",\r\n\t[dojox.widget._RollingListPane], {\r\n\t// summary:\r\n\t//\t\ta pane that will handle groups (treats them as menu items)\r\n\t\r\n\t// templateString: string\r\n\t//\t\tour template\r\n\ttemplateString: '<div><div dojoAttachPoint=\"containerNode\"></div>' +\r\n\t\t\t\t\t'<div dojoAttachPoint=\"menuContainer\">' +\r\n\t\t\t\t\t\t'<div dojoAttachPoint=\"menuNode\"></div>' +\r\n\t\t\t\t\t'</div></div>',\r\n\r\n\t// _menu: dijit.Menu\r\n\t//\t\tThe menu that we will call addChild() on for adding items\r\n\t_menu: null,\r\n\t\r\n\t_setContent: function(/*String|DomNode|Nodelist*/cont){\r\n\t\tif(!this._menu){\r\n\t\t\t// Only set the content if we don't already have a menu\r\n\t\t\tthis.inherited(arguments);\r\n\t\t}\r\n\t},\r\n\r\n\t_onMinWidthChange: function(v){\r\n\t\t// override and resize the menu instead\r\n\t\tif(!this._menu){ return; }\r\n\t\tvar dWidth = dojo.marginBox(this.domNode).w;\r\n\t\tvar mWidth = dojo.marginBox(this._menu.domNode).w;\r\n\t\tthis._updateNodeWidth(this._menu.domNode, v - (dWidth - mWidth));\r\n\t},\r\n\r\n\tonItems: function(){\r\n\t\t// summary:\r\n\t\t//\t\tcalled after a fetch or load\r\n\t\tvar selectItem, hadChildren = false;\r\n\t\tif(this._menu){\r\n\t\t\tselectItem = this._getSelected();\r\n\t\t\tthis._menu.destroyRecursive();\r\n\t\t}\r\n\t\tthis._menu = this._getMenu();\r\n\t\tvar child, selectMenuItem;\r\n\t\tif(this.items.length){\r\n\t\t\tdojo.forEach(this.items, function(item){\r\n\t\t\t\tchild = this.parentWidget._getMenuItemForItem(item, this);\r\n\t\t\t\tif(child){\r\n\t\t\t\t\tif(selectItem && this.parentWidget._itemsMatch(child.item, selectItem.item)){\r\n\t\t\t\t\t\tselectMenuItem = child;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis._menu.addChild(child);\r\n\t\t\t\t}\r\n\t\t\t}, this);\r\n\t\t}else{\r\n\t\t\tchild = this.parentWidget._getMenuItemForItem(null, this);\r\n\t\t\tif(child){\r\n\t\t\t\tthis._menu.addChild(child);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(selectMenuItem){\r\n\t\t\tthis._setSelected(selectMenuItem);\r\n\t\t\tif((selectItem && !selectItem.children && selectMenuItem.children) ||\r\n\t\t\t\t(selectItem && selectItem.children && !selectMenuItem.children)){\r\n\t\t\t\tvar itemPane = this.parentWidget._getPaneForItem(selectMenuItem.item, this, selectMenuItem.children);\r\n\t\t\t\tif(itemPane){\r\n\t\t\t\t\tthis.parentWidget.addChild(itemPane, this.getIndexInParent() + 1);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis.parentWidget._removeAfter(this);\r\n\t\t\t\t\tthis.parentWidget._onItemClick(null, this, selectMenuItem.item, selectMenuItem.children);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}else if(selectItem){\r\n\t\t\tthis.parentWidget._removeAfter(this);\r\n\t\t}\r\n\t\tthis.containerNode.innerHTML = \"\";\r\n\t\tthis.containerNode.appendChild(this._menu.domNode);\r\n\t\tthis.parentWidget.scrollIntoView(this);\r\n\t\tthis._checkScrollConnection(true);\r\n\t\tthis.inherited(arguments);\r\n\t\tthis._onMinWidthChange(this.minWidth);\r\n\t},\r\n\t\r\n\t_checkScrollConnection: function(doLoad){\r\n\t\t// summary:\r\n\t\t//\t\tchecks whether or not we need to connect to our onscroll\r\n\t\t//\t\tfunction\r\n\t\tvar store = this.store;\r\n\t\tif(this._scrollConn){\r\n\t\t\tthis.disconnect(this._scrollConn);\r\n\t\t}\r\n\t\tdelete this._scrollConn;\r\n\t\tif(!dojo.every(this.items, function(i){return store.isItemLoaded(i);})){\r\n\t\t\tif(doLoad){\r\n\t\t\t\tthis._loadVisibleItems();\r\n\t\t\t}\r\n\t\t\tthis._scrollConn = this.connect(this.domNode, \"onscroll\", \"_onScrollPane\");\r\n\t\t}\r\n\t},\r\n\t\r\n\tstartup: function(){\r\n\t\tthis.inherited(arguments);\r\n\t\tthis.parentWidget._updateClass(this.domNode, \"GroupPane\");\r\n\t},\r\n\t\r\n\tfocus: function(/*boolean*/force){\r\n\t\t// summary:\r\n\t\t//\t\tsets the focus to this current widget\r\n\t\tif(this._menu){\r\n\t\t\tif(this._pendingFocus){\r\n\t\t\t\tthis.disconnect(this._pendingFocus);\r\n\t\t\t}\r\n\t\t\tdelete this._pendingFocus;\r\n\t\t\t\r\n\t\t\t// We focus the right widget - either the focusedChild, the\r\n\t\t\t// selected node, the first menu item, or the menu itself\r\n\t\t\tvar focusWidget = this._menu.focusedChild;\r\n\t\t\tif(!focusWidget){\r\n\t\t\t\tvar focusNode = dojo.query(\".dojoxRollingListItemSelected\", this.domNode)[0];\r\n\t\t\t\tif(focusNode){\r\n\t\t\t\t\tfocusWidget = dijit.byNode(focusNode);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(!focusWidget){\r\n\t\t\t\tfocusWidget = this._menu.getChildren()[0] || this._menu;\r\n\t\t\t}\r\n\t\t\tthis._focusByNode = false;\r\n\t\t\tif(focusWidget.focusNode){\r\n\t\t\t\tif(!this.parentWidget._savedFocus || force){\r\n\t\t\t\t\ttry{focusWidget.focusNode.focus();}catch(e){}\r\n\t\t\t\t}\r\n\t\t\t\twindow.setTimeout(function(){\r\n\t\t\t\t\ttry{\r\n\t\t\t\t\t\tdojo.window.scrollIntoView(focusWidget.focusNode);\r\n\t\t\t\t\t}catch(e){}\r\n\t\t\t\t}, 1);\r\n\t\t\t}else if(focusWidget.focus){\r\n\t\t\t\tif(!this.parentWidget._savedFocus || force){\r\n\t\t\t\t\tfocusWidget.focus();\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\tthis._focusByNode = true;\r\n\t\t\t}\r\n\t\t\tthis.inherited(arguments);\r\n\t\t}else if(!this._pendingFocus){\r\n\t\t\tthis._pendingFocus = this.connect(this, \"onItems\", \"focus\");\r\n\t\t}\r\n\t},\r\n\t\r\n\t_getMenu: function(){\r\n\t\t// summary:\r\n\t\t//\t\treturns a widget to be used for the container widget.\r\n\t\tvar self = this;\r\n\t\tvar menu = new dijit.Menu({\r\n\t\t\tparentMenu: this.parentPane ? this.parentPane._menu : null,\r\n\t\t\tonCancel: function(/*Boolean*/ closeAll){\r\n\t\t\t\tif(self.parentPane){\r\n\t\t\t\t\tself.parentPane.focus(true);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t_moveToPopup: function(/*Event*/ evt){\r\n\t\t\t\tif(this.focusedChild && !this.focusedChild.disabled){\r\n\t\t\t\t\tthis.onItemClick(this.focusedChild, evt);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}, this.menuNode);\r\n\t\tthis.connect(menu, \"onItemClick\", function(/*dijit.MenuItem*/ item, /*Event*/ evt){\r\n\t\t\tif(item.disabled){ return; }\r\n\t\t\tevt.alreadySelected = dojo.hasClass(item.domNode, \"dojoxRollingListItemSelected\");\r\n\t\t\tif(evt.alreadySelected &&\r\n\t\t\t\t((evt.type == \"keypress\" && evt.charOrCode != dojo.keys.ENTER) ||\r\n\t\t\t\t(evt.type == \"internal\"))){\r\n\t\t\t\tvar p = this.parentWidget.getChildren()[this.getIndexInParent() + 1];\r\n\t\t\t\tif(p){\r\n\t\t\t\t\tp.focus(true);\r\n\t\t\t\t\tthis.parentWidget.scrollIntoView(p);\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\tthis._setSelected(item, menu);\r\n\t\t\t\tthis.parentWidget._onItemClick(evt, this, item.item, item.children);\r\n\t\t\t\tif(evt.type == \"keypress\" && evt.charOrCode == dojo.keys.ENTER){\r\n\t\t\t\t\tthis.parentWidget._onExecute();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tif(!menu._started){\r\n\t\t\tmenu.startup();\r\n\t\t}\r\n\t\treturn menu;\r\n\t},\r\n\t\r\n\t_onScrollPane: function(){\r\n\t\t// summary:\r\n\t\t//\t\tcalled when the pane has been scrolled - it sets a timeout\r\n\t\t//\t\tso that we don't try and load our visible items too often during\r\n\t\t//\t\ta scroll\r\n\t\tif(this._visibleLoadPending){\r\n\t\t\twindow.clearTimeout(this._visibleLoadPending);\r\n\t\t}\r\n\t\tthis._visibleLoadPending = window.setTimeout(dojo.hitch(this, \"_loadVisibleItems\"), 500);\r\n\t},\r\n\t\r\n\t_loadVisibleItems: function(){\r\n\t\t// summary:\r\n\t\t//\t\tloads the items that are currently visible in the pane\r\n\t\tdelete this._visibleLoadPending;\r\n\t\tvar menu = this._menu;\r\n\t\tif(!menu){ return; }\r\n\t\tvar children = menu.getChildren();\r\n\t\tif(!children || !children.length){ return; }\r\n\t\tvar gpbme = function(n, m, pb){\r\n\t\t\tvar s = dojo.getComputedStyle(n);\r\n\t\t\tvar r = 0;\r\n\t\t\tif(m){ r += dojo._getMarginExtents(n, s).t; }\r\n\t\t\tif(pb){ r += dojo._getPadBorderExtents(n, s).t; }\r\n\t\t\treturn r;\r\n\t\t};\r\n\t\tvar topOffset = gpbme(this.domNode, false, true) +\r\n\t\t\t\t\t\tgpbme(this.containerNode, true, true) +\r\n\t\t\t\t\t\tgpbme(menu.domNode, true, true) +\r\n\t\t\t\t\t\tgpbme(children[0].domNode, true, false);\r\n\t\tvar h = dojo.contentBox(this.domNode).h;\r\n\t\tvar minOffset = this.domNode.scrollTop - topOffset - (h/2);\r\n\t\tvar maxOffset = minOffset + (3*h/2);\r\n\t\tvar menuItemsToLoad = dojo.filter(children, function(c){\r\n\t\t\tvar cnt = c.domNode.offsetTop;\r\n\t\t\tvar s = c.store;\r\n\t\t\tvar i = c.item;\r\n\t\t\treturn (cnt >= minOffset && cnt <= maxOffset && !s.isItemLoaded(i));\r\n\t\t})\r\n\t\tvar itemsToLoad = dojo.map(menuItemsToLoad, function(c){\r\n\t\t\treturn c.item;\r\n\t\t});\r\n\t\tvar onItems = dojo.hitch(this, function(){\r\n\t\t\tvar selectItem = this._getSelected();\r\n\t\t\tvar selectMenuItem;\r\n\t\t\tdojo.forEach(itemsToLoad, function(item, idx){\r\n\t\t\t\tvar newItem = this.parentWidget._getMenuItemForItem(item, this);\r\n\t\t\t\tvar oItem = menuItemsToLoad[idx];\r\n\t\t\t\tvar oIdx = oItem.getIndexInParent();\r\n\t\t\t\tmenu.removeChild(oItem);\r\n\t\t\t\tif(newItem){\r\n\t\t\t\t\tif(selectItem && this.parentWidget._itemsMatch(newItem.item, selectItem.item)){\r\n\t\t\t\t\t\tselectMenuItem = newItem;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tmenu.addChild(newItem, oIdx);\r\n\t\t\t\t\tif(menu.focusedChild == oItem){\r\n\t\t\t\t\t\tmenu.focusChild(newItem);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\toItem.destroy();\r\n\t\t\t}, this);\r\n\t\t\tthis._checkScrollConnection(false);\r\n\t\t});\r\n\t\tthis._doLoadItems(itemsToLoad, onItems);\r\n\t},\r\n\t\r\n\t_getSelected: function(/*dijit.Menu?*/ menu){\r\n\t\t// summary:\r\n\t\t//\t\treturns the selected menu item - or null if none are selected\r\n\t\tif(!menu){ menu = this._menu; }\r\n\t\tif(menu){\r\n\t\t\tvar children = this._menu.getChildren();\r\n\t\t\tfor(var i = 0, item; (item = children[i]); i++){\r\n\t\t\t\tif(dojo.hasClass(item.domNode, \"dojoxRollingListItemSelected\")){\r\n\t\t\t\t\treturn item;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\t\r\n\t_setSelected: function(/*dijit.MenuItem?*/ item, /*dijit.Menu?*/ menu){\r\n\t\t// summary:\r\n\t\t//\t\tselects the given item in the given menu (defaults to pane's menu)\r\n\t\tif(!menu){ menu = this._menu;}\r\n\t\tif(menu){\r\n\t\t\tdojo.forEach(menu.getChildren(), function(i){\r\n\t\t\t\tthis.parentWidget._updateClass(i.domNode, \"Item\", {\"Selected\": (item && (i == item && !i.disabled))});\r\n\t\t\t}, this);\r\n\t\t}\r\n\t}\r\n});\r\n\r\ndojo.declare(\"dojox.widget.RollingList\",\r\n\t[dijit._Widget, dijit._Templated, dijit._Container], {\r\n\t// summary:\r\n\t//\t\ta rolling list that can be tied to a data store with children\r\n\t\t\r\n\t// templateString: String\r\n\t//\t\tThe template to be used to construct the widget.\r\n\ttemplateString: dojo.cache(\"dojox.widget\", \"RollingList/RollingList.html\"),\r\n\twidgetsInTemplate: true,\r\n\t\r\n\t// className: string\r\n\t//\t\tan additional class (or space-separated classes) to add for our widget\r\n\tclassName: \"\",\r\n\t\r\n\t// store: store\r\n\t//\t\tthe store we must use\r\n\tstore: null,\r\n\t\r\n\t// query: object\r\n\t//\t\ta query to pass to the datastore.  This is only used if items are null\r\n\tquery: null,\r\n\t\r\n\t// queryOptions: object\r\n\t//\t\tquery options to be passed to the datastore\r\n\tqueryOptions: null,\r\n\t\r\n\t// childrenAttrs: String[]\r\n\t//\t\tone ore more attributes that holds children of a node\r\n\tchildrenAttrs: [\"children\"],\r\n\r\n\t// parentAttr: string\r\n\t//\t\tthe attribute to read for finding our parent item (if any)\r\n\tparentAttr: \"\",\r\n\t\r\n\t// value: item\r\n\t//\t\tThe value that has been selected\r\n\tvalue: null,\r\n\t\r\n\t// executeOnDblClick: boolean\r\n\t//\t\tSet to true if you want to call onExecute when an item is\r\n\t//\t\tdouble-clicked, false if you want to call onExecute yourself. (mainly\r\n\t//\t\tused for popups to control how they want to be handled)\r\n\texecuteOnDblClick: true,\r\n\t\r\n\t// preloadItems: boolean or int\r\n\t//\t\tif set to true, then onItems will be called only *after* all items have\r\n\t//\t\tbeen loaded (ie store.isLoaded will return true for all of them).  If\r\n\t//\t\tfalse, then no preloading will occur.  If set to an integer, preloading\r\n\t//\t\twill occur if the number of items is less than or equal to the value\r\n\t//\t\tof the integer.  The onItems function will need to be aware of handling\r\n\t//\t\titems that may not be loaded\r\n\tpreloadItems: false,\r\n\t\r\n\t// showButtons: boolean\r\n\t//\t\tif set to true, then buttons for \"OK\" and \"Cancel\" will be provided\r\n\tshowButtons: false,\r\n\t\r\n\t// okButtonLabel: string\r\n\t//\t\tThe string to use for the OK button - will use dijit's common \"OK\" string\r\n\t//\t\tif not set\r\n\tokButtonLabel: \"\",\r\n\t\r\n\t// cancelButtonLabel: string\r\n\t//\t\tThe string to use for the Cancel button - will use dijit's common\r\n\t//\t\t\"Cancel\" string if not set\r\n\tcancelButtonLabel: \"\",\r\n\r\n\t// minPaneWidth: integer\r\n\t//\t\tthe minimum pane width (in px) for all child panes.  If they are narrower,\r\n\t//\t\tthe width will be increased to this value.\r\n\tminPaneWidth: 0,\r\n\t\r\n\tpostMixInProperties: function(){\r\n\t\t// summary:\r\n\t\t//\t\tMix in our labels, if they are not set\r\n\t\tthis.inherited(arguments);\r\n\t\tvar loc = dojo.i18n.getLocalization(\"dijit\", \"common\");\r\n\t\tthis.okButtonLabel = this.okButtonLabel || loc.buttonOk;\r\n\t\tthis.cancelButtonLabel = this.cancelButtonLabel || loc.buttonCancel;\r\n\t},\r\n\t\r\n\t_setShowButtonsAttr: function(doShow){\r\n\t\t// summary:\r\n\t\t//\t\tSets the visibility of the buttons for the widget\r\n\t\tvar needsLayout = false;\r\n\t\tif((this.showButtons != doShow && this._started) ||\r\n\t\t\t(this.showButtons == doShow && !this.started)){\r\n\t\t\tneedsLayout = true;\r\n\t\t}\r\n\t\tdojo.toggleClass(this.domNode, \"dojoxRollingListButtonsHidden\", !doShow);\r\n\t\tthis.showButtons = doShow;\r\n\t\tif(needsLayout){\r\n\t\t\tif(this._started){\r\n\t\t\t\tthis.layout();\r\n\t\t\t}else{\r\n\t\t\t\twindow.setTimeout(dojo.hitch(this, \"layout\"), 0);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\r\n\t_itemsMatch: function(/*item*/ item1, /*item*/ item2){\r\n\t\t// summary:\r\n\t\t//\t\treturns whether or not the two items match - checks ID if\r\n\t\t//\t\tthey aren't the exact same object\r\n\t\tif(!item1 && !item2){\r\n\t\t\treturn true;\r\n\t\t}else if(!item1 || !item2){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn (item1 == item2 ||\r\n\t\t\t(this._isIdentity && this.store.getIdentity(item1) == this.store.getIdentity(item2)));\r\n\t},\r\n\t\r\n\t_removeAfter: function(/*Widget or int*/ idx){\r\n\t\t// summary:\r\n\t\t//\t\tremoves all widgets after the given widget (or index)\r\n\t\tif(typeof idx != \"number\"){\r\n\t\t\tidx = this.getIndexOfChild(idx);\r\n\t\t}\r\n\t\tif(idx >= 0){\r\n\t\t\tdojo.forEach(this.getChildren(), function(c, i){\r\n\t\t\t\tif(i > idx){\r\n\t\t\t\t\tthis.removeChild(c);\r\n\t\t\t\t\tc.destroyRecursive();\r\n\t\t\t\t}\r\n\t\t\t}, this);\r\n\t\t}\r\n\t\tvar children = this.getChildren(), child = children[children.length - 1];\r\n\t\tvar selItem = null;\r\n\t\twhile(child && !selItem){\r\n\t\t\tvar val = child._getSelected ? child._getSelected() : null;\r\n\t\t\tif(val){\r\n\t\t\t\tselItem = val.item;\r\n\t\t\t}\r\n\t\t\tchild = child.parentPane;\r\n\t\t}\r\n\t\tif(!this._setInProgress){\r\n\t\t\tthis._setValue(selItem);\r\n\t\t}\r\n\t},\r\n\t\r\n\taddChild: function(/*dijit._Widget*/ widget, /*int?*/ insertIndex){\r\n\t\t// summary:\r\n\t\t//\t\tadds a child to this rolling list - if passed an insertIndex,\r\n\t\t//\t\tthen all children from that index on will be removed and destroyed\r\n\t\t//\t\tbefore adding the child.\r\n\t\tif(insertIndex > 0){\r\n\t\t\tthis._removeAfter(insertIndex - 1);\r\n\t\t}\r\n\t\tthis.inherited(arguments);\r\n\t\tif(!widget._started){\r\n\t\t\twidget.startup();\r\n\t\t}\r\n\t\twidget.attr(\"minWidth\", this.minPaneWidth);\r\n\t\tthis.layout();\r\n\t\tif(!this._savedFocus){\r\n\t\t\twidget.focus();\r\n\t\t}\r\n\t},\r\n\t\r\n\t_setMinPaneWidthAttr: function(value){\r\n\t\t// summary:\r\n\t\t//\t\tSets the min pane width of all children\r\n\t\tif(value !== this.minPaneWidth){\r\n\t\t\tthis.minPaneWidth = value;\r\n\t\t\tdojo.forEach(this.getChildren(), function(c){\r\n\t\t\t\tc.attr(\"minWidth\", value);\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\t\r\n\t_updateClass: function(/* Node */ node, /* String */ type, /* Object? */ options){\r\n\t\t// summary:\r\n\t\t//\t\tsets the state of the given node with the given type and options\r\n\t\t// options:\r\n\t\t//\t\tan object with key-value-pairs.  The values are boolean, if true,\r\n\t\t//\t\tthe key is added as a class, if false, it is removed.\r\n\t\tif(!this._declaredClasses){\r\n\t\t\tthis._declaredClasses = (\"dojoxRollingList \" + this.className).split(\" \");\r\n\t\t}\r\n\t\tdojo.forEach(this._declaredClasses, function(c){\r\n\t\t\tif(c){\r\n\t\t\t\tdojo.addClass(node, c + type);\r\n\t\t\t\tfor(var k in options||{}){\r\n\t\t\t\t\tdojo.toggleClass(node, c + type + k, options[k]);\r\n\t\t\t\t}\r\n\t\t\t\tdojo.toggleClass(node, c + type + \"FocusSelected\",\r\n\t\t\t\t\t(dojo.hasClass(node, c + type + \"Focus\") && dojo.hasClass(node, c + type + \"Selected\")));\r\n\t\t\t\tdojo.toggleClass(node, c + type + \"HoverSelected\",\r\n\t\t\t\t\t(dojo.hasClass(node, c + type + \"Hover\") && dojo.hasClass(node, c + type + \"Selected\")));\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\t\r\n\tscrollIntoView: function(/*dijit._Widget*/ childWidget){\r\n\t\t// summary:\r\n\t\t//\t\tscrolls the given widget into view\r\n\t\tif(this._scrollingTimeout){\r\n\t\t\twindow.clearTimeout(this._scrollingTimeout);\r\n\t\t}\r\n\t\tdelete this._scrollingTimeout;\r\n\t\tthis._scrollingTimeout = window.setTimeout(dojo.hitch(this, function(){\r\n\t\t\tif(childWidget.domNode){\r\n\t\t\t\tdojo.window.scrollIntoView(childWidget.domNode);\r\n\t\t\t}\r\n\t\t\tdelete this._scrollingTimeout;\r\n\t\t\treturn;\r\n\t\t}), 1);\r\n\t},\r\n\t\r\n\tresize: function(args){\r\n\t\tdijit.layout._LayoutWidget.prototype.resize.call(this, args);\r\n\t},\r\n\t\r\n\tlayout: function(){\r\n\t\tvar children = this.getChildren();\r\n\t\tif(this._contentBox){\r\n\t\t\tvar bn = this.buttonsNode;\r\n\t\t\tvar height = this._contentBox.h - dojo.marginBox(bn).h -\r\n\t\t\t\t\t\t\t\tdojox.html.metrics.getScrollbar().h;\r\n\t\t\tdojo.forEach(children, function(c){\r\n\t\t\t\tdojo.marginBox(c.domNode, {h: height});\r\n\t\t\t});\r\n\t\t}\r\n\t\tif(this._focusedPane){\r\n\t\t\tvar foc = this._focusedPane;\r\n\t\t\tdelete this._focusedPane;\r\n\t\t\tif(!this._savedFocus){\r\n\t\t\t\tfoc.focus();\r\n\t\t\t}\r\n\t\t}else if(children && children.length){\r\n\t\t\tif(!this._savedFocus){\r\n\t\t\t\tchildren[0].focus();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\r\n\t_onChange: function(/*item*/ value){\r\n\t\tthis.onChange(value);\r\n\t},\r\n\r\n\t_setValue: function(/* item */ value){\r\n\t\t// summary:\r\n\t\t//\t\tinternally sets the value and fires onchange\r\n\t\tdelete this._setInProgress;\r\n\t\tif(!this._itemsMatch(this.value, value)){\r\n\t\t\tthis.value = value;\r\n\t\t\tthis._onChange(value);\r\n\t\t}\r\n\t},\r\n\t\r\n\t_setValueAttr: function(/* item */ value){\r\n\t\t// summary:\r\n\t\t//\t\tsets the value of this widget to the given store item\r\n\t\tif(this._itemsMatch(this.value, value) && !value){ return; }\r\n\t\tif(this._setInProgress && this._setInProgress === value){ return; }\r\n\t\tthis._setInProgress = value;\r\n\t\tif(!value || !this.store.isItem(value)){\r\n\t\t\tvar pane = this.getChildren()[0];\r\n\t\t\tpane._setSelected(null);\r\n\t\t\tthis._onItemClick(null, pane, null, null);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tvar fetchParentItems = dojo.hitch(this, function(/*item*/ item, /*function*/callback){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tFetches the parent items for the given item\r\n\t\t\tvar store = this.store, id;\r\n\t\t\tif(this.parentAttr && store.getFeatures()[\"dojo.data.api.Identity\"] &&\r\n\t\t\t\t((id = this.store.getValue(item, this.parentAttr)) || id === \"\")){\r\n\t\t\t\t// Fetch by parent attribute\r\n\t\t\t\tvar cb = function(i){\r\n\t\t\t\t\tif(store.getIdentity(i) == store.getIdentity(item)){\r\n\t\t\t\t\t\tcallback(null);\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tcallback([i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tif(id === \"\"){\r\n\t\t\t\t\tcallback(null);\r\n\t\t\t\t}else if(typeof id == \"string\"){\r\n\t\t\t\t\tstore.fetchItemByIdentity({identity: id, onItem: cb});\r\n\t\t\t\t}else if(store.isItem(id)){\r\n\t\t\t\t\tcb(id);\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\t// Fetch by finding children\r\n\t\t\t\tvar numCheck = this.childrenAttrs.length;\r\n\t\t\t\tvar parents = [];\r\n\t\t\t\tdojo.forEach(this.childrenAttrs, function(attr){\r\n\t\t\t\t\tvar q = {};\r\n\t\t\t\t\tq[attr] = item;\r\n\t\t\t\t\tstore.fetch({query: q, scope: this,\r\n\t\t\t\t\t\tonComplete: function(items){\r\n\t\t\t\t\t\t\tif(this._setInProgress !== value){\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tparents = parents.concat(items);\r\n\t\t\t\t\t\t\tnumCheck--;\r\n\t\t\t\t\t\t\tif(numCheck === 0){\r\n\t\t\t\t\t\t\t\tcallback(parents);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}, this);\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\tvar setFromChain = dojo.hitch(this, function(/*item[]*/itemChain, /*integer*/idx){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tSets the value of the widget at the given index in the chain - onchanges are not\r\n\t\t\t//\t\tfired here\r\n\t\t\tvar set = itemChain[idx];\r\n\t\t\tvar child = this.getChildren()[idx];\r\n\t\t\tvar conn;\r\n\t\t\tif(set && child){\r\n\t\t\t\tvar fx = dojo.hitch(this, function(){\r\n\t\t\t\t\tif(conn){\r\n\t\t\t\t\t\tthis.disconnect(conn);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdelete conn;\r\n\t\t\t\t\tif(this._setInProgress !== value){\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar selOpt = dojo.filter(child._menu.getChildren(), function(i){\r\n\t\t\t\t\t\treturn this._itemsMatch(i.item, set);\r\n\t\t\t\t\t}, this)[0];\r\n\t\t\t\t\tif(selOpt){\r\n\t\t\t\t\t\tidx++;\r\n\t\t\t\t\t\tchild._menu.onItemClick(selOpt, {type: \"internal\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstopPropagation: function(){},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tpreventDefault: function(){}});\r\n\t\t\t\t\t\tif(itemChain[idx]){\r\n\t\t\t\t\t\t\tsetFromChain(itemChain, idx);\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tthis._setValue(set);\r\n\t\t\t\t\t\t\tthis.onItemClick(set, child, this.getChildItems(set));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tif(!child.isLoaded){\r\n\t\t\t\t\tconn = this.connect(child, \"onLoad\", fx);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tfx();\r\n\t\t\t\t}\r\n\t\t\t}else if(idx === 0){\r\n\t\t\t\tthis.set(\"value\", null);\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\tvar parentChain = [];\r\n\t\tvar onParents = dojo.hitch(this, function(/*item[]*/ parents){\r\n\t\t\t// summary:\r\n\t\t\t//\t\trecursively grabs the parents - only the first one is followed\r\n\t\t\tif(parents && parents.length){\r\n\t\t\t\tparentChain.push(parents[0]);\r\n\t\t\t\tfetchParentItems(parents[0], onParents);\r\n\t\t\t}else{\r\n\t\t\t\tif(!parents){\r\n\t\t\t\t\tparentChain.pop();\r\n\t\t\t\t}\r\n\t\t\t\tparentChain.reverse();\r\n\t\t\t\tsetFromChain(parentChain, 0);\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t// Only set the value in display if we are shown - if we are in a dropdown,\r\n\t\t// and are hidden, don't actually do the scrolling in the display (it can\r\n\t\t// mess up layouts)\r\n\t\tvar ns = this.domNode.style;\r\n\t\tif(ns.display == \"none\" || ns.visibility == \"hidden\"){\r\n\t\t\tthis._setValue(value);\r\n\t\t}else if(!this._itemsMatch(value, this._visibleItem)){\r\n\t\t\tonParents([value]);\r\n\t\t}\r\n\t},\r\n\t\r\n\t_onItemClick: function(/* Event */ evt, /* dijit._Contained */ pane, /* item */ item, /* item[]? */ children){\r\n\t\t// summary:\r\n\t\t//\t\tinternally called when a widget should pop up its child\r\n\t\t\r\n\t\tif(evt){\r\n\t\t\tvar itemPane = this._getPaneForItem(item, pane, children);\r\n\t\t\tvar alreadySelected = (evt.type == \"click\" && evt.alreadySelected);\r\n\r\n\t\t\tif(alreadySelected && itemPane){\r\n\t\t\t\tthis._removeAfter(pane.getIndexInParent() + 1);\r\n\t\t\t\tvar next = pane.getNextSibling();\r\n\t\t\t\tif(next && next._setSelected){\r\n\t\t\t\t\tnext._setSelected(null);\r\n\t\t\t\t}\r\n\t\t\t\tthis.scrollIntoView(next);\r\n\t\t\t}else if(itemPane){\r\n\t\t\t\tthis.addChild(itemPane, pane.getIndexInParent() + 1);\r\n\t\t\t\tif(this._savedFocus){\r\n\t\t\t\t\titemPane.focus(true);\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\tthis._removeAfter(pane);\r\n\t\t\t\tthis.scrollIntoView(pane);\r\n\t\t\t}\r\n\t\t}else if(pane){\r\n\t\t\tthis._removeAfter(pane);\r\n\t\t\tthis.scrollIntoView(pane);\r\n\t\t}\r\n\t\tif(!evt || evt.type != \"internal\"){\r\n\t\t\tthis._setValue(item);\r\n\t\t\tthis.onItemClick(item, pane, children);\r\n\t\t}\r\n\t\tthis._visibleItem = item;\r\n\t},\r\n\t\r\n\t_getPaneForItem: function(/* item? */ item, /* dijit._Contained? */ parentPane, /* item[]? */ children){\r\n\t\t// summary:\r\n\t\t//\t\tgets the pane for the given item, and mixes in our needed parts\r\n\t\t//\t\tReturns the pane for the given item (null if the root pane) - after mixing in\r\n\t\t//\t\tits stuff.\r\n\t\tvar ret = this.getPaneForItem(item, parentPane, children);\r\n\t\tret.store = this.store;\r\n\t\tret.parentWidget = this;\r\n\t\tret.parentPane = parentPane||null;\r\n\t\tif(!item){\r\n\t\t\tret.query = this.query;\r\n\t\t\tret.queryOptions = this.queryOptions;\r\n\t\t}else if(children){\r\n\t\t\tret.items = children;\r\n\t\t}else{\r\n\t\t\tret.items = [item];\r\n\t\t}\r\n\t\treturn ret;\r\n\t},\r\n\t\r\n\t_getMenuItemForItem: function(/*item*/ item, /* dijit._Contained */ parentPane){\r\n\t\t// summary:\r\n\t\t//\t\treturns a widget for the given store item.  The returned\r\n\t\t//\t\titem will be added to this widget's container widget.  null will\r\n\t\t//\t\tbe passed in for an \"empty\" item.\r\n\t\tvar store = this.store;\r\n\t\tif(!item || !store || !store.isItem(item)){\r\n\t\t\tvar i = new dijit.MenuItem({\r\n\t\t\t\tlabel: \"---\",\r\n\t\t\t\tdisabled: true,\r\n\t\t\t\ticonClass: \"dojoxEmpty\",\r\n\t\t\t\tfocus: function(){\r\n\t\t\t\t\t// Do nothing on focus of this guy...\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tthis._updateClass(i.domNode, \"Item\");\r\n\t\t\treturn i;\r\n\t\t}else{\r\n\t\t\tvar itemLoaded = store.isItemLoaded(item);\r\n\t\t\tvar childItems = itemLoaded ? this.getChildItems(item) : undefined;\r\n\t\t\tvar widgetItem;\r\n\t\t\tif(childItems){\r\n\t\t\t\twidgetItem = this.getMenuItemForItem(item, parentPane, childItems);\r\n\t\t\t\twidgetItem.children = childItems;\r\n\t\t\t\tthis._updateClass(widgetItem.domNode, \"Item\", {\"Expanding\": true});\r\n\t\t\t\tif(!widgetItem._started){\r\n\t\t\t\t\tvar c = widgetItem.connect(widgetItem, \"startup\", function(){\r\n\t\t\t\t\t\tthis.disconnect(c);\r\n\t\t\t\t\t\tdojo.style(this.arrowWrapper, \"visibility\", \"\");\r\n\t\t\t\t\t});\r\n\t\t\t\t}else{\r\n\t\t\t\t\tdojo.style(widgetItem.arrowWrapper, \"visibility\", \"\");\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\twidgetItem = this.getMenuItemForItem(item, parentPane, null);\r\n\t\t\t\tif(itemLoaded){\r\n\t\t\t\t\tthis._updateClass(widgetItem.domNode, \"Item\", {\"Single\": true});\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis._updateClass(widgetItem.domNode, \"Item\", {\"Unloaded\": true});\r\n\t\t\t\t\twidgetItem.attr(\"disabled\", true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\twidgetItem.store = this.store;\r\n\t\t\twidgetItem.item = item;\r\n\t\t\tif(!widgetItem.label){\r\n\t\t\t\twidgetItem.attr(\"label\", this.store.getLabel(item).replace(/</,\"&lt;\"));\r\n\t\t\t}\r\n\t\t\tif(widgetItem.focusNode){\r\n\t\t\t\tvar self = this;\r\n\t\t\t\twidgetItem.focus = function(){\r\n\t\t\t\t\t// Don't set our class\r\n\t\t\t\t\tif(!this.disabled){try{this.focusNode.focus();}catch(e){}}\r\n\t\t\t\t};\r\n\t\t\t\twidgetItem.connect(widgetItem.focusNode, \"onmouseenter\", function(){\r\n\t\t\t\t\tif(!this.disabled){\r\n\t\t\t\t\t\tself._updateClass(this.domNode, \"Item\", {\"Hover\": true});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\twidgetItem.connect(widgetItem.focusNode, \"onmouseleave\", function(){\r\n\t\t\t\t\tif(!this.disabled){\r\n\t\t\t\t\t\tself._updateClass(this.domNode, \"Item\", {\"Hover\": false});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\twidgetItem.connect(widgetItem.focusNode, \"blur\", function(){\r\n\t\t\t\t\tself._updateClass(this.domNode, \"Item\", {\"Focus\": false, \"Hover\": false});\r\n\t\t\t\t});\r\n\t\t\t\twidgetItem.connect(widgetItem.focusNode, \"focus\", function(){\r\n\t\t\t\t\tself._updateClass(this.domNode, \"Item\", {\"Focus\": true});\r\n\t\t\t\t\tself._focusedPane = parentPane;\r\n\t\t\t\t});\r\n\t\t\t\tif(this.executeOnDblClick){\r\n\t\t\t\t\twidgetItem.connect(widgetItem.focusNode, \"ondblclick\", function(){\r\n\t\t\t\t\t\tself._onExecute();\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn widgetItem;\r\n\t\t}\r\n\t},\r\n\t\r\n\t_setStore: function(/* dojo/data/api/Read */ store){\r\n\t\t// summary:\r\n\t\t//\t\tsets the store for this widget */\r\n\t\tif(store === this.store && this._started){ return; }\r\n\t\tthis.store = store;\r\n\t\tthis._isIdentity = store.getFeatures()[\"dojo.data.api.Identity\"];\r\n\t\tvar rootPane = this._getPaneForItem();\r\n\t\tthis.addChild(rootPane, 0);\r\n\t},\r\n\t\r\n\t_onKey: function(/*Event*/ e){\r\n\t\t// summary:\r\n\t\t//\t\tcalled when a keypress event happens on this widget\r\n\t\tif(e.charOrCode == dojo.keys.BACKSPACE){\r\n\t\t\tdojo.stopEvent(e);\r\n\t\t\treturn;\r\n\t\t}else if(e.charOrCode == dojo.keys.ESCAPE && this._savedFocus){\r\n\t\t\ttry{dijit.focus(this._savedFocus);}catch(e){}\r\n\t\t\tdojo.stopEvent(e);\r\n\t\t\treturn;\r\n\t\t}else if(e.charOrCode == dojo.keys.LEFT_ARROW ||\r\n\t\t\te.charOrCode == dojo.keys.RIGHT_ARROW){\r\n\t\t\tdojo.stopEvent(e);\r\n\t\t\treturn;\r\n\t\t}\r\n\t},\r\n\t\r\n\t_resetValue: function(){\r\n\t\t// summary:\r\n\t\t//\t\tfunction called when the value is reset.\r\n\t\tthis.set(\"value\", this._lastExecutedValue);\r\n\t},\r\n\t\r\n\t_onCancel: function(){\r\n\t\t// summary:\r\n\t\t//\t\tfunction called when the cancel button is clicked.  It\r\n\t\t//\t\tresets its value to whatever was last executed and then cancels\r\n\t\tthis._resetValue();\r\n\t\tthis.onCancel();\r\n\t},\r\n\t\r\n\t_onExecute: function(){\r\n\t\t// summary:\r\n\t\t//\t\tfunction called when the OK button is clicked or when an\r\n\t\t//\t\titem is selected (double-clicked or \"enter\" pressed on it)\r\n\t\tthis._lastExecutedValue = this.get(\"value\");\r\n\t\tthis.onExecute();\r\n\t},\r\n\t\r\n\tfocus: function(){\r\n\t\t// summary:\r\n\t\t//\t\tsets the focus state of this widget\r\n\t\tvar wasSaved = this._savedFocus;\r\n\t\tthis._savedFocus = dijit.getFocus(this);\r\n\t\tif(!this._savedFocus.node){\r\n\t\t\tdelete this._savedFocus;\r\n\t\t}\r\n\t\tif(!this._focusedPane){\r\n\t\t\tvar child = this.getChildren()[0];\r\n\t\t\tif(child && !wasSaved){\r\n\t\t\t\tchild.focus(true);\r\n\t\t\t}\r\n\t\t}else{\r\n\t\t\tthis._savedFocus = dijit.getFocus(this);\r\n\t\t\tvar foc = this._focusedPane;\r\n\t\t\tdelete this._focusedPane;\r\n\t\t\tif(!wasSaved){\r\n\t\t\t\tfoc.focus(true);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\r\n\thandleKey:function(/*Event*/e){\r\n\t\t// summary:\r\n\t\t//\t\thandle the key for the given event - called by dropdown\r\n\t\t//\t\twidgets\r\n\t\tif(e.keyCode == dojo.keys.DOWN_ARROW){\r\n\t\t\tdelete this._savedFocus;\r\n\t\t\tthis.focus();\r\n\t\t\treturn false;\r\n\t\t}else if(e.keyCode == dojo.keys.ESCAPE){\r\n\t\t\tthis._onCancel();\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t},\r\n\t\r\n\t_updateChildClasses: function(){\r\n\t\t// summary:\r\n\t\t//\t\tCalled when a child is added or removed - so that we can\r\n\t\t//\t\tupdate the classes for styling the \"current\" one differently than\r\n\t\t//\t\tthe others\r\n\t\tvar children = this.getChildren();\r\n\t\tvar length = children.length;\r\n\t\tdojo.forEach(children, function(c, idx){\r\n\t\t\tdojo.toggleClass(c.domNode, \"dojoxRollingListPaneCurrentChild\", (idx == (length - 1)));\r\n\t\t\tdojo.toggleClass(c.domNode, \"dojoxRollingListPaneCurrentSelected\", (idx == (length - 2)));\r\n\t\t});\r\n\t},\r\n\r\n\tstartup: function(){\r\n\t\tif(this._started){ return; }\r\n\t\tif(!this.getParent || !this.getParent()){\r\n\t\t\tthis.resize();\r\n\t\t\tthis.connect(dojo.global, \"onresize\", \"resize\");\r\n\t\t}\r\n\t\tthis.connect(this, \"addChild\", \"_updateChildClasses\");\r\n\t\tthis.connect(this, \"removeChild\", \"_updateChildClasses\");\r\n\t\tthis._setStore(this.store);\r\n\t\tthis.set(\"showButtons\", this.showButtons);\r\n\t\tthis.inherited(arguments);\r\n\t\tthis._lastExecutedValue = this.get(\"value\");\r\n\t},\r\n\t\r\n\tgetChildItems: function(/*item*/ item){\r\n\t\t// summary:\r\n\t\t//\t\tReturns the child items for the given store item\r\n\t\tvar childItems, store = this.store;\r\n\t\tdojo.forEach(this.childrenAttrs, function(attr){\r\n\t\t\tvar vals = store.getValues(item, attr);\r\n\t\t\tif(vals && vals.length){\r\n\t\t\t\tchildItems = (childItems||[]).concat(vals);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn childItems;\r\n\t},\r\n\t\r\n\tgetMenuItemForItem: function(/*item*/ item, /* dijit._Contained */ parentPane, /* item[]? */ children){\r\n\t\t// summary:\r\n\t\t//\t\tuser overridable function to return a widget for the given item\r\n\t\t//\t\tand its children.\r\n\t\treturn new dijit.MenuItem({});\r\n\t},\r\n\r\n\tgetPaneForItem: function(/* item? */ item, /* dijit._Contained? */ parentPane, /* item[]? */ children){\r\n\t\t// summary:\r\n\t\t//\t\tuser-overridable function to return a pane that corresponds\r\n\t\t//\t\tto the given item in the store.  It can return null to not add a new pane\r\n\t\t//\t\t(ie, you are planning on doing something else with it in onItemClick)\r\n\r\n\t\t// Item is undefined for the root pane, children is undefined for non-group panes\r\n\t\tif(!item || children){\r\n\t\t\treturn new dojox.widget._RollingListGroupPane({});\r\n\t\t}else{\r\n\t\t\treturn null;\r\n\t\t}\r\n\t},\r\n\r\n\tonItemClick: function(/* item */ item, /* dijit._Contained */ pane, /* item[]? */ children){\r\n\t\t// summary:\r\n\t\t//\t\tcalled when an item is clicked - it receives the store item\r\n\t},\r\n\t\r\n\tonExecute: function(){\r\n\t\t// summary:\r\n\t\t//\t\texists so that popups don't disappear too soon\r\n\t},\r\n\t\r\n\tonCancel: function(){\r\n\t\t// summary:\r\n\t\t//\t\texists so that we can close ourselves if we wish\r\n\t},\r\n\t\r\n\tonChange: function(/* item */ value){\r\n\t\t// summary:\r\n\t\t//\t\tcalled when the value of this widget has changed\r\n\t}\r\n\t\r\n});\r\n"]}