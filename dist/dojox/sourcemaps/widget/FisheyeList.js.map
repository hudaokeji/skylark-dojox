{"version":3,"sources":["widget/FisheyeList.js"],"names":["define","declare","has","lang","aspect","dom","attr","domClass","geometry","style","construct","on","winUtil","mouse","_WidgetBase","_TemplatedMixin","_Container","FisheyeListItem","constructor","this","pos","x","y","timerScale","EDGE","CENTER","LEFT","RIGHT","TOP","BOTTOM","templateString","snarfChildDomOutput","itemWidth","itemHeight","itemMaxWidth","itemMaxHeight","imgNode","orientation","isFixed","conservativeTrigger","effectUnits","itemPadding","attachEdge","labelEdge","postCreate","e","isHorizontal","setSelectable","domNode","selectedNode","isOver","hitX1","hitY1","hitX2","hitY2","anchorEdge","_toEdge","proximityLeft","proximityRight","proximityTop","proximityBottom","startup","children","getChildren","_initializePositioning","_onMouseMoveHandle","pausable","doc","documentElement","hitch","pause","own","_onScroll","leave","after","global","itemCount","length","barWidth","barHeight","totalWidth","totalHeight","i","posX","posY","cenX","cenY","isz","r","c","lhs","rhs","siz","range_lhs","range_rhs","effectRangeLeft","effectRangeRght","set","width","height","itm","elm","left","top","_calcHitGrid","_overElement","node","byId","pageX","pageY","absolute","position","bottom","h","right","w","_onBodyOut","body","_setDormant","_onGridMouseMove","_setActive","resume","_onMouseMove","_expandSlowly","onResized","_paint","prx","cen","max_off_cen","off_weight","weight","_weighAt","_setItemSize","main_p","Math","round","offset","sizeMain","_positionElementsFrom","dist","abs","limit","p","scale","sizeW","sizeH","sizeOff","usualX","usualY","svgNode","setSize","usual","start","get","_positionLabel","bpos","apos","mb","getMarginBox","lblNode","inp","def","toUpperCase","setTimeout"],"mappings":"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","file":"../../widget/FisheyeList.js","sourcesContent":["define([\"dojo/_base/declare\", \"dojo/_base/sniff\", \"dojo/_base/lang\", \"dojo/aspect\", \"dojo/dom\", \"dojo/dom-attr\", \"dojo/dom-class\", \"dojo/dom-geometry\", \"dojo/dom-style\", \"dojo/dom-construct\", \"dojo/on\", \"dojo/_base/window\", \"dojo/mouse\", \"dijit/_WidgetBase\", \"dijit/_TemplatedMixin\", \"dijit/_Container\", \"./FisheyeListItem\"],\r\n\tfunction(declare, has, lang, aspect, dom, attr, domClass, geometry, style, construct, on, winUtil, mouse, _WidgetBase, _TemplatedMixin, _Container, FisheyeListItem){\r\n\r\n\t\treturn declare(\"dojox.widget.FisheyeList\",\r\n\t\t\t[_WidgetBase, _TemplatedMixin, _Container], {\r\n\t\t\t\t// summary:\r\n\t\t\t\t//\t\tMenu similar to the fish eye menu on the Mac OS\r\n\t\t\t\t// example:\r\n\t\t\t\t// |\t<div dojoType=\"dojo.widget.FisheyeList\"\r\n\t\t\t\t// |\t\titemWidth=\"40\" itemHeight=\"40\"\r\n\t\t\t\t// |\t\titemMaxWidth=\"150\" itemMaxHeight=\"150\"\r\n\t\t\t\t// |\t\torientation=\"horizontal\"\r\n\t\t\t\t// |\t\teffectUnits=\"2\"\r\n\t\t\t\t// |\t\titemPadding=\"10\"\r\n\t\t\t\t// |\t\tattachEdge=\"center\"\r\n\t\t\t\t// |\t\tlabelEdge=\"bottom\">\r\n\t\t\t\t// |\r\n\t\t\t\t// |\t\t<div dojoType=\"dojox.widget.FisheyeListItem\"\r\n\t\t\t\t// |\t\t\tid=\"item1\"\r\n\t\t\t\t// |\t\t\tonclick=\"alert('click on' + this.label + '(from widget id ' + this.widgetId + ')!');\"\r\n\t\t\t\t// |\t\t\tlabel=\"Item 1\"\r\n\t\t\t\t// |\t\t\ticonSrc=\"images/fisheye_1.png\">\r\n\t\t\t\t// |\t\t</div>\r\n\t\t\t\t// |\t\t...\r\n\t\t\t\t// |\t</div>\r\n\r\n\t\t\t\tconstructor: function(){\r\n\t\t\t\t\t//\r\n\t\t\t\t\t// TODO\r\n\t\t\t\t\t// fix really long labels in vertical mode\r\n\t\t\t\t\t//\r\n\r\n\t\t\t\t\tthis.pos = {'x': -1, 'y': -1};\t// current cursor position, relative to the grid\r\n\r\n\t\t\t\t\t// for conservative trigger mode, when triggered, timerScale is gradually increased from 0 to 1\r\n\t\t\t\t\tthis.timerScale = 1.0;\r\n\t\t\t\t},\r\n\r\n\t\t\t\tEDGE: {\r\n\t\t\t\t\tCENTER: 0,\r\n\t\t\t\t\tLEFT: 1,\r\n\t\t\t\t\tRIGHT: 2,\r\n\t\t\t\t\tTOP: 3,\r\n\t\t\t\t\tBOTTOM: 4\r\n\t\t\t\t},\r\n\r\n\t\t\t\ttemplateString: '<div class=\"dojoxFisheyeListBar\" data-dojo-attach-point=\"containerNode\"></div>',\r\n\r\n\t\t\t\tsnarfChildDomOutput: true,\r\n\r\n\t\t\t\t// itemWidth: Integer\r\n\t\t\t\t//\t\twidth of menu item (in pixels) in it's dormant state (when the mouse is far away)\r\n\t\t\t\titemWidth: 40,\r\n\r\n\t\t\t\t// itemHeight: Integer\r\n\t\t\t\t//\t\theight of menu item (in pixels) in it's dormant state (when the mouse is far away)\r\n\t\t\t\titemHeight: 40,\r\n\r\n\t\t\t\t// itemMaxWidth: Integer\r\n\t\t\t\t//\t\twidth of menu item (in pixels) in it's fully enlarged state (when the mouse is directly over it)\r\n\t\t\t\titemMaxWidth: 150,\r\n\r\n\t\t\t\t// itemMaxHeight: Integer\r\n\t\t\t\t//\t\theight of menu item (in pixels) in it's fully enlarged state (when the mouse is directly over it)\r\n\t\t\t\titemMaxHeight: 150,\r\n\r\n\t\t\t\timgNode: null,\r\n\r\n\t\t\t\t// orientation: String\r\n\t\t\t\t//\t\torientation of the menu, either \"horizontal\" or \"vertical\"\r\n\t\t\t\torientation: 'horizontal',\r\n\r\n\t\t\t\t// isFixed: Boolean\r\n\t\t\t\t//\t\ttoggle to enable additional listener (window scroll) if FisheyeList is in a fixed postion\r\n\t\t\t\tisFixed: false,\r\n\r\n\t\t\t\t// conservativeTrigger: Boolean\r\n\t\t\t\t//\t\tif true, don't start enlarging menu items until mouse is over an image;\r\n\t\t\t\t//\t\tif false, start enlarging menu items as the mouse moves near them.\r\n\t\t\t\tconservativeTrigger: false,\r\n\r\n\t\t\t\t// effectUnits: Number\r\n\t\t\t\t//\t\tcontrols how much reaction the menu makes, relative to the distance of the mouse from the menu\r\n\t\t\t\teffectUnits: 2,\r\n\r\n\t\t\t\t// itemPadding: Integer\r\n\t\t\t\t//\t\tpadding (in pixels) between each menu item\r\n\t\t\t\titemPadding: 10,\r\n\r\n\t\t\t\t// attachEdge: String\r\n\t\t\t\t//\t\tControls the border that the menu items don't expand past;\r\n\t\t\t\t//\t\tfor example, if set to \"top\", then the menu items will drop downwards as they expand.\r\n\t\t\t\t//\t\tValues: \"center\", \"left\", \"right\", \"top\", \"bottom\".\r\n\t\t\t\tattachEdge: 'center',\r\n\r\n\t\t\t\t// labelEdge: String\r\n\t\t\t\t//\t\tControls were the labels show up in relation to the menu item icons.\r\n\t\t\t\t//\t\tValues: \"center\", \"left\", \"right\", \"top\", \"bottom\".\r\n\t\t\t\tlabelEdge: 'bottom',\r\n\r\n\t\t\t\tpostCreate: function(){\r\n\t\t\t\t\tvar e = this.EDGE,\r\n\t\t\t\t\t\tisHorizontal = this.isHorizontal = (this.orientation == 'horizontal');\r\n\r\n\t\t\t\t\tdom.setSelectable(this.domNode, false);\r\n\r\n\t\t\t\t\tthis.selectedNode = -1;\r\n\r\n\t\t\t\t\tthis.isOver = false;\r\n\t\t\t\t\tthis.hitX1 = -1;\r\n\t\t\t\t\tthis.hitY1 = -1;\r\n\t\t\t\t\tthis.hitX2 = -1;\r\n\t\t\t\t\tthis.hitY2 = -1;\r\n\r\n\t\t\t\t\t//\r\n\t\t\t\t\t// only some edges make sense...\r\n\t\t\t\t\t//\r\n\t\t\t\t\tthis.anchorEdge = this._toEdge(this.attachEdge, e.CENTER);\r\n\t\t\t\t\tthis.labelEdge  = this._toEdge(this.labelEdge,  e.TOP);\r\n\r\n\t\t\t\t\tif(this.labelEdge == e.CENTER){ this.labelEdge = e.TOP; }\r\n\r\n\t\t\t\t\tif(isHorizontal){\r\n\t\t\t\t\t\tif(this.anchorEdge == e.LEFT){ this.anchorEdge = e.CENTER; }\r\n\t\t\t\t\t\tif(this.anchorEdge == e.RIGHT){ this.anchorEdge = e.CENTER; }\r\n\t\t\t\t\t\tif(this.labelEdge == e.LEFT){ this.labelEdge = e.TOP; }\r\n\t\t\t\t\t\tif(this.labelEdge == e.RIGHT){ this.labelEdge = e.TOP; }\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tif(this.anchorEdge == e.TOP){ this.anchorEdge = e.CENTER; }\r\n\t\t\t\t\t\tif(this.anchorEdge == e.BOTTOM){ this.anchorEdge = e.CENTER; }\r\n\t\t\t\t\t\tif(this.labelEdge == e.TOP){ this.labelEdge = e.LEFT; }\r\n\t\t\t\t\t\tif(this.labelEdge == e.BOTTOM){ this.labelEdge = e.LEFT; }\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//\r\n\t\t\t\t\t// figure out the proximity size\r\n\t\t\t\t\t//\r\n\t\t\t\t\tvar effectUnits = this.effectUnits;\r\n\t\t\t\t\tthis.proximityLeft   = this.itemWidth  * (effectUnits - 0.5);\r\n\t\t\t\t\tthis.proximityRight  = this.itemWidth  * (effectUnits - 0.5);\r\n\t\t\t\t\tthis.proximityTop\t= this.itemHeight * (effectUnits - 0.5);\r\n\t\t\t\t\tthis.proximityBottom = this.itemHeight * (effectUnits - 0.5);\r\n\r\n\t\t\t\t\tif(this.anchorEdge == e.LEFT){\r\n\t\t\t\t\t\tthis.proximityLeft = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(this.anchorEdge == e.RIGHT){\r\n\t\t\t\t\t\tthis.proximityRight = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(this.anchorEdge == e.TOP){\r\n\t\t\t\t\t\tthis.proximityTop = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(this.anchorEdge == e.BOTTOM){\r\n\t\t\t\t\t\tthis.proximityBottom = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(this.anchorEdge == e.CENTER){\r\n\t\t\t\t\t\tthis.proximityLeft   /= 2;\r\n\t\t\t\t\t\tthis.proximityRight  /= 2;\r\n\t\t\t\t\t\tthis.proximityTop\t/= 2;\r\n\t\t\t\t\t\tthis.proximityBottom /= 2;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\tstartup: function(){\r\n\t\t\t\t\t// summary:\r\n\t\t\t\t\t//\t\tcreate our connections and setup our FisheyeList\r\n\t\t\t\t\tthis.children = this.getChildren();\r\n\t\t\t\t\t//original postCreate() --tk\r\n\t\t\t\t\tthis._initializePositioning();\r\n\r\n\t\t\t\t\t//\r\n\t\t\t\t\t// in liberal trigger mode, activate menu whenever mouse is close, in conservative mode, pause until needed\r\n\t\t\t\t\t//\r\n\t\t\t\t\tthis._onMouseMoveHandle = on.pausable(winUtil.doc.documentElement, \"mousemove\", lang.hitch(this, \"_onMouseMove\"));\r\n\t\t\t\t\tif(this.conservativeTrigger){\r\n\t\t\t\t\t\tthis._onMouseMoveHandle.pause();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(this.isFixed){\r\n\t\t\t\t\t\tthis.own(on(winUtil.doc,\"scroll\", lang.hitch(this, this._onScroll)));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Deactivate the menu if mouse is moved off screen (doesn't work for FF?)\r\n\t\t\t\t\tthis.own(\r\n\t\t\t\t\t\ton(winUtil.doc.documentElement, mouse.leave, lang.hitch(this, \"_onBodyOut\")),\r\n\t\t\t\t\t\taspect.after(this, \"addChild\", lang.hitch(this, \"_initializePositioning\"), true),\r\n\t\t\t\t\t\taspect.after(winUtil.global, \"onresize\", lang.hitch(this, \"_initializePositioning\"), true)\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\r\n\t\t\t\t_initializePositioning: function(){\r\n\t\t\t\t\tthis.itemCount = this.children.length;\r\n\r\n\t\t\t\t\tthis.barWidth  = (this.isHorizontal ? this.itemCount : 1) * this.itemWidth;\r\n\t\t\t\t\tthis.barHeight = (this.isHorizontal ? 1 : this.itemCount) * this.itemHeight;\r\n\r\n\t\t\t\t\tthis.totalWidth  = this.proximityLeft + this.proximityRight  + this.barWidth;\r\n\t\t\t\t\tthis.totalHeight = this.proximityTop  + this.proximityBottom + this.barHeight;\r\n\r\n\t\t\t\t\t//\r\n\t\t\t\t\t// calculate effect ranges for each item\r\n\t\t\t\t\t//\r\n\r\n\t\t\t\t\tfor(var i=0; i<this.children.length; i++){\r\n\r\n\t\t\t\t\t\tthis.children[i].posX = this.itemWidth  * (this.isHorizontal ? i : 0);\r\n\t\t\t\t\t\tthis.children[i].posY = this.itemHeight * (this.isHorizontal ? 0 : i);\r\n\r\n\t\t\t\t\t\tthis.children[i].cenX = this.children[i].posX + (this.itemWidth  / 2);\r\n\t\t\t\t\t\tthis.children[i].cenY = this.children[i].posY + (this.itemHeight / 2);\r\n\r\n\t\t\t\t\t\tvar isz = this.isHorizontal ? this.itemWidth : this.itemHeight,\r\n\t\t\t\t\t\t\tr = this.effectUnits * isz,\r\n\t\t\t\t\t\t\tc = this.isHorizontal ? this.children[i].cenX : this.children[i].cenY,\r\n\t\t\t\t\t\t\tlhs = this.isHorizontal ? this.proximityLeft : this.proximityTop,\r\n\t\t\t\t\t\t\trhs = this.isHorizontal ? this.proximityRight : this.proximityBottom,\r\n\t\t\t\t\t\t\tsiz = this.isHorizontal ? this.barWidth : this.barHeight,\r\n\r\n\t\t\t\t\t\t\trange_lhs = r,\r\n\t\t\t\t\t\t\trange_rhs = r;\r\n\r\n\t\t\t\t\t\tif(range_lhs > c+lhs){ range_lhs = c+lhs; }\r\n\t\t\t\t\t\tif(range_rhs > (siz-c+rhs)){ range_rhs = siz-c+rhs; }\r\n\r\n\t\t\t\t\t\tthis.children[i].effectRangeLeft = range_lhs / isz;\r\n\t\t\t\t\t\tthis.children[i].effectRangeRght = range_rhs / isz;\r\n\r\n\t\t\t\t\t\t//dojo.debug('effect range for '+i+' is '+range_lhs+'/'+range_rhs);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//\r\n\t\t\t\t\t// create the bar\r\n\t\t\t\t\t//\r\n\t\t\t\t\tstyle.set(this.domNode, {width: this.barWidth + 'px', height: this.barHeight + 'px'});\r\n\r\n\t\t\t\t\t//\r\n\t\t\t\t\t// position the items\r\n\t\t\t\t\t//\r\n\t\t\t\t\tfor(i=0; i<this.children.length; i++){\r\n\t\t\t\t\t\tvar itm = this.children[i];\r\n\t\t\t\t\t\tvar elm = itm.domNode;\r\n\t\t\t\t\t\tstyle.set(elm, {left: itm.posX + 'px', top: itm.posY + 'px', width: this.itemWidth + 'px', height: this.itemHeight + 'px'});\r\n\r\n\t\t\t\t\t\tstyle.set(itm.imgNode, {left: this.itemPadding+'%', top: this.itemPadding+'%', width: (100 - 2 * this.itemPadding) + '%', height: (100 - 2 * this.itemPadding) + '%'});\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//\r\n\t\t\t\t\t// calc the grid\r\n\t\t\t\t\t//\r\n\t\t\t\t\tthis._calcHitGrid();\r\n\t\t\t\t},\r\n\r\n\t\t\t\t_overElement: function(/* DomNode|String */ node, /* Event */ e){\r\n\t\t\t\t\t// summary:\r\n\t\t\t\t\t//\t\tReturns whether the mouse is over the passed element.\r\n\t\t\t\t\t// node:\r\n\t\t\t\t\t//\t\tMust must be display:block (ie, not a `<span>`)\r\n\t\t\t\t\tnode = dom.byId(node);\r\n\t\t\t\t\tvar mouse = {x: e.pageX, y: e.pageY},\r\n\t\t\t\t\t\tabsolute = geometry.position(node, true),\r\n\t\t\t\t\t\ttop = absolute.y,\r\n\t\t\t\t\t\tbottom = top + absolute.h,\r\n\t\t\t\t\t\tleft = absolute.x,\r\n\t\t\t\t\t\tright = left + absolute.w;\r\n\r\n\t\t\t\t\treturn (mouse.x >= left\r\n\t\t\t\t\t\t&& mouse.x <= right\r\n\t\t\t\t\t\t&& mouse.y >= top\r\n\t\t\t\t\t\t&& mouse.y <= bottom\r\n\t\t\t\t\t\t);\t// Boolean\r\n\t\t\t\t},\r\n\r\n\t\t\t\t_onBodyOut: function(/*Event*/ e){\r\n\t\t\t\t\t// clicking over an object inside of body causes this event to fire; ignore that case\r\n\t\t\t\t\tif( this._overElement(winUtil.body(), e) ){\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis._setDormant(e);\r\n\t\t\t\t},\r\n\r\n\t\t\t\t_setDormant: function(/*Event*/ e){\r\n\t\t\t\t\t// summary:\r\n\t\t\t\t\t//\t\tcalled when mouse moves out of menu's range\r\n\r\n\t\t\t\t\tif(!this.isOver){ return; }\t// already dormant?\r\n\t\t\t\t\tthis.isOver = false;\r\n\r\n\t\t\t\t\tif(this.conservativeTrigger){\r\n\t\t\t\t\t\t// user can't re-trigger the menu expansion\r\n\t\t\t\t\t\t// until he mouses over a icon again\r\n\t\t\t\t\t\tthis._onMouseMoveHandle.pause();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis._onGridMouseMove(-1, -1);\r\n\t\t\t\t},\r\n\r\n\t\t\t\t_setActive: function(/*Event*/ e){\r\n\t\t\t\t\t// summary:\r\n\t\t\t\t\t//\t\tcalled when mouse is moved into menu's range\r\n\r\n\t\t\t\t\tif(this.isOver){ return; }\t// already activated?\r\n\t\t\t\t\tthis.isOver = true;\r\n\r\n\t\t\t\t\tif(this.conservativeTrigger){\r\n\t\t\t\t\t\t// switch event handlers so that we handle mouse events from anywhere near\r\n\t\t\t\t\t\t// the menu\r\n\t\t\t\t\t\tthis._onMouseMoveHandle.resume();\r\n\r\n\t\t\t\t\t\tthis.timerScale=0.0;\r\n\r\n\t\t\t\t\t\t// call mouse handler to do some initial necessary calculations/positioning\r\n\t\t\t\t\t\tthis._onMouseMove(e);\r\n\r\n\t\t\t\t\t\t// slowly expand the icon size so it isn't jumpy\r\n\t\t\t\t\t\tthis._expandSlowly();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\t_onMouseMove: function(/*Event*/ e){\r\n\t\t\t\t\t// summary:\r\n\t\t\t\t\t//\t\tcalled when mouse is moved\r\n\t\t\t\t\tif(\t(e.pageX >= this.hitX1) && (e.pageX <= this.hitX2) &&\r\n\t\t\t\t\t\t(e.pageY >= this.hitY1) && (e.pageY <= this.hitY2)\t){\r\n\t\t\t\t\t\tif(!this.isOver){\r\n\t\t\t\t\t\t\tthis._setActive(e);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis._onGridMouseMove(e.pageX-this.hitX1, e.pageY-this.hitY1);\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tif(this.isOver){\r\n\t\t\t\t\t\t\tthis._setDormant(e);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\t_onScroll: function(){\r\n\t\t\t\t\tthis._calcHitGrid();\r\n\t\t\t\t},\r\n\r\n\t\t\t\tonResized: function(){\r\n\t\t\t\t\tthis._calcHitGrid();\r\n\t\t\t\t},\r\n\r\n\t\t\t\t_onGridMouseMove: function(x, y){\r\n\t\t\t\t\t// summary:\r\n\t\t\t\t\t//\t\tcalled when mouse is moved in the vicinity of the menu\r\n\t\t\t\t\tthis.pos = {x:x, y:y};\r\n\t\t\t\t\tthis._paint();\r\n\t\t\t\t},\r\n\r\n\t\t\t\t_paint: function(){\r\n\t\t\t\t\tvar x=this.pos.x;\r\n\t\t\t\t\tvar y=this.pos.y;\r\n\r\n\t\t\t\t\tif(this.itemCount <= 0){ return; }\r\n\r\n\t\t\t\t\t//\r\n\t\t\t\t\t// figure out our main index\r\n\t\t\t\t\t//\r\n\t\t\t\t\tvar pos = this.isHorizontal ? x : y,\r\n\t\t\t\t\t\tprx = this.isHorizontal ? this.proximityLeft : this.proximityTop,\r\n\t\t\t\t\t\tsiz = this.isHorizontal ? this.itemWidth : this.itemHeight,\r\n\t\t\t\t\t\tsim = this.isHorizontal ?\r\n\t\t\t\t\t\t\t(1.0-this.timerScale)*this.itemWidth + this.timerScale*this.itemMaxWidth :\r\n\t\t\t\t\t\t\t(1.0-this.timerScale)*this.itemHeight + this.timerScale*this.itemMaxHeight,\r\n\r\n\t\t\t\t\t\tcen = ((pos - prx) / siz) - 0.5,\r\n\t\t\t\t\t\tmax_off_cen = (sim / siz) - 0.5;\r\n\r\n\t\t\t\t\tif(max_off_cen > this.effectUnits){ max_off_cen = this.effectUnits; }\r\n\r\n\t\t\t\t\t//\r\n\t\t\t\t\t// figure out our off-axis weighting\r\n\t\t\t\t\t//\r\n\t\t\t\t\tvar off_weight = 0, cen2;\r\n\r\n\t\t\t\t\tif(this.anchorEdge == this.EDGE.BOTTOM){\r\n\t\t\t\t\t\tcen2 = (y - this.proximityTop) / this.itemHeight;\r\n\t\t\t\t\t\toff_weight = (cen2 > 0.5) ? 1 : y / (this.proximityTop + (this.itemHeight / 2));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(this.anchorEdge == this.EDGE.TOP){\r\n\t\t\t\t\t\tcen2 = (y - this.proximityTop) / this.itemHeight;\r\n\t\t\t\t\t\toff_weight = (cen2 < 0.5) ? 1 : (this.totalHeight - y) / (this.proximityBottom + (this.itemHeight / 2));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(this.anchorEdge == this.EDGE.RIGHT){\r\n\t\t\t\t\t\tcen2 = (x - this.proximityLeft) / this.itemWidth;\r\n\t\t\t\t\t\toff_weight = (cen2 > 0.5) ? 1 : x / (this.proximityLeft + (this.itemWidth / 2));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(this.anchorEdge == this.EDGE.LEFT){\r\n\t\t\t\t\t\tcen2 = (x - this.proximityLeft) / this.itemWidth;\r\n\t\t\t\t\t\toff_weight = (cen2 < 0.5) ? 1 : (this.totalWidth - x) / (this.proximityRight + (this.itemWidth / 2));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(this.anchorEdge == this.EDGE.CENTER){\r\n\t\t\t\t\t\tif(this.isHorizontal){\r\n\t\t\t\t\t\t\toff_weight = y / (this.totalHeight);\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\toff_weight = x / (this.totalWidth);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif(off_weight > 0.5){\r\n\t\t\t\t\t\t\toff_weight = 1 - off_weight;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\toff_weight *= 2;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//\r\n\t\t\t\t\t// set the sizes\r\n\t\t\t\t\t//\r\n\t\t\t\t\tfor(var i=0; i<this.itemCount; i++){\r\n\t\t\t\t\t\tvar weight = this._weighAt(cen, i);\r\n\t\t\t\t\t\tif(weight < 0){weight = 0;}\r\n\t\t\t\t\t\tthis._setItemSize(i, weight * off_weight);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//\r\n\t\t\t\t\t// set the positions\r\n\t\t\t\t\t//\r\n\r\n\t\t\t\t\tvar main_p = Math.round(cen),\r\n\t\t\t\t\t\toffset = 0;\r\n\r\n\t\t\t\t\tif(cen < 0){\r\n\r\n\t\t\t\t\t\tmain_p = 0;\r\n\r\n\t\t\t\t\t}else if(cen > this.itemCount - 1){\r\n\r\n\t\t\t\t\t\tmain_p = this.itemCount -1;\r\n\r\n\t\t\t\t\t}else{\r\n\r\n\t\t\t\t\t\toffset = (cen - main_p) * ((this.isHorizontal ? this.itemWidth : this.itemHeight) - this.children[main_p].sizeMain);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis._positionElementsFrom(main_p, offset);\r\n\t\t\t\t},\r\n\r\n\t\t\t\t_weighAt: function(/*Integer*/ cen, /*Integer*/ i){\r\n\t\t\t\t\tvar dist = Math.abs(cen - i),\r\n\t\t\t\t\t\tlimit = ((cen - i) > 0) ? this.children[i].effectRangeRght : this.children[i].effectRangeLeft;\r\n\r\n\t\t\t\t\treturn (dist > limit) ? 0 : (1 - dist / limit); // Integer\r\n\t\t\t\t},\r\n\r\n\t\t\t\t_setItemSize: function(p, scale){\r\n\t\t\t\t\tif(this.children[p].scale == scale){ return; }\r\n\t\t\t\t\tthis.children[p].scale = scale;\r\n\r\n\t\t\t\t\tscale *= this.timerScale;\r\n\t\t\t\t\tvar w = Math.round(this.itemWidth  + ((this.itemMaxWidth  - this.itemWidth ) * scale)),\r\n\t\t\t\t\t\th = Math.round(this.itemHeight + ((this.itemMaxHeight - this.itemHeight) * scale));\r\n\r\n\t\t\t\t\tif(this.isHorizontal){\r\n\r\n\t\t\t\t\t\tthis.children[p].sizeW = w;\r\n\t\t\t\t\t\tthis.children[p].sizeH = h;\r\n\r\n\t\t\t\t\t\tthis.children[p].sizeMain = w;\r\n\t\t\t\t\t\tthis.children[p].sizeOff  = h;\r\n\r\n\t\t\t\t\t\tvar y = 0;\r\n\t\t\t\t\t\tif(this.anchorEdge == this.EDGE.TOP){\r\n\t\t\t\t\t\t\ty = (this.children[p].cenY - (this.itemHeight / 2));\r\n\t\t\t\t\t\t}else if(this.anchorEdge == this.EDGE.BOTTOM){\r\n\t\t\t\t\t\t\ty = (this.children[p].cenY - (h - (this.itemHeight / 2)));\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\ty = (this.children[p].cenY - (h / 2));\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tthis.children[p].usualX = Math.round(this.children[p].cenX - (w / 2));\r\n\t\t\t\t\t\tstyle.set(this.children[p].domNode, {top: y + 'px', left: this.children[p].usualX + 'px'});\r\n\r\n\t\t\t\t\t}else{\r\n\r\n\t\t\t\t\t\tthis.children[p].sizeW = w;\r\n\t\t\t\t\t\tthis.children[p].sizeH = h;\r\n\r\n\t\t\t\t\t\tthis.children[p].sizeOff  = w;\r\n\t\t\t\t\t\tthis.children[p].sizeMain = h;\r\n\r\n\t\t\t\t\t\tvar x = 0;\r\n\t\t\t\t\t\tif(this.anchorEdge == this.EDGE.LEFT){\r\n\t\t\t\t\t\t\tx = this.children[p].cenX - (this.itemWidth / 2);\r\n\t\t\t\t\t\t}else if(this.anchorEdge == this.EDGE.RIGHT){\r\n\t\t\t\t\t\t\tx = this.children[p].cenX - (w - (this.itemWidth / 2));\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tx = this.children[p].cenX - (w / 2);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tthis.children[p].usualY = Math.round(this.children[p].cenY - (h / 2));\r\n\t\t\t\t\t\tstyle.set(this.children[p].domNode, {left: x + 'px', top: this.children[p].usualY + 'px'});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tstyle.set(this.children[p].domNode, {width: w + 'px', height: h + 'px'});\r\n\r\n\t\t\t\t\tif(this.children[p].svgNode){\r\n\t\t\t\t\t\tthis.children[p].svgNode.setSize(w, h);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\t_positionElementsFrom: function(p, offset){\r\n\t\t\t\t\tvar pos = 0;\r\n\r\n\t\t\t\t\tvar usual, start;\r\n\t\t\t\t\tif(this.isHorizontal){\r\n\t\t\t\t\t\tusual = \"usualX\";\r\n\t\t\t\t\t\tstart = \"left\";\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tusual = \"usualY\";\r\n\t\t\t\t\t\tstart = \"top\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tpos = Math.round(this.children[p][usual] + offset);\r\n\t\t\t\t\tif(style.get(this.children[p].domNode, start) != (pos + 'px')){\r\n\t\t\t\t\t\tstyle.set(this.children[p].domNode, start, pos + 'px');\r\n\t\t\t\t\t\tthis._positionLabel(this.children[p]);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// position before\r\n\t\t\t\t\tvar bpos = pos;\r\n\t\t\t\t\tfor(var i=p-1; i>=0; i--){\r\n\t\t\t\t\t\tbpos -= this.children[i].sizeMain;\r\n\r\n\t\t\t\t\t\tif(style.get(this.children[p].domNode, start) != (bpos + 'px')){\r\n\t\t\t\t\t\t\tstyle.set(this.children[i].domNode, start, bpos + 'px');\r\n\t\t\t\t\t\t\tthis._positionLabel(this.children[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// position after\r\n\t\t\t\t\tvar apos = pos;\r\n\t\t\t\t\tfor(i=p+1; i<this.itemCount; i++){\r\n\t\t\t\t\t\tapos += this.children[i-1].sizeMain;\r\n\t\t\t\t\t\tif(style.get(this.children[p].domNode, start) != (apos + 'px')){\r\n\t\t\t\t\t\t\tstyle.set(this.children[i].domNode, start, apos + 'px');\r\n\t\t\t\t\t\t\tthis._positionLabel(this.children[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\t_positionLabel: function(itm){\r\n\t\t\t\t\tvar x = 0;\r\n\t\t\t\t\tvar y = 0;\r\n\r\n\t\t\t\t\tvar mb = geometry.getMarginBox(itm.lblNode);\r\n\r\n\t\t\t\t\tif(this.labelEdge == this.EDGE.TOP){\r\n\t\t\t\t\t\tx = Math.round((itm.sizeW / 2) - (mb.w / 2));\r\n\t\t\t\t\t\ty = -mb.h;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif(this.labelEdge == this.EDGE.BOTTOM){\r\n\t\t\t\t\t\tx = Math.round((itm.sizeW / 2) - (mb.w / 2));\r\n\t\t\t\t\t\ty = itm.sizeH;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif(this.labelEdge == this.EDGE.LEFT){\r\n\t\t\t\t\t\tx = -mb.w;\r\n\t\t\t\t\t\ty = Math.round((itm.sizeH / 2) - (mb.h / 2));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif(this.labelEdge == this.EDGE.RIGHT){\r\n\t\t\t\t\t\tx = itm.sizeW;\r\n\t\t\t\t\t\ty = Math.round((itm.sizeH / 2) - (mb.h / 2));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tstyle.set(itm.lblNode, {left: x + 'px', top: y + 'px'});\r\n\t\t\t\t},\r\n\r\n\t\t\t\t_calcHitGrid: function(){\r\n\r\n\t\t\t\t\tvar pos = geometry.position(this.domNode, true);\r\n\r\n\t\t\t\t\tthis.hitX1 = pos.x - this.proximityLeft;\r\n\t\t\t\t\tthis.hitY1 = pos.y - this.proximityTop;\r\n\t\t\t\t\tthis.hitX2 = this.hitX1 + this.totalWidth;\r\n\t\t\t\t\tthis.hitY2 = this.hitY1 + this.totalHeight;\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\t_toEdge: function(inp, def){\r\n\t\t\t\t\treturn this.EDGE[inp.toUpperCase()] || def;\r\n\t\t\t\t},\r\n\r\n\t\t\t\t_expandSlowly: function(){\r\n\t\t\t\t\t// summary:\r\n\t\t\t\t\t//\t\tslowly expand the image to user specified max size\r\n\t\t\t\t\tif(!this.isOver){ return; }\r\n\t\t\t\t\tthis.timerScale += 0.2;\r\n\t\t\t\t\tthis._paint();\r\n\t\t\t\t\tif(this.timerScale<1.0){\r\n\t\t\t\t\t\tsetTimeout(lang.hitch(this, \"_expandSlowly\"), 10);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t});\r\n"]}