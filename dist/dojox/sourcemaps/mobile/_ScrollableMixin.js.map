{"version":3,"sources":["mobile/_ScrollableMixin.js"],"names":["define","dojo","config","declare","lang","win","dom","domClass","registry","Scrollable","fixedHeader","fixedFooter","_fixedAppFooter","scrollableParams","allowNestedScrolls","appBars","constructor","this","destroy","cleanup","inherited","arguments","startup","_started","byId","findAppBars","node","params","parentNode","domNode","isLocalHeader","fixedHeaderHeight","offsetHeight","isLocalFooter","style","bottom","fixedFooterHeight","scrollType","mblScrollableScrollType","init","p","getParent","dirLock","_resizeHandle","subscribe","display","elem","doc","activeElement","isFormElement","isDescendant","containerNode","scrollIntoView","i","len","c","body","childNodes","length","checkFixedBar","local","nodeType","fixed","getAttribute","byNode","add","top"],"mappings":";;;;;;;AAAAA,QACC,oBACA,oBACA,qBACA,kBACA,oBACA,WACA,iBACA,iBACA,gBACE,SAASC,EAAMC,EAAQC,EAASC,EAAMC,EAAKC,EAAKC,EAAUC,EAAUC,GAqItE,OAjIUN,EAAQ,gCAAiCM,GAMlDC,YAAa,GAIbC,YAAa,GAEbC,gBAAiB,GAIjBC,iBAAkB,KAIlBC,oBAAoB,EAIpBC,SAAS,EAETC,YAAa,WAKZC,KAAKJ,qBAGNK,QAAS,WACRD,KAAKE,UACLF,KAAKG,UAAUC,YAGhBC,QAAS,WACR,IAAGL,KAAKM,SAAR,CACGN,KAAKL,kBACPK,KAAKL,gBAAkBN,EAAIkB,KAAKP,KAAKL,kBAEtCK,KAAKQ,cACL,IAAIC,EAAMC,EAASV,KAAKJ,iBAkBxB,GAjBGI,KAAKP,eACPgB,EAAOpB,EAAIkB,KAAKP,KAAKP,cACbkB,YAAcX,KAAKY,UAC1BZ,KAAKa,eAAgB,GAEtBH,EAAOI,kBAAoBL,EAAKM,cAE9Bf,KAAKN,eACPe,EAAOpB,EAAIkB,KAAKP,KAAKN,cACbiB,YAAcX,KAAKY,UAC1BZ,KAAKgB,eAAgB,EACrBP,EAAKQ,MAAMC,OAAS,OAErBR,EAAOS,kBAAoBV,EAAKM,cAEjCf,KAAKoB,WAAapB,KAAKoB,YAAcnC,EAAOoC,yBAA2B,EACvErB,KAAKsB,KAAKZ,GACPV,KAAKH,mBACP,IAAI,IAAI0B,EAAIvB,KAAKwB,YAAaD,EAAGA,EAAIA,EAAEC,YACtC,GAAGD,GAAKA,EAAE3B,iBAAiB,CAC1BI,KAAKyB,SAAU,EACfF,EAAEE,SAAU,EACZ,MAMHzB,KAAK0B,cAAgB1B,KAAK2B,UAAU,+BAAgC,WACnE,GAAkC,SAA/B3B,KAAKY,QAAQK,MAAMW,QAAtB,CACA,IAAIC,EAAOzC,EAAI0C,IAAIC,cAChB/B,KAAKgC,cAAcH,IAASxC,EAAI4C,aAAaJ,EAAM7B,KAAKkC,gBAC1DlC,KAAKmC,eAAeN,MAGtB7B,KAAKG,UAAUC,aAGhBI,YAAa,WAGZ,GAAIR,KAAKF,QAAT,CACA,IAAIsC,EAAGC,EAAKC,EACZ,IAAIF,EAAI,EAAGC,EAAMjD,EAAImD,OAAOC,WAAWC,OAAQL,EAAIC,EAAKD,IACvDE,EAAIlD,EAAImD,OAAOC,WAAWJ,GAC1BpC,KAAK0C,cAAcJ,GAAG,GAEvB,GAAGtC,KAAKY,QAAQD,WACf,IAAIyB,EAAI,EAAGC,EAAMrC,KAAKY,QAAQD,WAAW6B,WAAWC,OAAQL,EAAIC,EAAKD,IACpEE,EAAItC,KAAKY,QAAQD,WAAW6B,WAAWJ,GACvCpC,KAAK0C,cAAcJ,GAAG,GAGxBtC,KAAKmB,kBAAoBnB,KAAKN,YAAcM,KAAKN,YAAYqB,aAAe,IAG7E2B,cAAe,SAAoBjC,EAAiBkC,GAGnD,GAAqB,IAAlBlC,EAAKmC,SAAe,CACtB,IAAIC,EAAQpC,EAAKqC,aAAa,UAC1BrC,EAAKqC,aAAa,sBACjBvD,EAASwD,OAAOtC,IAASlB,EAASwD,OAAOtC,GAAMoC,MACpD,GAAa,QAAVA,EAMF,OALAvD,EAAS0D,IAAIvC,EAAM,qBAChBkC,IACFlC,EAAKQ,MAAMgC,IAAM,MACjBjD,KAAKP,YAAcgB,GAEboC,EACF,GAAa,WAAVA,EAOR,OANAvD,EAAS0D,IAAIvC,EAAM,qBAChBkC,EACF3C,KAAKN,YAAce,EAEnBT,KAAKL,gBAAkBc,EAEjBoC,EAGT,OAAO","file":"../../mobile/_ScrollableMixin.js","sourcesContent":["define([\r\n\t\"dojo/_base/kernel\",\r\n\t\"dojo/_base/config\",\r\n\t\"dojo/_base/declare\",\r\n\t\"dojo/_base/lang\",\r\n\t\"dojo/_base/window\",\r\n\t\"dojo/dom\",\r\n\t\"dojo/dom-class\",\r\n\t\"dijit/registry\",\t// registry.byNode\r\n\t\"./scrollable\"\r\n], function(dojo, config, declare, lang, win, dom, domClass, registry, Scrollable){\r\n\t// module:\r\n\t//\t\tdojox/mobile/_ScrollableMixin\r\n\r\n\tvar cls = declare(\"dojox.mobile._ScrollableMixin\", Scrollable, {\r\n\t\t// summary:\r\n\t\t//\t\tMixin for widgets to have a touch scrolling capability.\r\n\t\r\n\t\t// fixedHeader: String\r\n\t\t//\t\tId of the fixed header.\r\n\t\tfixedHeader: \"\",\r\n\r\n\t\t// fixedFooter: String\r\n\t\t//\t\tId of the fixed footer.\r\n\t\tfixedFooter: \"\",\r\n\r\n\t\t_fixedAppFooter: \"\",\r\n\r\n\t\t// scrollableParams: Object\r\n\t\t//\t\tParameters for dojox/mobile/scrollable.init().\r\n\t\tscrollableParams: null,\r\n\r\n\t\t// allowNestedScrolls: Boolean\r\n\t\t//\t\tFlag to allow scrolling in nested containers, e.g. to allow ScrollableView in a SwapView.\r\n\t\tallowNestedScrolls: true,\r\n\r\n\t\t// appBars: Boolean\r\n\t\t//\t\tEnables the search for application-specific bars (header or footer).\r\n\t\tappBars: true, \r\n\r\n\t\tconstructor: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tCreates a new instance of the class.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\tthis.scrollableParams = {};\r\n\t\t},\r\n\r\n\t\tdestroy: function(){\r\n\t\t\tthis.cleanup();\r\n\t\t\tthis.inherited(arguments);\r\n\t\t},\r\n\r\n\t\tstartup: function(){\r\n\t\t\tif(this._started){ return; }\r\n\t\t\tif(this._fixedAppFooter){\r\n\t\t\t\tthis._fixedAppFooter = dom.byId(this._fixedAppFooter);\r\n\t\t\t}\r\n\t\t\tthis.findAppBars();\r\n\t\t\tvar node, params = this.scrollableParams;\r\n\t\t\tif(this.fixedHeader){\r\n\t\t\t\tnode = dom.byId(this.fixedHeader);\r\n\t\t\t\tif(node.parentNode == this.domNode){ // local footer\r\n\t\t\t\t\tthis.isLocalHeader = true;\r\n\t\t\t\t}\r\n\t\t\t\tparams.fixedHeaderHeight = node.offsetHeight;\r\n\t\t\t}\r\n\t\t\tif(this.fixedFooter){\r\n\t\t\t\tnode = dom.byId(this.fixedFooter);\r\n\t\t\t\tif(node.parentNode == this.domNode){ // local footer\r\n\t\t\t\t\tthis.isLocalFooter = true;\r\n\t\t\t\t\tnode.style.bottom = \"0px\";\r\n\t\t\t\t}\r\n\t\t\t\tparams.fixedFooterHeight = node.offsetHeight;\r\n\t\t\t}\r\n\t\t\tthis.scrollType = this.scrollType || config.mblScrollableScrollType || 0;\r\n\t\t\tthis.init(params);\r\n\t\t\tif(this.allowNestedScrolls){\r\n\t\t\t\tfor(var p = this.getParent(); p; p = p.getParent()){\r\n\t\t\t\t\tif(p && p.scrollableParams){\r\n\t\t\t\t\t\tthis.dirLock = true;\r\n\t\t\t\t\t\tp.dirLock = true;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// subscribe to afterResizeAll to scroll the focused input field into view\r\n\t\t\t// so as not to break layout on orientation changes while keyboard is shown (#14991)\r\n\t\t\tthis._resizeHandle = this.subscribe(\"/dojox/mobile/afterResizeAll\", function(){\r\n\t\t\t\tif(this.domNode.style.display === 'none'){ return; }\r\n\t\t\t\tvar elem = win.doc.activeElement;\r\n\t\t\t\tif(this.isFormElement(elem) && dom.isDescendant(elem, this.containerNode)){\r\n\t\t\t\t\tthis.scrollIntoView(elem);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tthis.inherited(arguments);\r\n\t\t},\r\n\r\n\t\tfindAppBars: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tSearch for application-specific header or footer.\r\n\t\t\tif(!this.appBars){ return; }\r\n\t\t\tvar i, len, c;\r\n\t\t\tfor(i = 0, len = win.body().childNodes.length; i < len; i++){\r\n\t\t\t\tc = win.body().childNodes[i];\r\n\t\t\t\tthis.checkFixedBar(c, false);\r\n\t\t\t}\r\n\t\t\tif(this.domNode.parentNode){\r\n\t\t\t\tfor(i = 0, len = this.domNode.parentNode.childNodes.length; i < len; i++){\r\n\t\t\t\t\tc = this.domNode.parentNode.childNodes[i];\r\n\t\t\t\t\tthis.checkFixedBar(c, false);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.fixedFooterHeight = this.fixedFooter ? this.fixedFooter.offsetHeight : 0;\r\n\t\t},\r\n\r\n\t\tcheckFixedBar: function(/*DomNode*/node, /*Boolean*/local){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tChecks if the given node is a fixed bar or not.\r\n\t\t\tif(node.nodeType === 1){\r\n\t\t\t\tvar fixed = node.getAttribute(\"fixed\") // TODO: Remove the non-HTML5-compliant attribute in 2.0\r\n\t\t\t\t\t|| node.getAttribute(\"data-mobile-fixed\")\r\n\t\t\t\t\t|| (registry.byNode(node) && registry.byNode(node).fixed);\r\n\t\t\t\tif(fixed === \"top\"){\r\n\t\t\t\t\tdomClass.add(node, \"mblFixedHeaderBar\");\r\n\t\t\t\t\tif(local){\r\n\t\t\t\t\t\tnode.style.top = \"0px\";\r\n\t\t\t\t\t\tthis.fixedHeader = node;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn fixed;\r\n\t\t\t\t}else if(fixed === \"bottom\"){\r\n\t\t\t\t\tdomClass.add(node, \"mblFixedBottomBar\");\r\n\t\t\t\t\tif(local){\r\n\t\t\t\t\t\tthis.fixedFooter = node;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tthis._fixedAppFooter = node;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn fixed;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\t});\r\n\treturn cls;\r\n});\r\n"]}