{"version":3,"sources":["mobile/bidi/ListItem.js"],"names":["define","declare","array","domConstruct","common","win","_applyAttributes","this","textDir","getParent","get","inherited","arguments","_applyTextDirToTextElements","_setRightTextAttr","text","templateString","rightTextNode","create","className","labelNode","rightText","innerHTML","_cv","enforceTextDirWithUcc","_setLabelAttr","removeUCCFromText","style","cssText","nEncount","forEach","domNode","childNodes","node","textNode","nodeType","nodeValue","MARK","RLE","LRE","currentNode","length","firstChild","search","doc","createTextNode","getTextDir","toLowerCase","place","nodeName","PDF","_setTextDirAttr"],"mappings":";;;;;;;AAAAA,QACC,qBACA,mBACA,qBACA,WACA,qBACE,SAASC,EAASC,EAAOC,EAAcC,EAAQC,GAKjD,OAAOJ,EAAQ,MASdK,iBAAkB,YACbC,KAAKC,SAAWD,KAAKE,aAAeF,KAAKE,YAAYC,IAAI,aAC5DH,KAAKC,QAAUD,KAAKE,YAAYC,IAAI,YAErCH,KAAKI,UAAWC,WACbL,KAAKC,SACJD,KAAKM,+BAIVC,kBAAmB,SAASC,GACvBR,KAAKS,gBAAmBT,KAAKU,gBAEhCV,KAAKU,cAAgBd,EAAae,OAAO,OAAQC,UAAU,wBAAyBZ,KAAKa,UAAW,WAElGb,KAAKU,gBACPV,KAAKc,UAAYN,EACjBR,KAAKU,cAAcK,UAAYf,KAAKgB,IAAMhB,KAAKgB,IAAIR,GAAQA,EACxDR,KAAKC,UACPD,KAAKU,cAAcK,UAAYlB,EAAOoB,sBAAsBjB,KAAKU,cAAcK,UAAWf,KAAKC,YAKlGiB,cAAe,SAAmBV,GACjCR,KAAKI,UAAU,gBAAgBC,WAC/BL,KAAKa,UAAUE,UAAYlB,EAAOoB,sBAAsBjB,KAAKa,UAAUE,UAAWf,KAAKC,UAGxFK,4BAA6B,WAG5B,GAAGN,KAAKa,UAAUE,UAIjB,OAHAf,KAAKa,UAAUE,UAAYlB,EAAOsB,kBAAkBnB,KAAKa,UAAUE,WACnEf,KAAKa,UAAUE,UAAYlB,EAAOoB,sBAAsBjB,KAAKa,UAAUE,UAAWf,KAAKC,cACvFD,KAAKa,UAAUO,MAAMC,QAAU,qBAGhC,IAAIC,EAAW,EACf3B,EAAM4B,QAAQvB,KAAKwB,QAAQC,WAAY,SAASC,GAC/C,IAAIC,EACJ,GAAgB,IAAbL,EAAe,CAEjB,GAAqB,IAAlBI,EAAKE,WAAmBF,EAAKG,YAAchC,EAAOiC,KAAKC,KAAOL,EAAKG,YAAchC,EAAOiC,KAAKE,KAG/F,OAFAN,EAAKG,UAAaH,EAAKG,YAAchC,EAAOiC,KAAKC,IAAOlC,EAAOiC,KAAKE,IAAMnC,EAAOiC,KAAKC,SACtFT,EAAW,GAGZ,IAAIW,EAAiC,IAAlBP,EAAKE,UAA6C,IAA3BF,EAAKD,WAAWS,OAAgBR,EAAKS,WAAaT,EAChE,IAAzBO,EAAYL,UAAkBK,EAAYJ,YAEC,GAA1CI,EAAYJ,UAAUO,OAAO,WAC/Bd,EAAW,EACXK,EAAW7B,EAAIuC,IAAIC,eAAyE,QAAzDtC,KAAKuC,WAAWN,EAAYJ,WAAWW,cAA2B3C,EAAOiC,KAAKC,IAAMlC,EAAOiC,KAAKE,KACnIpC,EAAa6C,MAAMd,EAAUD,EAAM,gBAKjB,IAAbJ,GAAkD,QAAhCI,EAAKgB,SAASF,gBACtClB,EAAW,EACXK,EAAW7B,EAAIuC,IAAIC,eAAezC,EAAOiC,KAAKa,KAC9C/C,EAAa6C,MAAMd,EAAUD,EAAM,YAEnC1B,OAGJ4C,gBAAiB,SAAS3C,GACtBA,GAAWD,KAAKC,UAAYA,IAC9BD,KAAKC,QAAUA,EACfD,KAAKM,8BACFN,KAAKU,gBACJV,KAAKU,cAAcK,UAAYlB,EAAOsB,kBAAkBnB,KAAKU,cAAcK,WAC3Ef,KAAKU,cAAcK,UAAYlB,EAAOoB,sBAAsBjB,KAAKU,cAAcK,UAAWf,KAAKC","file":"../../../mobile/bidi/ListItem.js","sourcesContent":["define([\r\n\t\"dojo/_base/declare\",\r\n\t\"dojo/_base/array\",\r\n\t\"dojo/dom-construct\",\r\n\t\"./common\",\r\n\t\"dojo/_base/window\"\r\n], function(declare, array, domConstruct, common, win){\r\n\r\n\t// module:\r\n\t//\t\tdojox/mobile/ListItem\r\n\r\n\treturn declare(null, {\r\n\t\t// summary:\r\n\t\t//\t\tSupport for control over text direction for mobile ListItem widget, using Unicode Control Characters to control text direction.\r\n\t\t// description:\r\n\t\t//\t\tImplementation for text direction support for Label and RightText.\r\n\t\t//\t\tText direction is also applied to ListItem's embedded nodes, containing text.\r\n\t\t//\t\tComplicated embedded nodes (like tables) are not supported.\r\n\t\t//\t\tThis class should not be used directly.\r\n\t\t//\t\tMobile ListItem widget loads this module when user sets \"has: {'dojo-bidi': true }\" in data-dojo-config.\r\n\t\t_applyAttributes: function(){\r\n\t\t\tif(!this.textDir && this.getParent() && this.getParent().get(\"textDir\")){\r\n\t\t\t\tthis.textDir = this.getParent().get(\"textDir\");\r\n\t\t\t}\r\n\t\t\tthis.inherited( arguments);\r\n\t\t\tif(this.textDir){\r\n\t\t\t    this._applyTextDirToTextElements();\r\n\t\t\t}    \r\n\t\t},\r\n\r\n\t\t_setRightTextAttr: function(text){\r\n\t\t\tif(!this.templateString && !this.rightTextNode){\r\n\t\t\t\t// When using a template, let the template create the element.\r\n\t\t\t\tthis.rightTextNode = domConstruct.create(\"div\", {className:\"mblListItemRightText\"}, this.labelNode, \"before\");\r\n\t\t\t}\r\n\t\t\tif(this.rightTextNode){ // when using a template it may not contain a rightTextNode \r\n\t\t\t\tthis.rightText = text;\r\n\t\t\t\tthis.rightTextNode.innerHTML = this._cv ? this._cv(text) : text;\r\n\t\t\t\tif(this.textDir){\r\n\t\t\t\t\tthis.rightTextNode.innerHTML = common.enforceTextDirWithUcc(this.rightTextNode.innerHTML, this.textDir);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_setLabelAttr: function(/*String*/text){\r\n\t\t\tthis.inherited(\"_setLabelAttr\",arguments);\r\n\t\t\tthis.labelNode.innerHTML = common.enforceTextDirWithUcc(this.labelNode.innerHTML, this.textDir);\r\n\t\t},\r\n\r\n\t\t_applyTextDirToTextElements: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tWrap child text nodes in directional UCC marks\r\n\t\t\tif(this.labelNode.innerHTML){\r\n\t\t\t\tthis.labelNode.innerHTML = common.removeUCCFromText(this.labelNode.innerHTML);\r\n\t\t\t\tthis.labelNode.innerHTML = common.enforceTextDirWithUcc(this.labelNode.innerHTML, this.textDir);\r\n\t\t\t\tthis.labelNode.style.cssText = \"text-align: start\";\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar nEncount = 0;\r\n\t\t\tarray.forEach(this.domNode.childNodes, function(node){\r\n\t\t\t\tvar textNode;\r\n\t\t\t\tif(nEncount === 0){\r\n\t\t\t\t\t/* Replace content of directional text node, if found */\r\n\t\t\t\t\tif(node.nodeType === 3 && (node.nodeValue === common.MARK.RLE || node.nodeValue === common.MARK.LRE)){\r\n\t\t\t\t\t\tnode.nodeValue = (node.nodeValue === common.MARK.RLE) ? common.MARK.LRE : common.MARK.RLE;\r\n\t\t\t\t\t\tnEncount = 2;\r\n\t\t\t\t\t\treturn;      \r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar currentNode = (node.nodeType === 1 && node.childNodes.length === 1) ? node.firstChild : node;\r\n\t\t\t\t\tif(currentNode.nodeType === 3 && currentNode.nodeValue){\r\n\t\t\t\t\t\t/* Insert directional text node */\r\n\t\t\t\t\t\tif(currentNode.nodeValue.search(/[.\\S]/) != -1){\r\n\t\t\t\t\t\t\tnEncount = 1;\r\n\t\t\t\t\t\t\ttextNode = win.doc.createTextNode((this.getTextDir(currentNode.nodeValue).toLowerCase() === 'rtl') ? common.MARK.RLE : common.MARK.LRE);    \r\n\t\t\t\t\t\t\tdomConstruct.place(textNode, node, \"before\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t/* Insert PDF text node, prevent further processing */\r\n\t\t\t\telse if(nEncount === 1 && node.nodeName.toLowerCase() === \"div\"){\r\n\t\t\t\t\t\tnEncount = 2;\r\n\t\t\t\t\t\ttextNode = win.doc.createTextNode(common.MARK.PDF);\r\n\t\t\t\t\t\tdomConstruct.place(textNode, node, \"before\");\r\n\t\t\t\t}\r\n\t\t\t}, this);\r\n\t\t},\r\n\r\n\t\t_setTextDirAttr: function(textDir){\r\n\t\t\tif(textDir && this.textDir !== textDir){\r\n\t\t\t\tthis.textDir = textDir;\r\n\t\t\t\tthis._applyTextDirToTextElements();\r\n\t\t\t\tif(this.rightTextNode){\r\n\t\t\t\t    this.rightTextNode.innerHTML = common.removeUCCFromText(this.rightTextNode.innerHTML);\r\n\t\t\t\t    this.rightTextNode.innerHTML = common.enforceTextDirWithUcc(this.rightTextNode.innerHTML, this.textDir);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n});\r\n"]}