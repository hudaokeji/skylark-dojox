{"version":3,"sources":["mobile/tests/imageControlsApp/app/assistants/flickr-search-text-assistant.js"],"names":["dojo","require","declare","dojox","mobile","app","SceneAssistant","setup","this","controller","parse","apiKey","listWidget","dijit","byId","textWidget","set","_this","search","hitch","handleGroupResults","connect","value","length","timer","setTimeout","item","index","node","console","log","arguments","stageController","pushScene","mixin","type","activate","searchType","sceneHeader","setLabel","focus","clearTimeout","searchText","trim","io","script","get","url","content","api_key","format","text","perPage","jsonp","addBoth","res","groups","group","i","label","name"],"mappings":";;;;;;;AAAAA,KAAKC,QAAQ,mCAEbD,KAAKE,QAAQ,4BAA6BC,MAAMC,OAAOC,IAAIC,gBAE1DC,MAAO,WAGNC,KAAKC,WAAWC,QAIhBF,KAAKG,OAAS,mCAEdH,KAAKI,WAAaC,MAAMC,KAAK,cAC7BN,KAAKO,WAAaF,MAAMC,KAAK,mBAE7BN,KAAKI,WAAWI,IAAI,YAEpB,IAAIC,EAAQT,KAEZA,KAAKU,OAASlB,KAAKmB,MAAMX,KAAMA,KAAKU,QACpCV,KAAKY,mBAAqBpB,KAAKmB,MAAMX,KAAMA,KAAKY,oBAKhDZ,KAAKa,QAAQb,KAAKO,WAAY,WAAY,SAASO,GAG9CA,GAAyB,GAAhBA,EAAMC,OAKfN,EAAMO,QACTP,EAAMO,MAAQC,WAAWR,EAAMC,OAAQ,MALvCD,EAAML,WAAWI,IAAI,cASvBR,KAAKa,QAAQb,KAAKI,WAAY,WAAY,SAASc,EAAMC,EAAOC,GAC/DC,QAAQC,IAAI,SAAUC,WAEtBd,EAAMR,WAAWuB,gBAAgBC,UAAU,oBAC1CjC,KAAKkC,OAAOC,KAAM,SAAUT,OAI/BU,SAAU,SAASC,GAKlB,GAHA7B,KAAK6B,WAAaA,EAGfA,EAAW,CACb,IAAIC,EAAczB,MAAMC,KAAK,gBAC7B,OAAOuB,GACN,IAAK,QACJC,EAAYC,SAAS,wBACrB,MACD,IAAK,OACJD,EAAYC,SAAS,wBACrB,MACD,IAAK,MACJD,EAAYC,SAAS,uBAKxB1B,MAAMC,KAAK,mBAAmB0B,SAG/BtB,OAAQ,WAIFV,KAAKgB,QACTiB,aAAajC,KAAKgB,OAClBhB,KAAKgB,MAAQ,MAGd,IAAIkB,EAAalC,KAAKO,WAAWC,IAAI,SAErC,IAAI0B,GAAc1C,KAAK2C,KAAKD,GAAYnB,OAAS,EAIhD,OAHAf,KAAKI,WAAWI,IAAI,iBAEpBa,QAAQC,IAAI,iBAME9B,KAAK4C,GAAGC,OAAOC,KAC7BC,IAHS,mEAITC,SACCC,QAASzC,KAAKG,OACduC,OAAQ,OACRC,KAAMT,EACNU,QAAS,IAEVC,MAAO,iBAECC,QAAQ9C,KAAKY,qBAGvBA,mBAAoB,SAASmC,GAC5B,IAAIC,EACJ,GAAGD,GAAOA,EAAIC,QAAUD,EAAIC,OAAOC,MAAM,CACxCD,EAASD,EAAIC,OAAOC,MAEpB,IAAI,IAAIC,EAAI,EAAGA,EAAIF,EAAOjC,OAAQmC,IACjCF,EAAOE,GAAGC,MAAQH,EAAOE,GAAGE,UAG7BJ,KAEDhD,KAAKI,WAAWI,IAAI,QAASwC","file":"../../../../../../mobile/tests/imageControlsApp/app/assistants/flickr-search-text-assistant.js","sourcesContent":["dojo.require(\"dojox.mobile.app.SceneAssistant\");\r\n\r\ndojo.declare(\"FlickrSearchTextAssistant\", dojox.mobile.app.SceneAssistant, {\r\n  \r\n\tsetup: function(){\r\n    \r\n\t\t// Instantiate widgets in the template HTML.\r\n\t\tthis.controller.parse();\r\n\t\t\r\n\t\t// This api key should not be reused. You should get your own\r\n\t\t// free api key from Flickr.\r\n\t\tthis.apiKey = \"8c6803164dbc395fb7131c9d54843627\";\r\n\t\t\r\n\t\tthis.listWidget = dijit.byId(\"searchList\");\r\n\t\tthis.textWidget = dijit.byId(\"searchTextInput\");\r\n\t\t\r\n\t\tthis.listWidget.set(\"items\", []);\r\n\t\t\r\n\t\tvar _this = this;\r\n\t\t\r\n\t\tthis.search = dojo.hitch(this, this.search);\r\n\t\tthis.handleGroupResults = dojo.hitch(this, this.handleGroupResults);\r\n\t\t\r\n\t\t// Listen for changes to the text widget.\r\n\t\t// To ensure that onChange is called on every letter change,\r\n\t\t// intermediateChanges is set to true on the widget\r\n\t\tthis.connect(this.textWidget, \"onChange\", function(value){\r\n\t\t//\t\tconsole.log(\"search value = \", value);\r\n\t\t\t\r\n\t\t\tif(!value || value.length == 0){\r\n\t\t\t\t_this.listWidget.set(\"items\", []);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(!_this.timer){\r\n\t\t\t\t_this.timer = setTimeout(_this.search, 300);\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\tthis.connect(this.listWidget, \"onSelect\", function(item, index, node){\r\n\t\t\tconsole.log(\"select\", arguments);\r\n\t\t\t\r\n\t\t\t_this.controller.stageController.pushScene(\"flickr-image-view\",\r\n\t\t\t\tdojo.mixin({type: \"group\"}, item));\r\n\t\t});\r\n\t},\r\n  \r\n\tactivate: function(searchType){\r\n    \r\n\t\tthis.searchType = searchType;\r\n\t\t\r\n\t\t// Set the title of the screen based on the type of the search\r\n\t\tif(searchType){\r\n\t\t\tvar sceneHeader = dijit.byId(\"searchHeader\");\r\n\t\t\tswitch(searchType){\r\n\t\t\t\tcase \"group\":\r\n\t\t\t\t\tsceneHeader.setLabel(\"Search Flickr Groups\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"user\":\r\n\t\t\t\t\tsceneHeader.setLabel(\"Search Flickr People\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"tag\":\r\n\t\t\t\t\tsceneHeader.setLabel(\"Search Flickr Tags\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\t// Focus in the search text input\r\n\t\tdijit.byId(\"searchTextInput\").focus();\r\n\t},\r\n  \r\n\tsearch: function(){\r\n\t  \t// summary:\r\n\t\t//\t\tPerform a search. Switch between group, user and tag search\r\n\t\t\r\n\t  \tif(this.timer){\r\n\t\t\tclearTimeout(this.timer);\r\n\t\t\tthis.timer = null;\r\n\t\t}\r\n\t\t\r\n\t\tvar searchText = this.textWidget.set(\"value\");\r\n\t\t\r\n\t\tif(!searchText || dojo.trim(searchText).length < 1){\r\n\t\t\tthis.listWidget.set(\"items\", []);\r\n\t\t\t\r\n\t\t\tconsole.log(\"NOT SEARCHING\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tvar url = \"http://api.flickr.com/services/rest/?method=flickr.groups.search\";\r\n\t\t\r\n\t\tvar deferred = dojo.io.script.get({\r\n\t\t\turl: url,\r\n\t\t\tcontent: {\r\n\t\t\t\tapi_key: this.apiKey,\r\n\t\t\t\tformat: \"json\",\r\n\t\t\t\ttext: searchText,\r\n\t\t\t\tperPage: 10\r\n\t\t\t},\r\n\t\t\tjsonp: \"jsoncallback\"\r\n\t\t});\r\n\t\tdeferred.addBoth(this.handleGroupResults);\r\n\t},\r\n  \r\n\thandleGroupResults: function(res){\r\n\t\tvar groups;\r\n\t\tif(res && res.groups && res.groups.group){\r\n\t\t\tgroups = res.groups.group;\r\n\t\t\t\r\n\t\t\tfor(var i = 0; i < groups.length; i++){\r\n\t\t\t\tgroups[i].label = groups[i].name;\r\n\t\t\t}\r\n\t\t}else{\r\n\t\t\tgroups = [];\r\n\t\t}\r\n\t\tthis.listWidget.set(\"items\", groups);\r\n\t}\r\n  \r\n});"]}