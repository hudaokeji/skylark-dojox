{"version":3,"sources":["mobile/tests/doh/roundrectstorelist/StoreList.js"],"names":["require","parser","Deferred","Cache","JsonRest","Memory","Observable","ready","registry","runner","EdgeToEdgeStoreList","RoundRectStoreList","DataList","testName","IsEdgeToEdgeList","store1","idProperty","target","store2","data","label","moveTo","__counter","store","switchTo","window","byId","setStore","add1","add","icon","delete1","remove","modif_counter","modify1","put","rightText","register","name","timeout","runTest","d","setTimeout","getTestCallback","demoWidget","assertTrue","customProp","assertEqual","domNode","className","iconNode","src","search","rightIconNode","labelNode","innerHTML","childNodes","doh","get","listWidget","onAdd","undefined","onUpdate","item","insertedInto","this","getChildren","length","addChild","createListItem","set","run"],"mappings":"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","file":"../../../../../mobile/tests/doh/roundrectstorelist/StoreList.js","sourcesContent":["require([\r\n\t\"dojo/parser\",\r\n\t\"dojo/_base/Deferred\",\r\n\t\"dojo/store/Cache\",\r\n\t\"dojo/store/JsonRest\",\r\n\t\"dojo/store/Memory\",\r\n\t\"dojo/store/Observable\",\r\n\t\"dojo/ready\", // dojo.ready\r\n\t\"dijit/registry\",\r\n\t\"doh/runner\",\t//doh functions\r\n\t\"dojox/mobile/EdgeToEdgeStoreList\",\r\n\t\"dojox/mobile/RoundRectStoreList\",\r\n\t\"dojox/mobile/tests/doh/CustomListItem\",\r\n\t/*\"dojox/mobile/parser\",*/\r\n\t\"dojox/mobile\",\r\n\t\"dojox/mobile/compat\"\r\n], function(parser, Deferred, Cache, JsonRest, Memory, Observable, ready, registry, runner, EdgeToEdgeStoreList, RoundRectStoreList){\r\n\r\n\tvar CLASS_NAME;\r\n\tvar DataList;\r\n\tvar testName;\r\n\r\n\tif(IsEdgeToEdgeList){\r\n\t\tCLASS_NAME = \"mblEdgeToEdgeList\";\r\n\t\tDataList = EdgeToEdgeStoreList;\r\n\t\ttestName = \"dojox.mobile.test.doh.EdgeToEdgeStoreList\";\r\n\t}else{\r\n\t\tCLASS_NAME = \"mblRoundRectList\";\r\n\t\tDataList = RoundRectStoreList;\r\n\t\ttestName = \"dojox.mobile.test.doh.RoundRectStoreList\";\r\n\t}\r\n\r\n\tvar static_data2 = [\r\n\t\t{label: \"Apple\", \tmoveTo: \"dummy\"},\r\n\t\t{label: \"Banana\", \tmoveTo: \"dummy\"},\r\n\t\t{label: \"Cherry\", \tmoveTo: \"dummy\"},\r\n\t\t{label: \"Grape\", \tmoveTo: \"dummy\"},\r\n\t\t{label: \"Kiwi\", \tmoveTo: \"dummy\"},\r\n\t\t{label: \"Lemon\", \tmoveTo: \"dummy\"},\r\n\t\t{label: \"Melon\", \tmoveTo: \"dummy\"},\r\n\t\t{label: \"Orange\", \tmoveTo: \"dummy\"},\r\n\t\t{label: \"Peach\", \tmoveTo: \"dummy\"}\r\n\t];\r\n\tvar url = \"settings2.json\";\r\n\tstore1 = new JsonRest({idProperty:\"label\", target: url});\r\n\tstore2 = Observable(new Memory({idProperty:\"label\", data: static_data2}));\r\n\tstore1.__counter = store2.__counter = 1;\r\n\tstore = store1;\r\n\r\n\t// switch to the selected store\r\n\tswitchTo = function(store){\r\n\t\twindow.store = store;\r\n\t\tregistry.byId(\"list\").setStore(store);\r\n\t};\r\n\t// add a new item\r\n\tadd1 = function(){\r\n\t\tstore.add({\r\n\t\t\tlabel: \"New Item \"+(store.__counter++),\r\n\t\t\ticon: \"../../images/i-icon-1.png\",\r\n\t\t\tmoveTo: \"dummy\"\r\n\t\t});\r\n\t};\r\n\t// delete the added item\r\n\tdelete1 = function(){\r\n\t\tif(store.__counter > 1){\r\n\t\t\tstore.remove(\"New Item \"+(--store.__counter));\r\n\t\t}\r\n\t};\r\n\t// modify the added item\r\n\tvar modif_counter = 0;\r\n\tmodify1 = function(){\r\n\t\tif(store.__counter > 1){\r\n\t\t\tstore.put({\r\n\t\t\t\tlabel: \"New Item \"+(store.__counter-1),\r\n\t\t\t\trightText: ++modif_counter + \" changes\"\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\tready(function(){\r\n\t\trunner.register(testName, [\r\n\t\t\t{\r\n\t\t\t\tname: DataList + \" Verification\",\r\n\t\t\t\ttimeout: 4000,\r\n\t\t\t\trunTest: function(){\r\n\t\t\t\t\tvar d = new runner.Deferred();\r\n\t\t\t\t\tsetTimeout(d.getTestCallback(function(){\r\n\t\t\t\t\t\tvar demoWidget = registry.byId(\"dojox_mobile_ListItem_0\");\r\n\t\t\t\t\t\t// check whether we correctly constructed a custom item\r\n\t\t\t\t\t\trunner.assertTrue(demoWidget.customProp);\r\n\t\t\t\t\t\trunner.assertEqual('mblListItem', demoWidget.domNode.className);\r\n\t\t\t\t\t\trunner.assertEqual('mblImageIcon mblListItemIcon', demoWidget.iconNode.className);\r\n\t\t\t\t\t\trunner.assertTrue(demoWidget.iconNode.src.search(/i-icon-1.png/i) != -1);\r\n\t\t\t\t\t\trunner.assertEqual('mblListItemRightIcon', demoWidget.rightIconNode.className);\r\n\t\t\t\t\t\trunner.assertEqual('mblListItemLabel', demoWidget.labelNode.className);\r\n\t\t\t\t\t\trunner.assertEqual('Wi-Fi', demoWidget.labelNode.innerHTML);\r\n\t\t\t\t\t\trunner.assertEqual('mblDomButtonArrow mblDomButton', demoWidget.rightIconNode.childNodes[0].className);\r\n\r\n\t\t\t\t\t\tdemoWidget = registry.byId(\"dojox_mobile_ListItem_3\");\r\n\t\t\t\t\t\trunner.assertEqual('mblListItem mblListItemSelected', demoWidget.domNode.className);\r\n\t\t\t\t\t\trunner.assertEqual('mblImageIcon mblListItemIcon', demoWidget.iconNode.className);\r\n\t\t\t\t\t\trunner.assertTrue(demoWidget.iconNode.src.search(/i-icon-4.png/i) != -1);\r\n\t\t\t\t\t\trunner.assertEqual('mblListItemRightIcon', demoWidget.rightIconNode.className);\r\n\t\t\t\t\t\trunner.assertEqual('mblListItemLabel', demoWidget.labelNode.className);\r\n\t\t\t\t\t\trunner.assertEqual('General', demoWidget.labelNode.innerHTML);\r\n\t\t\t\t\t\trunner.assertEqual('mblDomButtonArrow mblDomButton', demoWidget.rightIconNode.childNodes[0].className);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}),500);\r\n\t\t\t\t\treturn d;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tname: DataList + \" Verification2\",\r\n\t\t\t\ttimeout: 10000,\r\n\t\t\t\trunTest: function(){\r\n\t\t\t\t\tvar d = new doh.Deferred();\r\n\t\t\t\t\tsetTimeout(d.getTestCallback(function(){\r\n\r\n\t\t\t\t\t\tswitchTo(store2);\r\n\t\t\t\t\t\tvar demoWidget = registry.byId(\"dojox_mobile_ListItem_13\");\r\n\t\t\t\t\t\trunner.assertEqual('mblListItem', demoWidget.domNode.className);\r\n\t\t\t\t\t\trunner.assertEqual(null, demoWidget.iconNode);\r\n\t\t\t\t\t\trunner.assertEqual('mblListItemLabel', demoWidget.labelNode.className);\r\n\t\t\t\t\t\trunner.assertEqual('Grape', demoWidget.labelNode.innerHTML);\r\n\t\t\t\t\t\trunner.assertEqual('mblDomButtonArrow mblDomButton', demoWidget.rightIconNode.childNodes[0].className);\r\n\r\n\r\n\t\t\t\t\t}),2500);\r\n\t\t\t\t\treturn d;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tname: DataList + \" Verification3\",\r\n\t\t\t\ttimeout: 10000,\r\n\t\t\t\trunTest: function(){\r\n\t\t\t\t\tvar d = new runner.Deferred();\r\n\t\t\t\t\tsetTimeout(d.getTestCallback(function(){\r\n\r\n\t\t\t\t\t\tadd1();\r\n\t\t\t\t\t\tadd1();\r\n\t\t\t\t\t\tadd1();\r\n\t\t\t\t\t\tvar demoWidget = registry.byId(\"dojox_mobile_ListItem_19\");\r\n\t\t\t\t\t\trunner.assertEqual('mblListItem', demoWidget.domNode.className);\r\n\t\t\t\t\t\trunner.assertEqual('mblImageIcon mblListItemIcon', demoWidget.iconNode.className);\r\n\t\t\t\t\t\trunner.assertEqual('mblListItemLabel', demoWidget.labelNode.className);\r\n\t\t\t\t\t\trunner.assertEqual('New Item 1', demoWidget.labelNode.innerHTML);\r\n\t\t\t\t\t\trunner.assertEqual('mblDomButtonArrow mblDomButton', demoWidget.rightIconNode.childNodes[0].className);\r\n\r\n\t\t\t\t\t\tdelete1();\r\n\t\t\t\t\t\tdemoWidget = registry.byId(\"dojox_mobile_ListItem_21\");\r\n\t\t\t\t\t\trunner.assertTrue(!demoWidget);\r\n\r\n\t\t\t\t\t\tdemoWidget = registry.byId(\"dojox_mobile_ListItem_20\");\r\n\t\t\t\t\t\trunner.assertEqual('mblListItem', demoWidget.domNode.className);\r\n\t\t\t\t\t\trunner.assertEqual('mblImageIcon mblListItemIcon', demoWidget.iconNode.className);\r\n\t\t\t\t\t\trunner.assertEqual('mblListItemLabel', demoWidget.labelNode.className);\r\n\t\t\t\t\t\trunner.assertEqual('New Item 2', demoWidget.labelNode.innerHTML);\r\n\t\t\t\t\t\trunner.assertEqual('mblDomButtonArrow mblDomButton', demoWidget.rightIconNode.childNodes[0].className);\r\n\r\n\t\t\t\t\t\tmodify1();\r\n\t\t\t\t\t\trunner.assertEqual(modif_counter+' changes', demoWidget.get(\"rightText\"), \"modify store item\");\r\n\t\t\t\t\t}),1500);\r\n\t\t\t\t\treturn d;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tname: DataList + \" Verification4 (1.8 compat mode)\",\r\n\t\t\t\ttimeout: 10000,\r\n\t\t\t\trunTest: function(){\r\n\t\t\t\t\tvar d = new runner.Deferred();\r\n\t\t\t\t\tsetTimeout(d.getTestCallback(function(){\r\n\r\n\t\t\t\t\t\t// Check compatibility with old-style widgets that define only an onUpdate method and no onAdd method\r\n\t\t\t\t\t\t// (like in Dojo Mobile 1.8). In that case onUpdate is called instead of onAdd, and put() is not handled.\r\n\t\t\t\t\t\tvar listWidget = registry.byId(\"list\");\r\n\t\t\t\t\t\tlistWidget.onAdd = undefined;\r\n\t\t\t\t\t\tlistWidget.onUpdate = function(/*Object*/item, /*Number*/insertedInto){\r\n\t\t\t\t\t\t\t// summary:\r\n\t\t\t\t\t\t\t//\t\tAdds a new item or updates an existing item.\r\n\t\t\t\t\t\t\tif(insertedInto === this.getChildren().length){\r\n\t\t\t\t\t\t\t\tthis.addChild(this.createListItem(item)); // add a new ListItem\r\n\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\tthis.getChildren()[insertedInto].set(item); // update the existing ListItem\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\tadd1();\r\n\t\t\t\t\t\tadd1();\r\n\t\t\t\t\t\tadd1();\r\n\t\t\t\t\t\tvar demoWidget = registry.byId(\"dojox_mobile_ListItem_22\");\r\n\t\t\t\t\t\trunner.assertEqual('mblListItem', demoWidget.domNode.className);\r\n\t\t\t\t\t\trunner.assertEqual('mblImageIcon mblListItemIcon', demoWidget.iconNode.className);\r\n\t\t\t\t\t\trunner.assertEqual('mblListItemLabel', demoWidget.labelNode.className);\r\n\t\t\t\t\t\trunner.assertEqual('New Item 3', demoWidget.labelNode.innerHTML);\r\n\t\t\t\t\t\trunner.assertEqual('mblDomButtonArrow mblDomButton', demoWidget.rightIconNode.childNodes[0].className);\r\n\r\n\t\t\t\t\t\tdelete1();\r\n\t\t\t\t\t\tdemoWidget = registry.byId(\"dojox_mobile_ListItem_24\");\r\n\t\t\t\t\t\trunner.assertTrue(!demoWidget);\r\n\r\n\t\t\t\t\t\tdemoWidget = registry.byId(\"dojox_mobile_ListItem_23\");\r\n\t\t\t\t\t\trunner.assertEqual('mblListItem', demoWidget.domNode.className);\r\n\t\t\t\t\t\trunner.assertEqual('mblImageIcon mblListItemIcon', demoWidget.iconNode.className);\r\n\t\t\t\t\t\trunner.assertEqual('mblListItemLabel', demoWidget.labelNode.className);\r\n\t\t\t\t\t\trunner.assertEqual('New Item 4', demoWidget.labelNode.innerHTML);\r\n\t\t\t\t\t\trunner.assertEqual('mblDomButtonArrow mblDomButton', demoWidget.rightIconNode.childNodes[0].className);\r\n\r\n\t\t\t\t\t\tmodify1();\r\n\t\t\t\t\t\trunner.assertEqual(\"\", demoWidget.get(\"rightText\"), \"modify store item (noop in compat mode)\");\r\n\t\t\t\t\t}),1500);\r\n\t\t\t\t\treturn d;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t]);\r\n\t\trunner.run();\r\n\t});\r\n});\r\n"]}