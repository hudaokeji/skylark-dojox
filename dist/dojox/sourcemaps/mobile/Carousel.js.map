{"version":3,"sources":["mobile/Carousel.js"],"names":["define","array","connect","declare","event","lang","has","domClass","domConstruct","domStyle","registry","Contained","Container","WidgetBase","lazyLoadUtils","CarouselItem","PageIndicator","SwapView","require","BidiCarousel","messages","Carousel","numVisible","itemWidth","title","pageIndicator","navButton","height","selectable","baseClass","buildRendering","i","len","this","containerNode","create","className","id","inherited","arguments","srcNodeRef","childNodes","length","appendChild","firstChild","headerNode","domNode","btnContainerNode","set","prevBtnNode","innerHTML","aria-controls","nextBtnNode","_prevHandle","_nextHandle","piw","titleNode","subscribe","_dragstartHandle","stop","selectedItemIndex","items","startup","_started","h","offsetParent","offsetHeight","style","store","setStore","Error","query","queryOptions","resizeItems","currentView","filter","getChildren","view","isVisible","node","item","idx","m","forEach","_instantiated","ch","nodeType","width","margin","add","refId","reset","resize","num","Math","floor","offsetWidth","getIndexByItemWidget","selectedItem","onComplete","select","fillPages","child","j","s","type","mixins","props","getValue","p","v","undefined","toUrl","destroyRecursive","nPages","ceil","pg","w","lazy","addChild","show","hide","children","to","instantiateView","onError","onUpdate","onDelete","onSet","attribute","oldValue","newValue","onNew","newItem","parentInfo","onStoreClose","request","getParentView","getEnclosingWidget","getParent","indexOf","getItemWidgetByIndex","index","onPrevBtnClick","goTo","onNextBtnClick","_onClick","e","onClick","keyCode","target","publish","itemWidget","remove","isHidden","get","visibility","display","instantiateLazyWidgets","root","handleViewChanged","nextView","previousView","_setTitleAttr","_cv","_set","ChildSwapViewProperties","extend"],"mappings":"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","file":"../../mobile/Carousel.js","sourcesContent":["define([\r\n\t\"dojo/_base/array\",\r\n\t\"dojo/_base/connect\",\r\n\t\"dojo/_base/declare\",\r\n\t\"dojo/_base/event\",\r\n\t\"dojo/_base/lang\",\r\n\t\"dojo/sniff\",\r\n\t\"dojo/dom-class\",\r\n\t\"dojo/dom-construct\",\r\n\t\"dojo/dom-style\",\r\n\t\"dijit/registry\",\r\n\t\"dijit/_Contained\",\r\n\t\"dijit/_Container\",\r\n\t\"dijit/_WidgetBase\",\r\n\t\"./lazyLoadUtils\",\r\n\t\"./CarouselItem\",\r\n\t\"./PageIndicator\",\r\n\t\"./SwapView\",\r\n\t\"require\",\r\n\t\"dojo/has!dojo-bidi?dojox/mobile/bidi/Carousel\",\r\n\t\"dojo/i18n!dojox/mobile/nls/messages\"\r\n], function(array, connect, declare, event, lang, has, domClass, domConstruct, domStyle, registry, Contained, Container, WidgetBase, lazyLoadUtils, CarouselItem, PageIndicator, SwapView, require, BidiCarousel, messages){\r\n\r\n\t// module:\r\n\t//\t\tdojox/mobile/Carousel\r\n\r\n\tvar Carousel = declare(has(\"dojo-bidi\") ? \"dojox.mobile.NonBidiCarousel\" : \"dojox.mobile.Carousel\", [WidgetBase, Container, Contained], {\r\n\t\t// summary:\r\n\t\t//\t\tA carousel widget that manages a list of images.\r\n\t\t// description:\r\n\t\t//\t\tThe carousel widget manages a list of images that can be\r\n\t\t//\t\tdisplayed horizontally, and allows the user to scroll through\r\n\t\t//\t\tthe list and select a single item.\r\n\t\t//\r\n\t\t//\t\tThis widget itself has no data store support, but there are two\r\n\t\t//\t\tsubclasses, dojox/mobile/DataCarousel and dojox/mobile/StoreCarousel,\r\n\t\t//\t\tavailable for generating the contents from a data store.\r\n\t\t//\t\tTo feed data into a Carousel through a dojo/data, use DataCarousel.\r\n\t\t//\t\tTo feed data into a Carousel through a dojo/store, use StoreCarousel.\r\n\t\t//\r\n\t\t//\t\tThe Carousel widget loads and instantiates its item contents in\r\n\t\t//\t\ta lazy manner. For example, if the number of visible items\r\n\t\t//\t\t(see the property numVisible) is 2, the widget creates 4 items, 2 for the\r\n\t\t//\t\tinitial pane and 2 for the next page, at startup time. If you\r\n\t\t//\t\tswipe the page to open the second page, the widget creates 2 more\r\n\t\t//\t\titems for the third page. If the item to create is a dojo widget,\r\n\t\t//\t\tits module is dynamically loaded automatically before instantiation.\r\n\r\n\t\t// numVisible: Number\r\n\t\t//\t\tThe number of visible items.\r\n\t\tnumVisible: 2,\r\n\r\n\t\t// itemWidth: Number\r\n\t\t//\t\tThe number of visible items (=numVisible) is determined by\r\n\t\t//\t\t(carousel_width / itemWidth).\r\n\t\t//\t\tIf itemWidth is specified, numVisible is automatically calculated.\r\n\t\t//\t\tIf resize() is called, numVisible is recalculated and the layout\r\n\t\t//\t\tis changed accordingly.\r\n\t\titemWidth: 0,\r\n\r\n\t\t// title: String\r\n\t\t//\t\tA title of the carousel to be displayed on the title bar.\r\n\t\ttitle: \"\",\r\n\r\n\t\t// pageIndicator: [const] Boolean\r\n\t\t//\t\tIf true, a page indicator, a series of small dots that indicate\r\n\t\t//\t\tthe current page, is displayed on the title bar.\r\n\t\t//\t\tNote that changing the value of the property after the widget\r\n\t\t//\t\tcreation has no effect.\r\n\t\tpageIndicator: true,\r\n\r\n\t\t// navButton: [const] Boolean\r\n\t\t//\t\tIf true, navigation buttons are displayed on the title bar.\r\n\t\t//\t\tNote that changing the value of the property after the widget\r\n\t\t//\t\tcreation has no effect.\r\n\t\tnavButton: false,\r\n\r\n\t\t// height: [const] String\r\n\t\t//\t\tExplicitly specified height of the widget (ex. \"300px\"). If\r\n\t\t//\t\t\"inherit\" is specified, the height is inherited from its offset\r\n\t\t//\t\tparent.\r\n\t\t//\t\tNote that changing the value of the property after the widget\r\n\t\t//\t\tcreation has no effect.\r\n\t\theight: \"\",\r\n\r\n\t\t// selectable: Boolean\r\n\t\t//\t\tIf true, an item can be selected by clicking it.\r\n\t\tselectable: true,\r\n\r\n\t\t/* internal properties */\t\r\n\t\t\r\n\t\t// baseClass: String\r\n\t\t//\t\tThe name of the CSS class of this widget.\r\n\t\tbaseClass: \"mblCarousel\",\r\n\r\n\t\tbuildRendering: function(){\r\n\t\t\tthis.containerNode = domConstruct.create(\"div\", {className: \"mblCarouselPages\", id: this.id + \"_pages\"});\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\tvar i, len;\r\n\t\t\tif(this.srcNodeRef){\r\n\t\t\t\t// reparent\r\n\t\t\t\tfor(i = 0, len = this.srcNodeRef.childNodes.length; i < len; i++){\r\n\t\t\t\t\tthis.containerNode.appendChild(this.srcNodeRef.firstChild);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.headerNode = domConstruct.create(\"div\", {className: \"mblCarouselHeaderBar\"}, this.domNode);\r\n\r\n\t\t\tif(this.navButton){\r\n\t\t\t\tthis.btnContainerNode = domConstruct.create(\"div\", {\r\n\t\t\t\t\tclassName: \"mblCarouselBtnContainer\"\r\n\t\t\t\t}, this.headerNode);\r\n\t\t\t\tdomStyle.set(this.btnContainerNode, \"float\", \"right\"); // workaround for webkit rendering problem\r\n\t\t\t\tthis.prevBtnNode = domConstruct.create(\"button\", {\r\n\t\t\t\t\tclassName: \"mblCarouselBtn\",\r\n\t\t\t\t\ttitle: messages[\"CarouselPrevious\"],\r\n\t\t\t\t\tinnerHTML: \"&lt;\",\r\n\t\t\t\t\t\"aria-controls\": this.containerNode.id\r\n\t\t\t\t}, this.btnContainerNode);\r\n\t\t\t\tthis.nextBtnNode = domConstruct.create(\"button\", {\r\n\t\t\t\t\tclassName: \"mblCarouselBtn\",\r\n\t\t\t\t\ttitle: messages[\"CarouselNext\"],\r\n\t\t\t\t\tinnerHTML: \"&gt;\",\r\n\t\t\t\t\t\"aria-controls\": this.containerNode.id\r\n\t\t\t\t}, this.btnContainerNode);\r\n\t\t\t\tthis._prevHandle = this.connect(this.prevBtnNode, \"onclick\", \"onPrevBtnClick\");\r\n\t\t\t\tthis._nextHandle = this.connect(this.nextBtnNode, \"onclick\", \"onNextBtnClick\");\r\n\t\t\t}\r\n\r\n\t\t\tif(this.pageIndicator){\r\n\t\t\t\tif(!this.title){\r\n\t\t\t\t\tthis.title = \"&nbsp;\";\r\n\t\t\t\t}\r\n\t\t\t\tthis.piw = new PageIndicator();\r\n\t\t\t\tthis.headerNode.appendChild(this.piw.domNode);\r\n\t\t\t}\r\n\r\n\t\t\tthis.titleNode = domConstruct.create(\"div\", {\r\n\t\t\t\tclassName: \"mblCarouselTitle\"\r\n\t\t\t}, this.headerNode);\r\n\r\n\t\t\tthis.domNode.appendChild(this.containerNode);\r\n\t\t\tthis.subscribe(\"/dojox/mobile/viewChanged\", \"handleViewChanged\");\r\n\t\t\tthis.connect(this.domNode, \"onclick\", \"_onClick\");\r\n\t\t\tthis.connect(this.domNode, \"onkeydown\", \"_onClick\");\r\n\t\t\tthis._dragstartHandle = this.connect(this.domNode, \"ondragstart\", event.stop);\r\n\t\t\tthis.selectedItemIndex = -1;\r\n\t\t\tthis.items = [];\r\n\t\t},\r\n\r\n\t\tstartup: function(){\r\n\t\t\tif(this._started){ return; }\r\n\r\n\t\t\tvar h;\r\n\t\t\tif(this.height === \"inherit\"){\r\n\t\t\t\tif(this.domNode.offsetParent){\r\n\t\t\t\t\th = this.domNode.offsetParent.offsetHeight + \"px\";\r\n\t\t\t\t}\r\n\t\t\t}else if(this.height){\r\n\t\t\t\th = this.height;\r\n\t\t\t}\r\n\t\t\tif(h){\r\n\t\t\t\tthis.domNode.style.height = h;\r\n\t\t\t}\r\n\r\n\t\t\tif(this.store){\r\n\t\t\t\tif(!this.setStore){\r\n\t\t\t\t\tthrow new Error(\"Use StoreCarousel or DataCarousel instead of Carousel.\");\r\n\t\t\t\t}\r\n\t\t\t\tvar store = this.store;\r\n\t\t\t\tthis.store = null;\r\n\t\t\t\tthis.setStore(store, this.query, this.queryOptions);\r\n\t\t\t}else{\r\n\t\t\t\tthis.resizeItems();\r\n\t\t\t}\r\n\t\t\tthis.inherited(arguments);\r\n\r\n\t\t\tthis.currentView = array.filter(this.getChildren(), function(view){\r\n\t\t\t\treturn view.isVisible();\r\n\t\t\t})[0];\r\n\t\t},\r\n\r\n\t\tresizeItems: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tResizes the child items of the carousel.\r\n\t\t\tvar idx = 0, i, len;\r\n\t\t\tvar h = this.domNode.offsetHeight - (this.headerNode ? this.headerNode.offsetHeight : 0);\r\n\t\t\tvar m = (has(\"ie\") < 10) ? 5 / this.numVisible - 1 : 5 / this.numVisible;\r\n\t\t\tvar node, item;\r\n\t\t\tarray.forEach(this.getChildren(), function(view){\r\n\t\t\t\tif(!(view instanceof SwapView)){ return; }\r\n\t\t\t\tif(!(view.lazy)){\r\n\t\t\t\t\tview._instantiated = true;\r\n\t\t\t\t}\r\n\t\t\t\tvar ch = view.containerNode.childNodes;\r\n\t\t\t\tfor(i = 0, len = ch.length; i < len; i++){\r\n\t\t\t\t\tnode = ch[i];\r\n\t\t\t\t\tif(node.nodeType !== 1){ continue; }\r\n\t\t\t\t\titem = this.items[idx] || {};\r\n\t\t\t\t\tdomStyle.set(node, {\r\n\t\t\t\t\t\twidth: item.width || (90 / this.numVisible + \"%\"),\r\n\t\t\t\t\t\theight: item.height || h + \"px\",\r\n\t\t\t\t\t\tmargin: \"0 \" + (item.margin || m + \"%\")\r\n\t\t\t\t\t});\r\n\t\t\t\t\tdomClass.add(node, \"mblCarouselSlot\");\r\n\t\t\t\t\tidx++;\r\n\t\t\t\t}\r\n\t\t\t}, this);\r\n\r\n\t\t\tif(this.piw){\r\n\t\t\t\tthis.piw.refId = this.containerNode.firstChild;\r\n\t\t\t\tthis.piw.reset();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tresize: function(){\r\n\t\t\tif(!this.itemWidth){ return; }\r\n\t\t\tvar num = Math.floor(this.domNode.offsetWidth / this.itemWidth);\r\n\t\t\tif(num === this.numVisible){ return; }\r\n\t\t\tthis.selectedItemIndex = this.getIndexByItemWidget(this.selectedItem);\r\n\t\t\tthis.numVisible = num;\r\n\t\t\tif(this.items.length > 0){\r\n\t\t\t\tthis.onComplete(this.items);\r\n\t\t\t\tthis.select(this.selectedItemIndex);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfillPages: function(){\r\n\t\t\tarray.forEach(this.getChildren(), function(child, i){\r\n\t\t\t\tvar s = \"\";\r\n\t\t\t\tvar j;\r\n\t\t\t\tfor(j = 0; j < this.numVisible; j++){\r\n\t\t\t\t\tvar type, props = \"\", mixins;\r\n\t\t\t\t\tvar idx = i * this.numVisible + j;\r\n\t\t\t\t\tvar item = {};\r\n\t\t\t\t\tif(idx < this.items.length){\r\n\t\t\t\t\t\titem = this.items[idx];\r\n\t\t\t\t\t\ttype = this.store.getValue(item, \"type\");\r\n\t\t\t\t\t\tif(type){\r\n\t\t\t\t\t\t\tprops = this.store.getValue(item, \"props\");\r\n\t\t\t\t\t\t\tmixins = this.store.getValue(item, \"mixins\");\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\ttype = \"dojox.mobile.CarouselItem\";\r\n\t\t\t\t\t\t\tarray.forEach([\"alt\", \"src\", \"headerText\", \"footerText\"], function(p){\r\n\t\t\t\t\t\t\t\tvar v = this.store.getValue(item, p);\r\n\t\t\t\t\t\t\t\tif(v !== undefined){\r\n\t\t\t\t\t\t\t\t\tif(props){ props += ','; }\r\n\t\t\t\t\t\t\t\t\tprops += p + ':\"' + v + '\"';\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}, this);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\ttype = \"dojox.mobile.CarouselItem\";\r\n\t\t\t\t\t\tprops = 'src:\"' + require.toUrl(\"dojo/resources/blank.gif\") + '\"' +\r\n\t\t\t\t\t\t\t', className:\"mblCarouselItemBlank\"';\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ts += '<div data-dojo-type=\"' + type + '\"';\r\n\t\t\t\t\tif(props){\r\n\t\t\t\t\t\ts += ' data-dojo-props=\\'' + props + '\\'';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(mixins){\r\n\t\t\t\t\t\ts += ' data-dojo-mixins=\\'' + mixins + '\\'';\r\n\t\t\t\t\t}\r\n\t\t\t\t\ts += '></div>';\r\n\t\t\t\t}\r\n\t\t\t\tchild.containerNode.innerHTML = s;\r\n\t\t\t}, this);\r\n\t\t},\r\n\r\n\t\tonComplete: function(/*Array*/items){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tA handler that is called after the fetch completes.\r\n\t\t\tarray.forEach(this.getChildren(), function(child){\r\n\t\t\t\tif(child instanceof SwapView){\r\n\t\t\t\t\tchild.destroyRecursive();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tthis.selectedItem = null;\r\n\t\t\tthis.items = items;\r\n\t\t\tvar nPages = Math.ceil(items.length / this.numVisible),\r\n\t\t\t\ti, h = this.domNode.offsetHeight - this.headerNode.offsetHeight,\r\n\t\t\t\tidx = this.selectedItemIndex === -1 ? 0 : this.selectedItemIndex,\r\n\t\t\t\tpg = Math.floor(idx / this.numVisible); // current page\r\n\t\t\tfor(i = 0; i < nPages; i++){\r\n\t\t\t\tvar w = new SwapView({height: h + \"px\", lazy:true});\r\n\t\t\t\tthis.addChild(w);\r\n\t\t\t\tif(i === pg){\r\n\t\t\t\t\tw.show();\r\n\t\t\t\t\tthis.currentView = w;\r\n\t\t\t\t}else{\r\n\t\t\t\t\tw.hide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.fillPages();\r\n\t\t\tthis.resizeItems();\r\n\t\t\tvar children = this.getChildren();\r\n\t\t\tvar from = pg - 1 < 0 ? 0 : pg - 1;\r\n\t\t\tvar to = pg + 1 > nPages - 1 ? nPages - 1 : pg + 1;\r\n\t\t\tfor(i = from; i <= to; i++){\r\n\t\t\t\tthis.instantiateView(children[i]);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tonError: function(/*String*/ /*===== errText =====*/){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tAn error handler.\r\n\t\t},\r\n\r\n\t\tonUpdate: function(/*Object*/ /*===== item, =====*/ /*Number*/ /*===== insertedInto =====*/){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tAdds a new item or updates an existing item.\r\n\t\t},\r\n\r\n\t\tonDelete: function(/*Object*/ /*===== item, =====*/ /*Number*/ /*===== removedFrom =====*/){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tDeletes an existing item.\r\n\t\t},\r\n\r\n\t\tonSet: function(item, attribute, oldValue, newValue){\r\n\t\t},\r\n\r\n\t\tonNew: function(newItem, parentInfo){\r\n\t\t},\r\n\r\n\t\tonStoreClose: function(request){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tCalled when the store is closed.\r\n\t\t},\r\n\r\n\t\tgetParentView: function(/*DomNode*/node){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tReturns the parent view of the given DOM node.\r\n\t\t\tvar w;\r\n\t\t\tfor(w = registry.getEnclosingWidget(node); w; w = w.getParent()){\r\n\t\t\t\tif(w.getParent() instanceof SwapView){ return w; }\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\r\n\t\tgetIndexByItemWidget: function(/*Widget*/w){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tReturns the index of a given item widget.\r\n\t\t\tif(!w){ return -1; }\r\n\t\t\tvar view = w.getParent();\r\n\t\t\treturn array.indexOf(this.getChildren(), view) * this.numVisible +\r\n\t\t\t\tarray.indexOf(view.getChildren(), w);\r\n\t\t},\r\n\r\n\t\tgetItemWidgetByIndex: function(/*Number*/index){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tReturns the index of an item widget at a given index.\r\n\t\t\tif(index === -1){ return null; }\r\n\t\t\tvar view = this.getChildren()[Math.floor(index / this.numVisible)];\r\n\t\t\treturn view.getChildren()[index % this.numVisible];\r\n\t\t},\r\n\r\n\t\tonPrevBtnClick: function(/*Event*/ /*===== e =====*/){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tCalled when the \"previous\" button is clicked.\r\n\t\t\tif(this.currentView){\r\n\t\t\t\tthis.currentView.goTo(-1);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tonNextBtnClick: function(/*Event*/ /*===== e =====*/){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tCalled when the \"next\" button is clicked.\r\n\t\t\tif(this.currentView){\r\n\t\t\t\tthis.currentView.goTo(1);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_onClick: function(e){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tInternal handler for click events.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\tif(this.onClick(e) === false){ return; } // user's click action\r\n\t\t\tif(e && e.type === \"keydown\"){ // keyboard navigation for accessibility\r\n\t\t\t\tif(e.keyCode === 39){ // right arrow\r\n\t\t\t\t\tthis.onNextBtnClick();\r\n\t\t\t\t}else if(e.keyCode === 37){ // left arrow\r\n\t\t\t\t\tthis.onPrevBtnClick();\r\n\t\t\t\t}else if(e.keyCode !== 13){ // !Enter\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar w;\r\n\t\t\tfor(w = registry.getEnclosingWidget(e.target); ; w = w.getParent()){\r\n\t\t\t\tif(!w){ return; }\r\n\t\t\t\tif(w.getParent() instanceof SwapView){ break; }\r\n\t\t\t}\r\n\t\t\tthis.select(w);\r\n\t\t\tvar idx = this.getIndexByItemWidget(w);\r\n\t\t\tconnect.publish(\"/dojox/mobile/carouselSelect\", [this, w, this.items[idx], idx]);\r\n\t\t},\r\n\r\n\t\tselect: function(/*Widget|Number*/itemWidget){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tSelects the given widget.\r\n\t\t\tif(typeof(itemWidget) === \"number\"){\r\n\t\t\t\titemWidget = this.getItemWidgetByIndex(itemWidget);\r\n\t\t\t}\r\n\t\t\tif(this.selectable){\r\n\t\t\t\tif(this.selectedItem){\r\n\t\t\t\t\tthis.selectedItem.set(\"selected\", false);\r\n\t\t\t\t\tdomClass.remove(this.selectedItem.domNode, \"mblCarouselSlotSelected\");\r\n\t\t\t\t}\r\n\t\t\t\tif(itemWidget){\r\n\t\t\t\t\titemWidget.set(\"selected\", true);\r\n\t\t\t\t\tdomClass.add(itemWidget.domNode, \"mblCarouselSlotSelected\");\r\n\t\t\t\t}\r\n\t\t\t\tthis.selectedItem = itemWidget;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tonClick: function(/*Event*/ /*===== e =====*/){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tUser-defined function to handle clicks.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tcallback\r\n\t\t},\r\n\r\n\t\tinstantiateView: function(view){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tInstantiates the given view.\r\n\t\t\tif(view && !view._instantiated){\r\n\t\t\t\tvar isHidden = (domStyle.get(view.domNode, \"display\") === \"none\");\r\n\t\t\t\tif(isHidden){\r\n\t\t\t\t\tdomStyle.set(view.domNode, {visibility:\"hidden\", display:\"\"});\r\n\t\t\t\t}\r\n\t\t\t\tlazyLoadUtils.instantiateLazyWidgets(view.containerNode, null, function(root){\r\n\t\t\t\t\tif(isHidden){\r\n\t\t\t\t\t\tdomStyle.set(view.domNode, {visibility:\"visible\", display:\"none\"});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tview._instantiated = true;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\thandleViewChanged: function(view){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tListens to \"/dojox/mobile/viewChanged\" events.\r\n\t\t\tif(view.getParent() !== this){ return; }\r\n\t\t\tif(this.currentView.nextView(this.currentView.domNode) === view){\r\n\t\t\t\tthis.instantiateView(view.nextView(view.domNode));\r\n\t\t\t}else{\r\n\t\t\t\tthis.instantiateView(view.previousView(view.domNode));\r\n\t\t\t}\r\n\t\t\tthis.currentView = view;\r\n\t\t},\r\n\r\n\t\t_setTitleAttr: function(/*String*/title){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\tthis.titleNode.innerHTML = this._cv ? this._cv(title) : title;\r\n\t\t\tthis._set(\"title\", title);\r\n\t\t}\r\n\t});\r\n\t\r\n\tCarousel.ChildSwapViewProperties = {\r\n\t\t// summary:\r\n\t\t//\t\tThis property can be specified for the SwapView children of a dojox/mobile/Carousel.\r\n\r\n\t\t// lazy: Boolean\r\n\t\t//\t\tSpecifies that the Carousel child must be lazily loaded.\r\n\t\tlazy: false\r\n\t};\r\n\r\n\t// Since any widget can be specified as an Accordion child, mix ChildWidgetProperties\r\n\t// into the base widget class.  (This is a hack, but it's effective.)\r\n\t// This is for the benefit of the parser. Remove for 2.0.  Also, hide from doc viewer.\r\n\tlang.extend(SwapView, /*===== {} || =====*/ Carousel.ChildSwapViewProperties);\r\n\t\r\n\treturn has(\"dojo-bidi\") ? declare(\"dojox.mobile.Carousel\", [Carousel, BidiCarousel]) : Carousel;\r\n});\r\n"]}