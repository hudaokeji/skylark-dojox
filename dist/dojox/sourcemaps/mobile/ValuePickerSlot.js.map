{"version":3,"sources":["mobile/ValuePickerSlot.js"],"names":["define","array","declare","event","lang","win","domClass","domConstruct","domAttr","touch","WidgetBase","iconUtils","has","BidiValuePickerSlot","ValuePickerSlot","items","labels","labelFrom","labelTo","zeroPad","value","step","readOnly","tabIndex","plusBtnLabel","plusBtnLabelRef","minusBtnLabel","minusBtnLabelRef","baseClass","buildRendering","this","inherited","arguments","initLabels","length","i","push","plusBtnNode","create","className","title","domNode","plusIconNode","createIcon","inputAreaNode","inputNode","readonly","minusBtnNode","minusIconNode","set","_setPlusBtnLabelAttr","_setPlusBtnLabelRefAttr","inputAreaNodeId","require","getUniqueId","_setMinusBtnLabelAttr","_setMinusBtnLabelRefAttr","_initialValue","startup","_started","_handlers","connect","press","hitch","e","_onChange","_set","a","zeros","Array","join","slice","spin","steps","pos","v","get","len","Math","abs","ceil","newItem","setInitialValue","_onClick","type","keyCode","onClick","node","currentTarget","_btn","onChange","validate","filter","toLowerCase","_onTouchStart","_conn","body","move","release","touchStartX","touches","pageX","clientX","touchStartY","pageY","clientY","add","_timer","remove","_interval","clearInterval","defer","setInterval","stop","_onTouchMove","x","y","forEach","disconnect","_onTouchEnd","_getKeyAttr","val","item","_getValueAttr","_setValueAttr","_spinToValue","applyValue","parent","getParent","onValueChanged","_setTabIndexAttr","setAttribute","_setAria","attr"],"mappings":"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","file":"../../mobile/ValuePickerSlot.js","sourcesContent":["define([\r\n\t\"dojo/_base/array\",\r\n\t\"dojo/_base/declare\",\r\n\t\"dojo/_base/event\",\r\n\t\"dojo/_base/lang\",\r\n\t\"dojo/_base/window\",\r\n\t\"dojo/dom-class\",\r\n\t\"dojo/dom-construct\",\r\n\t\"dojo/dom-attr\",\r\n\t\"dojo/touch\",\r\n\t\"dijit/_WidgetBase\",\r\n\t\"./iconUtils\",\r\n\t\"dojo/has\",\r\n\t\"dojo/has!dojo-bidi?dojox/mobile/bidi/ValuePickerSlot\"\r\n], function(array, declare, event, lang, win, domClass, domConstruct, domAttr, touch, WidgetBase, iconUtils, has, BidiValuePickerSlot){\r\n\r\n\t// module:\r\n\t//\t\tdojox/mobile/ValuePickerSlot\r\n\r\n\tvar ValuePickerSlot = declare(has(\"dojo-bidi\") ?  \"dojox.mobile.NonBidiValuePickerSlot\" : \"dojox.mobile.ValuePickerSlot\", WidgetBase, {\r\n\t\t// summary:\r\n\t\t//\t\tA widget representing one slot of a ValuePicker widget.\r\n\t\t\r\n\t\t// items: Array\r\n\t\t//\t\tAn array of array of key-label pairs\r\n\t\t//\t\t(e.g. [[0, \"Jan\"], [1,\"Feb\"], ...]). If key values for each label\r\n\t\t//\t\tare not necessary, labels can be used instead.\r\n\t\titems: [],\r\n\r\n\t\t// labels: String[]\r\n\t\t//\t\tAn array of labels to be displayed on the value picker\r\n\t\t//\t\t(e.g. [\"Jan\",\"Feb\",...]). This is a simplified version of the\r\n\t\t//\t\titems property.\r\n\t\tlabels: [],\r\n\r\n\t\t// labelFrom: Number\r\n\t\t//\t\tThe start value of display values of the value picker. This\r\n\t\t//\t\tparameter is especially useful when value picker has serial\r\n\t\t//\t\tvalues.\r\n\t\tlabelFrom: 0,\r\n\r\n\t\t// labelTo: Number\r\n\t\t//\t\tThe end value of display values of the value picker.\r\n\t\tlabelTo: 0,\r\n\r\n\t\t// zeroPad: Number\r\n\t\t//\t\tLength of zero padding numbers.\r\n\t\t//\t\tEx. zeroPad=2 -> \"00\", \"01\", ...\r\n\t\t//\t\tEx. zeroPad=3 -> \"000\", \"001\", ...\r\n\t\tzeroPad: 0,\r\n\r\n\t\t// value: String\r\n\t\t//\t\tThe initial value of the value picker.\r\n\t\tvalue: \"\",\r\n\r\n\t\t// step: Number\r\n\t\t//\t\tThe steps between labelFrom and labelTo.\r\n\t\tstep: 1,\r\n\r\n\t\t// readOnly: [const] Boolean\r\n\t\t//\t\tA flag used to indicate if the input field is readonly or not.\r\n\t\t//\t\tNote that changing the value of the property after the widget \r\n\t\t//\t\tcreation has no effect.\r\n\t\treadOnly: false,\r\n\r\n\t\t// tabIndex: String\r\n\t\t//\t\tTabindex setting for this widget so users can hit the tab key to\r\n\t\t//\t\tfocus on it.\r\n\t\ttabIndex: \"0\",\r\n\r\n\t\t// key: Object\r\n\t\t//\t\tThe key of the currently selected value in the items array. This is a read-only property.\r\n\t\t//\t\tWarning: Do not use this property directly, make sure to call the get() method.\r\n\t\t/*=====\r\n\t\tkey: null,\r\n\t\t=====*/\r\n\t\t\r\n\t\t// plusBtnLabel: String\r\n\t\t//\t\t(Accessibility) Text label for plus button\r\n\t\tplusBtnLabel: \"\",\r\n\t\t\r\n\t\t// plusBtnLabelRef: String\r\n\t\t//\t\t(Accessibility) Reference to a node id containing text label for plus button\r\n\t\tplusBtnLabelRef: \"\",\r\n\t\t\r\n\t\t// minusBtnLabel: String\r\n\t\t//\t\t(Accessibility) Text label for minus button\r\n\t\tminusBtnLabel: \"\",\r\n\t\t\r\n\t\t// minusBtnLabelRef: String\r\n\t\t//\t\t(Accessibility) Reference to a node id containing text label for minus button\r\n\t\tminusBtnLabelRef: \"\",\r\n\r\n\t\t/* internal properties */\t\r\n\t\tbaseClass: \"mblValuePickerSlot\",\r\n\r\n\t\tbuildRendering: function(){\r\n\t\t\tthis.inherited(arguments);\r\n\r\n\t\t\tthis.initLabels();\r\n\t\t\tif(this.labels.length > 0){\r\n\t\t\t\tthis.items = [];\r\n\t\t\t\tfor(var i = 0; i < this.labels.length; i++){\r\n\t\t\t\t\tthis.items.push([i, this.labels[i]]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.plusBtnNode = domConstruct.create(\"div\", {\r\n\t\t\t\tclassName: \"mblValuePickerSlotPlusButton mblValuePickerSlotButton\",\r\n\t\t\t\ttitle: \"+\"\r\n\t\t\t}, this.domNode);\r\n\t\t\t\r\n\t\t\tthis.plusIconNode = domConstruct.create(\"div\", {\r\n\t\t\t\tclassName: \"mblValuePickerSlotIcon\"\r\n\t\t\t}, this.plusBtnNode);\r\n\t\t\ticonUtils.createIcon(\"mblDomButtonGrayPlus\", null, this.plusIconNode);\r\n\r\n\t\t\tthis.inputAreaNode = domConstruct.create(\"div\", {\r\n\t\t\t\tclassName: \"mblValuePickerSlotInputArea\"\r\n\t\t\t}, this.domNode);\r\n\t\t\tthis.inputNode = domConstruct.create(\"input\", {\r\n\t\t\t\tclassName: \"mblValuePickerSlotInput\",\r\n\t\t\t\treadonly: this.readOnly\r\n\t\t\t}, this.inputAreaNode);\r\n\t\t\t\r\n\t\t\tthis.minusBtnNode = domConstruct.create(\"div\", {\r\n\t\t\t\tclassName: \"mblValuePickerSlotMinusButton mblValuePickerSlotButton\",\r\n\t\t\t\ttitle: \"-\"\r\n\t\t\t}, this.domNode);\r\n\t\t\tthis.minusIconNode = domConstruct.create(\"div\", {\r\n\t\t\t\tclassName: \"mblValuePickerSlotIcon\"\r\n\t\t\t}, this.minusBtnNode);\r\n\t\t\ticonUtils.createIcon(\"mblDomButtonGrayMinus\", null, this.minusIconNode);\r\n\t\t\t\r\n\t\t\tdomAttr.set(this.plusBtnNode, \"role\", \"button\"); //a11y\r\n\t\t\tthis._setPlusBtnLabelAttr(this.plusBtnLabel);\r\n\t\t\tthis._setPlusBtnLabelRefAttr(this.plusBtnLabelRef);\r\n\t\t\t\r\n\t\t\tdomAttr.set(this.inputNode, \"role\", \"textbox\");\r\n\t\t\tvar registry = require(\"dijit/registry\");\r\n\t\t\tvar inputAreaNodeId =  registry.getUniqueId(\"dojo_mobile__mblValuePickerSlotInput\");\r\n\t\t\tdomAttr.set(this.inputNode, \"id\", inputAreaNodeId);\r\n\t\t\tdomAttr.set(this.plusBtnNode, \"aria-controls\", inputAreaNodeId);\r\n\t\t\t\r\n\t\t\tdomAttr.set(this.minusBtnNode, \"role\", \"button\");\r\n\t\t\tdomAttr.set(this.minusBtnNode, \"aria-controls\", inputAreaNodeId);\r\n\t\t\tthis._setMinusBtnLabelAttr(this.minusBtnLabel);\r\n\t\t\tthis._setMinusBtnLabelRefAttr(this.minusBtnLabelRef);\r\n\r\n\t\t\tif(this.value === \"\" && this.items.length > 0){\r\n\t\t\t\tthis.value = this.items[0][1];\r\n\t\t\t}\r\n\t\t\tthis._initialValue = this.value;\r\n\t\t},\r\n\r\n\t\tstartup: function(){\r\n\t\t\tif(this._started){ return; }\r\n\t\t\tthis._handlers = [\r\n\t\t\t\tthis.connect(this.plusBtnNode, touch.press, \"_onTouchStart\"),\r\n\t\t\t\tthis.connect(this.minusBtnNode, touch.press, \"_onTouchStart\"),\r\n\t\t\t\tthis.connect(this.plusBtnNode, \"onkeydown\", \"_onClick\"), // for desktop browsers\r\n\t\t\t\tthis.connect(this.minusBtnNode, \"onkeydown\", \"_onClick\"), // for desktop browsers\r\n\t\t\t\tthis.connect(this.inputNode, \"onchange\", lang.hitch(this, function(e){\r\n\t\t\t\t\tthis._onChange(e);\r\n\t\t\t\t}))\r\n\t\t\t];\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\tthis._set(this.plusBtnLabel);\r\n\t\t},\r\n\r\n\t\tinitLabels: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tInitializes the labels of this slot according to the labelFrom and labelTo properties.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\tif(this.labelFrom !== this.labelTo){\r\n\t\t\t\tvar a = this.labels = [],\r\n\t\t\t\t\tzeros = this.zeroPad && Array(this.zeroPad).join(\"0\");\r\n\t\t\t\tfor(var i = this.labelFrom; i <= this.labelTo; i += this.step){\r\n\t\t\t\t\ta.push(this.zeroPad ? (zeros + i).slice(-this.zeroPad) : i + \"\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tspin: function(/*Number*/steps){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tSpins the slot as specified by steps.\r\n\r\n\t\t\t// find the position of the current value\r\n\t\t\tvar pos = -1,\r\n\t\t\t\tv = this.get(\"value\"),\r\n\t\t\t\tlen = this.items.length;\r\n\t\t\tfor(var i = 0; i < len; i++){\r\n\t\t\t\tif(this.items[i][1] === v){\r\n\t\t\t\t\tpos = i;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(v == -1){ return; }\r\n\t\t\tpos += steps;\r\n\t\t\tif(pos < 0){ // shift to positive\r\n\t\t\t\tpos += (Math.abs(Math.ceil(pos / len)) + 1) * len;\r\n\t\t\t}\r\n\t\t\tvar newItem = this.items[pos % len];\r\n\t\t\tthis.set(\"value\", newItem[1]);\r\n\t\t},\r\n\r\n\t\tsetInitialValue: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tSets the initial value using this.value or the first item.\r\n\t\t\tthis.set(\"value\", this._initialValue);\r\n\t\t},\r\n\r\n\t\t_onClick: function(e){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tInternal handler for click events.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\tif(e && e.type === \"keydown\" && e.keyCode !== 13){ return; }\r\n\t\t\tif(this.onClick(e) === false){ return; } // user's click action\r\n\t\t\tvar node = e.currentTarget;\r\n\t\t\tif(node === this.plusBtnNode || node === this.minusBtnNode){\r\n\t\t\t\tthis._btn = node;\r\n\t\t\t}\r\n\t\t\tthis.spin(this._btn === this.plusBtnNode ? 1 : -1);\r\n\t\t},\r\n\r\n\t\tonClick: function(/*Event*/ /*===== e =====*/){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tUser defined function to handle clicks\r\n\t\t\t// tags:\r\n\t\t\t//\t\tcallback\r\n\t\t},\r\n\r\n\t\t_onChange: function(e){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tInternal handler for the input field's value change events\r\n\t\t\t// tags:\r\n\t\t\t//\t\tcallback\r\n\t\t\tif(this.onChange(e) === false){ return; } // user's click action\r\n\t\t\tvar v = this.get(\"value\"), // text in the input field\r\n\t\t\t\ta = this.validate(v);\r\n\t\t\tthis.set(\"value\", a.length ? a[0][1] : this.value);\r\n\t\t},\r\n\r\n\t\tonChange: function(/*Event*/ /*===== e =====*/){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tUser defined function to handle value changes\r\n\t\t\t// tags:\r\n\t\t\t//\t\tcallback\r\n\t\t},\r\n\r\n\t\tvalidate: function(value){\r\n\t\t\treturn array.filter(this.items, function(a){\r\n\t\t\t\treturn (a[1] + \"\").toLowerCase() == (value + \"\").toLowerCase();\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t_onTouchStart: function(e){\r\n\t\t\tthis._conn = [\r\n\t\t\t\tthis.connect(win.body(), touch.move, \"_onTouchMove\"),\r\n\t\t\t\tthis.connect(win.body(), touch.release, \"_onTouchEnd\")\r\n\t\t\t];\r\n\t\t\tthis.touchStartX = e.touches ? e.touches[0].pageX : e.clientX;\r\n\t\t\tthis.touchStartY = e.touches ? e.touches[0].pageY : e.clientY;\r\n\t\t\tdomClass.add(e.currentTarget, \"mblValuePickerSlotButtonSelected\");\r\n\t\t\tthis._btn = e.currentTarget;\r\n\t\t\tif(this._timer){\r\n\t\t\t\tthis._timer.remove(); // fail safe\r\n\t\t\t\tthis._timer = null;\r\n\t\t\t}\r\n\t\t\tif(this._interval){\r\n\t\t\t\tclearInterval(this._interval); // fail safe\r\n\t\t\t\tthis._interval = null;\r\n\t\t\t}\r\n\t\t\tthis._timer = this.defer(function(){\r\n\t\t\t\tthis._interval = setInterval(lang.hitch(this, function(){\r\n\t\t\t\t\tthis.spin(this._btn === this.plusBtnNode ? 1 : -1);\r\n\t\t\t\t}), 60);\r\n\t\t\t\tthis._timer = null;\r\n\t\t\t}, 1000);\r\n\t\t\tevent.stop(e);\r\n\t\t},\r\n\r\n\t\t_onTouchMove: function(e){\r\n\t\t\tvar x = e.touches ? e.touches[0].pageX : e.clientX;\r\n\t\t\tvar y = e.touches ? e.touches[0].pageY : e.clientY;\r\n\t\t\tif(Math.abs(x - this.touchStartX) >= 4 ||\r\n\t\t\t   Math.abs(y - this.touchStartY) >= 4){ // dojox/mobile/scrollable.threshold\r\n\t\t\t   \tif(this._timer){\r\n\t\t\t\t\tthis._timer.remove(); // fail safe\r\n\t\t\t\t\tthis._timer = null;\r\n\t\t\t\t}\r\n\t\t\t\tif(this._interval){\r\n\t\t\t\t\tclearInterval(this._interval); // fail safe\r\n\t\t\t\t\tthis._interval = null;\r\n\t\t\t\t}\r\n\t\t\t\tarray.forEach(this._conn, this.disconnect, this);\r\n\t\t\t\tdomClass.remove(this._btn, \"mblValuePickerSlotButtonSelected\");\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_onTouchEnd: function(e){\r\n\t\t\tif(this._timer){\r\n\t\t\t\tthis._timer.remove();\r\n\t\t\t\tthis._timer = null;\r\n\t\t\t}\r\n\t\t\tarray.forEach(this._conn, this.disconnect, this);\r\n\t\t\tdomClass.remove(this._btn, \"mblValuePickerSlotButtonSelected\");\r\n\t\t\tif(this._interval){\r\n\t\t\t\tclearInterval(this._interval);\r\n\t\t\t\tthis._interval = null;\r\n\t\t\t}else{\r\n\t\t\t\tthis._onClick(e);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_getKeyAttr: function(){\r\n\t\t\tvar val = this.get(\"value\");\r\n\t\t\tvar item = array.filter(this.items, function(item){\r\n\t\t\t\treturn item[1] === val;\r\n\t\t\t})[0];\r\n\t\t\treturn item ? item[0] : null;\r\n\t\t},\r\n\r\n\t\t_getValueAttr: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tGets the currently selected value.\r\n\t\t\treturn this.inputNode.value;\r\n\t\t},\r\n\r\n\t\t_setValueAttr: function(value){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tSets a new value to this slot.\r\n\t\t\tthis._spinToValue(value, true);\r\n\t\t},\r\n\t\t\r\n\t\t_spinToValue: function(value, applyValue){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tSets a new value to this slot.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\tif(this.get(\"value\") == value){\r\n\t\t\t\treturn; // no change; avoid notification\r\n\t\t\t}\r\n\t\t\tthis.inputNode.value = value;\r\n\t\t\t// to avoid unnecessary notifications, applyValue is undefined when \r\n\t\t\t// _spinToValue is called by _DatePickerMixin.\r\n\t\t\tif(applyValue){\r\n\t\t\t\tthis._set(\"value\", value);\r\n\t\t\t}\r\n\t\t\tvar parent = this.getParent();\r\n\t\t\tif(parent && parent.onValueChanged){\r\n\t\t\t\tparent.onValueChanged(this);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_setTabIndexAttr: function(/*String*/ tabIndex){\r\n\t\t\tthis.plusBtnNode.setAttribute(\"tabIndex\", tabIndex);\r\n\t\t\tthis.minusBtnNode.setAttribute(\"tabIndex\", tabIndex);\r\n\t\t},\r\n\t\t\r\n\t\t_setAria: function(node, attr, value){\r\n\t\t\tif(value){\r\n\t\t\t\tdomAttr.set(node, attr, value);\r\n\t\t\t}else{\r\n\t\t\t\tdomAttr.remove(node, attr);\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t_setPlusBtnLabelAttr: function(/*String*/ plusBtnLabel){\r\n\t\t\tthis._setAria(this.plusBtnNode, \"aria-label\", plusBtnLabel);\r\n\t\t},\r\n\t\t\r\n\t\t_setPlusBtnLabelRefAttr: function(/*String*/ plusBtnLabelRef){\r\n\t\t\tthis._setAria(this.plusBtnNode, \"aria-labelledby\", plusBtnLabelRef);\r\n\t\t},\r\n\t\t\r\n\t\t_setMinusBtnLabelAttr: function(/*String*/ minusBtnLabel){\r\n\t\t\tthis._setAria(this.minusBtnNode, \"aria-label\", minusBtnLabel);\r\n\t\t},\r\n\t\t\r\n\t\t_setMinusBtnLabelRefAttr: function(/*String*/ minusBtnLabelRef){\r\n\t\t\tthis._setAria(this.minusBtnNode, \"aria-labelledby\", minusBtnLabelRef);\r\n\t\t}\r\n\t});\r\n\t\r\n\treturn has(\"dojo-bidi\") ? declare(\"dojox.mobile.ValuePickerSlot\", [ValuePickerSlot, BidiValuePickerSlot]) : ValuePickerSlot;\r\n});\r\n"]}