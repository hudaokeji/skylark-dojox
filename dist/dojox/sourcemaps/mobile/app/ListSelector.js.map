{"version":3,"sources":["mobile/app/ListSelector.js"],"names":["dojo","provide","experimental","require","declare","dojox","mobile","app","_Widget","data","controller","onChoose","destroyOnHide","_setDataAttr","this","render","postCreate","addClass","domNode","_this","connect","event","hasClass","target","_idx","value","hide","removeClass","getWindowSize","mask","create","class","innerHTML","assistant","show","fromNode","startPos","fromNodePos","windowSize","_abs","x","w","y","console","log","style","opacity","display","width","Math","floor","maxWidth","query","forEach","node","float","max","marginBox","min","round","targetHeight","h","targetY","getScroll","anim1","animateProperty","duration","properties","start","end","height","top","left","fontSize","onEnd","anim2","fadeIn","fx","combine","play","get","destroy","fadeOut","row","empty","i","length","className","label","inherited","arguments"],"mappings":"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","file":"../../../mobile/app/ListSelector.js","sourcesContent":["dojo.provide(\"dojox.mobile.app.ListSelector\");\r\ndojo.experimental(\"dojox.mobile.app.ListSelector\");\r\n\r\ndojo.require(\"dojox.mobile.app._Widget\");\r\ndojo.require(\"dojo.fx\");\r\n\r\ndojo.declare(\"dojox.mobile.app.ListSelector\", dojox.mobile.app._Widget, {\r\n\r\n\t// data: Array\r\n\t//\t\tThe array of items to display.  Each element in the array\r\n\t//\t\tshould have both a label and value attribute, e.g.\r\n\t//\t\t[{label: \"Open\", value: 1} , {label: \"Delete\", value: 2}]\r\n\tdata: null,\r\n\r\n\t// controller: Object\r\n\t//\t\tThe current SceneController widget.\r\n\tcontroller: null,\r\n\r\n\t// onChoose: Function\r\n\t//\t\tThe callback function for when an item is selected\r\n\tonChoose: null,\r\n\r\n\tdestroyOnHide: false,\r\n\r\n\t_setDataAttr: function(data){\r\n\t\tthis.data = data;\r\n\t\r\n\t\tif(this.data){\r\n\t\t\tthis.render();\r\n\t\t}\r\n\t},\r\n\r\n\tpostCreate: function(){\r\n\t\tdojo.addClass(this.domNode, \"listSelector\");\r\n\t\r\n\t\tvar _this = this;\r\n\t\r\n\t\tthis.connect(this.domNode, \"onclick\", function(event){\r\n\t\t\tif(!dojo.hasClass(event.target, \"listSelectorRow\")){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\r\n\t\t\tif(_this.onChoose){\r\n\t\t\t\t_this.onChoose(_this.data[event.target._idx].value);\r\n\t\t\t}\r\n\t\t\t_this.hide();\r\n\t\t});\r\n\r\n\t\tthis.connect(this.domNode, \"onmousedown\", function(event){\r\n\t\t\tif(!dojo.hasClass(event.target, \"listSelectorRow\")){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tdojo.addClass(event.target, \"listSelectorRow-selected\");\r\n\t\t});\r\n\r\n\t\tthis.connect(this.domNode, \"onmouseup\", function(event){\r\n\t\t\tif(!dojo.hasClass(event.target, \"listSelectorRow\")){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tdojo.removeClass(event.target, \"listSelectorRow-selected\");\r\n\t\t});\r\n\r\n\t\tthis.connect(this.domNode, \"onmouseout\", function(event){\r\n\t\t\tif(!dojo.hasClass(event.target, \"listSelectorRow\")){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tdojo.removeClass(event.target, \"listSelectorRow-selected\");\r\n\t\t});\r\n\t\r\n\t\tvar viewportSize = this.controller.getWindowSize();\r\n\t\r\n\t\tthis.mask = dojo.create(\"div\", {\"class\": \"dialogUnderlayWrapper\",\r\n\t\t\tinnerHTML: \"<div class=\\\"dialogUnderlay\\\"></div>\"\r\n\t\t}, this.controller.assistant.domNode);\r\n\t\r\n\t\tthis.connect(this.mask, \"onclick\", function(){\r\n\t\t\t_this.onChoose && _this.onChoose();\r\n\t\t\t_this.hide();\r\n\t\t});\r\n\t},\r\n\r\n\tshow: function(fromNode){\r\n\r\n\t\t// Using dojo.fx here. Must figure out how to do this with CSS animations!!\r\n\t\tvar startPos;\r\n\t\r\n\t\tvar windowSize = this.controller.getWindowSize();\r\n\t\tvar fromNodePos;\r\n\t\tif(fromNode){\r\n\t\t\tfromNodePos = dojo._abs(fromNode);\r\n\t\t\tstartPos = fromNodePos;\r\n\t\t}else{\r\n\t\t\tstartPos.x = windowSize.w / 2;\r\n\t\t\tstartPos.y = 200;\r\n\t\t}\r\n\t\tconsole.log(\"startPos = \", startPos);\r\n\t\r\n\t\tdojo.style(this.domNode, {\r\n\t\t\topacity: 0,\r\n\t\t\tdisplay: \"\",\r\n\t\t\twidth: Math.floor(windowSize.w * 0.8) + \"px\"\r\n\t\t});\r\n\t\r\n\t\tvar maxWidth = 0;\r\n\t\tdojo.query(\">\", this.domNode).forEach(function(node){\r\n\t\t\tdojo.style(node, {\r\n\t\t\t\t\"float\": \"left\"\r\n\t\t\t});\r\n\t\t\tmaxWidth = Math.max(maxWidth, dojo.marginBox(node).w);\r\n\t\t\tdojo.style(node, {\r\n\t\t\t\t\"float\": \"none\"\r\n\t\t\t});\r\n\t\t});\r\n\t\tmaxWidth = Math.min(maxWidth, Math.round(windowSize.w * 0.8))\r\n\t\t\t\t\t+ dojo.style(this.domNode, \"paddingLeft\")\r\n\t\t\t\t\t+ dojo.style(this.domNode, \"paddingRight\")\r\n\t\t\t\t\t+ 1;\r\n\t\r\n\t\tdojo.style(this.domNode, \"width\", maxWidth + \"px\");\r\n\t\tvar targetHeight = dojo.marginBox(this.domNode).h;\r\n\t\r\n\t\tvar _this = this;\r\n\t\r\n\t\r\n\t\tvar targetY = fromNodePos ?\r\n\t\t\t\tMath.max(30, fromNodePos.y - targetHeight - 10) :\r\n\t\t\t\tthis.getScroll().y + 30;\r\n\t\r\n\t\tconsole.log(\"fromNodePos = \", fromNodePos, \" targetHeight = \", targetHeight,\r\n\t\t\t\t\" targetY = \" + targetY, \" startPos \", startPos);\r\n\t\r\n\t\r\n\t\tvar anim1 = dojo.animateProperty({\r\n\t\t\tnode: this.domNode,\r\n\t\t\tduration: 400,\r\n\t\t\tproperties: {\r\n\t\t\t\twidth: {start: 1, end: maxWidth},\r\n\t\t\t\theight: {start: 1, end: targetHeight},\r\n\t\t\t\ttop: {start: startPos.y, end: targetY},\r\n\t\t\t\tleft: {start: startPos.x, end: (windowSize.w/2 - maxWidth/2)},\r\n\t\t\t\topacity: {start: 0, end: 1},\r\n\t\t\t\tfontSize: {start: 1}\r\n\t\t\t},\r\n\t\t\tonEnd: function(){\r\n\t\t\t\tdojo.style(_this.domNode, \"width\", \"inherit\");\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar anim2 = dojo.fadeIn({\r\n\t\t\tnode: this.mask,\r\n\t\t\tduration: 400\r\n\t\t});\r\n\t\tdojo.fx.combine([anim1, anim2]).play();\r\n\r\n\t},\r\n\r\n\thide: function(){\r\n\t\t// Using dojo.fx here. Must figure out how to do this with CSS animations!!\r\n\t\r\n\t\tvar _this = this;\r\n\t\r\n\t\tvar anim1 = dojo.animateProperty({\r\n\t\t\tnode: this.domNode,\r\n\t\t\tduration: 500,\r\n\t\t\tproperties: {\r\n\t\t\t\twidth: {end: 1},\r\n\t\t\t\theight: {end: 1},\r\n\t\t\t\topacity: {end: 0},\r\n\t\t\t\tfontSize: {end: 1}\r\n\t\t\t},\r\n\t\t\tonEnd: function(){\r\n\t\t\t\tif(_this.get(\"destroyOnHide\")){\r\n\t\t\t\t\t_this.destroy();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\r\n\t\tvar anim2 = dojo.fadeOut({\r\n\t\t\tnode: this.mask,\r\n\t\t\tduration: 400\r\n\t\t});\r\n\t\tdojo.fx.combine([anim1, anim2]).play();\r\n\t},\r\n\r\n\trender: function(){\r\n\t\t// summary:\r\n\t\t//\t\tRenders\r\n\t\r\n\t\tdojo.empty(this.domNode);\r\n\t\tdojo.style(this.domNode, \"opacity\", 0);\r\n\t\r\n\t\tvar row;\r\n\t\r\n\t\tfor(var i = 0; i < this.data.length; i++){\r\n\t\t\t// Create each row and add any custom classes. Also set the _idx property.\r\n\t\t\trow = dojo.create(\"div\", {\r\n\t\t\t\t\"class\": \"listSelectorRow \" + (this.data[i].className || \"\"),\r\n\t\t\t\tinnerHTML: this.data[i].label\r\n\t\t\t}, this.domNode);\r\n\t\r\n\t\t\trow._idx = i;\r\n\t\r\n\t\t\tif(i == 0){\r\n\t\t\t\tdojo.addClass(row, \"first\");\r\n\t\t\t}\r\n\t\t\tif(i == this.data.length - 1){\r\n\t\t\t\tdojo.addClass(row, \"last\");\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tdestroy: function(){\r\n\t\tthis.inherited(arguments);\r\n\t\tdojo.destroy(this.mask);\r\n\t}\r\n\r\n});\r\n"]}