{"version":3,"sources":["mobile/scrollable.js"],"names":["define","dojo","connect","event","lang","win","domClass","domConstruct","domStyle","domGeom","touch","registry","TextBoxMixin","has","css3","maskUtils","declare","BidiScrollable","dm","getObject","add","elem","doc","createElement","style","name","documentElement","appendChild","v","defaultView","getComputedStyle","hasTranslate3d","indexOf","removeChild","Scrollable","extend","fixedHeaderHeight","fixedFooterHeight","isLocalFooter","scrollBar","scrollDir","weight","fadeScrollBar","disableFlashScrollBar","threshold","constraint","touchNode","propagatable","dirLock","height","scrollType","_parentPadBorderExtentsBottom","_moved","init","params","p","hasOwnProperty","this","getElementById","domNode","msTouchAction","containerNode","_v","_h","_f","_ch","push","press","_useTopLeft","_useTransformTransition","i","setKeyframes","set","_speed","x","y","_appFooterHeight","isTopLevel","noResize","resize","_this","setTimeout","flashScrollBar","global","addEventListener","_onScroll","e","display","pos","scrollTop","scrollLeft","getPos","scrollTo","disableTouchScroll","_onFocusScroll","nodeRect","scrollableRect","node","activeElement","getBoundingClientRect","getDim","d","h","top","scrollIntoView","cleanup","length","disconnect","removeEventListener","findDisp","parentNode","nodeType","contains","nodes","childNodes","n","getScreenSize","innerHeight","clientHeight","offsetHeight","w","innerWidth","clientWidth","offsetWidth","_fixedAppFooter","isLocalHeader","marginTop","tagName","offsetParent","offsetTop","getBorderExtents","screenHeight","dh","getContentBox","parent","parentRect","contentBottom","bottom","contentHeight","Math","max","scrollHeight","min","charAt","_conn","onTouchEnd","onFlickAnimationStart","stop","onFlickAnimationEnd","_keepInputCaretInActiveElement","an","animationName","_scrollBarNodeV","remove","_scrollBarNodeH","className","target","_scrollBarV","_scrollBarH","cls","srcElement","stopAnimation","_bounce","bounce","slideTo","undefined","hideScrollBar","removeCover","isFormElement","t","onTouchStart","Date","getTime","startTime","move","release","_aborted","abort","touchStartX","touches","pageX","clientX","touchStartY","pageY","clientY","startPos","_dim","_time","_posX","_posY","_locked","_preventDefaultInNextTouchMove","preventDefault","onTouchMove","enclosingWidget","getEnclosingWidget","targetTouches","isInstanceOf","dx","dy","to","dim","abs","addCover","showScrollBar","round","o","c","d0","d1","shift","initialValue","value","type","speed","clicked","_sendClick","getSpeed","adjustDestination","duration","easing","distance","velocity","sqrt","pow","alignWithTop","dt","calcSpeed","time","doNotMoveScrollBar","scrollEvent","beforeTopHeight","afterBottomHeight","doScroll","bubbles","cancelable","beforeTop","afterBottom","onBeforeScroll","s","left","makeTranslateStr","scrollScrollBarTo","calcScrollBarPos","onAfterScroll","_runSlideAnimation","slideScrollBarTo","parseInt","m","arr","split","offsetLeft","createBar","self","dir","bar","wrapper","create","props","position","overflow","right","width","opacity","backgroundColor","fontSize","MozBorderRadius","zIndex","borderRadius","transformOrigin","resetScrollBar","_fadeRule","getElementsByTagName","textContent","sheet","cssRules","f","animationDuration","wrapperH","barH","_scrollBarWrapperV","_scrollBarWrapperH","transition","fromPos","toPos","from","idx","transitionProperty","transitionDuration","transitionTimingFunction","transform","animationTimingFunction","fx","quadOut","linear","onBegin","onEnd","play","hd","l","createMask","createRoundMask","noCover","_cover","body","setSelectable","_rule","rule","deleteRule","insertRule","appendRule","call","selectable","KhtmlUserSelect","MozUserSelect","onselectstart","unselectable","setObject"],"mappings":"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","file":"../../mobile/scrollable.js","sourcesContent":["define([\r\n\t\"dojo/_base/kernel\",\r\n\t\"dojo/_base/connect\",\r\n\t\"dojo/_base/event\",\r\n\t\"dojo/_base/lang\",\r\n\t\"dojo/_base/window\",\r\n\t\"dojo/dom-class\",\r\n\t\"dojo/dom-construct\",\r\n\t\"dojo/dom-style\",\r\n\t\"dojo/dom-geometry\",\r\n\t\"dojo/touch\",\r\n\t\"dijit/registry\",\r\n\t\"dijit/form/_TextBoxMixin\",\r\n\t\"./sniff\",\r\n\t\"./_css3\",\r\n\t\"./_maskUtils\",\r\n\t\"dojo/_base/declare\",\r\n\t\"dojo/has!dojo-bidi?dojox/mobile/bidi/Scrollable\"\r\n], function(dojo, connect, event, lang, win, domClass, domConstruct, domStyle,\r\n\t\t\t domGeom, touch, registry, TextBoxMixin, has, css3, maskUtils, declare, BidiScrollable){\r\n\r\n\t// module:\r\n\t//\t\tdojox/mobile/scrollable\r\n\r\n\t// TODO: rename to Scrollable.js (capital S) for 2.0\r\n\r\n\t// TODO: shouldn't be referencing this dojox/mobile variable, would be better to require the mobile.js module\r\n\tvar dm = lang.getObject(\"dojox.mobile\", true);\r\n\r\n\t// feature detection\r\n\thas.add(\"translate3d\", function(){\r\n\t\tif(has(\"css3-animations\")){\r\n\t\t\tvar elem = win.doc.createElement(\"div\");\r\n\t\t\telem.style[css3.name(\"transform\")] = \"translate3d(0px,1px,0px)\";\r\n\t\t\twin.doc.documentElement.appendChild(elem);\r\n\t\t\tvar v = win.doc.defaultView.getComputedStyle(elem, '')[css3.name(\"transform\", true)];\r\n\t\t\tvar hasTranslate3d = v && v.indexOf(\"matrix\") === 0;\r\n\t\t\twin.doc.documentElement.removeChild(elem);\r\n\t\t\treturn hasTranslate3d;\r\n\t\t}\r\n\t});\r\n\r\n\tvar Scrollable = function(){\r\n\t\t// summary:\r\n\t\t//\t\tMixin for enabling touch scrolling capability.\r\n\t\t// description:\r\n\t\t//\t\tMixin for enabling touch scrolling capability.\r\n\t\t//\t\tMobile WebKit browsers do not allow scrolling inner DIVs. (For instance,\r\n\t\t//\t\ton iOS you need the two-finger operation to scroll them.)\r\n\t\t//\t\tThat means you cannot have fixed-positioned header/footer bars.\r\n\t\t//\t\tTo solve this issue, this module disables the browsers default scrolling\r\n\t\t//\t\tbehavior, and rebuilds its own scrolling machinery by handling touch\r\n\t\t//\t\tevents. In this module, this.domNode has height \"100%\" and is fixed to\r\n\t\t//\t\tthe window, and this.containerNode scrolls. If you place a bar outside\r\n\t\t//\t\tof this.containerNode, then it will be fixed-positioned while\r\n\t\t//\t\tthis.containerNode is scrollable.\r\n\t\t//\r\n\t\t//\t\tThis module has the following features:\r\n\t\t//\r\n\t\t//\t\t- Scrolls inner DIVs vertically, horizontally, or both.\r\n\t\t//\t\t- Vertical and horizontal scroll bars.\r\n\t\t//\t\t- Flashes the scroll bars when a view is shown.\r\n\t\t//\t\t- Simulates the flick operation using animation.\r\n\t\t//\t\t- Respects header/footer bars if any.\r\n\t};\r\n\r\n\tlang.extend(Scrollable, {\r\n\t\t// fixedHeaderHeight: Number\r\n\t\t//\t\theight of a fixed header\r\n\t\tfixedHeaderHeight: 0,\r\n\r\n\t\t// fixedFooterHeight: Number\r\n\t\t//\t\theight of a fixed footer\r\n\t\tfixedFooterHeight: 0,\r\n\r\n\t\t// isLocalFooter: Boolean\r\n\t\t//\t\tfooter is view-local (as opposed to application-wide)\r\n\t\tisLocalFooter: false,\r\n\r\n\t\t// scrollBar: Boolean\r\n\t\t//\t\tshow scroll bar or not\r\n\t\tscrollBar: true,\r\n\r\n\t\t// scrollDir: String\r\n\t\t//\t\tv: vertical, h: horizontal, vh: both, f: flip\r\n\t\tscrollDir: \"v\",\r\n\r\n\t\t// weight: Number\r\n\t\t//\t\tfrictional drag\r\n\t\tweight: 0.6,\r\n\r\n\t\t// fadeScrollBar: Boolean\r\n\t\tfadeScrollBar: true,\r\n\r\n\t\t// disableFlashScrollBar: Boolean\r\n\t\tdisableFlashScrollBar: false,\r\n\r\n\t\t// threshold: Number\r\n\t\t//\t\tdrag threshold value in pixels\r\n\t\tthreshold: 4,\r\n\r\n\t\t// constraint: Boolean\r\n\t\t//\t\tbounce back to the content area\r\n\t\tconstraint: true,\r\n\r\n\t\t// touchNode: DOMNode\r\n\t\t//\t\ta node that will have touch event handlers\r\n\t\ttouchNode: null,\r\n\r\n\t\t// propagatable: Boolean\r\n\t\t//\t\tlet touchstart event propagate up\r\n\t\tpropagatable: true,\r\n\r\n\t\t// dirLock: Boolean\r\n\t\t//\t\tdisable the move handler if scroll starts in the unexpected direction\r\n\t\tdirLock: false,\r\n\r\n\t\t// height: String\r\n\t\t//\t\texplicitly specified height of this widget (ex. \"300px\")\r\n\t\theight: \"\",\r\n\r\n\t\t// scrollType: Number\r\n\t\t//\t\t- 1: use (-webkit-)transform:translate3d(x,y,z) style, use (-webkit-)animation for slide animation\r\n\t\t//\t\t- 2: use top/left style,\r\n\t\t//\t\t- 3: use (-webkit-)transform:translate3d(x,y,z) style, use (-webkit-)transition for slide animation\r\n\t\t//\t\t- 0: use default value (3 for Android, iOS6+, and BlackBerry; otherwise 1)\r\n\t\tscrollType: 0,\r\n\t\t\r\n\t\t// _parentPadBorderExtentsBottom: [private] Number\r\n\t\t//\t\tFor Tooltip.js.\r\n\t\t_parentPadBorderExtentsBottom: 0,\r\n\r\n\t\t// _moved: [private] Boolean\r\n\t\t//\t\tFlag that signals if the user have moved in (one of) the scroll\r\n\t\t//\t\tdirection(s) since touch start (a move under the threshold is ignored).\r\n\t\t_moved: false,\r\n\r\n\t\tinit: function(/*Object?*/params){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tInitialize according to the given params.\r\n\t\t\t// description:\r\n\t\t\t//\t\tMixes in the given params into this instance. At least domNode\r\n\t\t\t//\t\tand containerNode have to be given.\r\n\t\t\t//\t\tStarts listening to the touchstart events.\r\n\t\t\t//\t\tCalls resize(), if this widget is a top level widget.\r\n\t\t\tif(params){\r\n\t\t\t\tfor(var p in params){\r\n\t\t\t\t\tif(params.hasOwnProperty(p)){\r\n\t\t\t\t\t\tthis[p] = ((p == \"domNode\" || p == \"containerNode\") && typeof params[p] == \"string\") ?\r\n\t\t\t\t\t\t\twin.doc.getElementById(params[p]) : params[p]; // mix-in params\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// prevent browser scrolling on IE10 (evt.preventDefault() is not enough)\r\n\t\t\tif(typeof this.domNode.style.msTouchAction != \"undefined\"){\r\n\t\t\t\tthis.domNode.style.msTouchAction = \"none\";\r\n\t\t\t}\r\n\t\t\tthis.touchNode = this.touchNode || this.containerNode;\r\n\t\t\tthis._v = (this.scrollDir.indexOf(\"v\") != -1); // vertical scrolling\r\n\t\t\tthis._h = (this.scrollDir.indexOf(\"h\") != -1); // horizontal scrolling\r\n\t\t\tthis._f = (this.scrollDir == \"f\"); // flipping views\r\n\r\n\t\t\tthis._ch = []; // connect handlers\r\n\t\t\tthis._ch.push(connect.connect(this.touchNode, touch.press, this, \"onTouchStart\"));\r\n\t\t\tif(has(\"css3-animations\")){\r\n\t\t\t\t// flag for whether to use -webkit-transform:translate3d(x,y,z) or top/left style.\r\n\t\t\t\t// top/left style works fine as a workaround for input fields auto-scrolling issue,\r\n\t\t\t\t// so use top/left in case of Android by default.\r\n\t\t\t\tthis._useTopLeft = this.scrollType ? this.scrollType === 2 : false;\r\n\t\t\t\t// Flag for using webkit transition on transform, instead of animation + keyframes.\r\n\t\t\t\t// (keyframes create a slight delay before the slide animation...)\r\n\t\t\t\tif(!this._useTopLeft){\r\n\t\t\t\t\tthis._useTransformTransition = \r\n\t\t\t\t\t\tthis.scrollType ? this.scrollType === 3 : has(\"ios\") >= 6 || has(\"android\") || has(\"bb\");\r\n\t\t\t\t}\r\n\t\t\t\tif(!this._useTopLeft){\r\n\t\t\t\t\tif(this._useTransformTransition){\r\n\t\t\t\t\t\tthis._ch.push(connect.connect(this.containerNode, css3.name(\"transitionEnd\"), this, \"onFlickAnimationEnd\"));\r\n\t\t\t\t\t\t// Note that there is no transitionstart event (#17822).\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tthis._ch.push(connect.connect(this.containerNode, css3.name(\"animationEnd\"), this, \"onFlickAnimationEnd\"));\r\n\t\t\t\t\t\tthis._ch.push(connect.connect(this.containerNode, css3.name(\"animationStart\"), this, \"onFlickAnimationStart\"));\r\n\t\r\n\t\t\t\t\t\t// Creation of keyframes takes a little time. If they are created\r\n\t\t\t\t\t\t// in a lazy manner, a slight delay is noticeable when you start\r\n\t\t\t\t\t\t// scrolling for the first time. This is to create keyframes up front.\r\n\t\t\t\t\t\tfor(var i = 0; i < 3; i++){\r\n\t\t\t\t\t\t\tthis.setKeyframes(null, null, i);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(has(\"translate3d\")){ // workaround for flicker issue on iPhone and Android 3.x/4.0\r\n\t\t\t\t\t\tdomStyle.set(this.containerNode, css3.name(\"transform\"), \"translate3d(0,0,0)\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis._ch.push(connect.connect(this.containerNode, css3.name(\"transitionEnd\"), this, \"onFlickAnimationEnd\"));\r\n\t\t\t\t\t// Note that there is no transitionstart event (#17822).\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis._speed = {x:0, y:0};\r\n\t\t\tthis._appFooterHeight = 0;\r\n\t\t\tif(this.isTopLevel() && !this.noResize){\r\n\t\t\t\tthis.resize();\r\n\t\t\t}\r\n\t\t\tvar _this = this;\r\n\t\t\tsetTimeout(function(){ \r\n\t\t\t\t// Why not using widget.defer() instead of setTimeout()? Because this module\r\n\t\t\t\t// is not always mixed into a widget (ex. dojox/mobile/_ComboBoxMenu), and adding \r\n\t\t\t\t// a check to call either defer or setTimeout has been considered overkill.\r\n\t\t\t\t_this.flashScrollBar();\r\n\t\t\t}, 600);\r\n\t\t\t\r\n\t\t\t// #16363: while navigating among input field using TAB (desktop keyboard) or \r\n\t\t\t// NEXT (mobile soft keyboard), domNode.scrollTop gets modified (this holds even \r\n\t\t\t// if the text widget has selectOnFocus at false, that is even if dijit's _FormWidgetMixin._onFocus \r\n\t\t\t// does not trigger a global scrollIntoView). This messes up ScrollableView's own \r\n\t\t\t// scrolling machinery. To avoid this misbehavior:\r\n\t\t\tif(win.global.addEventListener){ // all supported browsers but IE8\r\n\t\t\t\t// (for IE8, using attachEvent is not a solution, because it only works in bubbling phase)\r\n\t\t\t\tthis._onScroll = function(e){\r\n\t\t\t\t\tif(!_this.domNode || _this.domNode.style.display === 'none'){ return; }\r\n\t\t\t\t\tvar scrollTop = _this.domNode.scrollTop;\r\n\t\t\t\t\tvar scrollLeft = _this.domNode.scrollLeft; \r\n\t\t\t\t\tvar pos;\r\n\t\t\t\t\tif(scrollTop > 0 || scrollLeft > 0){ \r\n\t\t\t\t\t\tpos = _this.getPos(); \r\n\t\t\t\t\t\t// Reset to zero while compensating using our own scroll: \r\n\t\t\t\t\t\t_this.domNode.scrollLeft = 0; \r\n\t\t\t\t\t\t_this.domNode.scrollTop = 0; \r\n\t\t\t\t\t\t_this.scrollTo({x: pos.x - scrollLeft, y: pos.y - scrollTop}); // no animation \r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\twin.global.addEventListener(\"scroll\", this._onScroll, true);\r\n\t\t\t}\r\n\t\t\t// #17062: Ensure auto-scroll when navigating focusable fields\r\n\t\t\tif(!this.disableTouchScroll && this.domNode.addEventListener){\r\n\t\t\t\tthis._onFocusScroll = function(e){\r\n\t\t\t\t\tif(!_this.domNode || _this.domNode.style.display === 'none'){ return; }\r\n\t\t\t\t\tvar node = win.doc.activeElement;\r\n\t\t\t\t\tvar nodeRect, scrollableRect;\r\n\t\t\t\t\tif(node){\r\n\t\t\t\t\t\tnodeRect = node.getBoundingClientRect();\r\n\t\t\t\t\t\tscrollableRect = _this.domNode.getBoundingClientRect();\r\n\t\t\t\t\t\tif(nodeRect.height < _this.getDim().d.h){\r\n\t\t\t\t\t\t\t// do not call scrollIntoView for elements with a height\r\n\t\t\t\t\t\t\t// larger than the height of scrollable's content display\r\n\t\t\t\t\t\t\t// area (it would be ergonomically harmful).\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif(nodeRect.top < (scrollableRect.top + _this.fixedHeaderHeight)){\r\n\t\t\t\t\t\t\t\t// scrolling towards top (to bring into the visible area an element\r\n\t\t\t\t\t\t\t\t// located above it).\r\n\t\t\t\t\t\t\t\t_this.scrollIntoView(node, true);\r\n\t\t\t\t\t\t\t}else if((nodeRect.top + nodeRect.height) > \r\n\t\t\t\t\t\t\t\t(scrollableRect.top + scrollableRect.height - _this.fixedFooterHeight)){\r\n\t\t\t\t\t\t\t\t// scrolling towards bottom (to bring into the visible area an element\r\n\t\t\t\t\t\t\t\t// located below it).\r\n\t\t\t\t\t\t\t\t_this.scrollIntoView(node, false);\r\n\t\t\t\t\t\t\t} // else do nothing (the focused node is already visible)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tthis.domNode.addEventListener(\"focus\", this._onFocusScroll, true);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tisTopLevel: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tReturns true if this is a top-level widget.\r\n\t\t\t// description:\r\n\t\t\t//\t\tSubclass may want to override.\r\n\t\t\treturn true;\r\n\t\t},\r\n\r\n\t\tcleanup: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tUninitialize the module.\r\n\t\t\tif(this._ch){\r\n\t\t\t\tfor(var i = 0; i < this._ch.length; i++){\r\n\t\t\t\t\tconnect.disconnect(this._ch[i]);\r\n\t\t\t\t}\r\n\t\t\t\tthis._ch = null;\r\n\t\t\t}\r\n\t\t\tif(this._onScroll && win.global.removeEventListener){ // all supported browsers but IE8\r\n\t\t\t\twin.global.removeEventListener(\"scroll\", this._onScroll, true);\r\n\t\t\t\tthis._onScroll = null;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(this._onFocusScroll && this.domNode.removeEventListener){\r\n\t\t\t\tthis.domNode.removeEventListener(\"focus\", this._onFocusScroll, true);\r\n\t\t\t\tthis._onFocusScroll = null;\r\n\t\t\t} \r\n\t\t},\r\n\r\n\t\tfindDisp: function(/*DomNode*/node){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tFinds the currently displayed view node from my sibling nodes.\r\n\t\t\tif(!node.parentNode){ return null; }\r\n\r\n\t\t\t// the given node is the first candidate\r\n\t\t\tif(node.nodeType === 1 && domClass.contains(node, \"mblSwapView\") && node.style.display !== \"none\"){\r\n\t\t\t\treturn node;\r\n\t\t\t}\r\n\r\n\t\t\tvar nodes = node.parentNode.childNodes;\r\n\t\t\tfor(var i = 0; i < nodes.length; i++){\r\n\t\t\t\tvar n = nodes[i];\r\n\t\t\t\tif(n.nodeType === 1 && domClass.contains(n, \"mblView\") && n.style.display !== \"none\"){\r\n\t\t\t\t\treturn n;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn node;\r\n\t\t},\r\n\r\n\t\tgetScreenSize: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tReturns the dimensions of the browser window.\r\n\t\t\treturn {\r\n\t\t\t\th: win.global.innerHeight||win.doc.documentElement.clientHeight||win.doc.documentElement.offsetHeight,\r\n\t\t\t\tw: win.global.innerWidth||win.doc.documentElement.clientWidth||win.doc.documentElement.offsetWidth\r\n\t\t\t};\r\n\t\t},\r\n\r\n\t\tresize: function(e){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tAdjusts the height of the widget.\r\n\t\t\t// description:\r\n\t\t\t//\t\tIf the height property is 'inherit', the height is inherited\r\n\t\t\t//\t\tfrom its offset parent. If 'auto', the content height, which\r\n\t\t\t//\t\tcould be smaller than the entire screen height, is used. If an\r\n\t\t\t//\t\texplicit height value (ex. \"300px\"), it is used as the new\r\n\t\t\t//\t\theight. If nothing is specified as the height property, from the\r\n\t\t\t//\t\tcurrent top position of the widget to the bottom of the screen\r\n\t\t\t//\t\twill be the new height.\r\n\r\n\t\t\t// moved from init() to support dynamically added fixed bars\r\n\t\t\tthis._appFooterHeight = (this._fixedAppFooter) ? this._fixedAppFooter.offsetHeight : 0;\r\n\t\t\tif(this.isLocalHeader){\r\n\t\t\t\tthis.containerNode.style.marginTop = this.fixedHeaderHeight + \"px\";\r\n\t\t\t}\r\n\r\n\t\t\t// Get the top position. Same as dojo.position(node, true).y\r\n\t\t\tvar top = 0;\r\n\t\t\tfor(var n = this.domNode; n && n.tagName != \"BODY\"; n = n.offsetParent){\r\n\t\t\t\tn = this.findDisp(n); // find the first displayed view node\r\n\t\t\t\tif(!n){ break; }\r\n\t\t\t\ttop += n.offsetTop + domGeom.getBorderExtents(n).h;\r\n\t\t\t}\r\n\r\n\t\t\t// adjust the height of this view\r\n\t\t\tvar\th,\r\n\t\t\t\tscreenHeight = this.getScreenSize().h,\r\n\t\t\t\tdh = screenHeight - top - this._appFooterHeight; // default height\r\n\t\t\tif(this.height === \"inherit\"){\r\n\t\t\t\tif(this.domNode.offsetParent){\r\n\t\t\t\t\th = domGeom.getContentBox(this.domNode.offsetParent).h - domGeom.getBorderExtents(this.domNode).h + \"px\";\r\n\t\t\t\t}\r\n\t\t\t}else if(this.height === \"auto\"){\r\n\t\t\t\tvar parent = this.domNode.offsetParent;\r\n\t\t\t\tif(parent){\r\n\t\t\t\t\tthis.domNode.style.height = \"0px\";\r\n\t\t\t\t\tvar\tparentRect = parent.getBoundingClientRect(),\r\n\t\t\t\t\t\tscrollableRect = this.domNode.getBoundingClientRect(),\r\n\t\t\t\t\t\tcontentBottom = parentRect.bottom - this._appFooterHeight - this._parentPadBorderExtentsBottom;\r\n\t\t\t\t\tif(scrollableRect.bottom >= contentBottom){ // use entire screen\r\n\t\t\t\t\t\tdh = screenHeight - (scrollableRect.top - parentRect.top) - this._appFooterHeight - this._parentPadBorderExtentsBottom;\r\n\t\t\t\t\t}else{ // stretch to fill predefined area\r\n\t\t\t\t\t\tdh = contentBottom - scrollableRect.bottom;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// content could be smaller than entire screen height\r\n\t\t\t\tvar contentHeight = Math.max(this.domNode.scrollHeight, this.containerNode.scrollHeight);\r\n\t\t\t\th = (contentHeight ? Math.min(contentHeight, dh) : dh) + \"px\";\r\n\t\t\t}else if(this.height){\r\n\t\t\t\th = this.height;\r\n\t\t\t}\r\n\t\t\tif(!h){\r\n\t\t\t\th = dh + \"px\";\r\n\t\t\t}\r\n\t\t\tif(h.charAt(0) !== \"-\" && // to ensure that h is not negative (e.g. \"-10px\")\r\n\t\t\t\th !== \"default\"){\r\n\t\t\t\tthis.domNode.style.height = h;\r\n\t\t\t}\r\n\r\n\t\t\tif(!this._conn){\r\n\t\t\t\t// to ensure that the view is within a scrolling area when resized.\r\n\t\t\t\tthis.onTouchEnd();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tonFlickAnimationStart: function(e){\r\n\t\t\tif(e){\r\n\t\t\t\tevent.stop(e);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tonFlickAnimationEnd: function(e){\r\n\t\t\tif(has(\"ios\")){\r\n\t\t\t\tthis._keepInputCaretInActiveElement();\r\n\t\t\t}\r\n\t\t\tif(e){\r\n\t\t\t\tvar an = e.animationName;\r\n\t\t\t\tif(an && an.indexOf(\"scrollableViewScroll2\") === -1){\r\n\t\t\t\t\tif(an.indexOf(\"scrollableViewScroll0\") !== -1){ // scrollBarV\r\n\t\t\t\t\t\tif(this._scrollBarNodeV){ domClass.remove(this._scrollBarNodeV, \"mblScrollableScrollTo0\"); }\r\n\t\t\t\t\t}else if(an.indexOf(\"scrollableViewScroll1\") !== -1){ // scrollBarH\r\n\t\t\t\t\t\tif(this._scrollBarNodeH){ domClass.remove(this._scrollBarNodeH, \"mblScrollableScrollTo1\"); }\r\n\t\t\t\t\t}else{ // fade or others\r\n\t\t\t\t\t\tif(this._scrollBarNodeV){ this._scrollBarNodeV.className = \"\"; }\r\n\t\t\t\t\t\tif(this._scrollBarNodeH){ this._scrollBarNodeH.className = \"\"; }\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif(this._useTransformTransition || this._useTopLeft){\r\n\t\t\t\t\tvar n = e.target;\r\n\t\t\t\t\tif(n === this._scrollBarV || n === this._scrollBarH){\r\n\t\t\t\t\t\tvar cls = \"mblScrollableScrollTo\" + (n === this._scrollBarV ? \"0\" : \"1\");\r\n\t\t\t\t\t\tif(domClass.contains(n, cls)){\r\n\t\t\t\t\t\t\tdomClass.remove(n, cls);\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tn.className = \"\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(e.srcElement){\r\n\t\t\t\t\tevent.stop(e);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.stopAnimation();\r\n\t\t\tif(this._bounce){\r\n\t\t\t\tvar _this = this;\r\n\t\t\t\tvar bounce = _this._bounce;\r\n\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t_this.slideTo(bounce, 0.3, \"ease-out\");\r\n\t\t\t\t}, 0);\r\n\t\t\t\t_this._bounce = undefined;\r\n\t\t\t}else{\r\n\t\t\t\tthis.hideScrollBar();\r\n\t\t\t\tthis.removeCover();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tisFormElement: function(/*DOMNode*/node){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tReturns true if the given node is a form control.\r\n\t\t\tif(node && node.nodeType !== 1){ node = node.parentNode; }\r\n\t\t\tif(!node || node.nodeType !== 1){ return false; }\r\n\t\t\tvar t = node.tagName;\r\n\t\t\treturn (t === \"SELECT\" || t === \"INPUT\" || t === \"TEXTAREA\" || t === \"BUTTON\");\r\n\t\t},\r\n\r\n\t\tonTouchStart: function(e){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tUser-defined function to handle touchStart events.\r\n\t\t\tif(this.disableTouchScroll){ return; }\r\n\t\t\tif(this._conn && (new Date()).getTime() - this.startTime < 500){\r\n\t\t\t\treturn; // ignore successive onTouchStart calls\r\n\t\t\t}\r\n\t\t\tif(!this._conn){\r\n\t\t\t\tthis._conn = [];\r\n\t\t\t\tthis._conn.push(connect.connect(win.doc, touch.move, this, \"onTouchMove\"));\r\n\t\t\t\tthis._conn.push(connect.connect(win.doc, touch.release, this, \"onTouchEnd\"));\r\n\t\t\t}\r\n\r\n\t\t\tthis._aborted = false;\r\n\t\t\tif(domClass.contains(this.containerNode, \"mblScrollableScrollTo2\")){\r\n\t\t\t\tthis.abort();\r\n\t\t\t}else{ // reset scrollbar class especially for reseting fade-out animation\r\n\t\t\t\tif(this._scrollBarNodeV){ this._scrollBarNodeV.className = \"\"; }\r\n\t\t\t\tif(this._scrollBarNodeH){ this._scrollBarNodeH.className = \"\"; }\r\n\t\t\t}\r\n\t\t\tthis.touchStartX = e.touches ? e.touches[0].pageX : e.clientX;\r\n\t\t\tthis.touchStartY = e.touches ? e.touches[0].pageY : e.clientY;\r\n\t\t\tthis.startTime = (new Date()).getTime();\r\n\t\t\tthis.startPos = this.getPos();\r\n\t\t\tthis._dim = this.getDim();\r\n\t\t\tthis._time = [0];\r\n\t\t\tthis._posX = [this.touchStartX];\r\n\t\t\tthis._posY = [this.touchStartY];\r\n\t\t\tthis._locked = false;\r\n\t\t\tthis._moved = false;\r\n\r\n\t\t\tthis._preventDefaultInNextTouchMove = true; // #17502\r\n\t\t\tif(!this.isFormElement(e.target)){\r\n\t\t\t\t// Call preventDefault to avoid browser scroll, except for form elements \r\n\t\t\t\t// for which doing it in touch.press would forbid the virtual keyboard \r\n\t\t\t\t// from showing up (for form elements which are text widgets, preventDefault\r\n\t\t\t\t// is called in touch.move). \r\n\t\t\t\tthis.propagatable ? e.preventDefault() : event.stop(e);\r\n\t\t\t\tthis._preventDefaultInNextTouchMove = false;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tonTouchMove: function(e){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tUser-defined function to handle touchMove events.\r\n\t\t\tif(this._locked){ return; }\r\n\t\t\t\r\n\t\t\tif(this._preventDefaultInNextTouchMove){ // #17502\r\n\t\t\t\tthis._preventDefaultInNextTouchMove = false; // only in the first touch.move\r\n\t\t\t\tvar enclosingWidget = registry.getEnclosingWidget(\r\n\t\t\t\t\t// On touch-enabled devices, e.target can be different in touch.move than in\r\n\t\t\t\t\t// touch.start. Hence:\r\n\t\t\t\t\t((e.targetTouches && e.targetTouches.length === 1) ? e.targetTouches[0] : e).target);\r\n\t\t\t\tif(enclosingWidget && enclosingWidget.isInstanceOf(TextBoxMixin)){\r\n\t\t\t\t\t// For touches on text widgets for which e.preventDefault() has not been\r\n\t\t\t\t\t// called in onTouchStart, call it in onTouchMove() to avoid browser scroll.\r\n\t\t\t\t\t// Not done on other elements such that for instance a native slider\r\n\t\t\t\t\t// can still handle touchmove events.\r\n\t\t\t\t\tthis.propagatable ? e.preventDefault() : event.stop(e);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar x = e.touches ? e.touches[0].pageX : e.clientX;\r\n\t\t\tvar y = e.touches ? e.touches[0].pageY : e.clientY;\r\n\t\t\tvar dx = x - this.touchStartX;\r\n\t\t\tvar dy = y - this.touchStartY;\r\n\t\t\tvar to = {x:this.startPos.x + dx, y:this.startPos.y + dy};\r\n\t\t\tvar dim = this._dim;\r\n\r\n\t\t\tdx = Math.abs(dx);\r\n\t\t\tdy = Math.abs(dy);\r\n\t\t\tif(this._time.length == 1){ // the first TouchMove after TouchStart\r\n\t\t\t\tif(this.dirLock){\r\n\t\t\t\t\tif(this._v && !this._h && dx >= this.threshold && dx >= dy ||\r\n\t\t\t\t\t\t(this._h || this._f) && !this._v && dy >= this.threshold && dy >= dx){\r\n\t\t\t\t\t\tthis._locked = true;\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(this._v && this._h){ // scrollDir=\"hv\"\r\n\t\t\t\t\tif(dy < this.threshold &&\r\n\t\t\t\t\t\tdx < this.threshold){\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}else{\r\n\t\t\t\t\tif(this._v && dy < this.threshold ||\r\n\t\t\t\t\t\t(this._h || this._f) && dx < this.threshold){\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis._moved = true;\r\n\t\t\t\tthis.addCover();\r\n\t\t\t\tthis.showScrollBar();\r\n\t\t\t}\r\n\r\n\t\t\tvar weight = this.weight;\r\n\t\t\tif(this._v && this.constraint){\r\n\t\t\t\tif(to.y > 0){ // content is below the screen area\r\n\t\t\t\t\tto.y = Math.round(to.y * weight);\r\n\t\t\t\t}else if(to.y < -dim.o.h){ // content is above the screen area\r\n\t\t\t\t\tif(dim.c.h < dim.d.h){ // content is shorter than display\r\n\t\t\t\t\t\tto.y = Math.round(to.y * weight);\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tto.y = -dim.o.h - Math.round((-dim.o.h - to.y) * weight);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif((this._h || this._f) && this.constraint){\r\n\t\t\t\tif(to.x > 0){\r\n\t\t\t\t\tto.x = Math.round(to.x * weight);\r\n\t\t\t\t}else if(to.x < -dim.o.w){\r\n\t\t\t\t\tif(dim.c.w < dim.d.w){\r\n\t\t\t\t\t\tto.x = Math.round(to.x * weight);\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tto.x = -dim.o.w - Math.round((-dim.o.w - to.x) * weight);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.scrollTo(to);\r\n\r\n\t\t\tvar max = 10;\r\n\t\t\tvar n = this._time.length; // # of samples\r\n\t\t\tif(n >= 2){\r\n\t\t\t\tthis._moved = true;\r\n\t\t\t\t// Check the direction of the finger move.\r\n\t\t\t\t// If the direction has been changed, discard the old data.\r\n\t\t\t\tvar d0, d1;\r\n\t\t\t\tif(this._v && !this._h){\r\n\t\t\t\t\td0 = this._posY[n - 1] - this._posY[n - 2];\r\n\t\t\t\t\td1 = y - this._posY[n - 1];\r\n\t\t\t\t}else if(!this._v && this._h){\r\n\t\t\t\t\td0 = this._posX[n - 1] - this._posX[n - 2];\r\n\t\t\t\t\td1 = x - this._posX[n - 1];\r\n\t\t\t\t}\r\n\t\t\t\tif(d0 * d1 < 0){ // direction changed\r\n\t\t\t\t\t// leave only the latest data\r\n\t\t\t\t\tthis._time = [this._time[n - 1]];\r\n\t\t\t\t\tthis._posX = [this._posX[n - 1]];\r\n\t\t\t\t\tthis._posY = [this._posY[n - 1]];\r\n\t\t\t\t\tn = 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(n == max){\r\n\t\t\t\tthis._time.shift();\r\n\t\t\t\tthis._posX.shift();\r\n\t\t\t\tthis._posY.shift();\r\n\t\t\t}\r\n\t\t\tthis._time.push((new Date()).getTime() - this.startTime);\r\n\t\t\tthis._posX.push(x);\r\n\t\t\tthis._posY.push(y);\r\n\t\t},\r\n\r\n\t\t_keepInputCaretInActiveElement: function(){\r\n\t\t\tvar activeElement = win.doc.activeElement;\r\n\t\t\tvar initialValue;\r\n\t\t\tif(activeElement && (activeElement.tagName == \"INPUT\" || activeElement.tagName == \"TEXTAREA\")){\r\n\t\t\t\tinitialValue = activeElement.value;\r\n\t\t\t\tif(activeElement.type == \"number\" || activeElement.type == \"week\"){\r\n\t\t\t\t\tif(initialValue){\r\n\t\t\t\t\t\tactiveElement.value = activeElement.value + 1;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tactiveElement.value = (activeElement.type == \"week\") ? \"2013-W10\" : 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tactiveElement.value = initialValue;\r\n\t\t\t\t}else{\r\n\t\t\t\t\tactiveElement.value = activeElement.value + \" \";\r\n\t\t\t\t\tactiveElement.value = initialValue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tonTouchEnd: function(/*Event*/e){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tUser-defined function to handle touchEnd events.\r\n\t\t\tif(this._locked){ return; }\r\n\t\t\tvar speed = this._speed = {x:0, y:0};\r\n\t\t\tvar dim = this._dim;\r\n\t\t\tvar pos = this.getPos();\r\n\t\t\tvar to = {}; // destination\r\n\t\t\tif(e){\r\n\t\t\t\tif(!this._conn){ return; } // if we get onTouchEnd without onTouchStart, ignore it.\r\n\t\t\t\tfor(var i = 0; i < this._conn.length; i++){\r\n\t\t\t\t\tconnect.disconnect(this._conn[i]);\r\n\t\t\t\t}\r\n\t\t\t\tthis._conn = null;\r\n\r\n\t\t\t\tvar clicked = false;\r\n\t\t\t\tif(!this._aborted && !this._moved){\r\n\t\t\t\t\tclicked = true;\r\n\t\t\t\t}\r\n\t\t\t\tif(clicked){ // clicked, not dragged or flicked\r\n\t\t\t\t\tthis.hideScrollBar();\r\n\t\t\t\t\tthis.removeCover();\r\n\t\t\t\t\t// need to send a synthetic click?\r\n\t\t\t\t\tif(has(\"touch\") && has(\"clicks-prevented\") && !this.isFormElement(e.target)){\r\n\t\t\t\t\t\tvar elem = e.target;\r\n\t\t\t\t\t\tif(elem.nodeType != 1){\r\n\t\t\t\t\t\t\telem = elem.parentNode;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\tdm._sendClick(elem, e);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tspeed = this._speed = this.getSpeed();\r\n\t\t\t}else{\r\n\t\t\t\tif(pos.x == 0 && pos.y == 0){ return; } // initializing\r\n\t\t\t\tdim = this.getDim();\r\n\t\t\t}\r\n\r\n\t\t\tif(this._v){\r\n\t\t\t\tto.y = pos.y + speed.y;\r\n\t\t\t}\r\n\t\t\tif(this._h || this._f){\r\n\t\t\t\tto.x = pos.x + speed.x;\r\n\t\t\t}\r\n\r\n\t\t\tif(this.adjustDestination(to, pos, dim) === false){ return; }\r\n\t\t\tif(this.constraint){\r\n\t\t\t\tif(this.scrollDir == \"v\" && dim.c.h < dim.d.h){ // content is shorter than display\r\n\t\t\t\t\tthis.slideTo({y:0}, 0.3, \"ease-out\"); // go back to the top\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}else if(this.scrollDir == \"h\" && dim.c.w < dim.d.w){ // content is narrower than display\r\n\t\t\t\t\tthis.slideTo({x:0}, 0.3, \"ease-out\"); // go back to the left\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}else if(this._v && this._h && dim.c.h < dim.d.h && dim.c.w < dim.d.w){\r\n\t\t\t\t\tthis.slideTo({x:0, y:0}, 0.3, \"ease-out\"); // go back to the top-left\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar duration, easing = \"ease-out\";\r\n\t\t\tvar bounce = {};\r\n\t\t\tif(this._v && this.constraint){\r\n\t\t\t\tif(to.y > 0){ // going down. bounce back to the top.\r\n\t\t\t\t\tif(pos.y > 0){ // started from below the screen area. return quickly.\r\n\t\t\t\t\t\tduration = 0.3;\r\n\t\t\t\t\t\tto.y = 0;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tto.y = Math.min(to.y, 20);\r\n\t\t\t\t\t\teasing = \"linear\";\r\n\t\t\t\t\t\tbounce.y = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t}else if(-speed.y > dim.o.h - (-pos.y)){ // going up. bounce back to the bottom.\r\n\t\t\t\t\tif(pos.y < -dim.o.h){ // started from above the screen top. return quickly.\r\n\t\t\t\t\t\tduration = 0.3;\r\n\t\t\t\t\t\tto.y = dim.c.h <= dim.d.h ? 0 : -dim.o.h; // if shorter, move to 0\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tto.y = Math.max(to.y, -dim.o.h - 20);\r\n\t\t\t\t\t\teasing = \"linear\";\r\n\t\t\t\t\t\tbounce.y = -dim.o.h;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif((this._h || this._f) && this.constraint){\r\n\t\t\t\tif(to.x > 0){ // going right. bounce back to the left.\r\n\t\t\t\t\tif(pos.x > 0){ // started from right of the screen area. return quickly.\r\n\t\t\t\t\t\tduration = 0.3;\r\n\t\t\t\t\t\tto.x = 0;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tto.x = Math.min(to.x, 20);\r\n\t\t\t\t\t\teasing = \"linear\";\r\n\t\t\t\t\t\tbounce.x = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t}else if(-speed.x > dim.o.w - (-pos.x)){ // going left. bounce back to the right.\r\n\t\t\t\t\tif(pos.x < -dim.o.w){ // started from left of the screen top. return quickly.\r\n\t\t\t\t\t\tduration = 0.3;\r\n\t\t\t\t\t\tto.x = dim.c.w <= dim.d.w ? 0 : -dim.o.w; // if narrower, move to 0\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tto.x = Math.max(to.x, -dim.o.w - 20);\r\n\t\t\t\t\t\teasing = \"linear\";\r\n\t\t\t\t\t\tbounce.x = -dim.o.w;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis._bounce = (bounce.x !== undefined || bounce.y !== undefined) ? bounce : undefined;\r\n\r\n\t\t\tif(duration === undefined){\r\n\t\t\t\tvar distance, velocity;\r\n\t\t\t\tif(this._v && this._h){\r\n\t\t\t\t\tvelocity = Math.sqrt(speed.x*speed.x + speed.y*speed.y);\r\n\t\t\t\t\tdistance = Math.sqrt(Math.pow(to.y - pos.y, 2) + Math.pow(to.x - pos.x, 2));\r\n\t\t\t\t}else if(this._v){\r\n\t\t\t\t\tvelocity = speed.y;\r\n\t\t\t\t\tdistance = to.y - pos.y;\r\n\t\t\t\t}else if(this._h){\r\n\t\t\t\t\tvelocity = speed.x;\r\n\t\t\t\t\tdistance = to.x - pos.x;\r\n\t\t\t\t}\r\n\t\t\t\tif(distance === 0 && !e){ return; } // #13154\r\n\t\t\t\tduration = velocity !== 0 ? Math.abs(distance / velocity) : 0.01; // time = distance / velocity\r\n\t\t\t}\r\n\t\t\tthis.slideTo(to, duration, easing);\r\n\t\t},\r\n\r\n\t\tadjustDestination: function(/*Object*/to, /*Object*/pos, /*Object*/dim){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tA stub function to be overridden by subclasses.\r\n\t\t\t// description:\r\n\t\t\t//\t\tThis function is called from onTouchEnd(). The purpose is to give its\r\n\t\t\t//\t\tsubclasses a chance to adjust the destination position. If this\r\n\t\t\t//\t\tfunction returns false, onTouchEnd() returns immediately without\r\n\t\t\t//\t\tperforming scroll.\r\n\t\t\t// to:\r\n\t\t\t//\t\tThe destination position. An object with x and y.\r\n\t\t\t// pos:\r\n\t\t\t//\t\tThe current position. An object with x and y.\r\n\t\t\t// dim:\r\n\t\t\t//\t\tDimension information returned by getDim().\t\t\t\r\n\r\n\t\t\t// subclass may want to implement\r\n\t\t\treturn true; // Boolean\r\n\t\t},\r\n\r\n\t\tabort: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tAborts scrolling.\r\n\t\t\t// description:\r\n\t\t\t//\t\tThis function stops the scrolling animation that is currently\r\n\t\t\t//\t\trunning. It is called when the user touches the screen while\r\n\t\t\t//\t\tscrolling.\r\n\t\t\tthis._aborted = true;\r\n\t\t\tthis.scrollTo(this.getPos());\r\n\t\t\tthis.stopAnimation();\r\n\t\t},\r\n\r\n\t\tstopAnimation: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tStops the currently running animation.\r\n\t\t\tdomClass.remove(this.containerNode, \"mblScrollableScrollTo2\");\r\n\t\t\tif(this._scrollBarV){\r\n\t\t\t\tthis._scrollBarV.className = \"\";\r\n\t\t\t}\r\n\t\t\tif(this._scrollBarH){\r\n\t\t\t\tthis._scrollBarH.className = \"\";\r\n\t\t\t}\r\n\t\t\tif(this._useTransformTransition || this._useTopLeft){\r\n\t\t\t\tthis.containerNode.style[css3.name(\"transition\")] = \"\";\r\n\t\t\t\tif(this._scrollBarV) { this._scrollBarV.style[css3.name(\"transition\")] = \"\"; }\r\n\t\t\t\tif(this._scrollBarH) { this._scrollBarH.style[css3.name(\"transition\")] = \"\"; }\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tscrollIntoView: function(/*DOMNode*/node, /*Boolean?*/alignWithTop, /*Number?*/duration){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tScrolls the pane until the searching node is in the view.\r\n\t\t\t// node:\r\n\t\t\t//\t\tA DOM node to be searched for view.\r\n\t\t\t// alignWithTop:\r\n\t\t\t//\t\tIf true, aligns the node at the top of the pane.\r\n\t\t\t//\t\tIf false, aligns the node at the bottom of the pane.\r\n\t\t\t// duration:\r\n\t\t\t//\t\tDuration of scrolling in seconds. (ex. 0.3)\r\n\t\t\t//\t\tIf not specified, scrolls without animation.\r\n\t\t\t// description:\r\n\t\t\t//\t\tJust like the scrollIntoView method of DOM elements, this\r\n\t\t\t//\t\tfunction causes the given node to scroll into view, aligning it\r\n\t\t\t//\t\teither at the top or bottom of the pane.\r\n\r\n\t\t\tif(!this._v){ return; } // cannot scroll vertically\r\n\r\n\t\t\tvar c = this.containerNode,\r\n\t\t\t\th = this.getDim().d.h, // the height of ScrollableView's content display area\r\n\t\t\t\ttop = 0;\r\n\r\n\t\t\t// Get the top position of node relative to containerNode\r\n\t\t\tfor(var n = node; n !== c; n = n.offsetParent){\r\n\t\t\t\tif(!n || n.tagName === \"BODY\"){ return; } // exit if node is not a child of scrollableView\r\n\t\t\t\ttop += n.offsetTop;\r\n\t\t\t}\r\n\t\t\t// Calculate scroll destination position\r\n\t\t\tvar y = alignWithTop ? Math.max(h - c.offsetHeight, -top) : Math.min(0, h - top - node.offsetHeight);\r\n\r\n\t\t\t// Scroll to destination position\r\n\t\t\t(duration && typeof duration === \"number\") ? \r\n\t\t\t\tthis.slideTo({y: y}, duration, \"ease-out\") : this.scrollTo({y: y});\r\n\t\t},\r\n\r\n\t\tgetSpeed: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tReturns an object that indicates the scrolling speed.\r\n\t\t\t// description:\r\n\t\t\t//\t\tFrom the position and elapsed time information, calculates the\r\n\t\t\t//\t\tscrolling speed, and returns an object with x and y.\r\n\t\t\tvar x = 0, y = 0, n = this._time.length;\r\n\t\t\t// if the user holds the mouse or finger more than 0.5 sec, do not move.\r\n\t\t\tif(n >= 2 && (new Date()).getTime() - this.startTime - this._time[n - 1] < 500){\r\n\t\t\t\tvar dy = this._posY[n - (n > 3 ? 2 : 1)] - this._posY[(n - 6) >= 0 ? n - 6 : 0];\r\n\t\t\t\tvar dx = this._posX[n - (n > 3 ? 2 : 1)] - this._posX[(n - 6) >= 0 ? n - 6 : 0];\r\n\t\t\t\tvar dt = this._time[n - (n > 3 ? 2 : 1)] - this._time[(n - 6) >= 0 ? n - 6 : 0];\r\n\t\t\t\ty = this.calcSpeed(dy, dt);\r\n\t\t\t\tx = this.calcSpeed(dx, dt);\r\n\t\t\t}\r\n\t\t\treturn {x:x, y:y};\r\n\t\t},\r\n\r\n\t\tcalcSpeed: function(/*Number*/distance, /*Number*/time){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tCalculate the speed given the distance and time.\r\n\t\t\treturn Math.round(distance / time * 100) * 4;\r\n\t\t},\r\n\r\n\t\tscrollTo: function(/*Object*/to, /*Boolean?*/doNotMoveScrollBar, /*DomNode?*/node){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tScrolls to the given position immediately without animation.\r\n\t\t\t// to:\r\n\t\t\t//\t\tThe destination position. An object with x and y.\r\n\t\t\t//\t\tex. {x:0, y:-5}\r\n\t\t\t// doNotMoveScrollBar:\r\n\t\t\t//\t\tIf true, the scroll bar will not be updated. If not specified,\r\n\t\t\t//\t\tit will be updated.\r\n\t\t\t// node:\r\n\t\t\t//\t\tA DOM node to scroll. If not specified, defaults to\r\n\t\t\t//\t\tthis.containerNode.\r\n\r\n\t\t\t// scroll events\r\n\t\t\tvar scrollEvent, beforeTopHeight, afterBottomHeight;\r\n\t\t\tvar doScroll = true;\r\n\t\t\tif(!this._aborted && this._conn){ // No scroll event if the call to scrollTo comes from abort or onTouchEnd\r\n\t\t\t\tif(!this._dim){\r\n\t\t\t\t\tthis._dim = this.getDim();\r\n\t\t\t\t}\r\n\t\t\t\tbeforeTopHeight = (to.y > 0)?to.y:0;\r\n\t\t\t\tafterBottomHeight = (this._dim.o.h + to.y < 0)?-1 * (this._dim.o.h + to.y):0;\r\n\t\t\t\tscrollEvent = {bubbles: false,\r\n\t\t\t\t\t\tcancelable: false,\r\n\t\t\t\t\t\tx: to.x,\r\n\t\t\t\t\t\ty: to.y,\r\n\t\t\t\t\t\tbeforeTop: beforeTopHeight > 0,\r\n\t\t\t\t\t\tbeforeTopHeight: beforeTopHeight,\r\n\t\t\t\t\t\tafterBottom: afterBottomHeight > 0,\r\n\t\t\t\t\t\tafterBottomHeight: afterBottomHeight};\r\n\t\t\t\t// before scroll event\r\n\t\t\t\tdoScroll = this.onBeforeScroll(scrollEvent);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(doScroll){\r\n\t\t\t\tvar s = (node || this.containerNode).style;\r\n\t\t\t\tif(has(\"css3-animations\")){\r\n\t\t\t\t\tif(!this._useTopLeft){\r\n\t\t\t\t\t\tif(this._useTransformTransition){\r\n\t\t\t\t\t\t\ts[css3.name(\"transition\")] = \"\";\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ts[css3.name(\"transform\")] = this.makeTranslateStr(to);\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\ts[css3.name(\"transition\")] = \"\";\r\n\t\t\t\t\t\tif(this._v){\r\n\t\t\t\t\t\t\ts.top = to.y + \"px\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(this._h || this._f){\r\n\t\t\t\t\t\t\ts.left = to.x + \"px\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}else{\r\n\t\t\t\t\tif(this._v){\r\n\t\t\t\t\t\ts.top = to.y + \"px\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(this._h || this._f){\r\n\t\t\t\t\t\ts.left = to.x + \"px\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(has(\"ios\")){\r\n\t\t\t\t\tthis._keepInputCaretInActiveElement();\r\n\t\t\t\t}\r\n\t\t\t\tif(!doNotMoveScrollBar){\r\n\t\t\t\t\tthis.scrollScrollBarTo(this.calcScrollBarPos(to));\r\n\t\t\t\t}\r\n\t\t\t\tif(scrollEvent){\r\n\t\t\t\t\t// After scroll event\r\n\t\t\t\t\tthis.onAfterScroll(scrollEvent);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tonBeforeScroll: function(/*Event*/e){\r\n\t\t\t// e: Event\r\n\t\t\t//\t\tthe scroll event, that contains the following attributes:\r\n\t\t\t//\t\tx (x coordinate of the scroll destination),\r\n\t\t\t//\t\ty (y coordinate of the scroll destination),\r\n\t\t\t//\t\tbeforeTop (a boolean that is true if the scroll detination is before the top of the scrollable),\r\n\t\t\t//\t\tbeforeTopHeight (the number of pixels before the top of the scrollable for the scroll destination),\r\n\t\t\t//\t\tafterBottom (a boolean that is true if the scroll destination is after the bottom of the scrollable),\r\n\t\t\t//\t\tafterBottomHeight (the number of pixels after the bottom of the scrollable for the scroll destination)\r\n\t\t\t// summary:\r\n\t\t\t//\t\tcalled before a scroll is initiated. If this method returns false,\r\n\t\t\t//\t\tthe scroll is canceled.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tcallback\r\n\t\t\treturn true;\r\n\t\t},\r\n\r\n\t\tonAfterScroll: function(/*Event*/e){\r\n\t\t\t// e: Event\r\n\t\t\t//\t\tthe scroll event, that contains the following attributes:\r\n\t\t\t//\t\tx (x coordinate of the scroll destination),\r\n\t\t\t//\t\ty (y coordinate of the scroll destination),\r\n\t\t\t//\t\tbeforeTop (a boolean that is true if the scroll detination is before the top of the scrollable),\r\n\t\t\t//\t\tbeforeTopHeight (the number of pixels before the top of the scrollable for the scroll destination),\r\n\t\t\t//\t\tafterBottom (a boolean that is true if the scroll destination is after the bottom of the scrollable),\r\n\t\t\t//\t\tafterBottomHeight (the number of pixels after the bottom of the scrollable for the scroll destination)\r\n\t\t\t// summary:\r\n\t\t\t//\t\tcalled after a scroll has been performed.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tcallback\r\n\t\t},\r\n\t\t\r\n\t\tslideTo: function(/*Object*/to, /*Number*/duration, /*String*/easing){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tScrolls to the given position with the slide animation.\r\n\t\t\t// to:\r\n\t\t\t//\t\tThe scroll destination position. An object with x and/or y.\r\n\t\t\t//\t\tex. {x:0, y:-5}, {y:-29}, etc.\r\n\t\t\t// duration:\r\n\t\t\t//\t\tDuration of scrolling in seconds. (ex. 0.3)\r\n\t\t\t// easing:\r\n\t\t\t//\t\tThe name of easing effect which webkit supports.\r\n\t\t\t//\t\t\"ease\", \"linear\", \"ease-in\", \"ease-out\", etc.\r\n\r\n\t\t\tthis._runSlideAnimation(this.getPos(), to, duration, easing, this.containerNode, 2);\r\n\t\t\tthis.slideScrollBarTo(to, duration, easing);\r\n\t\t},\r\n\r\n\t\tmakeTranslateStr: function(/*Object*/to){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tConstructs a string value that is passed to the -webkit-transform property.\r\n\t\t\t// to:\r\n\t\t\t//\t\tThe destination position. An object with x and/or y.\r\n\t\t\t// description:\r\n\t\t\t//\t\tReturn value example: \"translate3d(0px,-8px,0px)\"\r\n\r\n\t\t\tvar y = this._v && typeof to.y == \"number\" ? to.y+\"px\" : \"0px\";\r\n\t\t\tvar x = (this._h||this._f) && typeof to.x == \"number\" ? to.x+\"px\" : \"0px\";\r\n\t\t\treturn has(\"translate3d\") ?\r\n\t\t\t\t\t\"translate3d(\"+x+\",\"+y+\",0px)\" : \"translate(\"+x+\",\"+y+\")\";\r\n\t\t},\r\n\r\n\t\tgetPos: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tGets the top position in the midst of animation.\r\n\t\t\tif(has(\"css3-animations\")){\r\n\t\t\t\tvar s = win.doc.defaultView.getComputedStyle(this.containerNode, '');\r\n\t\t\t\tif(!this._useTopLeft){\r\n\t\t\t\t\tvar m = s[css3.name(\"transform\")];\r\n\t\t\t\t\tif(m && m.indexOf(\"matrix\") === 0){\r\n\t\t\t\t\t\tvar arr = m.split(/[,\\s\\)]+/);\r\n\t\t\t\t\t\t// IE10 returns a matrix3d\r\n\t\t\t\t\t\tvar i = m.indexOf(\"matrix3d\") === 0 ? 12 : 4;\r\n\t\t\t\t\t\treturn {y:arr[i+1] - 0, x:arr[i] - 0};\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn {x:0, y:0};\r\n\t\t\t\t}else{\r\n\t\t\t\t\treturn {x:parseInt(s.left) || 0, y:parseInt(s.top) || 0};\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\t// this.containerNode.offsetTop does not work here,\r\n\t\t\t\t// because it adds the height of the top margin.\r\n\t\t\t\tvar y = parseInt(this.containerNode.style.top) || 0;\r\n\t\t\t\treturn {y:y, x:this.containerNode.offsetLeft};\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tgetDim: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tReturns various internal dimensional information needed for calculation.\r\n\r\n\t\t\tvar d = {};\r\n\t\t\t// content width/height\r\n\t\t\td.c = {h:this.containerNode.offsetHeight, w:this.containerNode.offsetWidth};\r\n\r\n\t\t\t// view width/height\r\n\t\t\td.v = {h:this.domNode.offsetHeight + this._appFooterHeight, w:this.domNode.offsetWidth};\r\n\r\n\t\t\t// display width/height\r\n\t\t\td.d = {h:d.v.h - this.fixedHeaderHeight - this.fixedFooterHeight - this._appFooterHeight, w:d.v.w};\r\n\r\n\t\t\t// overflowed width/height\r\n\t\t\td.o = {h:d.c.h - d.v.h + this.fixedHeaderHeight + this.fixedFooterHeight + this._appFooterHeight, w:d.c.w - d.v.w};\r\n\t\t\treturn d;\r\n\t\t},\r\n\r\n\t\tshowScrollBar: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tShows the scroll bar.\r\n\t\t\t// description:\r\n\t\t\t//\t\tThis function creates the scroll bar instance if it does not\r\n\t\t\t//\t\texist yet, and calls resetScrollBar() to reset its length and\r\n\t\t\t//\t\tposition.\r\n\r\n\t\t\tif(!this.scrollBar){ return; }\r\n\r\n\t\t\tvar dim = this._dim;\r\n\t\t\tif(this.scrollDir == \"v\" && dim.c.h <= dim.d.h){ return; }\r\n\t\t\tif(this.scrollDir == \"h\" && dim.c.w <= dim.d.w){ return; }\r\n\t\t\tif(this._v && this._h && dim.c.h <= dim.d.h && dim.c.w <= dim.d.w){ return; }\r\n\r\n\t\t\tvar createBar = function(self, dir){\r\n\t\t\t\tvar bar = self[\"_scrollBarNode\" + dir];\r\n\t\t\t\tif(!bar){\r\n\t\t\t\t\tvar wrapper = domConstruct.create(\"div\", null, self.domNode);\r\n\t\t\t\t\tvar props = { position: \"absolute\", overflow: \"hidden\" };\r\n\t\t\t\t\tif(dir == \"V\"){\r\n\t\t\t\t\t\tprops.right = \"2px\";\r\n\t\t\t\t\t\tprops.width = \"5px\";\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tprops.bottom = (self.isLocalFooter ? self.fixedFooterHeight : 0) + 2 + \"px\";\r\n\t\t\t\t\t\tprops.height = \"5px\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdomStyle.set(wrapper, props);\r\n\t\t\t\t\twrapper.className = \"mblScrollBarWrapper\";\r\n\t\t\t\t\tself[\"_scrollBarWrapper\"+dir] = wrapper;\r\n\r\n\t\t\t\t\tbar = domConstruct.create(\"div\", null, wrapper);\r\n\t\t\t\t\tdomStyle.set(bar, css3.add({\r\n\t\t\t\t\t\topacity: 0.6,\r\n\t\t\t\t\t\tposition: \"absolute\",\r\n\t\t\t\t\t\tbackgroundColor: \"#606060\",\r\n\t\t\t\t\t\tfontSize: \"1px\",\r\n\t\t\t\t\t\tMozBorderRadius: \"2px\",\r\n\t\t\t\t\t\tzIndex: 2147483647 // max of signed 32-bit integer\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tborderRadius: \"2px\",\r\n\t\t\t\t\t\ttransformOrigin: \"0 0\"\r\n\t\t\t\t\t}));\r\n\t\t\t\t\tdomStyle.set(bar, dir == \"V\" ? {width: \"5px\"} : {height: \"5px\"});\r\n\t\t\t\t\tself[\"_scrollBarNode\" + dir] = bar;\r\n\t\t\t\t}\r\n\t\t\t\treturn bar;\r\n\t\t\t};\r\n\t\t\tif(this._v && !this._scrollBarV){\r\n\t\t\t\tthis._scrollBarV = createBar(this, \"V\");\r\n\t\t\t}\r\n\t\t\tif(this._h && !this._scrollBarH){\r\n\t\t\t\tthis._scrollBarH = createBar(this, \"H\");\r\n\t\t\t}\r\n\t\t\tthis.resetScrollBar();\r\n\t\t},\r\n\r\n\t\thideScrollBar: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tHides the scroll bar.\r\n\t\t\t// description:\r\n\t\t\t//\t\tIf the fadeScrollBar property is true, hides the scroll bar with\r\n\t\t\t//\t\tthe fade animation.\r\n\r\n\t\t\tif(this.fadeScrollBar && has(\"css3-animations\")){\r\n\t\t\t\tif(!dm._fadeRule){\r\n\t\t\t\t\tvar node = domConstruct.create(\"style\", null, win.doc.getElementsByTagName(\"head\")[0]);\r\n\t\t\t\t\tnode.textContent =\r\n\t\t\t\t\t\t\".mblScrollableFadeScrollBar{\"+\r\n\t\t\t\t\t\t\"  \" + css3.name(\"animation-duration\", true) + \": 1s;\"+\r\n\t\t\t\t\t\t\"  \" + css3.name(\"animation-name\", true) + \": scrollableViewFadeScrollBar;}\"+\r\n\t\t\t\t\t\t\"@\" + css3.name(\"keyframes\", true) + \" scrollableViewFadeScrollBar{\"+\r\n\t\t\t\t\t\t\"  from { opacity: 0.6; }\"+\r\n\t\t\t\t\t\t\"  to { opacity: 0; }}\";\r\n\t\t\t\t\tdm._fadeRule = node.sheet.cssRules[1];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(!this.scrollBar){ return; }\r\n\t\t\tvar f = function(bar, self){\r\n\t\t\t\tdomStyle.set(bar, css3.add({\r\n\t\t\t\t\topacity: 0\r\n\t\t\t\t}, {\r\n\t\t\t\t\tanimationDuration: \"\"\r\n\t\t\t\t}));\r\n\t\t\t\t// do not use fade animation in case of using top/left on Android\r\n\t\t\t\t// since it causes screen flicker during adress bar's fading out\r\n\t\t\t\tif(!(self._useTopLeft && has('android'))){\r\n\t\t\t\t\tbar.className = \"mblScrollableFadeScrollBar\";\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tif(this._scrollBarV){\r\n\t\t\t\tf(this._scrollBarV, this);\r\n\t\t\t\tthis._scrollBarV = null;\r\n\t\t\t}\r\n\t\t\tif(this._scrollBarH){\r\n\t\t\t\tf(this._scrollBarH, this);\r\n\t\t\t\tthis._scrollBarH = null;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tcalcScrollBarPos: function(/*Object*/to){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tCalculates the scroll bar position.\r\n\t\t\t// description:\r\n\t\t\t//\t\tGiven the scroll destination position, calculates the top and/or\r\n\t\t\t//\t\tthe left of the scroll bar(s). Returns an object with x and y.\r\n\t\t\t// to:\r\n\t\t\t//\t\tThe scroll destination position. An object with x and y.\r\n\t\t\t//\t\tex. {x:0, y:-5}\t\t\t\r\n\r\n\t\t\tvar pos = {};\r\n\t\t\tvar dim = this._dim;\r\n\t\t\tvar f = function(wrapperH, barH, t, d, c){\r\n\t\t\t\tvar y = Math.round((d - barH - 8) / (d - c) * t);\r\n\t\t\t\tif(y < -barH + 5){\r\n\t\t\t\t\ty = -barH + 5;\r\n\t\t\t\t}\r\n\t\t\t\tif(y > wrapperH - 5){\r\n\t\t\t\t\ty = wrapperH - 5;\r\n\t\t\t\t}\r\n\t\t\t\treturn y;\r\n\t\t\t};\r\n\t\t\tif(typeof to.y == \"number\" && this._scrollBarV){\r\n\t\t\t\tpos.y = f(this._scrollBarWrapperV.offsetHeight, this._scrollBarV.offsetHeight, to.y, dim.d.h, dim.c.h);\r\n\t\t\t}\r\n\t\t\tif(typeof to.x == \"number\" && this._scrollBarH){\r\n\t\t\t\tpos.x = f(this._scrollBarWrapperH.offsetWidth, this._scrollBarH.offsetWidth, to.x, dim.d.w, dim.c.w);\r\n\t\t\t}\r\n\t\t\treturn pos;\r\n\t\t},\r\n\r\n\t\tscrollScrollBarTo: function(/*Object*/to){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tMoves the scroll bar(s) to the given position without animation.\r\n\t\t\t// to:\r\n\t\t\t//\t\tThe destination position. An object with x and/or y.\r\n\t\t\t//\t\tex. {x:2, y:5}, {y:20}, etc.\r\n\r\n\t\t\tif(!this.scrollBar){ return; }\r\n\t\t\tif(this._v && this._scrollBarV && typeof to.y == \"number\"){\r\n\t\t\t\tif(has(\"css3-animations\")){\r\n\t\t\t\t\tif(!this._useTopLeft){\r\n\t\t\t\t\t\tif(this._useTransformTransition){\r\n\t\t\t\t\t\t\tthis._scrollBarV.style[css3.name(\"transition\")] = \"\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis._scrollBarV.style[css3.name(\"transform\")] = this.makeTranslateStr({y:to.y});\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tdomStyle.set(this._scrollBarV, css3.add({\r\n\t\t\t\t\t\t\ttop: to.y + \"px\"\r\n\t\t\t\t\t\t}, {\r\n\t\t\t\t\t\t\ttransition: \"\"\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t}\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis._scrollBarV.style.top = to.y + \"px\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(this._h && this._scrollBarH && typeof to.x == \"number\"){\r\n\t\t\t\tif(has(\"css3-animations\")){\r\n\t\t\t\t\tif(!this._useTopLeft){\r\n\t\t\t\t\t\tif(this._useTransformTransition){\r\n\t\t\t\t\t\t\tthis._scrollBarH.style[css3.name(\"transition\")] = \"\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis._scrollBarH.style[css3.name(\"transform\")] = this.makeTranslateStr({x:to.x});\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tdomStyle.set(this._scrollBarH, css3.add({\r\n\t\t\t\t\t\t\tleft: to.x + \"px\"\r\n\t\t\t\t\t\t}, {\r\n\t\t\t\t\t\t\ttransition: \"\"\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t}\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis._scrollBarH.style.left = to.x + \"px\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tslideScrollBarTo: function(/*Object*/to, /*Number*/duration, /*String*/easing){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tMoves the scroll bar(s) to the given position with the slide animation.\r\n\t\t\t// to:\r\n\t\t\t//\t\tThe destination position. An object with x and y.\r\n\t\t\t//\t\tex. {x:0, y:-5}\r\n\t\t\t// duration:\r\n\t\t\t//\t\tDuration of the animation in seconds. (ex. 0.3)\r\n\t\t\t// easing:\r\n\t\t\t//\t\tThe name of easing effect which webkit supports.\r\n\t\t\t//\t\t\"ease\", \"linear\", \"ease-in\", \"ease-out\", etc.\r\n\r\n\t\t\tif(!this.scrollBar){ return; }\r\n\t\t\tvar fromPos = this.calcScrollBarPos(this.getPos());\r\n\t\t\tvar toPos = this.calcScrollBarPos(to);\r\n\t\t\tif(this._v && this._scrollBarV){\r\n\t\t\t\tthis._runSlideAnimation({y:fromPos.y}, {y:toPos.y}, duration, easing, this._scrollBarV, 0);\r\n\t\t\t}\r\n\t\t\tif(this._h && this._scrollBarH){\r\n\t\t\t\tthis._runSlideAnimation({x:fromPos.x}, {x:toPos.x}, duration, easing, this._scrollBarH, 1);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_runSlideAnimation: function(/*Object*/from, /*Object*/to, /*Number*/duration, /*String*/easing, /*DomNode*/node, /*Number*/idx){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\t\r\n\t\t\t// idx: 0:scrollbarV, 1:scrollbarH, 2:content\r\n\t\t\tif(has(\"css3-animations\")){\r\n\t\t\t\tif(!this._useTopLeft){\r\n\t\t\t\t\tif(this._useTransformTransition){\r\n\t\t\t\t\t\t// for iOS6 (maybe others?): use -webkit-transform + -webkit-transition\r\n\t\t\t\t\t\tif(to.x === undefined){ to.x = from.x; }\r\n\t\t\t\t\t\tif(to.y === undefined){ to.y = from.y; }\r\n\t\t\t\t\t\t // make sure we actually change the transform, otherwise no webkitTransitionEnd is fired.\r\n\t\t\t\t\t\tif(to.x !== from.x || to.y !== from.y){\r\n\t\t\t\t\t\t\tthis.onFlickAnimationStart(); // needed because there is no transitionstart event.\r\n\t\t\t\t\t\t\tdomStyle.set(node, css3.add({}, {\r\n\t\t\t\t\t\t\t\ttransitionProperty: css3.name(\"transform\"),\r\n\t\t\t\t\t\t\t\ttransitionDuration: duration + \"s\",\r\n\t\t\t\t\t\t\t\ttransitionTimingFunction: easing\r\n\t\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t\tvar t = this.makeTranslateStr(to);\r\n\t\t\t\t\t\t\tsetTimeout(function(){ // setTimeout is needed to prevent webkitTransitionEnd not fired\r\n\t\t\t\t\t\t\t\tdomStyle.set(node, css3.add({}, {\r\n\t\t\t\t\t\t\t\t\ttransform: t\r\n\t\t\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t\t}, 0);\r\n\t\t\t\t\t\t\tdomClass.add(node, \"mblScrollableScrollTo\"+idx);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// transform not changed, just hide the scrollbar\r\n\t\t\t\t\t\t\tthis.hideScrollBar();\r\n\t\t\t\t\t\t\tthis.removeCover();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\t// use -webkit-transform + -webkit-animation\r\n\t\t\t\t\t\tthis.setKeyframes(from, to, idx);\r\n\t\t\t\t\t\tdomStyle.set(node, css3.add({}, {\r\n\t\t\t\t\t\t\tanimationDuration: duration + \"s\",\r\n\t\t\t\t\t\t\tanimationTimingFunction: easing\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t\tdomClass.add(node, \"mblScrollableScrollTo\"+idx);\r\n\t\t\t\t\t\tif(idx == 2){\r\n\t\t\t\t\t\t\tthis.scrollTo(to, true, node);\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tthis.scrollScrollBarTo(to);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}else if(to.x !== undefined || to.y !== undefined){\r\n\t\t\t\t\tthis.onFlickAnimationStart(); // #17822: needed because there is no transitionstart event.\r\n\t\t\t\t\tdomStyle.set(node, css3.add({}, {\r\n\t\t\t\t\t\t// #17822 when scrolling on one direction, avoid unnecessarily animating\r\n\t\t\t\t\t\t// both top and left, because this leads to two transitionend events fired \r\n\t\t\t\t\t\t// instead of one in some browsers (Safari/iOS7 at least).\r\n\t\t\t\t\t\ttransitionProperty: (to.x !== undefined && to.y !== undefined) ?\r\n\t\t\t\t\t\t\t\"top, left\" :\r\n\t\t\t\t\t\t\tto.y !== undefined ? \"top\" : \"left\",\r\n\t\t\t\t\t\ttransitionDuration: duration + \"s\",\r\n\t\t\t\t\t\ttransitionTimingFunction: easing\r\n\t\t\t\t\t}));\r\n\t\t\t\t\tsetTimeout(function(){ // setTimeout is needed to prevent webkitTransitionEnd not fired\r\n\t\t\t\t\t\tvar style = {};\r\n\t\t\t\t\t\tif(to.x !== undefined){\r\n\t\t\t\t\t\t\tstyle.left = to.x + \"px\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(to.y !== undefined){\r\n\t\t\t\t\t\t\tstyle.top = to.y + \"px\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdomStyle.set(node, style);\r\n\t\t\t\t\t}, 0);\r\n\t\t\t\t\tdomClass.add(node, \"mblScrollableScrollTo\"+idx);\r\n\t\t\t\t}\r\n\t\t\t}else if(dojo.fx && dojo.fx.easing && duration){\r\n\t\t\t\t// If you want to support non-webkit browsers,\r\n\t\t\t\t// your application needs to load necessary modules as follows:\r\n\t\t\t\t//\r\n\t\t\t\t// | dojo.require(\"dojo.fx\");\r\n\t\t\t\t// | dojo.require(\"dojo.fx.easing\");\r\n\t\t\t\t//\r\n\t\t\t\t// This module itself does not make dependency on them.\r\n\t\t\t\t// TODO: for 2.0 the dojo global is going away. Use require(\"dojo/fx\") and require(\"dojo/fx/easing\") instead.\r\n\t\t\t\t\r\n\t\t\t\tvar self = this;\r\n\t\t\t\tvar s = dojo.fx.slideTo({\r\n\t\t\t\t\tnode: node,\r\n\t\t\t\t\tduration: duration*1000,\r\n\t\t\t\t\tleft: to.x,\r\n\t\t\t\t\ttop: to.y,\r\n\t\t\t\t\teasing: (easing == \"ease-out\") ? dojo.fx.easing.quadOut : dojo.fx.easing.linear,\r\n\t\t\t\t\tonBegin: function(){ // #17822\r\n\t\t\t\t\t\tif(idx == 2){\r\n\t\t\t\t\t\t\tself.onFlickAnimationStart();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tonEnd: function(){\r\n\t\t\t\t\t\tif(idx == 2){\r\n\t\t\t\t\t\t\tself.onFlickAnimationEnd();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}).play();\r\n\t\t\t}else{\r\n\t\t\t\t// directly jump to the destination without animation\r\n\t\t\t\tif(idx == 2){\r\n\t\t\t\t\tthis.onFlickAnimationStart(); // #17822\r\n\t\t\t\t\tthis.scrollTo(to, false, node);\r\n\t\t\t\t\tthis.onFlickAnimationEnd();\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis.scrollScrollBarTo(to);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tresetScrollBar: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tResets the scroll bar length, position, etc.\r\n\t\t\tvar f = function(wrapper, bar, d, c, hd, v){\r\n\t\t\t\tif(!bar){ return; }\r\n\t\t\t\tvar props = {};\r\n\t\t\t\tprops[v ? \"top\" : \"left\"] = hd + 4 + \"px\"; // +4 is for top or left margin\r\n\t\t\t\tvar t = (d - 8) <= 0 ? 1 : d - 8;\r\n\t\t\t\tprops[v ? \"height\" : \"width\"] = t + \"px\";\r\n\t\t\t\tdomStyle.set(wrapper, props);\r\n\t\t\t\tvar l = Math.round(d * d / c); // scroll bar length\r\n\t\t\t\tl = Math.min(Math.max(l - 8, 5), t); // -8 is for margin for both ends\r\n\t\t\t\tbar.style[v ? \"height\" : \"width\"] = l + \"px\";\r\n\t\t\t\tdomStyle.set(bar, {\"opacity\": 0.6});\r\n\t\t\t};\r\n\t\t\tvar dim = this.getDim();\r\n\t\t\tf(this._scrollBarWrapperV, this._scrollBarV, dim.d.h, dim.c.h, this.fixedHeaderHeight, true);\r\n\t\t\tf(this._scrollBarWrapperH, this._scrollBarH, dim.d.w, dim.c.w, 0);\r\n\t\t\tthis.createMask();\r\n\t\t},\r\n\r\n\t\tcreateMask: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tCreates a mask for a scroll bar edge.\r\n\t\t\t// description:\r\n\t\t\t//\t\tThis function creates a mask that hides corners of one scroll\r\n\t\t\t//\t\tbar edge to make it round edge. The other side of the edge is\r\n\t\t\t//\t\talways visible and round shaped with the border-radius style.\r\n\t\t\tif(!(has(\"mask-image\"))){ return; }\r\n\t\t\tif(this._scrollBarWrapperV){\r\n\t\t\t\tvar h = this._scrollBarWrapperV.offsetHeight;\r\n\t\t\t\tmaskUtils.createRoundMask(this._scrollBarWrapperV, 0, 0, 0, 0, 5, h, 2, 2, 0.5);\r\n\t\t\t}\r\n\t\t\tif(this._scrollBarWrapperH){\r\n\t\t\t\tvar w = this._scrollBarWrapperH.offsetWidth;\r\n\t\t\t\tmaskUtils.createRoundMask(this._scrollBarWrapperH, 0, 0, 0, 0, w, 5, 2, 2, 0.5);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tflashScrollBar: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tShows the scroll bar instantly.\r\n\t\t\t// description:\r\n\t\t\t//\t\tThis function shows the scroll bar, and then hides it 300ms\r\n\t\t\t//\t\tlater. This is used to show the scroll bar to the user for a\r\n\t\t\t//\t\tshort period of time when a hidden view is revealed.\r\n\t\t\tif(this.disableFlashScrollBar || !this.domNode){ return; }\r\n\t\t\tthis._dim = this.getDim();\r\n\t\t\tif(this._dim.d.h <= 0){ return; } // dom is not ready\r\n\t\t\tthis.showScrollBar();\r\n\t\t\tvar _this = this;\r\n\t\t\tsetTimeout(function(){\r\n\t\t\t\t_this.hideScrollBar();\r\n\t\t\t}, 300);\r\n\t\t},\r\n\r\n\t\taddCover: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tAdds the transparent DIV cover.\r\n\t\t\t// description:\r\n\t\t\t//\t\tThe cover is to prevent DOM events from affecting the child\r\n\t\t\t//\t\twidgets such as a list widget. Without the cover, for example,\r\n\t\t\t//\t\tchild widgets may receive a click event and respond to it\r\n\t\t\t//\t\tunexpectedly when the user flicks the screen to scroll.\r\n\t\t\t//\t\tNote that only the desktop browsers need the cover.\r\n\r\n\t\t\tif(!has(\"touch\") && !this.noCover){\r\n\t\t\t\tif(!dm._cover){\r\n\t\t\t\t\tdm._cover = domConstruct.create(\"div\", null, win.doc.body);\r\n\t\t\t\t\tdm._cover.className = \"mblScrollableCover\";\r\n\t\t\t\t\tdomStyle.set(dm._cover, {\r\n\t\t\t\t\t\tbackgroundColor: \"#ffff00\",\r\n\t\t\t\t\t\topacity: 0,\r\n\t\t\t\t\t\tposition: \"absolute\",\r\n\t\t\t\t\t\ttop: \"0px\",\r\n\t\t\t\t\t\tleft: \"0px\",\r\n\t\t\t\t\t\twidth: \"100%\",\r\n\t\t\t\t\t\theight: \"100%\",\r\n\t\t\t\t\t\tzIndex: 2147483647 // max of signed 32-bit integer\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis._ch.push(connect.connect(dm._cover, touch.press, this, \"onTouchEnd\"));\r\n\t\t\t\t}else{\r\n\t\t\t\t\tdm._cover.style.display = \"\";\r\n\t\t\t\t}\r\n\t\t\t\tthis.setSelectable(dm._cover, false);\r\n\t\t\t\tthis.setSelectable(this.domNode, false);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tremoveCover: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tRemoves the transparent DIV cover.\r\n\r\n\t\t\tif(!has(\"touch\") && dm._cover){\r\n\t\t\t\tdm._cover.style.display = \"none\";\r\n\t\t\t\tthis.setSelectable(dm._cover, true);\r\n\t\t\t\tthis.setSelectable(this.domNode, true);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tsetKeyframes: function(/*Object*/from, /*Object*/to, /*Number*/idx){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tProgrammatically sets key frames for the scroll animation.\r\n\r\n\t\t\tif(!dm._rule){\r\n\t\t\t\tdm._rule = [];\r\n\t\t\t}\r\n\t\t\t// idx: 0:scrollbarV, 1:scrollbarH, 2:content\r\n\t\t\tif(!dm._rule[idx]){\r\n\t\t\t\tvar node = domConstruct.create(\"style\", null, win.doc.getElementsByTagName(\"head\")[0]);\r\n\t\t\t\tnode.textContent =\r\n\t\t\t\t\t\".mblScrollableScrollTo\"+idx+\"{\" + css3.name(\"animation-name\", true) + \": scrollableViewScroll\"+idx+\";}\"+\r\n\t\t\t\t\t\"@\" + css3.name(\"keyframes\", true) + \" scrollableViewScroll\"+idx+\"{}\";\r\n\t\t\t\tdm._rule[idx] = node.sheet.cssRules[1];\r\n\t\t\t}\r\n\t\t\tvar rule = dm._rule[idx];\r\n\t\t\tif(rule){\r\n\t\t\t\tif(from){\r\n\t\t\t\t\trule.deleteRule(has(\"webkit\")?\"from\":0);\r\n\t\t\t\t\t(rule.insertRule||rule.appendRule).call(rule, \"from { \" + css3.name(\"transform\", true) + \": \"+this.makeTranslateStr(from)+\"; }\");\r\n\t\t\t\t}\r\n\t\t\t\tif(to){\r\n\t\t\t\t\tif(to.x === undefined){ to.x = from.x; }\r\n\t\t\t\t\tif(to.y === undefined){ to.y = from.y; }\r\n\t\t\t\t\trule.deleteRule(has(\"webkit\")?\"to\":1);\r\n\t\t\t\t\t(rule.insertRule||rule.appendRule).call(rule, \"to { \" + css3.name(\"transform\", true) + \": \"+this.makeTranslateStr(to)+\"; }\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tsetSelectable: function(/*DomNode*/node, /*Boolean*/selectable){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tSets the given node as selectable or unselectable.\r\n\t\t\t \r\n\t\t\t// dojo.setSelectable has dependency on dojo.query. Redefine our own.\r\n\t\t\tnode.style.KhtmlUserSelect = selectable ? \"auto\" : \"none\";\r\n\t\t\tnode.style.MozUserSelect = selectable ? \"\" : \"none\";\r\n\t\t\tnode.onselectstart = selectable ? null : function(){return false;};\r\n\t\t\tif(has(\"ie\")){\r\n\t\t\t\tnode.unselectable = selectable ? \"\" : \"on\";\r\n\t\t\t\tvar nodes = node.getElementsByTagName(\"*\");\r\n\t\t\t\tfor(var i = 0; i < nodes.length; i++){\r\n\t\t\t\t\tnodes[i].unselectable = selectable ? \"\" : \"on\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\tScrollable = has(\"dojo-bidi\") ? declare(\"dojox.mobile.Scrollable\", [Scrollable, BidiScrollable]) : Scrollable;\r\n\tlang.setObject(\"dojox.mobile.scrollable\", Scrollable);\r\n\r\n\treturn Scrollable;\r\n});\r\n"]}