{"version":3,"sources":["mobile/Switch.js"],"names":["define","array","connect","declare","event","win","domClass","domConstruct","domStyle","domAttr","touch","Contained","WidgetBase","has","maskUtils","dm","BidiSwitch","Switch","value","name","leftLabel","rightLabel","shape","tabIndex","_setTabIndexAttr","baseClass","role","buildRendering","this","templateString","domNode","srcNodeRef","tagName","create","style","msTouchAction","inherited","arguments","c","className","match","add","nameAttr","innerHTML","n","inner","firstChild","left","childNodes","right","knob","input","set","switchNode","rootNode","labelNode","class","for","id","appendChild","cloneNode","focusNode","postCreate","_startHandle","press","_initialValue","startup","_started","resize","get","outWidth","innWidth","isLeftToRight","width","_hasMaskImage","_createMaskImage","_changeState","state","anim","on","display","remove","_this","defer","_timer","w","h","_width","rDef","rDefs","split","rx","parseFloat","ry","length","replace","createRoundMask","_onClick","e","type","keyCode","onClick","_moved","_set","onStateChanged","onTouchStart","innerStartX","offsetLeft","_conn","move","doc","release","push","touchStartX","touches","pageX","clientX","stop","onTouchMove","dx","preventDefault","targetTouches","pos","Math","abs","onTouchEnd","forEach","disconnect","newState","_newState","_sendClick","_setValueAttr","_setLeftLabelAttr","label","_cv","_setRightLabelAttr","reset"],"mappings":"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","file":"../../mobile/Switch.js","sourcesContent":["define([\r\n\t\"dojo/_base/array\",\r\n\t\"dojo/_base/connect\",\r\n\t\"dojo/_base/declare\",\r\n\t\"dojo/_base/event\",\r\n\t\"dojo/_base/window\",\r\n\t\"dojo/dom-class\",\r\n\t\"dojo/dom-construct\",\r\n\t\"dojo/dom-style\",\r\n\t\"dojo/dom-attr\",\r\n\t\"dojo/touch\",\r\n\t\"dijit/_Contained\",\r\n\t\"dijit/_WidgetBase\",\r\n\t\"./sniff\",\r\n\t\"./_maskUtils\",\r\n\t\"./common\",\r\n\t\"dojo/has!dojo-bidi?dojox/mobile/bidi/Switch\"\r\n], function(array, connect, declare, event, win, domClass, domConstruct, domStyle, domAttr, touch, Contained, WidgetBase, has, maskUtils, dm, BidiSwitch){\r\n\r\n\t// module:\r\n\t//\t\tdojox/mobile/Switch\r\n\r\n\tvar Switch = declare(has(\"dojo-bidi\") ? \"dojox.mobile.NonBidiSwitch\" : \"dojox.mobile.Switch\", [WidgetBase, Contained],{\r\n\t\t// summary:\r\n\t\t//\t\tA toggle switch with a sliding knob.\r\n\t\t// description:\r\n\t\t//\t\tSwitch is a toggle switch with a sliding knob. You can either\r\n\t\t//\t\ttap or slide the knob to toggle the switch. The onStateChanged\r\n\t\t//\t\thandler is called when the switch is manipulated.\r\n\r\n\t\t// value: String\r\n\t\t//\t\tThe initial state of the switch: \"on\" or \"off\". The default\r\n\t\t//\t\tvalue is \"on\".\r\n\t\tvalue: \"on\",\r\n\r\n\t\t// name: String\r\n\t\t//\t\tA name for a hidden input field, which holds the current value.\r\n\t\tname: \"\",\r\n\r\n\t\t// leftLabel: String\r\n\t\t//\t\tThe left-side label of the switch.\r\n\t\tleftLabel: \"ON\",\r\n\r\n\t\t// rightLabel: String\r\n\t\t//\t\tThe right-side label of the switch.\r\n\t\trightLabel: \"OFF\",\r\n\r\n\t\t// shape: String\r\n\t\t//\t\tThe shape of the switch.\r\n\t\t//\t\t\"mblSwDefaultShape\", \"mblSwSquareShape\", \"mblSwRoundShape1\",\r\n\t\t//\t\t\"mblSwRoundShape2\", \"mblSwArcShape1\" or \"mblSwArcShape2\".\r\n\t\t//\t\tThe default value is \"mblSwDefaultShape\".\r\n\t\tshape: \"mblSwDefaultShape\",\r\n\r\n\t\t// tabIndex: String\r\n\t\t//\t\tTabindex setting for this widget so users can hit the tab key to\r\n\t\t//\t\tfocus on it.\r\n\t\ttabIndex: \"0\",\r\n\t\t_setTabIndexAttr: \"\", // sets tabIndex to domNode\r\n\r\n\t\t/* internal properties */\r\n\t\tbaseClass: \"mblSwitch\",\r\n\t\t// role: [private] String\r\n\t\t//\t\tThe accessibility role.\r\n\t\trole: \"\", // a11y\r\n\r\n\t\tbuildRendering: function(){\r\n\t\t\tif(!this.templateString){ // true if this widget is not templated\r\n\t\t\t\tthis.domNode = (this.srcNodeRef && this.srcNodeRef.tagName === \"SPAN\") ?\r\n\t\t\t\t\tthis.srcNodeRef : domConstruct.create(\"span\");\r\n\t\t\t}\r\n\t\t\t// prevent browser scrolling on IE10 (evt.preventDefault() is not enough)\r\n\t\t\tif(typeof this.domNode.style.msTouchAction != \"undefined\"){\r\n\t\t\t\tthis.domNode.style.msTouchAction = \"none\";\r\n\t\t\t}\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\tif(!this.templateString){ // true if this widget is not templated\r\n\t\t\t\tvar c = (this.srcNodeRef && this.srcNodeRef.className) || this.className || this[\"class\"];\r\n\t\t\t\tif((c = c.match(/mblSw.*Shape\\d*/))){ this.shape = c; }\r\n\t\t\t\tdomClass.add(this.domNode, this.shape);\r\n\t\t\t\tvar nameAttr = this.name ? \" name=\\\"\" + this.name + \"\\\"\" : \"\";\r\n\t\t\t\tthis.domNode.innerHTML =\r\n\t\t\t\t\t  '<div class=\"mblSwitchInner\">'\r\n\t\t\t\t\t+\t'<div class=\"mblSwitchBg mblSwitchBgLeft\">'\r\n\t\t\t\t\t+\t\t'<div class=\"mblSwitchText mblSwitchTextLeft\"></div>'\r\n\t\t\t\t\t+\t'</div>'\r\n\t\t\t\t\t+\t'<div class=\"mblSwitchBg mblSwitchBgRight\">'\r\n\t\t\t\t\t+\t\t'<div class=\"mblSwitchText mblSwitchTextRight\"></div>'\r\n\t\t\t\t\t+\t'</div>'\r\n\t\t\t\t\t+\t'<div class=\"mblSwitchKnob\"></div>'\r\n\t\t\t\t\t+\t'<input type=\"hidden\"'+nameAttr+'></div>'\r\n\t\t\t\t\t+ '</div>';\r\n\t\t\t\tvar n = this.inner = this.domNode.firstChild;\r\n\t\t\t\tthis.left = n.childNodes[0];\r\n\t\t\t\tthis.right = n.childNodes[1];\r\n\t\t\t\tthis.knob = n.childNodes[2];\r\n\t\t\t\tthis.input = n.childNodes[3];\r\n\t\t\t}\r\n\t\t\tdomAttr.set(this.domNode, \"role\", \"checkbox\"); //a11y\r\n\t\t\tdomAttr.set(this.domNode, \"aria-checked\", (this.value === \"on\") ? \"true\" : \"false\"); //a11y\r\n\r\n\t\t\tthis.switchNode = this.domNode;\r\n\r\n\t\t\tif(has(\"windows-theme\")) {\r\n\t\t\t\tvar rootNode = domConstruct.create(\"div\", {className: \"mblSwitchContainer\"});\r\n\t\t\t\tthis.labelNode = domConstruct.create(\"label\", {\"class\": \"mblSwitchLabel\", \"for\": this.id}, rootNode);\r\n\t\t\t\trootNode.appendChild(this.domNode.cloneNode(true));\r\n\t\t\t\tthis.domNode = rootNode;\r\n\t\t\t\tthis.focusNode = rootNode.childNodes[1];\r\n\t\t\t\tthis.labelNode.innerHTML = (this.value==\"off\") ? this.rightLabel : this.leftLabel;\r\n\t\t\t\tthis.switchNode = this.domNode.childNodes[1];\r\n\t\t\t\tvar inner = this.inner = this.domNode.childNodes[1].firstChild;\r\n\t\t\t\tthis.left = inner.childNodes[0];\r\n\t\t\t\tthis.right = inner.childNodes[1];\r\n\t\t\t\tthis.knob = inner.childNodes[2];\r\n\t\t\t\tthis.input = inner.childNodes[3];\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tpostCreate: function(){\r\n\t\t\tthis.connect(this.switchNode, \"onclick\", \"_onClick\");\r\n\t\t\tthis.connect(this.switchNode, \"onkeydown\", \"_onClick\"); // for desktop browsers\r\n\t\t\tthis._startHandle = this.connect(this.switchNode, touch.press, \"onTouchStart\");\r\n\t\t\tthis._initialValue = this.value; // for reset()\r\n\t\t},\r\n\r\n\t\tstartup: function(){\r\n\t\t\tif(!this._started){\r\n\t\t\t\tthis.resize();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tresize: function(){\r\n\t\t\tif(has(\"windows-theme\")){\r\n\t\t\t\t// Override the custom CSS width (if any) to avoid misplacement.\r\n\t\t\t\t// Per design, the windows theme does not allow resizing the controls.\r\n\t\t\t\t// The label of the switch is placed next to the switch, and a custom\r\n\t\t\t\t// width would only have the effect to increase the distance between the\r\n\t\t\t\t// label and the switch, which is undesired. Hence, on windows theme,\r\n\t\t\t\t// ensure the width of root DOM node is 100%.\r\n\t\t\t\tdomStyle.set(this.domNode, \"width\", \"100%\");\r\n\t\t\t}else{\r\n\t\t\t\tvar value = domStyle.get(this.domNode,\"width\");\r\n\t\t\t\tvar outWidth = value + \"px\";\r\n\t\t\t\tvar innWidth = (value - domStyle.get(this.knob,\"width\")) + \"px\";\r\n\t\t\t\tdomStyle.set(this.left, \"width\", outWidth);\r\n\t\t\t\tdomStyle.set(this.right,this.isLeftToRight()?{width: outWidth, left: innWidth}:{width: outWidth});\r\n\t\t\t\tdomStyle.set(this.left.firstChild, \"width\", innWidth);\r\n\t\t\t\tdomStyle.set(this.right.firstChild, \"width\", innWidth);\r\n\t\t\t\tdomStyle.set(this.knob, \"left\", innWidth);\r\n\t\t\t\tif(this.value == \"off\"){\r\n\t\t\t\t\tdomStyle.set(this.inner, \"left\", this.isLeftToRight()?(\"-\" + innWidth):0);\r\n\t\t\t\t}\r\n\t\t\t\tthis._hasMaskImage = false;\r\n\t\t\t\tthis._createMaskImage();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_changeState: function(/*String*/state, /*Boolean*/anim){\r\n\t\t\tvar on = (state === \"on\");\r\n\t\t\tthis.left.style.display = \"\";\r\n\t\t\tthis.right.style.display = \"\";\r\n\t\t\tthis.inner.style.left = \"\";\r\n\t\t\tif(anim){\r\n\t\t\t\tdomClass.add(this.switchNode, \"mblSwitchAnimation\");\r\n\t\t\t}\r\n\t\t\tdomClass.remove(this.switchNode, on ? \"mblSwitchOff\" : \"mblSwitchOn\");\r\n\t\t\tdomClass.add(this.switchNode, on ? \"mblSwitchOn\" : \"mblSwitchOff\");\r\n\t\t\tdomAttr.set(this.switchNode, \"aria-checked\", on ? \"true\" : \"false\"); //a11y\r\n\r\n\t\t\tif(!on && !has(\"windows-theme\")){\r\n\t\t\t\tthis.inner.style.left  = (this.isLeftToRight()?(-(domStyle.get(this.domNode,\"width\") - domStyle.get(this.knob,\"width\"))):0) + \"px\";\r\n\t\t\t}\r\n\r\n\t\t\tvar _this = this;\r\n\t\t\t_this.defer(function(){\r\n\t\t\t\t_this.left.style.display = on ? \"\" : \"none\";\r\n\t\t\t\t_this.right.style.display = !on ? \"\" : \"none\";\r\n\t\t\t\tdomClass.remove(_this.switchNode, \"mblSwitchAnimation\");\r\n\t\t\t}, anim ? 300 : 0);\r\n\t\t},\r\n\r\n\t\t_createMaskImage: function(){\r\n\t\t\tif(this._timer){\r\n\t\t\t\t this._timer.remove();\r\n\t\t\t\t delete this._timer;\r\n\t\t\t}\r\n\t\t\tif(this._hasMaskImage){ return; }\r\n\t\t\tvar w = domStyle.get(this.domNode,\"width\"), h = domStyle.get(this.domNode,\"height\");\r\n\t\t\tthis._width = (w - domStyle.get(this.knob,\"width\"));\r\n\t\t\tthis._hasMaskImage = true;\r\n\t\t\tif(!(has(\"mask-image\"))){ return; }\r\n\t\t\tvar rDef = domStyle.get(this.left, \"borderTopLeftRadius\");\r\n\t\t\tif(rDef == \"0px\"){ return; }\r\n\t\t\tvar rDefs = rDef.split(\" \");\r\n\t\t\tvar rx = parseFloat(rDefs[0]), ry = (rDefs.length == 1) ? rx : parseFloat(rDefs[1]);\r\n\t\t\tvar id = (this.shape+\"Mask\"+w+h+rx+ry).replace(/\\./,\"_\");\r\n\r\n\t\t\tmaskUtils.createRoundMask(this.switchNode, 0, 0, 0, 0, w, h, rx, ry, 1);\r\n\t\t},\r\n\r\n\t\t_onClick: function(e){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tInternal handler for click events.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\tif(e && e.type === \"keydown\" && e.keyCode !== 13){ return; }\r\n\t\t\tif(this.onClick(e) === false){ return; } // user's click action\r\n\t\t\tif(this._moved){ return; }\r\n\t\t\tthis._set(\"value\", this.input.value = (this.value == \"on\") ? \"off\" : \"on\");\r\n\t\t\tthis._changeState(this.value, true);\r\n\t\t\tthis.onStateChanged(this.value);\r\n\t\t},\r\n\r\n\t\tonClick: function(/*Event*/ /*===== e =====*/){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tUser defined function to handle clicks\r\n\t\t\t// tags:\r\n\t\t\t//\t\tcallback\r\n\t\t},\r\n\r\n\t\tonTouchStart: function(/*Event*/e){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tInternal function to handle touchStart events.\r\n\t\t\tthis._moved = false;\r\n\t\t\tthis.innerStartX = this.inner.offsetLeft;\r\n\t\t\tif(!this._conn){\r\n\t\t\t\tthis._conn = [\r\n\t\t\t\t\tthis.connect(this.inner, touch.move, \"onTouchMove\"),\r\n\t\t\t\t\tthis.connect(win.doc, touch.release, \"onTouchEnd\")\r\n\t\t\t\t];\r\n\r\n\t\t\t\t/* While moving the slider knob sometimes IE fires MSPointerCancel event. That prevents firing\r\n\t\t\t\tMSPointerUp event (http://msdn.microsoft.com/ru-ru/library/ie/hh846776%28v=vs.85%29.aspx) so the\r\n\t\t\t\tknob can be stuck in the middle of the switch. As a fix we handle MSPointerCancel event with the\r\n\t\t\t\tsame lintener as for MSPointerUp event.\r\n\t\t\t\t*/\r\n\t\t\t\tif(has(\"windows-theme\")){\r\n\t\t\t\t\tthis._conn.push(this.connect(win.doc, \"MSPointerCancel\", \"onTouchEnd\"));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.touchStartX = e.touches ? e.touches[0].pageX : e.clientX;\r\n\t\t\tthis.left.style.display = \"\";\r\n\t\t\tthis.right.style.display = \"\";\r\n\t\t\tevent.stop(e);\r\n\t\t\tthis._createMaskImage();\r\n\t\t},\r\n\r\n\t\tonTouchMove: function(/*Event*/e){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tInternal function to handle touchMove events.\r\n\t\t\te.preventDefault();\r\n\t\t\tvar dx;\r\n\t\t\tif(e.targetTouches){\r\n\t\t\t\tif(e.targetTouches.length != 1){ return; }\r\n\t\t\t\tdx = e.targetTouches[0].clientX - this.touchStartX;\r\n\t\t\t}else{\r\n\t\t\t\tdx = e.clientX - this.touchStartX;\r\n\t\t\t}\r\n\t\t\tvar pos = this.innerStartX + dx;\r\n\t\t\tvar d = 10;\r\n\t\t\tif(pos <= -(this._width-d)){ pos = -this._width; }\r\n\t\t\tif(pos >= -d){ pos = 0; }\r\n\t\t\tthis.inner.style.left = pos + \"px\";\r\n\t\t\tif(Math.abs(dx) > d){\r\n\t\t\t\tthis._moved = true;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tonTouchEnd: function(/*Event*/e){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tInternal function to handle touchEnd events.\r\n\t\t\tarray.forEach(this._conn, connect.disconnect);\r\n\t\t\tthis._conn = null;\r\n\t\t\tif(this.innerStartX == this.inner.offsetLeft){\r\n\t\t\t\t// need to send a synthetic click?\r\n\t\t\t\tif(has(\"touch\") && has(\"clicks-prevented\")){\r\n\t\t\t\t\tdm._sendClick(this.inner, e);\r\n\t\t\t\t}\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar newState = (this.inner.offsetLeft < -(this._width/2)) ? \"off\" : \"on\";\r\n\t\t\tnewState = this._newState(newState);\r\n\t\t\tthis._changeState(newState, true);\r\n\t\t\tif(newState != this.value){\r\n\t\t\t\tthis._set(\"value\", this.input.value = newState);\r\n\t\t\t\tthis.onStateChanged(newState);\r\n\t\t\t}\r\n\t\t},\r\n\t\t_newState: function(newState){\r\n\t\t\treturn newState;\r\n\t\t},\r\n\t\tonStateChanged: function(/*String*/newState){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tStub function to connect to from your application.\r\n\t\t\t// description:\r\n\t\t\t//\t\tCalled when the state has been changed.\r\n\t\t\tif (this.labelNode) {\r\n\t\t\t\tthis.labelNode.innerHTML = newState=='off' ? this.rightLabel : this.leftLabel;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_setValueAttr: function(/*String*/value){\r\n\t\t\tthis._changeState(value, false);\r\n\t\t\tif(this.value != value){\r\n\t\t\t\tthis._set(\"value\", this.input.value = value);\r\n\t\t\t\tthis.onStateChanged(value);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_setLeftLabelAttr: function(/*String*/label){\r\n\t\t\tthis.leftLabel = label;\r\n\t\t\tthis.left.firstChild.innerHTML = this._cv ? this._cv(label) : label;\r\n\t\t},\r\n\r\n\t\t_setRightLabelAttr: function(/*String*/label){\r\n\t\t\tthis.rightLabel = label;\r\n\t\t\tthis.right.firstChild.innerHTML = this._cv ? this._cv(label) : label;\r\n\t\t},\r\n\r\n\t\treset: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tReset the widget's value to what it was at initialization time\r\n\t\t\tthis.set(\"value\", this._initialValue);\r\n\t\t}\r\n\t});\r\n\r\n\treturn has(\"dojo-bidi\") ? declare(\"dojox.mobile.Switch\", [Switch, BidiSwitch]) : Switch;\r\n});\r\n"]}