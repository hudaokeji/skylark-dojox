{"version":3,"sources":["storage/FlashStorageProvider.js"],"names":["dojo","provide","require","declare","dojox","storage","Provider","initialized","_available","_statusHandler","_flashReady","_pageReady","initialize","config","flash","addLoadedListener","hitch","this","_loaded","swfLoc","moduleUrl","toString","setSwf","connect","setFlushDelay","newDelay","isNaN","Error","comm","String","getFlushDelay","Number","flush","namespace","DEFAULT_NAMESPACE","isAvailable","put","key","value","resultsHandler","isValidKey","isString","toJson","putMultiple","keys","values","isValidKeyArray","Array","length","metaKey","join","lengths","i","metaValue","metaLengths","get","results","_destringify","getMultiple","metaResults","eval","test","substring","fromJson","getKeys","split","sort","getNamespaces","clear","remove","removeMultiple","raise","isPermanent","getMaximumSize","SIZE_NO_LIMIT","hasSettingsUI","showSettingsUI","showSettings","obj","setVisible","center","hideSettingsUI","isFunction","onHideSettingsUI","call","getResourceList","_allNamespaces","manager","loaded","_onStatus","statusResult","ds","dfo","PENDING","register","FlashStorageProvider"],"mappings":"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","file":"../../storage/FlashStorageProvider.js","sourcesContent":["dojo.provide(\"dojox.storage.FlashStorageProvider\");\r\n\r\ndojo.require(\"dojox.flash\");\r\ndojo.require(\"dojox.storage.manager\");\r\ndojo.require(\"dojox.storage.Provider\");\r\n\r\n\r\ndojo.declare(\"dojox.storage.FlashStorageProvider\", dojox.storage.Provider, {\r\n\t\t// summary:\r\n\t\t//\t\tStorage provider that uses features in Flash to achieve permanent\r\n\t\t//\t\tstorage\r\n\t\t// description:\r\n\t\t//\t\tAuthors of this storage provider-\r\n\t\t//\t\tBrad Neuberg, bkn3@columbia.edu\r\n\r\n\t\tinitialized: false,\r\n\t\t\r\n\t\t_available: null,\r\n\t\t_statusHandler: null,\r\n\t\t_flashReady: false,\r\n\t\t_pageReady: false,\r\n\t\t\r\n\t\tinitialize: function(){\r\n\t\t  //console.debug(\"FlashStorageProvider.initialize\");\r\n\t\t\tif(dojo.config[\"disableFlashStorage\"] == true){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// initialize our Flash\r\n\t\t\tdojox.flash.addLoadedListener(dojo.hitch(this, function(){\r\n\t\t\t  //console.debug(\"flashReady\");\r\n\t\t\t  // indicate our Flash subsystem is now loaded\r\n\t\t\t  this._flashReady = true;\r\n\t\t\t  if(this._flashReady && this._pageReady){\r\n\t\t\t\t  this._loaded();\r\n\t\t\t\t}\r\n\t\t\t}));\r\n\t\t\tvar swfLoc = dojo.moduleUrl(\"dojox\", \"storage/Storage.swf\").toString();\r\n\t\t\tdojox.flash.setSwf(swfLoc, false);\r\n\t\t\t\r\n\t\t\t// wait till page is finished loading\r\n\t\t\tdojo.connect(dojo, \"loaded\", this, function(){\r\n\t\t\t  //console.debug(\"pageReady\");\r\n\t\t\t  this._pageReady = true;\r\n\t\t\t  if(this._flashReady && this._pageReady){\r\n\t\t\t    this._loaded();\r\n\t\t\t  }\r\n\t\t\t});\r\n\t\t},\r\n\t\t\r\n\t\t//\tSet a new value for the flush delay timer.\r\n\t\t//\tPossible values:\r\n\t\t//\t  0 : Perform the flush synchronously after each \"put\" request\r\n\t\t//\t> 0 : Wait until 'newDelay' ms have passed without any \"put\" request to flush\r\n\t\t//\t -1 : Do not  automatically flush\r\n\t\tsetFlushDelay: function(newDelay){\r\n\t\t\tif(newDelay === null || typeof newDelay === \"undefined\" || isNaN(newDelay)){\r\n\t\t\t\tthrow new Error(\"Invalid argunment: \" + newDelay);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tdojox.flash.comm.setFlushDelay(String(newDelay));\r\n\t\t},\r\n\t\t\r\n\t\tgetFlushDelay: function(){\r\n\t\t\treturn Number(dojox.flash.comm.getFlushDelay());\r\n\t\t},\r\n\t\t\r\n\t\tflush: function(namespace){\r\n\t\t\t//FIXME: is this test necessary?  Just use !namespace\r\n\t\t\tif(namespace == null || typeof namespace == \"undefined\"){\r\n\t\t\t\tnamespace = dojox.storage.DEFAULT_NAMESPACE;\r\n\t\t\t}\r\n\t\t\tdojox.flash.comm.flush(namespace);\r\n\t\t},\r\n\r\n\t\tisAvailable: function(){\r\n\t\t\treturn (this._available = !dojo.config[\"disableFlashStorage\"]);\r\n\t\t},\r\n\r\n\t\tput: function(key, value, resultsHandler, namespace){\r\n\t\t\tif(!this.isValidKey(key)){\r\n\t\t\t\tthrow new Error(\"Invalid key given: \" + key);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(!namespace){\r\n\t\t\t\tnamespace = dojox.storage.DEFAULT_NAMESPACE;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(!this.isValidKey(namespace)){\r\n\t\t\t\tthrow new Error(\"Invalid namespace given: \" + namespace);\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t\tthis._statusHandler = resultsHandler;\r\n\t\t\t\r\n\t\t\t// serialize the value;\r\n\t\t\t// handle strings differently so they have better performance\r\n\t\t\tif(dojo.isString(value)){\r\n\t\t\t\tvalue = \"string:\" + value;\r\n\t\t\t}else{\r\n\t\t\t\tvalue = dojo.toJson(value);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tdojox.flash.comm.put(key, value, namespace);\r\n\t\t},\r\n\r\n\t\tputMultiple: function(keys, values, resultsHandler, namespace){\r\n\t\t\tif(!this.isValidKeyArray(keys) || ! values instanceof Array\r\n\t\t\t    || keys.length != values.length){\r\n\t\t\t\tthrow new Error(\"Invalid arguments: keys = [\" + keys + \"], values = [\" + values + \"]\");\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(!namespace){\r\n\t\t\t\tnamespace = dojox.storage.DEFAULT_NAMESPACE;\r\n\t\t\t}\r\n\r\n\t\t\tif(!this.isValidKey(namespace)){\r\n\t\t\t\tthrow new Error(\"Invalid namespace given: \" + namespace);\r\n\t\t\t}\r\n\r\n\t\t\tthis._statusHandler = resultsHandler;\r\n\t\t\t\r\n\t\t\t//\tConvert the arguments on strings we can pass along to Flash\r\n\t\t\tvar metaKey = keys.join(\",\");\r\n\t\t\tvar lengths = [];\r\n\t\t\tfor(var i=0;i<values.length;i++){\r\n\t\t\t\tif(dojo.isString(values[i])){\r\n\t\t\t\t\tvalues[i] = \"string:\" + values[i];\r\n\t\t\t\t}else{\r\n\t\t\t\t\tvalues[i] = dojo.toJson(values[i]);\r\n\t\t\t\t}\r\n\t\t\t\tlengths[i] = values[i].length;\r\n\t\t\t}\r\n\t\t\tvar metaValue = values.join(\"\");\r\n\t\t\tvar metaLengths = lengths.join(\",\");\r\n\t\t\t\r\n\t\t\tdojox.flash.comm.putMultiple(metaKey, metaValue, metaLengths, namespace);\r\n\t\t},\r\n\r\n\t\tget: function(key, namespace){\r\n\t\t\tif(!this.isValidKey(key)){\r\n\t\t\t\tthrow new Error(\"Invalid key given: \" + key);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(!namespace){\r\n\t\t\t\tnamespace = dojox.storage.DEFAULT_NAMESPACE;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(!this.isValidKey(namespace)){\r\n\t\t\t\tthrow new Error(\"Invalid namespace given: \" + namespace);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar results = dojox.flash.comm.get(key, namespace);\r\n\r\n\t\t\tif(results == \"\"){\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\r\n\t\t\treturn this._destringify(results);\r\n\t\t},\r\n\r\n\t\tgetMultiple: function(/*array*/ keys, /*string?*/ namespace){ /*Object*/\r\n\t\t\tif(!this.isValidKeyArray(keys)){\r\n\t\t\t\tthrow new (\"Invalid key array given: \" + keys);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(!namespace){\r\n\t\t\t\tnamespace = dojox.storage.DEFAULT_NAMESPACE;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(!this.isValidKey(namespace)){\r\n\t\t\t\tthrow new Error(\"Invalid namespace given: \" + namespace);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar metaKey = keys.join(\",\");\r\n\t\t\tvar metaResults = dojox.flash.comm.getMultiple(metaKey, namespace);\r\n\t\t\tvar results = eval(\"(\" + metaResults + \")\");\r\n\t\t\t\r\n\t\t\t//\tdestringify each entry back into a real JS object\r\n\t\t\t//FIXME: use dojo.map\r\n\t\t\tfor(var i = 0; i < results.length; i++){\r\n\t\t\t\tresults[i] = (results[i] == \"\") ? null : this._destringify(results[i]);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn results;\r\n\t\t},\r\n\r\n\t\t_destringify: function(results){\r\n\t\t\t// destringify the content back into a\r\n\t\t\t// real JavaScript object;\r\n\t\t\t// handle strings differently so they have better performance\r\n\t\t\tif(dojo.isString(results) && (/^string:/.test(results))){\r\n\t\t\t\tresults = results.substring(\"string:\".length);\r\n\t\t\t}else{\r\n\t\t\t\tresults = dojo.fromJson(results);\r\n\t\t\t}\r\n\t\t\r\n\t\t\treturn results;\r\n\t\t},\r\n\t\t\r\n\t\tgetKeys: function(namespace){\r\n\t\t\tif(!namespace){\r\n\t\t\t\tnamespace = dojox.storage.DEFAULT_NAMESPACE;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(!this.isValidKey(namespace)){\r\n\t\t\t\tthrow new Error(\"Invalid namespace given: \" + namespace);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar results = dojox.flash.comm.getKeys(namespace);\r\n\t\t\t\r\n\t\t\t// Flash incorrectly returns an empty string as \"null\"\r\n\t\t\tif(results == null || results == \"null\"){\r\n\t\t\t  results = \"\";\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tresults = results.split(\",\");\r\n\t\t\tresults.sort();\r\n\t\t\t\r\n\t\t\treturn results;\r\n\t\t},\r\n\t\t\r\n\t\tgetNamespaces: function(){\r\n\t\t\tvar results = dojox.flash.comm.getNamespaces();\r\n\t\t\t\r\n\t\t\t// Flash incorrectly returns an empty string as \"null\"\r\n\t\t\tif(results == null || results == \"null\"){\r\n\t\t\t  results = dojox.storage.DEFAULT_NAMESPACE;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tresults = results.split(\",\");\r\n\t\t\tresults.sort();\r\n\t\t\t\r\n\t\t\treturn results;\r\n\t\t},\r\n\r\n\t\tclear: function(namespace){\r\n\t\t\tif(!namespace){\r\n\t\t\t\tnamespace = dojox.storage.DEFAULT_NAMESPACE;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(!this.isValidKey(namespace)){\r\n\t\t\t\tthrow new Error(\"Invalid namespace given: \" + namespace);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tdojox.flash.comm.clear(namespace);\r\n\t\t},\r\n\t\t\r\n\t\tremove: function(key, namespace){\r\n\t\t\tif(!namespace){\r\n\t\t\t\tnamespace = dojox.storage.DEFAULT_NAMESPACE;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(!this.isValidKey(namespace)){\r\n\t\t\t\tthrow new Error(\"Invalid namespace given: \" + namespace);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tdojox.flash.comm.remove(key, namespace);\r\n\t\t},\r\n\t\t\r\n\t\tremoveMultiple: function(/*array*/ keys, /*string?*/ namespace){ /*Object*/\r\n\t\t\tif(!this.isValidKeyArray(keys)){\r\n\t\t\t\tdojo.raise(\"Invalid key array given: \" + keys);\r\n\t\t\t}\r\n\t\t\tif(!namespace){\r\n\t\t\t\tnamespace = dojox.storage.DEFAULT_NAMESPACE;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(!this.isValidKey(namespace)){\r\n\t\t\t\tthrow new Error(\"Invalid namespace given: \" + namespace);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar metaKey = keys.join(\",\");\r\n\t\t\tdojox.flash.comm.removeMultiple(metaKey, namespace);\r\n\t\t},\r\n\r\n\t\tisPermanent: function(){\r\n\t\t\treturn true;\r\n\t\t},\r\n\r\n\t\tgetMaximumSize: function(){\r\n\t\t\treturn dojox.storage.SIZE_NO_LIMIT;\r\n\t\t},\r\n\r\n\t\thasSettingsUI: function(){\r\n\t\t\treturn true;\r\n\t\t},\r\n\r\n\t\tshowSettingsUI: function(){\r\n\t\t\tdojox.flash.comm.showSettings();\r\n\t\t\tdojox.flash.obj.setVisible(true);\r\n\t\t\tdojox.flash.obj.center();\r\n\t\t},\r\n\r\n\t\thideSettingsUI: function(){\r\n\t\t\t// hide the dialog\r\n\t\t\tdojox.flash.obj.setVisible(false);\r\n\t\t\t\r\n\t\t\t// call anyone who wants to know the dialog is\r\n\t\t\t// now hidden\r\n\t\t\tif(dojo.isFunction(dojox.storage.onHideSettingsUI)){\r\n\t\t\t\tdojox.storage.onHideSettingsUI.call(null);\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\tgetResourceList: function(){ /* Array[] */\r\n\t\t\t// Dojo Offline no longer uses the FlashStorageProvider for offline\r\n\t\t\t// storage; Gears is now required\r\n\t\t\treturn [];\r\n\t\t},\r\n\t\t\r\n\t\t/** Called when Flash and the page are finished loading. */\r\n\t\t_loaded: function(){\r\n\t\t\t// get available namespaces\r\n\t\t\tthis._allNamespaces = this.getNamespaces();\r\n\t\t\t\r\n\t\t\tthis.initialized = true;\r\n\r\n\t\t\t// indicate that this storage provider is now loaded\r\n\t\t\tdojox.storage.manager.loaded();\r\n\t\t},\r\n\t\t\r\n\t\t//\tCalled if the storage system needs to tell us about the status\r\n\t\t//\tof a put() request.\r\n\t\t_onStatus: function(statusResult, key, namespace){\r\n\t\t  //console.debug(\"onStatus, statusResult=\"+statusResult+\", key=\"+key);\r\n\t\t\tvar ds = dojox.storage;\r\n\t\t\tvar dfo = dojox.flash.obj;\r\n\t\t\t\r\n\t\t\tif(statusResult == ds.PENDING){\r\n\t\t\t\tdfo.center();\r\n\t\t\t\tdfo.setVisible(true);\r\n\t\t\t}else{\r\n\t\t\t\tdfo.setVisible(false);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(ds._statusHandler){\r\n\t\t\t\tds._statusHandler.call(null, statusResult, key, null, namespace);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n);\r\n\r\ndojox.storage.manager.register(\"dojox.storage.FlashStorageProvider\",\r\n\t\t\t\t\t\t\t\tnew dojox.storage.FlashStorageProvider());\r\n"]}