{"version":3,"sources":["storage/tests/test_storage.js"],"names":["dojo","require","TestStorage","currentProvider","currentNamespace","initialize","dojox","storage","manager","available","o","document","createElement","appendChild","createTextNode","value","selected","selector","byId","disabled","alert","this","_determineCurrentNamespace","_printAvailableProviders","_printAvailableNamespaces","_printAvailableKeys","providerDirectory","connect","providerChange","namespaceDirectory","namespaceChange","directory","directoryChange","storageValueElem","printValueSize","keyNameField","evt","selectedIndex","currentChild","firstChild","nextSibling","nodeType","functionName","id","match","_printProviderMetadata","hasSettingsUI","provider","target","query","window","location","href","indexOf","ns","key","_handleLoad","load","preventDefault","stopPropagation","loadMultiple","dir","i","keyArray","options","length","push","_handleLoadMultiple","save","namespace","_save","saveMultiple","valueArray","_saveMultiple","clearNamespace","clear","_printStatus","self","saveHandler","status","keyName","FAILED","SUCCESS","DEFAULT_NAMESPACE","putMultiple","exp","configure","onHideSettingsUI","showSettingsUI","remove","keyValueField","childNodes","removeChild","removeMultiple","confirm","units","storageValue","size","Math","round","innerHTML","saveBook","d","xhrGet","url","handleAs","addCallback","hitch","results","addErrback","error","saveXML","put","availableKeys","getKeys","optionNode","resultArray","getMultiple","toJson","namespacesDir","availableNamespaces","getNamespaces","get","storageType","declaredClass","isSupported","isAvailable","maximumSize","getMaximumSize","permanent","isPermanent","uiConfig","moreInfo","flash","info","version","message","top","currentNode","className","fadeOut","node","duration","play","defaultPresent","setTimeout","p","providers","name","addOnLoad","isInitialized"],"mappings":"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","file":"../../../storage/tests/test_storage.js","sourcesContent":["dojo.require(\"dojox.storage\");\r\n\r\nvar TestStorage = {\r\n\tcurrentProvider: \"default\",\r\n\tcurrentNamespace: null,\r\n\t\r\n\tinitialize: function(){\r\n\t\t//console.debug(\"test_storage.initialize()\");\r\n\t\t\r\n\t\t// do we even have a storage provider?\r\n\t\tif(dojox.storage.manager.available == false){\r\n\t\t\tvar o = document.createElement(\"option\");\r\n\t\t\to.appendChild(document.createTextNode(\"None\"));\r\n\t\t\to.value = \"None\";\r\n\t\t\to.selected = true;\r\n\t\t\tvar selector = dojo.byId(\"currentStorageProvider\");\r\n\t\t\tselector.disabled = true;\r\n\t\t\tselector.appendChild(o);\r\n\t\t\t\r\n\t\t\talert(\"No storage provider is available on this browser\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\t// what should our starting namespace be?\r\n\t\tthis._determineCurrentNamespace();\r\n\t\t\r\n\t\t// clear out old values and enable input forms\r\n\t\tdojo.byId(\"storageNamespace\").value = this.currentNamespace;\r\n\t\tdojo.byId(\"storageNamespace\").disabled = false;\r\n\t\tdojo.byId(\"storageKey\").value = \"\";\r\n\t\tdojo.byId(\"storageKey\").disabled = false;\r\n\t\tdojo.byId(\"storageValue\").value = \"\";\r\n\t\tdojo.byId(\"storageValue\").disabled = false;\r\n\t\t\r\n\t\t// write out available providers\r\n\t\tthis._printAvailableProviders();\r\n\t\t\r\n\t\t// write out our available namespaces\r\n\t\tthis._printAvailableNamespaces();\r\n\t\t\r\n\t\t// write out our available keys\r\n\t\tthis._printAvailableKeys();\r\n\t\t\r\n\t\t// initialize our event handlers\r\n\t\tvar providerDirectory = dojo.byId(\"currentStorageProvider\");\r\n\t\tdojo.connect(providerDirectory, \"onchange\", this, this.providerChange);\r\n\t\tvar namespaceDirectory = dojo.byId(\"namespaceDirectory\");\r\n\t\tdojo.connect(namespaceDirectory, \"onchange\", this, this.namespaceChange);\r\n\t\tvar directory = dojo.byId(\"directory\");\r\n\t\tdojo.connect(directory, \"onchange\", this, this.directoryChange);\r\n\t\tvar storageValueElem = dojo.byId(\"storageValue\");\r\n\t\tdojo.connect(storageValueElem, \"onkeyup\", this, this.printValueSize);\r\n\t\t\r\n\t\t// make the directory be unselected if the key name field gets focus\r\n\t\tvar keyNameField = dojo.byId(\"storageKey\");\r\n\t\tdojo.connect(keyNameField, \"onfocus\", function(evt){\r\n\t\t\tdirectory.selectedIndex = -1;\r\n\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t \r\n\t\t// add onclick listeners to all of our buttons\r\n\t\tvar buttonContainer = dojo.byId(\"buttonContainer\");\r\n\t\tvar currentChild = buttonContainer.firstChild;\r\n\t\twhile(currentChild.nextSibling != null){\r\n\t\t\tif(currentChild.nodeType == 1){\r\n\t\t\t\tvar buttonName = currentChild.id;\r\n\t\t\t\tvar functionName = buttonName.match(/^(.*)Button$/)[1];\r\n\t\t\t\tdojo.connect(currentChild, \"onclick\", this, this[functionName]);\r\n\t\t\t\tcurrentChild.disabled = false;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tcurrentChild = currentChild.nextSibling;\r\n\t\t}\r\n\t\t\r\n\t\t// print out metadata\r\n\t\tthis._printProviderMetadata();\r\n\t\t\r\n\t\t// disable the configuration button if none is supported for this provider\r\n\t\tif(dojox.storage.hasSettingsUI() == false){\r\n\t\t\tdojo.byId(\"configureButton\").disabled = true;\r\n\t\t}\r\n\t},\r\n\t\r\n\tproviderChange: function(evt){\r\n\t\tvar provider = evt.target.value;\r\n\t\t\r\n\t\t// reload the page with this provider\r\n\t\tvar query = \"\";\r\n\t\tif(window.location.href.indexOf(\"forceStorageProvider\") == -1){\r\n\t\t\tquery = \"?\";\r\n\t\t}else{\r\n\t\t\tquery = \"&\";\r\n\t\t}\r\n\t\t\r\n\t\twindow.location.href += query + \"forceStorageProvider=\" + provider;\r\n\t},\r\n\t\r\n\tnamespaceChange: function(evt){\r\n\t\tvar ns = evt.target.value;\r\n\t\tthis.currentNamespace = ns;\r\n\t\t\r\n\t\t// update our available keys\r\n\t\tthis._printAvailableKeys();\r\n\t\t\r\n\t\t// clear out our key and values\r\n\t\tdojo.byId(\"storageNamespace\").value = this.currentNamespace;\r\n\t\tdojo.byId(\"storageKey\").value = \"\";\r\n\t\tdojo.byId(\"storageValue\").value = \"\";\r\n\t},\r\n\t\r\n\tdirectoryChange: function(evt){\r\n\t\tvar key = evt.target.value;\r\n\t\t\r\n\t\t// add this value into the form\r\n\t\tvar keyNameField = dojo.byId(\"storageKey\");\r\n\t\tkeyNameField.value = key;\r\n\t\t\r\n\t\tthis._handleLoad(key);\r\n\t},\r\n\t\r\n\tload: function(evt){\r\n\t\t// cancel the button's default behavior\r\n\t\tevt.preventDefault();\r\n\t\tevt.stopPropagation();\r\n\t\t\r\n\t\t// get the key to load\r\n\t\tvar key = dojo.byId(\"storageKey\").value;\r\n\t\t\r\n\t\tif(key == null || typeof key == \"undefined\" || key == \"\"){\r\n\t\t\talert(\"Please enter a key name\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tthis._handleLoad(key);\r\n\t},\r\n\t\r\n\tloadMultiple: function(evt){\r\n\t\t// cancel the button's default behavior\r\n\t\tevt.preventDefault();\r\n\t\tevt.stopPropagation();\r\n           \r\n\t\t// get the keys to load\r\n\t\tvar dir = dojo.byId(\"directory\");\r\n\t\tif(dir.selectedIndex < 0){\r\n\t\t\talert(\"Please select a key from the 'All Keys' list\");\r\n\t\t\treturn;\r\n\t\t}\r\n                 \r\n\t\tvar keyArray = [dir.value], i;\r\n  \r\n\t\tfor(i = dir.options.selectedIndex + 1; i < dir.options.length\r\n\t\t\t\t\t\t\t\t\t&& keyArray.length < 10; i++){\r\n\t\t\t\t\t\t\t\t\t\tkeyArray.push(dir.options[i].value);\r\n\t\t}\r\n\r\n\t\tfor(i = dir.options.selectedIndex - 1; i >= 0 && keyArray.length < 10; i--){\r\n\t\t\tkeyArray.push(dir.options[i].value);\r\n\t\t}\r\n                                 \r\n\t\tthis._handleLoadMultiple(keyArray);\r\n\t},\r\n\t\r\n\tsave: function(evt){\r\n\t\t// cancel the button's default behavior\r\n\t\tevt.preventDefault();\r\n\t\tevt.stopPropagation();\r\n\t\t\r\n\t\t// get the new values\r\n\t\tvar key = dojo.byId(\"storageKey\").value;\r\n\t\tvar value = dojo.byId(\"storageValue\").value;\r\n\t\tvar namespace = dojo.byId(\"storageNamespace\").value;\r\n\t\t\r\n\t\tif(key == null || typeof key == \"undefined\" || key == \"\"){\r\n\t\t\talert(\"Please enter a key name\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tif(value == null || typeof value == \"undefined\" || value == \"\"){\r\n\t\t\talert(\"Please enter a key value\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\t// print out the size of the value\r\n\t\tthis.printValueSize();\r\n\t\t\r\n\t\t// do the save\r\n\t\tthis._save(key, value, namespace);\r\n\t},\r\n\t\r\n\tsaveMultiple: function(evt) {\r\n\t\t// cancel the button's default behavior\r\n\t\tevt.preventDefault();\r\n\t\tevt.stopPropagation();\r\n                \r\n\t\t// get the new values\r\n\t\tvar key = dojo.byId(\"storageKey\").value;\r\n\t\tvar value = dojo.byId(\"storageValue\").value;\r\n\t\tvar namespace = dojo.byId(\"storageNamespace\").value;\r\n          \r\n\t\tif(key == null || typeof key == \"undefined\" || key == \"\"){\r\n\t\t\talert(\"Please enter a key name\");\r\n\t\t\treturn;\r\n\t\t}\r\n     \r\n\t\tif(value == null || typeof value == \"undefined\" || value == \"\"){\r\n\t\t\talert(\"Please enter a key value\");\r\n\t\t\treturn;\r\n\t\t}\r\n                 \r\n\t\t// print out the size of the value\r\n\t\tthis.printValueSize();\r\n                 \r\n\t\t// do the save\r\n\t\tvar keyArray = [], valueArray = [];\r\n\t\tfor(var i = 0; i < 10; i++) {\r\n\t\t\tkeyArray.push(key+i);\r\n\t\t\tvalueArray.push(i + \") \" + value);\r\n\t\t}\r\n\t\tthis._saveMultiple(keyArray, valueArray, namespace);\r\n\t},\r\n\t\r\n\tclearNamespace: function(evt){\r\n\t\t// cancel the button's default behavior\r\n\t\tevt.preventDefault();\r\n\t\tevt.stopPropagation();\r\n\t\t\r\n\t\tdojox.storage.clear(this.currentNamespace);\r\n\t\t\r\n\t\tthis._printAvailableNamespaces();\r\n\t\tthis._printAvailableKeys();\r\n\t},\r\n\t\r\n\t_saveMultiple: function(keyArray, valueArray, namespace) {\r\n\t\tthis._printStatus(\"Saving 10 keys, starting with '\" + keyArray[0] + \"'...\");\r\n\t\tvar self = this;\r\n\t\tvar saveHandler = function(status, keyName){\r\n\t\t\t//console.debug(\"saveHandler, status=\"+status+\", keyName=\"+keyName);\r\n\t\t\tif(status == dojox.storage.FAILED){\r\n\t\t\t\talert(\"You do not have permission to store data for this web site. \"\r\n\t\t\t\t\t\t\t+ \"Press the Configure button to grant permission.\");\r\n\t\t\t}else if(status == dojox.storage.SUCCESS){\r\n\t\t\t\t// clear out the old value\r\n\t\t\t\tdojo.byId(\"storageKey\").value = \"\";\r\n\t\t\t\tdojo.byId(\"storageValue\").value = \"\";\r\n \t\t\t\tself._printStatus(\"Saved '\" + keyArray[0] + \"' and \"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ (keyArray.length - 1) + \" others\");\r\n              \r\n\t\t\t\tif(typeof namespace != \"undefined\" && namespace != null){\r\n\t\t\t\t\tself.currentNamespace = namespace;\r\n\t\t\t\t}\r\n             \r\n\t\t\t\tself._printAvailableKeys();\r\n\t\t\t\tself._printAvailableNamespaces();\r\n\t\t\t}\r\n\t\t};\r\n             \r\n\t\ttry{\r\n\t\t\tif(namespace == dojox.storage.DEFAULT_NAMESPACE){\r\n\t\t\t\tdojox.storage.putMultiple(keyArray, valueArray, saveHandler);\r\n\t\t\t}else{\r\n\t\t\t\tdojox.storage.putMultiple(keyArray, valueArray, saveHandler, namespace);\r\n\t\t\t}\r\n\t\t}catch(exp){\r\n\t\t\talert(exp);\r\n\t\t}\r\n\t},\r\n\t\r\n\tconfigure: function(evt){\r\n\t\t// cancel the button's default behavior\r\n\t\tevt.preventDefault();\r\n\t\tevt.stopPropagation();\r\n\t\t\r\n\t\tif(dojox.storage.hasSettingsUI()){\r\n\t\t\t// redraw our keys after the dialog is closed, in\r\n\t\t\t// case they have all been erased\r\n\t\t\tvar self = this;\r\n\t\t\tdojox.storage.onHideSettingsUI = function(){\r\n\t\t\t\tself._printAvailableKeys();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// show the dialog\r\n\t\t\tdojox.storage.showSettingsUI();\r\n\t\t}\r\n\t},\r\n\t\r\n\tremove: function(evt){\r\n\t\t// cancel the button's default behavior\r\n\t\tevt.preventDefault();\r\n\t\tevt.stopPropagation();\r\n\t\t\r\n\t\t// determine what key to delete; if the directory has a selected value,\r\n\t\t// use that; otherwise, use the key name field\r\n\t\tvar directory = dojo.byId(\"directory\");\r\n\t\tvar keyNameField = dojo.byId(\"storageKey\");\r\n\t\tvar keyValueField = dojo.byId(\"storageValue\");\r\n\t\tvar key;\r\n\t\tif(directory.selectedIndex != -1){\r\n\t\t\tkey = directory.value;\r\n\t\t\t// delete this option\r\n\t\t\tvar options = directory.childNodes;\r\n\t\t\tfor(var i = 0; i < options.length; i++){\r\n\t\t\t\tif(options[i].nodeType == 1 &&\r\n\t\t\t\t\t options[i].value == key){\r\n\t\t\t\t\tdirectory.removeChild(options[i]);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}else{\r\n\t\t\tkey = keyNameField.value;\r\n\t\t}\r\n\t\t\r\n\t\tkeyNameField.value = \"\";\r\n\t\tkeyValueField.value = \"\";\r\n\t\t\r\n\t\t// now delete the value\r\n\t\tthis._printStatus(\"Removing '\" + key + \"'...\");\r\n\t\tif(this.currentNamespace == dojox.storage.DEFAULT_NAMESPACE){\r\n\t\t\tdojox.storage.remove(key);\r\n\t\t}else{\r\n\t\t\tdojox.storage.remove(key, this.currentNamespace);\r\n\t\t}\r\n\t\t\r\n\t\t// update our UI\r\n\t\tthis._printAvailableNamespaces();\r\n\t\tthis._printStatus(\"Removed '\" + key);\r\n\t},\r\n\t\r\n\tremoveMultiple: function(evt){\r\n\t\t// cancel the button's default behavior\r\n\t\tevt.preventDefault();\r\n\t\tevt.stopPropagation();\r\n\r\n\t\t//\tTry to help the user understands what she's doing\r\n\t\tif(confirm(\"Are you sure you want to delete the entry for the selected key and up to 10 more entries?\")){\r\n\r\n\t\t\t// get the keys for entries to remove\r\n\t\t\tvar dir = dojo.byId(\"directory\");\r\n\t\t\tif(dir.selectedIndex < 0){\r\n\t\t\t\talert(\"Please select a key from the 'All Keys' list\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t                 \r\n\t\t\tvar keyArray = [];\r\n\t\t\tfor(var i = dir.options.selectedIndex; i < dir.options.length && keyArray.length < 10; i++){\r\n\t\t\t\tkeyArray.push( dir.options[i].value);\r\n\t\t\t}\r\n\r\n\t\t\tthis._printStatus(\"Removing '\" + (dir.options.selectedIndex - i) + \"' keys starting with '\" + dir.options[dir.options.selectedIndex].value + \"' ...\");\r\n\t\t\tif(this.currentNamespace == dojox.storage.DEFAULT_NAMESPACE){\r\n\t\t\t\tdojox.storage.removeMultiple(keyArray);\r\n\t\t\t}else{\r\n\t\t\t\tdojox.storage.removeMultiple(keyArray, this.currentNamespace);\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t\t//\tRemove the entries from the option list\r\n\t\t\tvar options = directory.childNodes;\r\n\t\t\tfor(i = dir.options.selectedIndex; i < dir.options.length && (i - dir.options.selectedIndex) < 10; i++){\r\n\t\t\t\tdirectory.removeChild(options[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\r\n\tprintValueSize: function(){\r\n\t\tvar storageValue = dojo.byId(\"storageValue\").value;\r\n\t\tvar size = 0;\r\n\t\tif(storageValue != null && typeof storageValue != \"undefined\"){\r\n\t\t\tsize = storageValue.length;\r\n\t\t}\r\n\t\t\r\n\t\t// determine the units we are dealing with\r\n\t\tvar units;\r\n\t\tif(size < 1024)\r\n\t\t\tunits = \" bytes\";\r\n\t\telse{\r\n\t\t\tunits = \" K\";\r\n\t\t\tsize = size / 1024;\r\n\t\t\tsize = Math.round(size);\r\n\t\t}\r\n\t\t\r\n\t\tsize = size + units;\r\n\t\t\r\n\t\tvar valueSize = dojo.byId(\"valueSize\");\r\n\t\tvalueSize.innerHTML = size;\r\n\t},\r\n\t\r\n\tsaveBook: function(evt){\r\n\t\tthis._printStatus(\"Loading book...\");\r\n\t\t\r\n\t\tvar d = dojo.xhrGet({\r\n\t\t\turl: \"resources/testBook.txt\",\r\n\t\t\thandleAs: \"text\"\r\n\t\t});\r\n\t\t\r\n\t\td.addCallback(dojo.hitch(this, function(results){\r\n\t\t\tthis._printStatus(\"Book loaded\");\r\n\t\t\tthis._save(\"testBook\", results);\r\n\t\t}));\r\n\t\t\r\n\t\td.addErrback(dojo.hitch(this, function(error){\r\n\t\t\talert(\"Unable to load testBook.txt: \" + error);\r\n\t\t}));\r\n\t\t\r\n\t\tif(!typeof evt != \"undefined\" && evt != null){\r\n\t\t\tevt.preventDefault();\r\n\t\t\tevt.stopPropagation();\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t},\r\n\t\r\n\tsaveXML: function(evt){\r\n\t\tthis._printStatus(\"Loading XML...\");\r\n\t\t\r\n\t\tvar d = dojo.xhrGet({\r\n\t\t\turl: \"resources/testXML.xml\",\r\n\t\t\thandleAs: \"text\"\r\n\t\t});\r\n\t\t\r\n\t\td.addCallback(dojo.hitch(this, function(results){\r\n\t\t\tthis._printStatus(\"XML loaded\");\r\n\t\t\tthis._save(\"testXML\", results);\r\n\t\t}));\r\n\t\t\r\n\t\td.addErrback(dojo.hitch(this, function(error){\r\n\t\t\talert(\"Unable to load testXML.xml: \" + error);\r\n\t\t}));\r\n\t\t\r\n\t\tif(!typeof evt != \"undefined\" && evt != null){\r\n\t\t\tevt.preventDefault();\r\n\t\t\tevt.stopPropagation();\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t},\r\n\t\r\n\t_save: function(key, value, namespace){\r\n\t\tthis._printStatus(\"Saving '\" + key + \"'...\");\r\n\t\tvar self = this;\r\n\t\tvar saveHandler = function(status, keyName){\r\n\t\t\t//console.debug(\"saveHandler, status=\"+status+\", keyName=\"+keyName);\r\n\t\t\tif(status == dojox.storage.FAILED){\r\n\t\t\t\talert(\"You do not have permission to store data for this web site. \"\r\n\t\t\t\t\t\t\t+ \"Press the Configure button to grant permission.\");\r\n\t\t\t}else if(status == dojox.storage.SUCCESS){\r\n\t\t\t\t// clear out the old value\r\n\t\t\t\tdojo.byId(\"storageKey\").value = \"\";\r\n\t\t\t\tdojo.byId(\"storageValue\").value = \"\";\r\n\t\t\t\tself._printStatus(\"Saved '\" + key + \"'\");\r\n\t\t\t\t\r\n\t\t\t\tif(typeof namespace != \"undefined\"\r\n\t\t\t\t\t&& namespace != null){\r\n\t\t\t\t\tself.currentNamespace = namespace;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tself._printAvailableKeys();\r\n\t\t\t\tself._printAvailableNamespaces();\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\ttry{\r\n\t\t\tif(namespace == dojox.storage.DEFAULT_NAMESPACE){\r\n\t\t\t\tdojox.storage.put(key, value, saveHandler);\r\n\t\t\t}else{\r\n\t\t\t\tdojox.storage.put(key, value, saveHandler, namespace);\r\n\t\t\t}\r\n\t\t}catch(exp){\r\n\t\t\talert(exp);\r\n\t\t}\r\n\t},\r\n\t\r\n\t_printAvailableKeys: function(){\r\n\t\tvar directory = dojo.byId(\"directory\");\r\n\t\t\r\n\t\t// clear out any old keys\r\n\t\tdirectory.innerHTML = \"\";\r\n\t\t\r\n\t\t// add new ones\r\n\t\tvar availableKeys;\r\n\t\tif(this.currentNamespace == dojox.storage.DEFAULT_NAMESPACE){\r\n\t\t\tavailableKeys = dojox.storage.getKeys();\r\n\t\t}else{\r\n\t\t\tavailableKeys = dojox.storage.getKeys(this.currentNamespace);\r\n\t\t}\r\n\t\t\r\n\t\tfor (var i = 0; i < availableKeys.length; i++){\r\n\t\t\tvar optionNode = document.createElement(\"option\");\r\n\t\t\toptionNode.appendChild(document.createTextNode(availableKeys[i]));\r\n\t\t\toptionNode.value = availableKeys[i];\r\n\t\t\tdirectory.appendChild(optionNode);\r\n\t\t}\r\n\t},\r\n\t\r\n\t_handleLoadMultiple: function(keyArray){\r\n\t\tthis._printStatus(\"Loading '\" + keyArray + \"'...\");\r\n              \r\n\t\t// get the value\r\n\t\tvar resultArray;\r\n\t\tif(this.currentNamespace == dojox.storage.DEFAULT_NAMESPACE){\r\n\t\t\tresultArray = dojox.storage.getMultiple(keyArray);\r\n\t\t}else{\r\n\t\t\tresultArray = dojox.storage.getMultiple(keyArray, this.currentNamespace);\r\n\t\t}\r\n               \r\n\t\t// jsonify it if it is a JavaScript object\r\n\t\tfor(var i = 0; i < resultArray.length; i++) {\r\n\t\t\tif(typeof resultArray[i] != \"string\"){\r\n\t\t\t\tresultArray[i] = dojo.toJson(resultArray[i]);\r\n\t\t\t}\r\n\t\t}\r\n                \r\n\t\t// print out its value\r\n\t\tthis._printStatus(\"Loaded '\" + keyArray[0] + \"' and \"\r\n\t\t\t\t\t\t\t\t\t\t\t+ (keyArray.length - 1) + \" others\");\r\n\t\tdojo.byId(\"storageValue\").value = \"\";\r\n\t\tfor(i = 0; i < resultArray.length; i++){\r\n\t\t\tdojo.byId(\"storageValue\").value += resultArray[i] + \"\\n----\\n\";\r\n\t\t}\r\n\t                 \r\n\t\t// print out the size of the value\r\n\t\tthis.printValueSize();\r\n\t},\r\n\t\r\n\t_printAvailableNamespaces: function(){\r\n\t\tvar namespacesDir = dojo.byId(\"namespaceDirectory\");\r\n\t\t\r\n\t\t// clear out any old namespaces\r\n\t\tnamespacesDir.innerHTML = \"\";\r\n\t\t\r\n\t\t// add new ones\r\n\t\tvar availableNamespaces = dojox.storage.getNamespaces();\r\n\t\tfor (var i = 0; i < availableNamespaces.length; i++){\r\n\t\t\tvar optionNode = document.createElement(\"option\");\r\n\t\t\toptionNode.appendChild(document.createTextNode(availableNamespaces[i]));\r\n\t\t\toptionNode.value = availableNamespaces[i];\r\n\t\t\tif(this.currentNamespace == availableNamespaces[i]){\r\n\t\t\t\toptionNode.selected = true;\r\n\t\t\t}\r\n\t\t\tnamespacesDir.appendChild(optionNode);\r\n\t\t}\r\n\t},\r\n\t\r\n\t_handleLoad: function(key){\r\n\t\tthis._printStatus(\"Loading '\" + key + \"'...\");\r\n\t\t\r\n\t\t// get the value\r\n\t\tvar results;\r\n\t\tif(this.currentNamespace == dojox.storage.DEFAULT_NAMESPACE){\r\n\t\t\tresults = dojox.storage.get(key);\r\n\t\t}else{\r\n\t\t\tresults = dojox.storage.get(key, this.currentNamespace);\r\n\t\t}\r\n\t\t\r\n\t\t// jsonify it if it is a JavaScript object\r\n\t\tif(typeof results != \"string\"){\r\n\t\t\tresults = dojo.toJson(results);\r\n\t\t}\r\n\t\t\r\n\t\t// print out its value\r\n\t\tthis._printStatus(\"Loaded '\" + key + \"'\");\r\n\t\tdojo.byId(\"storageValue\").value = results;\r\n\t\t\r\n\t\t// print out the size of the value\r\n\t\tthis.printValueSize();\r\n\t},\r\n\t\r\n\t_printProviderMetadata: function(){\r\n\t\tvar storageType = dojox.storage.manager.currentProvider.declaredClass;\r\n\t\tvar isSupported = dojox.storage.isAvailable();\r\n\t\tvar maximumSize = dojox.storage.getMaximumSize();\r\n\t\tvar permanent = dojox.storage.isPermanent();\r\n\t\tvar uiConfig = dojox.storage.hasSettingsUI();\r\n\t\tvar moreInfo = \"\";\r\n\t\tif(dojox.storage.manager.currentProvider.declaredClass\r\n\t\t\t\t== \"dojox.storage.FlashStorageProvider\"){\r\n\t\t\tmoreInfo = \"Flash Version \" + dojox.flash.info.version;\r\n\t\t}\r\n\t\tdojo.byId(\"currentStorageProvider\").innerHTML = storageType;\r\n\t\tdojo.byId(\"isSupported\").innerHTML = isSupported;\r\n\t\tdojo.byId(\"isPersistent\").innerHTML = permanent;\r\n\t\tdojo.byId(\"hasUIConfig\").innerHTML = uiConfig;\r\n\t\tdojo.byId(\"maximumSize\").innerHTML = maximumSize;\r\n\t\tdojo.byId(\"moreInfo\").innerHTML = moreInfo;\r\n\t},\r\n\t\r\n\t_printStatus: function(message){\r\n\t\t// remove the old status\r\n\t\tvar top = dojo.byId(\"top\");\r\n\t\tfor (var i = 0; i < top.childNodes.length; i++){\r\n\t\t\tvar currentNode = top.childNodes[i];\r\n\t\t\tif (currentNode.nodeType == 1 &&\r\n\t\t\t\t\tcurrentNode.className == \"status\"){\r\n\t\t\t\ttop.removeChild(currentNode);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tvar status = document.createElement(\"span\");\r\n\t\tstatus.className = \"status\";\r\n\t\tstatus.innerHTML = message;\r\n\t\t\r\n\t\ttop.appendChild(status);\r\n\t\tdojo.fadeOut({node: status, duration: 2000}).play();\r\n\t},\r\n\t\r\n\t_determineCurrentNamespace: function(){\r\n\t\tthis.currentNamespace = dojox.storage.DEFAULT_NAMESPACE;\r\n\t\t\r\n\t\t// what is current namespace?\r\n\t\tvar availableNamespaces = dojox.storage.getNamespaces();\r\n\t\tif(this.currentNamespace == dojox.storage.DEFAULT_NAMESPACE){\r\n\t\t\t// do we even have the default namespace in our available namespaces?\r\n\t\t\tvar defaultPresent = false;\r\n\t\t\tfor(var i = 0; i < availableNamespaces.length; i++){\r\n\t\t\t\tif(availableNamespaces[i] == dojox.storage.DEFAULT_NAMESPACE){\r\n\t\t\t\t\tdefaultPresent = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(!defaultPresent && availableNamespaces.length){\r\n\t\t\t\tthis.currentNamespace = availableNamespaces[0];\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\r\n\t_printAvailableProviders: function(){\r\n\t\t// it is scary that this timeout is needed; if it is not present,\r\n\t\t// the options don't appear on Firefox and Safari, even though the\r\n\t\t// page is finished loading! it might have to do with some strange\r\n\t\t// interaction where our initialize method is called from ExternalInterface,\r\n\t\t// which originated inside of Flash. -- Brad Neuberg\r\n\t\twindow.setTimeout(function(){\r\n\t\t\tvar selector = dojo.byId(\"currentStorageProvider\");\r\n\t\t\tvar p = dojox.storage.manager.providers;\r\n\t\t\tfor(var i = 0; i < p.length; i++){\r\n\t\t\t\tvar name = p[i].declaredClass;\r\n\t\t\t\tvar o = document.createElement(\"option\");\r\n\t\t\t\to.appendChild(document.createTextNode(name));\r\n\t\t\t\to.value = name;\r\n\t\t\t\tif(dojox.storage.manager.currentProvider == p[i]){\r\n\t\t\t\t\to.selected = true;\r\n\t\t\t\t}\r\n\t\t\t\r\n\t\t\t\tselector.appendChild(o);\r\n\t\t\t}\r\n\t\t}, 1);\r\n\t}\r\n};\r\n\r\n// wait until the storage system is finished loading\r\ndojo.addOnLoad(function(){\r\n\t// is the storage already loaded?\r\n\tif(dojox.storage.manager.isInitialized() == false){\r\n\t\tdojo.connect(dojox.storage.manager, \"loaded\", TestStorage, TestStorage.initialize);\r\n\t}else{\r\n\t\tdojo.connect(dojo, \"loaded\", TestStorage, TestStorage.initialize);\r\n\t}\r\n});"]}