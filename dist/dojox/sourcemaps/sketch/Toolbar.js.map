{"version":3,"sources":["sketch/Toolbar.js"],"names":["define","dojo","getObject","dojox","declare","constructor","this","_childMaps","_children","add","plugin","connect","hitch","push","_resetGroup","p","cs","forEach","c","attr","dijit","Toolbar","figure","plugins","postCreate","inherited","arguments","shapeGroup","sketch","ButtonGroup","_plugins","obj","name","isString","tools","args","setToolbar","_defaultTool","button","setFigure","f","destroy","addGroupItem","item","group","console","error","reset","activate","_setShape","s","surface","hasSelections","i","selected","length","before","serialize","convert","history","CommandTypes","Convert","makeToolbar","node","toolbar","appendChild","domNode"],"mappings":";;;;;;;AAAAA,QACC,oBACA,kBACA,qBACA,eACA,gBACA,qBACE,SAASC,GA8FX,OA7FAA,EAAKC,UAAU,UAAU,EAAMC,OAC/BF,EAAKG,QAAQ,2BAA4B,MACxCC,YAAa,WACZC,KAAKC,cACLD,KAAKE,cAENC,IAAK,SAAqBC,GACzBJ,KAAKC,WAAWG,GAAQA,EAAOC,QAAQD,EAAO,aAAaT,EAAKW,MAAMN,KAAK,cAAcI,IACzFJ,KAAKE,UAAUK,KAAKH,IAOrBI,YAAa,SAASC,GACrB,IAAIC,EAAGV,KAAKE,UACZP,EAAKgB,QAAQD,EAAG,SAASE,GACrBH,GAAGG,GAAKA,EAAQ,MAClBA,EAAEC,KAAK,WAAU,QAMrBlB,EAAKG,QAAQ,uBAAwBgB,MAAMC,SAC1CC,OAAQ,KACRC,QAAS,KACTC,WAAY,WACXlB,KAAKmB,UAAUC,WACfpB,KAAKqB,WAAW,IAAIxB,MAAMyB,OAAOC,YAE7BvB,KAAKiB,UACRjB,KAAKiB,SAAS,OAAO,cAAc,cAAc,YAAY,cAAc,WAE5EjB,KAAKwB,YAEL7B,EAAKgB,QAAQX,KAAKiB,QAAQ,SAASQ,GAClC,IAAIC,EAAK/B,EAAKgC,SAASF,GAAKA,EAAIA,EAAIC,KAChCjB,EAAE,IAAIZ,MAAMyB,OAAOM,MAAMF,GAAMD,EAAII,UACvC7B,KAAKwB,SAASjB,KAAKE,GACnBA,EAAEqB,WAAW9B,OACTA,KAAK+B,cAAgBtB,EAAEuB,SAC1BhC,KAAK+B,aAAatB,IAElBT,OAEHiC,UAAW,SAASC,GACnBlC,KAAKgB,OAASkB,EACdlC,KAAKK,QAAQ6B,EAAE,SAAS,SACxBvC,EAAKgB,QAAQX,KAAKwB,SAAU,SAASf,GACpCA,EAAEwB,UAAUC,MAGdC,QAAS,WACRxC,EAAKgB,QAAQX,KAAKwB,SAAS,SAASf,GACnCA,EAAE0B,YAEHnC,KAAKmB,UAAUC,kBACRpB,KAAK+B,oBACL/B,KAAKwB,UAEbY,aAAc,SAAoBC,EAAKC,GAC5B,cAAPA,EAKHtC,KAAKqB,WAAWlB,IAAIkC,GAJnBE,QAAQC,MAAM,uBAAuBF,IAMvCG,MAAO,WACNzC,KAAK+B,aAAaW,YAEnBC,UAAW,SAASC,GACnB,GAAI5C,KAAKgB,OAAO6B,SAEb7C,KAAKgB,OAAO8B,gBACd,IAAI,IAAIC,EAAE,EAAGA,EAAE/C,KAAKgB,OAAOgC,SAASC,OAAQF,IAAI,CAC/C,IAAIG,EAAOlD,KAAKgB,OAAOgC,SAASD,GAAGI,YACnCnD,KAAKgB,OAAOoC,QAAQpD,KAAKgB,OAAOgC,SAASD,GAAIH,GAC7C5C,KAAKgB,OAAOqC,QAAQlD,IAAIN,MAAMyB,OAAOgC,aAAaC,QAASvD,KAAKgB,OAAOgC,SAASD,GAAIG,OAMxFrD,MAAMyB,OAAOkC,YAAY,SAASC,EAAKzC,GACtC,IAAI0C,EAAQ,IAAI7D,MAAMyB,OAAOP,QAG7B,OAFA2C,EAAQzB,UAAUjB,GAClByC,EAAKE,YAAYD,EAAQE,SAClBF,GAGD7D,MAAMyB,OAAOP","file":"../../sketch/Toolbar.js","sourcesContent":["define([\r\n\t\"dojo/_base/kernel\",\r\n\t\"dojo/_base/lang\",\r\n\t\"dojo/_base/declare\",\r\n\t\"./Annotation\",\r\n\t\"dijit/Toolbar\",\r\n\t\"dijit/form/Button\"\r\n], function(dojo){\r\n\tdojo.getObject(\"sketch\", true, dojox);\r\n\tdojo.declare(\"dojox.sketch.ButtonGroup\", null, {\r\n\t\tconstructor: function(){\r\n\t\t\tthis._childMaps={};\r\n\t\t\tthis._children=[];\r\n\t\t},\r\n\t\tadd: function(/*_Plugin*/ plugin){\r\n\t\t\tthis._childMaps[plugin]=plugin.connect(plugin,'onActivate',dojo.hitch(this,'_resetGroup',plugin));\r\n\t\t\tthis._children.push(plugin);\r\n\t\t},\r\n\t//\tremove: function(/*_Plugin*/ plugin){\r\n\t//\t\twidget.disconnect(this._childMaps[widget.id]);\r\n\t//\t\tdelete this._childMaps[widget.id];\r\n\t//\t\tthis._children.splice(this._children.indexOf(widget.id),1);\r\n\t//\t},\r\n\t\t_resetGroup: function(p){\r\n\t\t\tvar cs=this._children;\r\n\t\t\tdojo.forEach(cs,function(c){\r\n\t\t\t\tif(p!=c && c['attr']){\r\n\t\t\t\t\tc.attr('checked',false);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n\r\n\tdojo.declare(\"dojox.sketch.Toolbar\", dijit.Toolbar, {\r\n\t\tfigure: null,\r\n\t\tplugins: null,\r\n\t\tpostCreate: function(){\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\tthis.shapeGroup=new dojox.sketch.ButtonGroup;\r\n\r\n\t\t\tif(!this.plugins){\r\n\t\t\t\tthis.plugins=['Lead','SingleArrow','DoubleArrow','Underline','Preexisting','Slider'];\r\n\t\t\t}\r\n\t\t\tthis._plugins=[];\r\n\r\n\t\t\tdojo.forEach(this.plugins,function(obj){\r\n\t\t\t\tvar name=dojo.isString(obj)?obj:obj.name;\r\n\t\t\t\tvar p=new dojox.sketch.tools[name](obj.args||{});\r\n\t\t\t\tthis._plugins.push(p);\r\n\t\t\t\tp.setToolbar(this);\r\n\t\t\t\tif(!this._defaultTool && p.button){\r\n\t\t\t\t\tthis._defaultTool=p;\r\n\t\t\t\t}\r\n\t\t\t},this);\r\n\t\t},\r\n\t\tsetFigure: function(f){\r\n\t\t\tthis.figure = f;\r\n\t\t\tthis.connect(f,'onLoad','reset');\r\n\t\t\tdojo.forEach(this._plugins, function(p){\r\n\t\t\t\tp.setFigure(f);\r\n\t\t\t});\r\n\t\t},\r\n\t\tdestroy: function(){\r\n\t\t\tdojo.forEach(this._plugins,function(p){\r\n\t\t\t\tp.destroy();\r\n\t\t\t});\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\tdelete this._defaultTool;\r\n\t\t\tdelete this._plugins;\r\n\t\t},\r\n\t\taddGroupItem: function(/*_Plugin*/item,group){\r\n\t\t\tif(group!='toolsGroup'){\r\n\t\t\t\tconsole.error('not supported group '+group);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis.shapeGroup.add(item);\r\n\t\t},\r\n\t\treset: function(){\r\n\t\t\tthis._defaultTool.activate();\r\n\t\t},\r\n\t\t_setShape: function(s){\r\n\t\t\tif(!this.figure.surface) return;\r\n\t\t\t//\tnow do the action.\r\n\t\t\tif(this.figure.hasSelections()){\r\n\t\t\t\tfor(var i=0; i<this.figure.selected.length; i++){\r\n\t\t\t\t\tvar before=this.figure.selected[i].serialize();\r\n\t\t\t\t\tthis.figure.convert(this.figure.selected[i], s);\r\n\t\t\t\t\tthis.figure.history.add(dojox.sketch.CommandTypes.Convert, this.figure.selected[i], before);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\r\n\tdojox.sketch.makeToolbar=function(node,figure){\r\n\t\tvar toolbar=new dojox.sketch.Toolbar();\r\n\t\ttoolbar.setFigure(figure);\r\n\t\tnode.appendChild(toolbar.domNode);\r\n\t\treturn toolbar;\r\n\t};\r\n\r\n\treturn dojox.sketch.Toolbar;\r\n});\r\n"]}