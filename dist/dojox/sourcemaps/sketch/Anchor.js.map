{"version":3,"sources":["sketch/Anchor.js"],"names":["define","dojo","getObject","dojox","sketch","Anchor","an","id","isControl","self","this","rect","type","annotation","_key","count","shape","beginEdit","CommandTypes","Modify","endEdit","zoom","pct","rs","Math","floor","width","gfx","renderer","setShape","x","y","height","setStroke","color","setBinding","pt","dx","dy","draw","drawBBox","setUndo","enable","figure","_add","size","createRect","setFill","getEventSource","setAttribute","zoomFactor","disable","_remove","remove"],"mappings":";;;;;;;AAAAA,QACC,oBACA,kBACA,UACE,SAASC,GA+DX,OA9DAA,EAAKC,UAAU,UAAU,EAAMC,OAE/BA,MAAMC,OAAOC,OAAO,SAASC,EAAIC,EAAIC,GACpC,IAAIC,EAAKC,KAELC,EAAK,KAETD,KAAKE,KAAK,WAAY,MAAO,UAC7BF,KAAKG,WAAWP,EAEhBI,KAAKH,GAAGA,EACRG,KAAKI,KAAK,UAAYX,MAAMC,OAAOC,OAAOU,QAC1CL,KAAKM,MAAM,KACXN,KAAKF,UAAsB,MAAXA,GAAiBA,EAEjCE,KAAKO,UAAU,WACdP,KAAKG,WAAWI,UAAUd,MAAMC,OAAOc,aAAaC,SAErDT,KAAKU,QAAQ,WACZV,KAAKG,WAAWO,WAEjBV,KAAKW,KAAK,SAASC,GAClB,GAAGZ,KAAKM,MAAM,CACb,IAAIO,EAAGC,KAAKC,MAnBL,EAmBgBH,GACnBI,EAA0B,OAApBvB,MAAMwB,IAAIC,SAAgB,EAAE,EAAEN,EACxCZ,KAAKM,MAAMa,UAAWC,EAAExB,EAAGC,GAAIuB,EAAEP,EAAIQ,EAAEzB,EAAGC,GAAIwB,EAAER,EAAIG,MAAS,EAAHH,EAAMS,OAAU,EAAHT,IAAQU,WAAYC,MAAM,QAASR,MAAMA,MAWlHhB,KAAKyB,WAAW,SAASC,GACxB9B,EAAGC,IAAMuB,EAAGxB,EAAGC,GAAIuB,EAAEM,EAAGC,GAAIN,EAAEzB,EAAGC,GAAIwB,EAAEK,EAAGE,IAC1ChC,EAAGiC,OACHjC,EAAGkC,YAEJ9B,KAAK+B,QAAQ,WAAYnC,EAAGmC,WAE5B/B,KAAKgC,OAAO,WACPpC,EAAGU,QACPV,EAAGqC,OAAOC,KAAKlC,MACfC,GAAOmB,EAAExB,EAAGC,GAAIuB,EA1CR,EA0CgBC,EAAEzB,EAAGC,GAAIwB,EA1CzB,EA0CiCL,MAAMmB,EAAQb,OAAOa,GAC9DnC,KAAKM,MAAMV,EAAGU,MAAM8B,WAAWnC,GAE7BoC,SAAS,IAAI,IAAI,IAAI,MACvBrC,KAAKM,MAAMgC,iBAAiBC,aAAa,KAAMxC,EAAKK,MACpDJ,KAAKM,MAAMgC,iBAAiBC,aAAa,kBAAmB,cAC5DvC,KAAKW,KAAKf,EAAGqC,OAAOO,cAErBxC,KAAKyC,QAAQ,WACZ7C,EAAGqC,OAAOS,QAAQ1C,MACfJ,EAAGU,OAAQV,EAAGU,MAAMqC,OAAO3C,KAAKM,OACnCN,KAAKM,MAAM,KACXL,EAAK,OAGPR,MAAMC,OAAOC,OAAOU,MAAM,EACnBZ,MAAMC,OAAOC","file":"../../sketch/Anchor.js","sourcesContent":["define([\r\n\t\"dojo/_base/kernel\",\r\n\t\"dojo/_base/lang\",\r\n\t\"../gfx\"\r\n], function(dojo){\r\n\tdojo.getObject(\"sketch\", true, dojox);\r\n\r\n\tdojox.sketch.Anchor=function(an, id, isControl){\r\n\t\tvar self=this;\r\n\t\tvar size=4;\t//\t.5 * size of anchor.\r\n\t\tvar rect=null;\r\n\r\n\t\tthis.type=function(){ return \"Anchor\"; };\r\n\t\tthis.annotation=an;\r\n\r\n\t\tthis.id=id;\r\n\t\tthis._key=\"anchor-\" + dojox.sketch.Anchor.count++;\r\n\t\tthis.shape=null;\r\n\t\tthis.isControl=(isControl!=null)?isControl:true;\r\n\r\n\t\tthis.beginEdit=function(){\r\n\t\t\tthis.annotation.beginEdit(dojox.sketch.CommandTypes.Modify);\r\n\t\t};\r\n\t\tthis.endEdit=function(){\r\n\t\t\tthis.annotation.endEdit();\r\n\t\t};\r\n\t\tthis.zoom=function(pct){\r\n\t\t\tif(this.shape){\r\n\t\t\t\tvar rs=Math.floor(size/pct);\r\n\t\t\t\tvar width=dojox.gfx.renderer=='vml'?1:1/pct\r\n\t\t\t\tthis.shape.setShape({ x:an[id].x-rs, y:an[id].y-rs, width:rs*2, height:rs*2 }).setStroke({ color:\"black\", width:width }); //For IE, maybe we need Math.ceil(1/pct)||1\r\n\t\t\t}\r\n\t\t}\r\n\t\t/*this.doChange=function(pt){\r\n\t\t\tif(this.isControl){\r\n\t\t\t\tthis.shape.applyTransform(pt);\r\n\t\t\t} else{\r\n\t\t\t\tan.transform.dx+=pt.dx;\r\n\t\t\t\tan.transform.dy+=pt.dy;\r\n\t\t\t}\r\n\t\t};*/\r\n\t\tthis.setBinding=function(pt){\r\n\t\t\tan[id]={ x: an[id].x+pt.dx, y:an[id].y+pt.dy };\r\n\t\t\tan.draw();\r\n\t\t\tan.drawBBox();\r\n\t\t};\r\n\t\tthis.setUndo=function(){ an.setUndo(); };\r\n\r\n\t\tthis.enable=function(){\r\n\t\t\tif(!an.shape){ return; }\r\n\t\t\tan.figure._add(this);\r\n\t\t\trect={ x:an[id].x-size, y:an[id].y-size, width:size*2, height:size*2 };\r\n\t\t\tthis.shape=an.shape.createRect(rect)\r\n\t\t\t\t//.setStroke({ color:\"black\", width:1 })\r\n\t\t\t\t.setFill([255,255,255,0.35]);\r\n\t\t\tthis.shape.getEventSource().setAttribute(\"id\", self._key);\r\n\t\t\tthis.shape.getEventSource().setAttribute(\"shape-rendering\", \"crispEdges\");\r\n\t\t\tthis.zoom(an.figure.zoomFactor);\r\n\t\t};\r\n\t\tthis.disable=function(){\r\n\t\t\tan.figure._remove(this);\r\n\t\t\tif(an.shape){ an.shape.remove(this.shape); }\r\n\t\t\tthis.shape=null;\r\n\t\t\trect=null;\r\n\t\t};\r\n\t};\r\n\tdojox.sketch.Anchor.count=0;\r\n\treturn dojox.sketch.Anchor;\r\n});\r\n"]}