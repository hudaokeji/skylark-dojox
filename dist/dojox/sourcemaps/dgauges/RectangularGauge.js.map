{"version":3,"sources":["dgauges/RectangularGauge.js"],"names":["define","declare","GaugeBase","matrix","orientation","_middleParts","_leadingParts","_trailingParts","_baseParts","_classParts","_layoutInfos","constructor","this","leading","x","y","w","h","middle","trailing","addInvalidatingProperties","addElement","name","element","location","inherited","arguments","obj","_elements","length","push","_isGFX","removeElement","getElement","indexOf","splice","_computeArrayBoundingBox","elements","minX","minY","maxX","maxY","bbox","Infinity","i","_computeBoundingBox","_gfxGroup","width","height","refreshRendering","_widgetBox","_elementsRenderers","_name","leadingBoundingBox","trailingBoundingBox","middleBoundingBox","setTransform","translate"],"mappings":"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","file":"../../dgauges/RectangularGauge.js","sourcesContent":["define([\"dojo/_base/declare\", \"./GaugeBase\", \"dojox/gfx/matrix\"], function(declare, GaugeBase, matrix){\r\n\treturn declare(\"dojox.dgauges.RectangularGauge\", GaugeBase, {\r\n\t\t// summary:\r\n\t\t//\t\tThe base class for rectangular gauges.\r\n\t\t//\t\tYou can create custom horizontal or vertical gauges by extending this class.\r\n\t\t//\t\tSee dojox/dgauges/components/default/HorinzontalLinearGauge.js for an example of rectangular gauge.\r\n\r\n\t\t// orientation: \"horizontal\"|\"vertical\"\r\n\t\t//\t\tThe orientation of the gauge. Default is \"horizontal\".\t\r\n\t\torientation: \"horizontal\",\r\n\t\t\r\n\t\t// leading, middle and trailing graphical parts\r\n\t\t_middleParts: null,\r\n\t\t_leadingParts: null,\r\n\t\t_trailingParts: null,\r\n\t\t_baseParts: null,\r\n\t\t_classParts: null,\r\n\t\t_layoutInfos: {},\r\n\t\tconstructor: function(){\r\n\t\t\r\n\t\t\tthis.orientation = \"horizontal\";\r\n\t\t\t\r\n\t\t\tthis._middleParts = [];\r\n\t\t\tthis._leadingParts = [];\r\n\t\t\tthis._trailingParts = [];\r\n\t\t\tthis._baseParts = [];\r\n\t\t\tthis._classParts = [];\r\n\t\t\t\r\n\t\t\tthis._layoutInfos = {\r\n\t\t\t\tleading: {\r\n\t\t\t\t\tx: 0,\r\n\t\t\t\t\ty: 0,\r\n\t\t\t\t\tw: 0,\r\n\t\t\t\t\th: 0\r\n\t\t\t\t},\r\n\t\t\t\tmiddle: {\r\n\t\t\t\t\tx: 0,\r\n\t\t\t\t\ty: 0,\r\n\t\t\t\t\tw: 0,\r\n\t\t\t\t\th: 0\r\n\t\t\t\t},\r\n\t\t\t\ttrailing: {\r\n\t\t\t\t\tx: 0,\r\n\t\t\t\t\ty: 0,\r\n\t\t\t\t\tw: 0,\r\n\t\t\t\t\th: 0\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tthis.addInvalidatingProperties([\"orientation\"]);\r\n\t\t\t\r\n\t\t},\r\n\t\t\r\n\t\taddElement: function(name, element, location){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tAdds a element to the gauge.\r\n\t\t\t// name: String\r\n\t\t\t//\t\tThe name of the element to be added.\r\n\t\t\t// element: Object\r\n\t\t\t//\t\tThis parameter can be:\r\n\t\t\t//\t\t- A function which takes on argument of type GFX Group and return null or a\r\n\t\t\t//\t\tGFX element retrievable using the getElementRenderer() method.\r\n\t\t\t//\t\t- A Scale instance, i.e. CircularScale or RectangularScale.\r\n\t\t\t//\t\t- A TextIndicator instance.\r\n\t\t\t// location: String\r\n\t\t\t//\t\tThe area to place the element. Valid values are \"leading\"|\"middle\"|\"trailing\". Leading and trailing areas are fixed size. The\r\n\t\t\t//\t\tmiddle area use the remaining size. If not specified, the element's refreshRendering \r\n\t\t\t//\t\tis called with the whole gauge size as argument.\r\n\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\t\r\n\t\t\tvar obj = this._elements[this._elements.length - 1];\r\n\t\t\t\r\n\t\t\tif(location == \"middle\"){\r\n\t\t\t\tthis._middleParts.push(obj);\r\n\t\t\t}else if(location == \"leading\"){\r\n\t\t\t\tthis._leadingParts.push(obj);\r\n\t\t\t}else if(location == \"trailing\"){\r\n\t\t\t\tthis._trailingParts.push(obj);\r\n\t\t\t}else{\r\n\t\t\t\tif(obj._isGFX){\r\n\t\t\t\t\tthis._baseParts.push(obj);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis._classParts.push(obj);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\tremoveElement: function(name){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tRemove the element defined by name from the gauge.\r\n\t\t\t// name: String\r\n\t\t\t//\t\tThe name of the element as defined using addElement.\r\n\t\t\t// returns: Object\r\n\t\t\t//\t\tA reference to the removed element.\t\t\r\n\t\t\tvar obj = this.getElement(name);\r\n\t\t\tif(obj){\r\n\t\t\t\tif(this._middleParts && this._middleParts.indexOf(obj) >= 0){\r\n\t\t\t\t\tthis._middleParts.splice(this._middleParts.indexOf(obj), 1);\r\n\t\t\t\t}else if(this._leadingParts && this._leadingParts.indexOf(obj) >= 0){\r\n\t\t\t\t\tthis._leadingParts.splice(this._leadingParts.indexOf(obj), 1);\r\n\t\t\t\t}else if(this._trailingParts && this._trailingParts.indexOf(obj) >= 0){\r\n\t\t\t\t\tthis._trailingParts.splice(this._trailingParts.indexOf(obj), 1);\r\n\t\t\t\t}else if(this._baseParts && this._baseParts.indexOf(obj) >= 0){\r\n\t\t\t\t\tthis._baseParts.splice(this._baseParts.indexOf(obj), 1);\r\n\t\t\t\t}else if(this._classParts && this._classParts.indexOf(obj) >= 0){\r\n\t\t\t\t\tthis._classParts.splice(this._classParts.indexOf(obj), 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.inherited(arguments);\r\n\t\t},\r\n\t\t\r\n\t\t_computeArrayBoundingBox: function(elements){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tInternal method.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\tif(elements.length == 0){\r\n\t\t\t\treturn {x: 0, y: 0, w: 0, h: 0};\r\n\t\t\t}\r\n\t\t\tvar bbox = null;\r\n\t\t\tvar minX, minY, maxX, maxY;\r\n\t\t\tminX = minY = +Infinity;\r\n\t\t\tmaxX = maxY = -Infinity;\r\n\t\t\tfor(var i = 0; i < elements.length; i++){\r\n\t\t\t\tbbox = this._computeBoundingBox(elements[i]._gfxGroup);\r\n\t\t\t\tif(minX > bbox.x){\r\n\t\t\t\t\tminX = bbox.x;\r\n\t\t\t\t}\r\n\t\t\t\tif(minY > bbox.y){\r\n\t\t\t\t\tminY = bbox.y;\r\n\t\t\t\t}\r\n\t\t\t\tif(maxX < bbox.x + bbox.width){\r\n\t\t\t\t\tmaxX = bbox.x + bbox.width;\r\n\t\t\t\t}\r\n\t\t\t\tif(maxY < bbox.y + bbox.height){\r\n\t\t\t\t\tmaxY = bbox.y + bbox.height;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn {x: minX, y:minY, w: maxX-minX, h: maxY-minY};\r\n\t\t},\r\n\t\t\r\n\t\trefreshRendering: function(){\r\n\t\t\tif(this._widgetBox.w <= 0 || this._widgetBox.h <= 0){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar i;\r\n\t\t\tif(this._baseParts){\r\n\t\t\t\tfor(i = 0; i < this._baseParts.length; i++){\r\n\t\t\t\t\tthis._baseParts[i].width = this._widgetBox.w;\r\n\t\t\t\t\tthis._baseParts[i].height = this._widgetBox.h;\r\n\t\t\t\t\tthis._elementsRenderers[this._baseParts[i]._name] = this._baseParts[i].refreshRendering();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(this._leadingParts){\r\n\t\t\t\tfor(i = 0; i < this._leadingParts.length; i++){\r\n\t\t\t\t\tthis._elementsRenderers[this._leadingParts[i]._name] = this._leadingParts[i].refreshRendering();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(this._trailingParts){\r\n\t\t\t\tfor(i = 0; i < this._trailingParts.length; i++){\r\n\t\t\t\t\tthis._elementsRenderers[this._trailingParts[i]._name] = this._trailingParts[i].refreshRendering();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar leadingBoundingBox = this._computeArrayBoundingBox(this._leadingParts);\r\n\t\t\tvar trailingBoundingBox = this._computeArrayBoundingBox(this._trailingParts);\r\n\t\t\tvar middleBoundingBox = {};\r\n\t\t\t\r\n\t\t\tif(this.orientation == \"horizontal\"){\r\n\t\t\t\tmiddleBoundingBox.x = leadingBoundingBox.x + leadingBoundingBox.w;\r\n\t\t\t\tmiddleBoundingBox.y = 0;\r\n\t\t\t\tmiddleBoundingBox.w = this._widgetBox.w - leadingBoundingBox.w - trailingBoundingBox.w;\r\n\t\t\t\tmiddleBoundingBox.h = this._widgetBox.h;\r\n\t\t\t}else{\r\n\t\t\t\tmiddleBoundingBox.x = 0;\r\n\t\t\t\tmiddleBoundingBox.y = leadingBoundingBox.y + leadingBoundingBox.h;\r\n\t\t\t\tmiddleBoundingBox.w = this._widgetBox.w; \r\n\t\t\t\tmiddleBoundingBox.h = this._widgetBox.h - leadingBoundingBox.h - trailingBoundingBox.h;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis._layoutInfos = {\r\n\t\t\t\tleading: leadingBoundingBox,\r\n\t\t\t\tmiddle: middleBoundingBox,\r\n\t\t\t\ttrailing: trailingBoundingBox\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\t// translates middle part\r\n\t\t\tfor(i = 0; i < this._middleParts.length; i++){\r\n\t\t\t\tthis._middleParts[i]._gfxGroup.setTransform([matrix.translate(middleBoundingBox.x, middleBoundingBox.y)]);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// translates trailing part\r\n\t\t\tif(this._trailingParts){\r\n\t\t\t\tfor(i = 0; i < this._trailingParts.length; i++){\r\n\t\t\t\t\tthis._trailingParts[i]._gfxGroup.setTransform(matrix.translate(this._widgetBox.w - trailingBoundingBox.w, 0));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Render remaining elements (scales, ...)\r\n\t\t\tfor(i = 0; i < this._classParts.length; i++){\r\n\t\t\t\tthis._elementsRenderers[this._classParts[i]._name] = this._classParts[i].refreshRendering();\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n});\r\n"]}