{"version":3,"sources":["dgauges/CircularGauge.js"],"names":["define","declare","domGeom","gfx","GaugeBase","_transformProperties","refreshRendering","this","_widgetBox","w","h","key","_elementsIndex","_elementsRenderers","bb","_computeBoundingBox","_gfxGroup","naturalRatio","x","width","y","height","widgetWidth","widgetHeight","xpos","ypos","scaleFactor","Math","max","scale","tx","ty","setTransform","matrix","translate","_gaugeToPage","px","py","np","position","domNode"],"mappings":";;;;;;;AAAAA,QAAQ,qBAAsB,oBAAqB,YAAa,eAAgB,SAASC,EAASC,EAASC,EAAKC,GAC/G,OAAOH,EAAQ,8BAA+BG,GAM7CC,qBAAsB,KAEtBC,iBAAkB,WACjB,KAAGC,KAAKC,WAAWC,GAAK,GAAKF,KAAKC,WAAWE,GAAK,GAAlD,CAIA,IAAI,IAAIC,KAAOJ,KAAKK,eACnBL,KAAKM,mBAAmBF,GAAOJ,KAAKK,eAAeD,GAAKL,mBAIzD,IAAIQ,EAAKP,KAAKQ,oBAAoBR,KAAKS,WAEnCC,GAAgBH,EAAGI,EAAIJ,EAAGK,QAAUL,EAAGM,EAAIN,EAAGO,QAC9CC,EAAcf,KAAKC,WAAWC,EAC9Bc,EAAehB,KAAKC,WAAWE,EAG/Bc,EAAO,EACPC,EAAO,EACPf,EAAI,EACJD,EAAI,EACLQ,EANeV,KAAKC,WAAWC,EAAIF,KAAKC,WAAWE,EASrDe,GAAQF,GADRb,GADAD,EAAIa,GACIL,IACoB,EAI5BO,GAAQF,GADRb,GADAC,EAAIa,GACIN,IACmB,EAE5B,IAAIS,EAAcC,KAAKC,IAAInB,GAAKK,EAAGI,EAAIJ,EAAGK,OAAQT,GAAKI,EAAGM,EAAIN,EAAGO,SACjEd,KAAKF,sBAAwBwB,MAAMH,EAAaI,GAAGN,EAAMO,GAAGN,GAC5DlB,KAAKS,UAAUgB,cAAc7B,EAAI8B,OAAOJ,MAAMH,GAAcvB,EAAI8B,OAAOC,UAAUV,EAAOE,EAAaD,EAAOC,OAG7GS,aAAc,SAASC,EAAIC,GAK1B,GAAG9B,KAAKF,qBAAqB,CAC5B,IAAIiC,EAAKpC,EAAQqC,SAAShC,KAAKiC,SAAS,GACxC,OAAQtB,EAAGoB,EAAGpB,EAAIkB,EAAK7B,KAAKF,qBAAqBwB,MAAQtB,KAAKF,qBAAqByB,GAAIV,EAAGkB,EAAGlB,EAAIiB,EAAK9B,KAAKF,qBAAqBwB,MAAQtB,KAAKF,qBAAqB0B,IAElK,OAAO","file":"../../dgauges/CircularGauge.js","sourcesContent":["define([\"dojo/_base/declare\", \"dojo/dom-geometry\", \"dojox/gfx\", \"./GaugeBase\"], function(declare, domGeom, gfx, GaugeBase){\r\n\treturn declare(\"dojox.dgauges.CircularGauge\", GaugeBase, {\r\n\t\t// summary:\r\n\t\t//\t\tThe base class for circular gauges.\r\n\t\t//\t\tYou can create custom circular or semi-circular gauges by extending this class.\r\n\t\t//\t\tSee dojox.dgauges.components.default.CircularLinearGauge.js for an example of circular gauge.\r\n\t\t\r\n\t\t_transformProperties: null,\r\n\t\t\r\n\t\trefreshRendering: function(){\r\n\t\t\tif(this._widgetBox.w <= 0 || this._widgetBox.h <= 0){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfor(var key in this._elementsIndex){\r\n\t\t\t\tthis._elementsRenderers[key] = this._elementsIndex[key].refreshRendering();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Maximize the drawing area and center the gauge\r\n\t\t\tvar bb = this._computeBoundingBox(this._gfxGroup);\r\n\t\t\t\r\n\t\t\tvar naturalRatio = (bb.x + bb.width) / (bb.y + bb.height);\r\n\t\t\tvar widgetWidth = this._widgetBox.w;\r\n\t\t\tvar widgetHeight = this._widgetBox.h;\r\n\t\t\tvar widgetRatio = this._widgetBox.w / this._widgetBox.h;\r\n\t\t\t\r\n\t\t\tvar xpos = 0;\r\n\t\t\tvar ypos = 0;\r\n\t\t\tvar h = 0;\r\n\t\t\tvar w = 0;\r\n\t\t\tif(naturalRatio > widgetRatio){\r\n\t\t\t\tw = widgetWidth;\r\n\t\t\t\th = w / naturalRatio;\r\n\t\t\t\typos = (widgetHeight - h) / 2;\r\n\t\t\t}else{\r\n\t\t\t\th = widgetHeight;\r\n\t\t\t\tw = h * naturalRatio;\r\n\t\t\t\txpos = (widgetWidth - w) / 2;\r\n\t\t\t}\r\n\t\t\tvar scaleFactor = Math.max(w / (bb.x + bb.width), h / (bb.y + bb.height));\r\n\t\t\tthis._transformProperties = {scale:scaleFactor, tx:xpos, ty:ypos};\r\n\t\t\tthis._gfxGroup.setTransform([gfx.matrix.scale(scaleFactor), gfx.matrix.translate(xpos / scaleFactor, ypos / scaleFactor)]);\r\n\t\t},\r\n\t\t\r\n\t\t_gaugeToPage: function(px, py){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tInternal method.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\tif(this._transformProperties){\r\n\t\t\t\tvar np = domGeom.position(this.domNode, true);\r\n\t\t\t\treturn {x: np.x + px * this._transformProperties.scale + this._transformProperties.tx, y: np.y + py * this._transformProperties.scale + this._transformProperties.ty};\r\n\t\t\t}else{\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n});\r\n"]}