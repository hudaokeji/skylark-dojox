{"version":3,"sources":["secure/tests/sandbox.js"],"names":["violater","func","name","runTest","t","insecure","e","console","log","f","dojo","provide","doh","register","div","document","createElement","body","appendChild","innerHTML","style","position","top","left","backgroundColor","color","container","dojox","secure","evaluate","assertEqual","match","bad"],"mappings":";;;;;;;AA4BA,SAASA,SAASC,GACjB,OAAQC,KAAMD,EAAKC,KACnBC,QAAS,SAASC,GACjB,IAAIC,EACJ,IACCJ,EAAKG,GACLC,GAAW,EACX,MAAMC,GACNC,QAAQC,IAAI,2BAA2BF,GAExCF,EAAEK,EAAEJ,KAtCNK,KAAKC,QAAQ,8BAEbC,IAAIC,SAAS,mCAEX,WACC,IAAIC,EAAMC,SAASC,cAAc,OACjCD,SAASE,KAAKC,YAAYJ,GAC1BA,EAAIK,UAAY,iBAChBL,EAAIM,MAAMC,SAAW,WACrBP,EAAIM,MAAME,IAAM,QAChBR,EAAIM,MAAMG,KAAO,QACjBT,EAAIM,MAAMI,gBAAkB,MAC5BV,EAAIM,MAAMK,MAAQ,QAClBC,UAAYX,SAASC,cAAc,OACnCU,UAAUN,MAAMI,gBAAkB,OAClCE,UAAUN,MAAMK,MAAQ,QACxBX,EAAII,YAAYQ,YAEjB,SAAmBtB,GAClBuB,MAAMC,OAAOC,SAAS,kCAAkCH,WACxDtB,EAAE0B,YAAY,WAAWJ,UAAUP,YAEpC,SAAkBf,GACjBuB,MAAMC,OAAOC,SAAS,4DAA4DH,WAClFtB,EAAEA,EAAEsB,UAAUP,UAAUY,MAAM,eAiBjCnB,IAAIC,SAAS,kCAEX,SAAoBT,GACnBA,EAAEK,EAAEkB,MAAMC,OAAOC,SAAS,gBAAgBH,aAE3C,SAAyBtB,GACxB,IACCuB,MAAMC,OAAOC,SAAS,aAAaH,WACnC,MAAMpB,IACNF,EAAEA,EAAgB,oBAAP4B","file":"../../../secure/tests/sandbox.js","sourcesContent":["dojo.provide(\"dojox.secure.tests.sandbox\");\r\n\r\ndoh.register(\"dojox.secure.tests.sandbox.good\",\r\n\t[\r\n\t\tfunction setup(){\r\n\t\t\tvar div = document.createElement(\"div\");\r\n\t\t\tdocument.body.appendChild(div);\r\n\t\t\tdiv.innerHTML = \"Sandboxed div:\";\r\n\t\t\tdiv.style.position = \"absolute\";\r\n\t\t\tdiv.style.top = \"100px\";\r\n\t\t\tdiv.style.left = \"100px\";\r\n\t\t\tdiv.style.backgroundColor = \"red\";\r\n\t\t\tdiv.style.color = \"white\";\r\n\t\t\tcontainer = document.createElement(\"div\");\r\n\t\t\tcontainer.style.backgroundColor = \"cyan\";\r\n\t\t\tcontainer.style.color = \"black\";\r\n\t\t\tdiv.appendChild(container);\r\n\t\t},\r\n\t\tfunction innerHTML(t){\r\n\t\t\tdojox.secure.evaluate(\"element.innerHTML = 'Hi there';\",container);\r\n\t\t\tt.assertEqual(\"Hi there\",container.innerHTML);\r\n\t\t},\r\n\t\tfunction docWrite(t){\r\n\t\t\tdojox.secure.evaluate(\"document.write(\\\"<div style='color:red'>written</div>\\\");\",container);\r\n\t\t\tt.t(container.innerHTML.match(/written/));\r\n\t\t}\r\n\t]);\r\n\r\nfunction violater(func) {\r\n\treturn {name: func.name,\r\n\trunTest: function(t) {\r\n\t\tvar insecure;\r\n\t\ttry {\r\n\t\t\tfunc(t);\r\n\t\t\tinsecure = true;\r\n\t\t}catch(e){\r\n\t\t\tconsole.log(\"successfully threw error\",e);\r\n\t\t}\r\n\t\tt.f(insecure);\r\n\t}};\r\n}\r\ndoh.register(\"dojox.secure.tests.sandbox.bad\",\r\n\t[\r\n\t\tfunction parentNode(t){\r\n\t\t\tt.f(dojox.secure.evaluate(\"document.body\",container));\r\n\t\t},\r\n\t\tfunction innerHTMLScript(t){\r\n\t\t\ttry {\r\n\t\t\t\tdojox.secure.evaluate(\"bad = true\",container);\r\n\t\t\t}catch(e){}\r\n\t\t\t\tt.t(typeof bad == 'undefined');\r\n\t\t}\r\n\t\t/*function innerHTMLScript2(t){\r\n\t\t\ttry{\r\n\t\t\t\tsecuredElement.innerHTML = '</script><script>bad=true;//';\r\n\t\t\t}catch(e){}\r\n\t\t\t\tt.t(typeof bad == 'undefined');\r\n\t\t},\r\n\t\tfunction writeScript(t){\r\n\t\t\ttry{\r\n\t\t\t\tsecuredDoc.write(\"<script>bad=true;</script>\");\r\n\t\t\t}catch(e){}\r\n\t\t\t\tt.t(typeof bad == 'undefined');\r\n\t\t},\r\n\t\tfunction appendScript(t){\r\n\t\t\ttry {\r\n\t\t\t\tvar script = securedDoc.createElement('script');\r\n\t\t\t\tscript.appendChild(securedDoc.createTextNode(\r\n\t\t\t\t        'bad=true'));\r\n\t\t\t\tsecuredElement.appendChild(script);\r\n\t\t\t}\r\n\t\t\tcatch(e) {\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\t\tt.t(typeof bad == 'undefined');\r\n\t\t},\r\n\t\tfunction cssExpression(t) {\r\n\t\t\tif (dojo.isIE) {\r\n\t\t\t\tsecuredElement.innerHTML = '<div id=\"oDiv\" style=\"left:expression((bad=true), 0)\">Example DIV</div>';\r\n\t\t\t\tt.t(typeof bad == 'undefined');\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\ttry{\r\n\t\t\t\t\tsecuredElement.innerHTML = '<input style=\\'-moz-binding: url(\"http://www.mozilla.org/xbl/htmlBindings.xml#checkbox\");\\'>';\r\n\t\t\t\t}catch(e){}\r\n\t\t\t\t\r\n\t\t\t\tt.f(securedElement.innerHTML.match(/mozilla/))\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t},\r\n\t\tfunction cssExpression2(t) {\r\n\t\t\tif (dojo.isIE) {\r\n\t\t\t\tsecuredElement.style.left = 'expression(alert(\"hello\"), 0)';\r\n\t\t\t\tt.f(securedElement.style.left.match(/alert/));\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tsecuredElement.style.MozBinding = 'url(\"http://www.mozilla.org/xbl/htmlBindings.xml#checkbox\")';\r\n\t\t\t\t}catch(e){}\r\n\t\t\t\t\t\r\n\t\t\t}\r\n\t\t},\r\n\t\tfunction cssExpression3(t) {\r\n\t\t\tif (dojo.isIE) {\r\n\t\t\t\tsecuredElement.style.behavior = 'url(a1.htc)';\r\n\t\t\t\tt.f(securedElement.style.behavior);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t},\r\n\t\tviolater(function addStyleTag(t) {\r\n\t\t\tsecuredElement.innerHTML = \"<style>div {color:expression(alert(\\\"hello\\\")}</style><div>test</div>\";\r\n\t\t}),\r\n\t\tviolater(function addStyleTag2(t) {\r\n\t\t\tsecuredElement.innerHTML = \"<style>@import 'unsafe.css'</style><div>unsafe css</div>\";\r\n\t\t})*/\r\n\t]);\r\n\t"]}