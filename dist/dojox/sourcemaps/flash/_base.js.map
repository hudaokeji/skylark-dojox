{"version":3,"sources":["flash/_base.js"],"names":["dojo","provide","experimental","require","dojox","flash","ready","url","_visible","_loadedListeners","_installingListeners","setSwf","visible","this","undefined","_initialize","addLoadedListener","listener","push","addInstallingListener","loaded","length","i","call","installing","installer","Install","needed","install","obj","Embed","write","comm","Communicator","Info","_detectVersion","prototype","version","versionMajor","versionMinor","versionRevision","capable","isVersionOrAbove","reqMajorVer","reqMinorVer","reqVer","parseFloat","versionStr","testVersion","axo","isIE","ActiveXObject","AllowScriptAccess","GetVariable","e","_JSFlashInfo","versionArray","split","versionString","navigator","plugins","swVer2","descArray","description","tempArrayMajor","tempArrayMinor","width","height","id","protocol","window","location","doExpressInstall","objectHTML","swfloc","swflocObject","swflocEmbed","dojoUrl","baseUrl","xdomainBase","document","host","redirectURL","escape","title","slice","Date","getTime","indexOf","connect","hitch","containerId","byId","div","createElement","style","position","zIndex","top","innerHTML","body","getElementsByTagName","Error","appendChild","get","isWebKit","setVisible","container","visibility","y","center","elementWidth","elementHeight","viewport","getBox","x","l","w","t","h","left","_addExternalInterfaceCallback","methodName","wrapperCall","methodArgs","Array","arguments","_encodeData","results","_execFlash","_decodeData","data","replace","plugin","flashExec","eval","CallFunction","__flash__argumentsToXML","info","installObj","alert","href","_onInstallStatus","msg"],"mappings":"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","file":"../../flash/_base.js","sourcesContent":["dojo.provide(\"dojox.flash._base\");\r\ndojo.experimental(\"dojox.flash\");\r\n\r\n// for dojo.window.getBox(), needed by dojox.flash.Embed.center()\r\ndojo.require(\"dojo.window\");\r\n\r\ndojox.flash = {\r\n\t// summary:\r\n\t//\t\tUtilities to embed and communicate with the Flash player from Javascript\r\n\t// description:\r\n\t//\t\tThe goal of dojox.flash is to make it easy to extend Flash's capabilities\r\n\t//\t\tinto an Ajax/DHTML environment.\r\n\t//\r\n\t//\t\tdojox.flash provides an easy object for interacting with the Flash plugin.\r\n\t//\t\tThis object provides methods to determine the current version of the Flash\r\n\t//\t\tplugin (dojox.flash.info); write out the necessary markup to\r\n\t//\t\tdynamically insert a Flash object into the page (dojox.flash.Embed; and\r\n\t//\t\tdo dynamic installation and upgrading of the current Flash plugin in\r\n\t//\t\tuse (dojox.flash.Install). If you want to call methods on the Flash object\r\n\t//\t\tembedded into the page it is your responsibility to use Flash's ExternalInterface\r\n\t//\t\tAPI and get a reference to the Flash object yourself.\r\n\t//\r\n\t//\t\tTo use dojox.flash, you must first wait until Flash is finished loading\r\n\t//\t\tand initializing before you attempt communication or interaction.\r\n\t//\t\tTo know when Flash is finished use dojo.connect:\r\n\t//\r\n\t// |\tdojo.connect(dojox.flash, \"loaded\", myInstance, \"myCallback\");\r\n\t//\r\n\t//\t\tThen, while the page is still loading provide the file name:\r\n\t//\r\n\t// |\tdojox.flash.setSwf(dojo.moduleUrl(\"dojox\", \"_storage/storage.swf\"));\r\n\t//\r\n\t//\t\tIf no SWF files are specified, then Flash is not initialized.\r\n\t//\r\n\t//\t\tYour Flash must use Flash's ExternalInterface to expose Flash methods and\r\n\t//\t\tto call JavaScript.\r\n\t//\r\n\t//\t\tsetSwf can take an optional 'visible' attribute to control whether\r\n\t//\t\tthe Flash object is visible or not on the page; the default is visible:\r\n\t//\r\n\t// |\tdojox.flash.setSwf(dojo.moduleUrl(\"dojox\", \"_storage/storage.swf\"), false);\r\n\t//\r\n\t//\t\tOnce finished, you can query Flash version information:\r\n\t//\r\n\t// |\tdojox.flash.info.version\r\n\t//\r\n\t//\t\tOr can communicate with Flash methods that were exposed:\r\n\t//\r\n\t// |\tvar f = dojox.flash.get();\r\n\t// |\tvar results = f.sayHello(\"Some Message\");\r\n\t//\r\n\t//\t\tYour Flash files should use DojoExternalInterface.as to register methods;\r\n\t//\t\tthis file wraps Flash's normal ExternalInterface but correct various\r\n\t//\t\tserialization bugs that ExternalInterface has.\r\n\t//\r\n\t// \t\tNotes:\r\n\t//\r\n\t//\t\t- dojox.flash is not meant to be a generic Flash embedding\r\n\t//\t\tmechanism; it is as generic as necessary to make Dojo Storage's\r\n\t//\t\tFlash Storage Provider as clean and modular as possible. If you want\r\n\t//\t\ta generic Flash embed mechanism see [SWFObject](http://blog.deconcept.com/swfobject/).\r\n\t//\t\t- dojox.flash can currently only work with one Flash object\r\n\t//\t\ton the page; it does not yet support multiple Flash objects on\r\n\t//\t\tthe same page.\r\n\t//\t\t- Your code can detect whether the Flash player is installing or having\r\n\t//\t\tits version revved in two ways. First, if dojox.flash detects that\r\n\t//\t\tFlash installation needs to occur, it sets dojox.flash.info.installing\r\n\t//\t\tto true. Second, you can detect if installation is necessary with the\r\n\t//\t\tfollowing callback:\r\n\t//\r\n\t// |\tdojo.connect(dojox.flash, \"installing\", myInstance, \"myCallback\");\r\n\t//\r\n\t//\t\tYou can use this callback to delay further actions that might need Flash;\r\n\t//\t\twhen installation is finished the full page will be refreshed and the\r\n\t//\t\tuser will be placed back on your page with Flash installed.\r\n\t//\r\n\t//\t\t-------------------\r\n\t//\t\tTodo/Known Issues\r\n\t//\t\t-------------------\r\n\t//\r\n\t//\t\t- On Internet Explorer, after doing a basic install, the page is\r\n\t//\t\tnot refreshed or does not detect that Flash is now available. The way\r\n\t//\t\tto fix this is to create a custom small Flash file that is pointed to\r\n\t//\t\tduring installation; when it is finished loading, it does a callback\r\n\t//\t\tthat says that Flash installation is complete on IE, and we can proceed\r\n\t//\t\tto initialize the dojox.flash subsystem.\r\n\t//\t\t- Things aren't super tested for sending complex objects to Flash\r\n\t//\t\tmethods, since Dojo Storage only needs strings.\r\n\t//\r\n\t//\t\tAuthor- Brad Neuberg, http://codinginparadise.org\r\n\r\n\tready: false,\r\n\turl: null,\r\n\t\r\n\t_visible: true,\r\n\t_loadedListeners: [],\r\n\t_installingListeners: [],\r\n\t\r\n\tsetSwf: function(/* String */ url, /* boolean? */ visible){\r\n\t\t// summary:\r\n\t\t//\t\tSets the SWF files and versions we are using.\r\n\t\t// url: String\r\n\t\t//\t\tThe URL to this Flash file.\r\n\t\t// visible: boolean?\r\n\t\t//\t\tWhether the Flash file is visible or not. If it is not visible we hide\r\n\t\t//\t\tit off the screen. This defaults to true (i.e. the Flash file is\r\n\t\t//\t\tvisible).\r\n\t\tthis.url = url;\r\n\t\t\r\n\t\tthis._visible = true;\r\n\t\tif(visible !== null && visible !== undefined){\r\n\t\t\tthis._visible = visible;\r\n\t\t}\r\n\t\t\r\n\t\t// initialize ourselves\r\n\t\tthis._initialize();\r\n\t},\r\n\t\r\n\taddLoadedListener: function(/* Function */ listener){\r\n\t\t// summary:\r\n\t\t//\tAdds a listener to know when Flash is finished loading.\r\n\t\t//\tUseful if you don't want a dependency on dojo.event.\r\n\t\t// listener: Function\r\n\t\t//\tA function that will be called when Flash is done loading.\r\n\t\t\r\n\t\tthis._loadedListeners.push(listener);\r\n\t},\r\n\r\n\taddInstallingListener: function(/* Function */ listener){\r\n\t\t// summary:\r\n\t\t//\tAdds a listener to know if Flash is being installed.\r\n\t\t//\tUseful if you don't want a dependency on dojo.event.\r\n\t\t// listener: Function\r\n\t\t//\tA function that will be called if Flash is being\r\n\t\t//\tinstalled\r\n\t\t\r\n\t\tthis._installingListeners.push(listener);\r\n\t},\r\n\t\r\n\tloaded: function(){\r\n\t\t// summary:\r\n\t\t//\t\tCalled back when the Flash subsystem is finished loading.\r\n\t\t// description:\r\n\t\t//\t\tA callback when the Flash subsystem is finished loading and can be\r\n\t\t//\t\tworked with. To be notified when Flash is finished loading, add a\r\n\t\t//\t\tloaded listener:\r\n\t\t//\r\n\t\t//\t\tdojox.flash.addLoadedListener(loadedListener);\r\n\t\r\n\t\tdojox.flash.ready = true;\r\n\t\tif(dojox.flash._loadedListeners.length){ // FIXME: redundant if? use forEach?\r\n\t\t\tfor(var i = 0;i < dojox.flash._loadedListeners.length; i++){\r\n\t\t\t\tdojox.flash._loadedListeners[i].call(null);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\r\n\tinstalling: function(){\r\n\t\t// summary:\r\n\t\t//\t\tCalled if Flash is being installed.\r\n\t\t// description:\r\n\t\t//\t\tA callback to know if Flash is currently being installed or\r\n\t\t//\t\thaving its version revved. To be notified if Flash is installing, connect\r\n\t\t//\t\tyour callback to this method using the following:\r\n\t\t//\r\n\t\t//\t\tdojo.event.connect(dojox.flash, \"installing\", myInstance, \"myCallback\");\r\n\t\t\r\n\t\tif(dojox.flash._installingListeners.length){ // FIXME: redundant if? use forEach?\r\n\t\t\tfor(var i = 0; i < dojox.flash._installingListeners.length; i++){\r\n\t\t\t\tdojox.flash._installingListeners[i].call(null);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\r\n\t// Initializes dojox.flash.\r\n\t_initialize: function(){\r\n\t\t//console.debug(\"dojox.flash._initialize\");\r\n\t\t// see if we need to rev or install Flash on this platform\r\n\t\tvar installer = new dojox.flash.Install();\r\n\t\tdojox.flash.installer = installer;\r\n\r\n\t\tif(installer.needed()){\r\n\t\t\tinstaller.install();\r\n\t\t}else{\r\n\t\t\t// write the flash object into the page\r\n\t\t\tdojox.flash.obj = new dojox.flash.Embed(this._visible);\r\n\t\t\tdojox.flash.obj.write();\r\n\t\t\t\r\n\t\t\t// setup the communicator\r\n\t\t\tdojox.flash.comm = new dojox.flash.Communicator();\r\n\t\t}\r\n\t}\r\n};\r\n\r\n\r\ndojox.flash.Info = function(){\r\n\t// summary:\r\n\t//\t\tA class that helps us determine whether Flash is available.\r\n\t// description:\r\n\t//\t\tA class that helps us determine whether Flash is available,\r\n\t//\t\tit's major and minor versions, and what Flash version features should\r\n\t//\t\tbe used for Flash/JavaScript communication. Parts of this code\r\n\t//\t\tare adapted from the automatic Flash plugin detection code autogenerated\r\n\t//\t\tby the Macromedia Flash 8 authoring environment.\r\n\t//\r\n\t//\t\tAn instance of this class can be accessed on dojox.flash.info after\r\n\t//\t\tthe page is finished loading.\r\n\r\n\tthis._detectVersion();\r\n};\r\n\r\ndojox.flash.Info.prototype = {\r\n\t// version: String\r\n\t//\t\tThe full version string, such as \"8r22\".\r\n\tversion: -1,\r\n\t\r\n\t// versionMajor, versionMinor, versionRevision: String\r\n\t//\t\tThe major, minor, and revisions of the plugin. For example, if the\r\n\t//\t\tplugin is 8r22, then the major version is 8, the minor version is 0,\r\n\t//\t\tand the revision is 22.\r\n\tversionMajor: -1,\r\n\tversionMinor: -1,\r\n\tversionRevision: -1,\r\n\t\r\n\t// capable: Boolean\r\n\t//\t\tWhether this platform has Flash already installed.\r\n\tcapable: false,\r\n\t\r\n\t// installing: Boolean\r\n\t//\t\tSet if we are in the middle of a Flash installation session.\r\n\tinstalling: false,\r\n\t\r\n\tisVersionOrAbove: function(\r\n\t\t\t\t\t\t\t/* int */ reqMajorVer,\r\n\t\t\t\t\t\t\t/* int */ reqMinorVer,\r\n\t\t\t\t\t\t\t/* int */ reqVer){ /* Boolean */\r\n\t\t// summary:\r\n\t\t//\t\tAsserts that this environment has the given major, minor, and revision\r\n\t\t//\t\tnumbers for the Flash player.\r\n\t\t// description:\r\n\t\t//\t\tAsserts that this environment has the given major, minor, and revision\r\n\t\t//\t\tnumbers for the Flash player.\r\n\t\t//\r\n\t\t//\t\tExample- To test for Flash Player 7r14:\r\n\t\t//\r\n\t\t//\t\tdojox.flash.info.isVersionOrAbove(7, 0, 14)\r\n\t\t// returns:\r\n\t\t//\t\tReturns true if the player is equal\r\n\t\t//\t\tor above the given version, false otherwise.\r\n\t\t\r\n\t\t// make the revision a decimal (i.e. transform revision 14 into\r\n\t\t// 0.14\r\n\t\treqVer = parseFloat(\".\" + reqVer);\r\n\t\t\r\n\t\tif(this.versionMajor >= reqMajorVer && this.versionMinor >= reqMinorVer\r\n\t\t\t && this.versionRevision >= reqVer){\r\n\t\t\treturn true;\r\n\t\t}else{\r\n\t\t\treturn false;\r\n\t\t}\r\n\t},\r\n\t\r\n\t_detectVersion: function(){\r\n\t\tvar versionStr;\r\n\t\t\r\n\t\t// loop backwards through the versions until we find the newest version\r\n\t\tfor(var testVersion = 25; testVersion > 0; testVersion--){\r\n\t\t\tif(dojo.isIE){\r\n\t\t\t\tvar axo;\r\n\t\t\t\ttry{\r\n\t\t\t\t\tif(testVersion > 6){\r\n\t\t\t\t\t\taxo = new ActiveXObject(\"ShockwaveFlash.ShockwaveFlash.\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ testVersion);\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\taxo = new ActiveXObject(\"ShockwaveFlash.ShockwaveFlash\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(typeof axo == \"object\"){\r\n\t\t\t\t\t\tif(testVersion == 6){\r\n\t\t\t\t\t\t\taxo.AllowScriptAccess = \"always\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tversionStr = axo.GetVariable(\"$version\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}catch(e){\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\tversionStr = this._JSFlashInfo(testVersion);\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t\tif(versionStr == -1 ){\r\n\t\t\t\tthis.capable = false;\r\n\t\t\t\treturn;\r\n\t\t\t}else if(versionStr != 0){\r\n\t\t\t\tvar versionArray;\r\n\t\t\t\tif(dojo.isIE){\r\n\t\t\t\t\tvar tempArray = versionStr.split(\" \");\r\n\t\t\t\t\tvar tempString = tempArray[1];\r\n\t\t\t\t\tversionArray = tempString.split(\",\");\r\n\t\t\t\t}else{\r\n\t\t\t\t\tversionArray = versionStr.split(\".\");\r\n\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\tthis.versionMajor = versionArray[0];\r\n\t\t\t\tthis.versionMinor = versionArray[1];\r\n\t\t\t\tthis.versionRevision = versionArray[2];\r\n\t\t\t\t\r\n\t\t\t\t// 7.0r24 == 7.24\r\n\t\t\t\tvar versionString = this.versionMajor + \".\" + this.versionRevision;\r\n\t\t\t\tthis.version = parseFloat(versionString);\r\n\t\t\t\t\r\n\t\t\t\tthis.capable = true;\r\n\t\t\t\t\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t \r\n\t// JavaScript helper required to detect Flash Player PlugIn version\r\n\t// information. Internet Explorer uses a corresponding Visual Basic\r\n\t// version to interact with the Flash ActiveX control.\r\n\t_JSFlashInfo: function(testVersion){\r\n\t\t// NS/Opera version >= 3 check for Flash plugin in plugin array\r\n\t\tif(navigator.plugins != null && navigator.plugins.length > 0){\r\n\t\t\tif(navigator.plugins[\"Shockwave Flash 2.0\"] ||\r\n\t\t\t\t navigator.plugins[\"Shockwave Flash\"]){\r\n\t\t\t\tvar swVer2 = navigator.plugins[\"Shockwave Flash 2.0\"] ? \" 2.0\" : \"\";\r\n\t\t\t\tvar flashDescription = navigator.plugins[\"Shockwave Flash\" + swVer2].description;\r\n\t\t\t\tvar descArray = flashDescription.split(\" \");\r\n\t\t\t\tvar tempArrayMajor = descArray[2].split(\".\");\r\n\t\t\t\tvar versionMajor = tempArrayMajor[0];\r\n\t\t\t\tvar versionMinor = tempArrayMajor[1];\r\n\t\t\t\tvar tempArrayMinor = (descArray[3] || descArray[4]).split(\"r\");\r\n\t\t\t\tvar versionRevision = tempArrayMinor[1] > 0 ? tempArrayMinor[1] : 0;\r\n\t\t\t\tvar version = versionMajor + \".\" + versionMinor + \".\" + versionRevision;\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\treturn version;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn -1;\r\n\t}\r\n};\r\n\r\ndojox.flash.Embed = function(visible){\r\n\t// summary:\r\n\t//\t\tA class that is used to write out the Flash object into the page.\r\n\t// description:\r\n\t//\t\tWrites out the necessary tags to embed a Flash file into the page. Note that\r\n\t//\t\tthese tags are written out as the page is loaded using document.write, so\r\n\t//\t\tyou must call this class before the page has finished loading.\r\n\t\r\n\tthis._visible = visible;\r\n};\r\n\r\ndojox.flash.Embed.prototype = {\r\n\t// width: int\r\n\t//\t\tThe width of this Flash applet. The default is the minimal width\r\n\t//\t\tnecessary to show the Flash settings dialog. Current value is\r\n\t//\t\t215 pixels.\r\n\twidth: 215,\r\n\t\r\n\t// height: int\r\n\t//\t\tThe height of this Flash applet. The default is the minimal height\r\n\t//\t\tnecessary to show the Flash settings dialog. Current value is\r\n\t//\t\t138 pixels.\r\n\theight: 138,\r\n\t\r\n\t// id: String\r\n\t//\t\tThe id of the Flash object. Current value is 'flashObject'.\r\n\tid: \"flashObject\",\r\n\t\r\n\t// Controls whether this is a visible Flash applet or not.\r\n\t_visible: true,\r\n\r\n\tprotocol: function(){\r\n\t\tswitch(window.location.protocol){\r\n\t\t\tcase \"https:\":\r\n\t\t\t\treturn \"https\";\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\treturn \"http\";\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t},\r\n\t\r\n\twrite: function(/* Boolean? */ doExpressInstall){\r\n\t\t// summary:\r\n\t\t//\t\tWrites the Flash into the page.\r\n\t\t// description:\r\n\t\t//\t\tThis must be called before the page\r\n\t\t//\t\tis finished loading.\r\n\t\t// doExpressInstall: Boolean\r\n\t\t//\t\tWhether to write out Express Install\r\n\t\t//\t\tinformation. Optional value; defaults to false.\r\n\t\t\r\n\t\t// figure out the SWF file to get and how to write out the correct HTML\r\n\t\t// for this Flash version\r\n\t\tvar objectHTML;\r\n\t\tvar swfloc = dojox.flash.url;\r\n\t\tvar swflocObject = swfloc;\r\n\t\tvar swflocEmbed = swfloc;\r\n\t\tvar dojoUrl = dojo.baseUrl;\r\n\t\tvar xdomainBase = document.location.protocol + '//' + document.location.host;\r\n\t\tif(doExpressInstall){\r\n\t\t\t// the location to redirect to after installing\r\n\t\t\tvar redirectURL = escape(window.location);\r\n\t\t\tdocument.title = document.title.slice(0, 47) + \" - Flash Player Installation\";\r\n\t\t\tvar docTitle = escape(document.title);\r\n\t\t\tswflocObject += \"?MMredirectURL=\" + redirectURL\r\n\t\t\t                + \"&MMplayerType=ActiveX\"\r\n\t\t\t                + \"&MMdoctitle=\" + docTitle\r\n\t\t\t                + \"&baseUrl=\" + escape(dojoUrl)\r\n\t\t\t                + \"&xdomain=\" + escape(xdomainBase);\r\n\t\t\tswflocEmbed += \"?MMredirectURL=\" + redirectURL\r\n\t\t\t                + \"&MMplayerType=PlugIn\"\r\n\t\t\t                + \"&baseUrl=\" + escape(dojoUrl)\r\n\t\t\t                + \"&xdomain=\" + escape(xdomainBase);\r\n\t\t}else{\r\n\t\t\t// IE/Flash has an evil bug that shows up some time: if we load the\r\n\t\t\t// Flash and it isn't in the cache, ExternalInterface works fine --\r\n\t\t\t// however, the second time when its loaded from the cache a timing\r\n\t\t\t// bug can keep ExternalInterface from working. The trick below\r\n\t\t\t// simply invalidates the Flash object in the cache all the time to\r\n\t\t\t// keep it loading fresh. -- Brad Neuberg\r\n\t\t\tswflocObject += \"?cachebust=\" + new Date().getTime();\r\n\t\t\tswflocObject += \"&baseUrl=\" + escape(dojoUrl);\r\n\t\t\tswflocObject += \"&xdomain=\" + escape(xdomainBase);\r\n\t\t}\r\n\r\n\t\tif(swflocEmbed.indexOf(\"?\") == -1){\r\n\t\t\tswflocEmbed += '?baseUrl='+escape(dojoUrl);\r\n\t\t}else{\r\n\t\t  swflocEmbed += '&baseUrl='+escape(dojoUrl);\r\n\t\t}\r\n\t\tswflocEmbed += '&xdomain='+escape(xdomainBase);\r\n\t\t\r\n\t\tobjectHTML =\r\n\t\t\t'<object classid=\"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\" '\r\n\t\t\t  + 'codebase=\"'\r\n\t\t\t\t+ this.protocol()\r\n\t\t\t\t+ '://fpdownload.macromedia.com/pub/shockwave/cabs/flash/'\r\n\t\t\t\t+ 'swflash.cab#version=8,0,0,0\"\\n '\r\n\t\t\t  + 'width=\"' + this.width + '\"\\n '\r\n\t\t\t  + 'height=\"' + this.height + '\"\\n '\r\n\t\t\t  + 'id=\"' + this.id + '\"\\n '\r\n\t\t\t  + 'name=\"' + this.id + '\"\\n '\r\n\t\t\t  + 'align=\"middle\">\\n '\r\n\t\t\t  + '<param name=\"allowScriptAccess\" value=\"always\"></param>\\n '\r\n\t\t\t  + '<param name=\"movie\" value=\"' + swflocObject + '\"></param>\\n '\r\n\t\t\t  + '<param name=\"quality\" value=\"high\"></param>\\n '\r\n\t\t\t  + '<param name=\"bgcolor\" value=\"#ffffff\"></param>\\n '\r\n\t\t\t  + '<embed src=\"' + swflocEmbed + '\" '\r\n\t\t\t  \t  + 'quality=\"high\" '\r\n\t\t\t\t  + 'bgcolor=\"#ffffff\" '\r\n\t\t\t\t  + 'width=\"' + this.width + '\" '\r\n\t\t\t\t  + 'height=\"' + this.height + '\" '\r\n\t\t\t\t  + 'id=\"' + this.id + 'Embed' + '\" '\r\n\t\t\t\t  + 'name=\"' + this.id + '\" '\r\n\t\t\t\t  + 'swLiveConnect=\"true\" '\r\n\t\t\t\t  + 'align=\"middle\" '\r\n\t\t\t\t  + 'allowScriptAccess=\"always\" '\r\n\t\t\t\t  + 'type=\"application/x-shockwave-flash\" '\r\n\t\t\t\t  + 'pluginspage=\"'\r\n\t\t\t\t  + this.protocol()\r\n\t\t\t\t  +'://www.macromedia.com/go/getflashplayer\" '\r\n\t\t\t\t  + '></embed>\\n'\r\n\t\t\t+ '</object>\\n';\r\n\t\t\t\t\t\r\n\t\t// using same mechanism on all browsers now to write out\r\n\t\t// Flash object into page\r\n\r\n\t\t// document.write no longer works correctly due to Eolas patent workaround\r\n\t\t// in IE; nothing happens (i.e. object doesn't go into page if we use it)\r\n\t\tdojo.connect(dojo, \"loaded\", dojo.hitch(this, function(){\r\n\t\t\t// Prevent putting duplicate SWFs onto the page\r\n\t\t\tvar containerId = this.id + \"Container\";\r\n\t\t\tif(dojo.byId(containerId)){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar div = document.createElement(\"div\");\r\n\t\t\tdiv.id = this.id + \"Container\";\r\n\t\t\t\r\n\t\t\tdiv.style.width = this.width + \"px\";\r\n\t\t\tdiv.style.height = this.height + \"px\";\r\n\t\t\tif(!this._visible){\r\n\t\t\t\tdiv.style.position = \"absolute\";\r\n\t\t\t\tdiv.style.zIndex = \"10000\";\r\n\t\t\t\tdiv.style.top = \"-1000px\";\r\n\t\t\t}\r\n\r\n\t\t\tdiv.innerHTML = objectHTML;\r\n\r\n\t\t\tvar body = document.getElementsByTagName(\"body\");\r\n\t\t\tif(!body || !body.length){\r\n\t\t\t\tthrow new Error(\"No body tag for this page\");\r\n\t\t\t}\r\n\t\t\tbody = body[0];\r\n\t\t\tbody.appendChild(div);\r\n\t\t}));\r\n\t},\r\n\t\r\n\tget: function(){ /* Object */\r\n\t\t// summary:\r\n\t\t//\t\tGets the Flash object DOM node.\r\n\r\n\t\tif(dojo.isIE || dojo.isWebKit){\r\n\t\t\t//TODO: should this really be the else?\r\n\t\t\treturn dojo.byId(this.id);\r\n\t\t}else{\r\n\t\t\t// different IDs on OBJECT and EMBED tags or\r\n\t\t\t// else Firefox will return wrong one and\r\n\t\t\t// communication won't work;\r\n\t\t\t// also, document.getElementById() returns a\r\n\t\t\t// plugin but ExternalInterface calls don't\r\n\t\t\t// work on it so we have to use\r\n\t\t\t// document[id] instead\r\n\t\t\treturn document[this.id + \"Embed\"];\r\n\t\t}\r\n\t},\r\n\t\r\n\tsetVisible: function(/* Boolean */ visible){\r\n\t\t// summary:\r\n\t\t//\t\tSets the visibility of this Flash object.\r\n\r\n\t\t//console.debug(\"setVisible, visible=\"+visible);\r\n\r\n\t\tvar container = dojo.byId(this.id + \"Container\");\r\n\t\tif(visible){\r\n\t\t\tcontainer.style.position = \"absolute\"; // IE -- Brad Neuberg\r\n\t\t\tcontainer.style.visibility = \"visible\";\r\n\t\t}else{\r\n\t\t\tcontainer.style.position = \"absolute\";\r\n\t\t\tcontainer.style.y = \"-1000px\";\r\n\t\t\tcontainer.style.visibility = \"hidden\";\r\n\t\t}\r\n\t},\r\n\t\r\n\tcenter: function(){\r\n\t\t// summary:\r\n\t\t//\t\tCenters the flash applet on the page.\r\n\t\t\r\n\t\tvar elementWidth = this.width;\r\n\t\tvar elementHeight = this.height;\r\n\r\n\t\tvar viewport = dojo.window.getBox();\r\n\r\n\t\t// compute the centered position\r\n\t\tvar x = viewport.l + (viewport.w - elementWidth) / 2;\r\n\t\tvar y = viewport.t + (viewport.h - elementHeight) / 2;\r\n\t\t\r\n\t\t// set the centered position\r\n\t\tvar container = dojo.byId(this.id + \"Container\");\r\n\t\tcontainer.style.top = y + \"px\";\r\n\t\tcontainer.style.left = x + \"px\";\r\n\t}\r\n};\r\n\r\n\r\ndojox.flash.Communicator = function(){\r\n\t// summary:\r\n\t//\tA class that is used to communicate between Flash and JavaScript.\r\n\t// description:\r\n\t//\tThis class helps mediate Flash and JavaScript communication. Internally\r\n\t//\tit uses Flash 8's ExternalInterface API, but adds functionality to fix\r\n\t//\tvarious encoding bugs that ExternalInterface has.\r\n}\r\n\r\ndojox.flash.Communicator.prototype = {\r\n\t// Registers the existence of a Flash method that we can call with\r\n\t// JavaScript, using Flash 8's ExternalInterface.\r\n\t_addExternalInterfaceCallback: function(methodName){\r\n\t\t//console.debug(\"addExternalInterfaceCallback, methodName=\"+methodName);\r\n\t\tvar wrapperCall = dojo.hitch(this, function(){\r\n\t\t\t// some browsers don't like us changing values in the 'arguments' array, so\r\n\t\t\t// make a fresh copy of it\r\n\t\t\tvar methodArgs = new Array(arguments.length);\r\n\t\t\tfor(var i = 0; i < arguments.length; i++){\r\n\t\t\t\tmethodArgs[i] = this._encodeData(arguments[i]);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar results = this._execFlash(methodName, methodArgs);\r\n\t\t\tresults = this._decodeData(results);\r\n\t\t\t\r\n\t\t\treturn results;\r\n\t\t});\r\n\t\t\r\n\t\tthis[methodName] = wrapperCall;\r\n\t},\r\n\t\r\n\t// Encodes our data to get around ExternalInterface bugs that are still\r\n\t// present even in Flash 9.\r\n\t_encodeData: function(data){\r\n\t\t//console.debug(\"encodeData, data=\", data);\r\n\t\tif(!data || typeof data != \"string\"){\r\n\t\t\treturn data;\r\n\t\t}\r\n\t\t\r\n\t\t// transforming \\ into \\\\ doesn't work; just use a custom encoding\r\n\t\tdata = data.replace(\"\\\\\", \"&custom_backslash;\");\r\n\r\n\t\t// also use custom encoding for the null character to avoid problems\r\n\t\tdata = data.replace(/\\0/g, \"&custom_null;\");\r\n\r\n\t\treturn data;\r\n\t},\r\n\t\r\n\t// Decodes our data to get around ExternalInterface bugs that are still\r\n\t// present even in Flash 9.\r\n\t_decodeData: function(data){\r\n\t\t//console.debug(\"decodeData, data=\", data);\r\n\t\t// weirdly enough, Flash sometimes returns the result as an\r\n\t\t// 'object' that is actually an array, rather than as a String;\r\n\t\t// detect this by looking for a length property; for IE\r\n\t\t// we also make sure that we aren't dealing with a typeof string\r\n\t\t// since string objects have length property there\r\n\t\tif(data && data.length && typeof data != \"string\"){\r\n\t\t\tdata = data[0];\r\n\t\t}\r\n\t\t\r\n\t\tif(!data || typeof data != \"string\"){\r\n\t\t\treturn data;\r\n\t\t}\r\n\t\t\r\n\t\t// needed for IE; \\0 is the NULL character\r\n\t\tdata = data.replace(/\\&custom_null\\;/g, \"\\0\");\r\n\t\r\n\t\t// certain XMLish characters break Flash's wire serialization for\r\n\t\t// ExternalInterface; these are encoded on the\r\n\t\t// DojoExternalInterface side into a custom encoding, rather than\r\n\t\t// the standard entity encoding, because otherwise we won't be able to\r\n\t\t// differentiate between our own encoding and any entity characters\r\n\t\t// that are being used in the string itself\r\n\t\tdata = data.replace(/\\&custom_lt\\;/g, \"<\")\r\n\t\t\t.replace(/\\&custom_gt\\;/g, \">\")\r\n\t\t\t.replace(/\\&custom_backslash\\;/g, '\\\\');\r\n\t\t\r\n\t\treturn data;\r\n\t},\r\n\t\r\n\t// Executes a Flash method; called from the JavaScript wrapper proxy we\r\n\t// create on dojox.flash.comm.\r\n\t_execFlash: function(methodName, methodArgs){\r\n\t\t//console.debug(\"execFlash, methodName=\"+methodName+\", methodArgs=\", methodArgs);\r\n\t\tvar plugin = dojox.flash.obj.get();\r\n\t\tmethodArgs = (methodArgs) ? methodArgs : [];\r\n\t\t\r\n\t\t// encode arguments that are strings\r\n\t\tfor(var i = 0; i < methodArgs; i++){\r\n\t\t\tif(typeof methodArgs[i] == \"string\"){\r\n\t\t\t\tmethodArgs[i] = this._encodeData(methodArgs[i]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// we use this gnarly hack below instead of\r\n\t\t// plugin[methodName] for two reasons:\r\n\t\t// 1) plugin[methodName] has no call() method, which\r\n\t\t// means we can't pass in multiple arguments dynamically\r\n\t\t// to a Flash method -- we can only have one\r\n\t\t// 2) On IE plugin[methodName] returns undefined --\r\n\t\t// plugin[methodName] used to work on IE when we\r\n\t\t// used document.write but doesn't now that\r\n\t\t// we use dynamic DOM insertion of the Flash object\r\n\t\t// -- Brad Neuberg\r\n\t\tvar flashExec = function(){\r\n\t\t\treturn eval(plugin.CallFunction(\r\n\t\t\t\t\t\t \"<invoke name=\\\"\" + methodName\r\n\t\t\t\t\t\t+ \"\\\" returntype=\\\"javascript\\\">\"\r\n\t\t\t\t\t\t+ __flash__argumentsToXML(methodArgs, 0)\r\n\t\t\t\t\t\t+ \"</invoke>\"));\r\n\t\t};\r\n\t\tvar results = flashExec.call(methodArgs);\r\n\t\t\r\n\t\tif(typeof results == \"string\"){\r\n\t\t\tresults = this._decodeData(results);\r\n\t\t}\r\n\t\t\t\r\n\t\treturn results;\r\n\t}\r\n}\r\n\r\n// FIXME: dojo.declare()-ify this\r\n\r\n// TODO: I did not test the Install code when I refactored Dojo Flash from 0.4 to\r\n// 1.0, so am not sure if it works. If Flash is not present I now prefer\r\n// that Gears is installed instead of Flash because GearsStorageProvider is\r\n// much easier to work with than Flash's hacky ExternalInterface.\r\n// -- Brad Neuberg\r\ndojox.flash.Install = function(){\r\n\t// summary:\r\n\t//\t\tHelps install Flash plugin if needed.\r\n\t// description:\r\n\t//\t\tFigures out the best way to automatically install the Flash plugin\r\n\t//\t\tfor this browser and platform. Also determines if installation or\r\n\t//\t\trevving of the current plugin is needed on this platform.\r\n};\r\n\r\ndojox.flash.Install.prototype = {\r\n\tneeded: function(){ /* Boolean */\r\n\t\t// summary:\r\n\t\t//\t\tDetermines if installation or revving of the current plugin is\r\n\t\t//\t\tneeded.\r\n\t\r\n\t\t// do we even have flash?\r\n\t\tif(!dojox.flash.info.capable){\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t// Must have ExternalInterface which came in Flash 8\r\n\t\tif(!dojox.flash.info.isVersionOrAbove(8, 0, 0)){\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t// otherwise we don't need installation\r\n\t\treturn false;\r\n\t},\r\n\r\n\tinstall: function(){\r\n\t\t// summary:\r\n\t\t//\t\tPerforms installation or revving of the Flash plugin.\r\n\t\tvar installObj;\r\n\t\r\n\t\t// indicate that we are installing\r\n\t\tdojox.flash.info.installing = true;\r\n\t\tdojox.flash.installing();\r\n\t\t\r\n\t\tif(dojox.flash.info.capable == false){ // we have no Flash at all\r\n\t\t\t// write out a simple Flash object to force the browser to prompt\r\n\t\t\t// the user to install things\r\n\t\t\tinstallObj = new dojox.flash.Embed(false);\r\n\t\t\tinstallObj.write(); // write out HTML for Flash\r\n\t\t}else if(dojox.flash.info.isVersionOrAbove(6, 0, 65)){ // Express Install\r\n\t\t\tinstallObj = new dojox.flash.Embed(false);\r\n\t\t\tinstallObj.write(true); // write out HTML for Flash 8 version+\r\n\t\t\tinstallObj.setVisible(true);\r\n\t\t\tinstallObj.center();\r\n\t\t}else{ // older Flash install than version 6r65\r\n\t\t\talert(\"This content requires a more recent version of the Macromedia \"\r\n\t\t\t\t\t\t+\" Flash Player.\");\r\n\t\t\twindow.location.href = + dojox.flash.Embed.protocol() +\r\n\t\t\t\t\t\t\"://www.macromedia.com/go/getflashplayer\";\r\n\t\t}\r\n\t},\r\n\t\r\n\t// Called when the Express Install is either finished, failed, or was\r\n\t// rejected by the user.\r\n\t_onInstallStatus: function(msg){\r\n\t\tif (msg == \"Download.Complete\"){\r\n\t\t\t// Installation is complete.\r\n\t\t\tdojox.flash._initialize();\r\n\t\t}else if(msg == \"Download.Cancelled\"){\r\n\t\t\talert(\"This content requires a more recent version of the Macromedia \"\r\n\t\t\t\t\t\t+\" Flash Player.\");\r\n\t\t\twindow.location.href = dojox.flash.Embed.protocol() +\r\n\t\t\t\t\t\t\"://www.macromedia.com/go/getflashplayer\";\r\n\t\t}else if (msg == \"Download.Failed\"){\r\n\t\t\t// The end user failed to download the installer due to a network failure\r\n\t\t\talert(\"There was an error downloading the Flash Player update. \"\r\n\t\t\t\t\t\t+ \"Please try again later, or visit macromedia.com to download \"\r\n\t\t\t\t\t\t+ \"the latest version of the Flash plugin.\");\r\n\t\t}\r\n\t}\r\n};\r\n\r\n// find out if Flash is installed\r\ndojox.flash.info = new dojox.flash.Info();\r\n\r\n// vim:ts=4:noet:tw=0:\r\n"]}