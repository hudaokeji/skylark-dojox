{"version":3,"sources":["calendar/MatrixView.js"],"names":["define","declare","arr","event","lang","has","fx","html","on","dom","domClass","domStyle","domGeometry","domConstruct","query","metrics","i18n","ViewBase","template","_TemplatedMixin","templateString","baseClass","_setTabIndexAttr","viewKind","renderData","startDate","refStartTime","refEndTime","columnCount","rowCount","horizontalRenderer","labelRenderer","expandRenderer","horizontalDecorationRenderer","percentOverlap","verticalGap","horizontalRendererHeight","labelRendererHeight","expandRendererHeight","cellPaddingTop","expandDuration","expandEasing","layoutDuringResize","roundToDay","showCellLabel","scrollable","resizeCursor","constructor","this","invalidatingProperties","_ddRendererList","_ddRendererPool","_rowHeaderHandles","destroy","preserveDom","_cleanupRowHeader","inherited","arguments","postCreate","_initialized","invalidRendering","refreshRendering","_createRenderData","rd","dateLocaleModule","dateClassObj","dateModule","dates","get","sheetHeight","itemContainer","offsetHeight","_computeRowsHeight","d","floorToDay","row","push","col","addAndFloor","startTime","newDate","endTime","add","displayedItemsInvalidated","_isEditing","_computeVisibleItems","items","displayedDecorationItemsInvalidated","decorationItems","decorationStoreManager","rtl","isLeftToRight","_validateProperties","isNaN","_setStartDateAttr","value","_set","_setColumnCountAttr","_setRowCountAttr","__fixEvt","e","sheet","source","_formatRowHeaderLabel","rowHeaderDatePattern","format","selector","datePattern","getWeekNumberLabel","_formatColumnHeaderLabel","getNames","columnHeaderLabelLength","getDay","cellHeaderShortPattern","cellHeaderLongPattern","_formatGridCellLabel","getDate","getLocalization","_calendar","domNode","oldRd","_createRendering","_layoutDecorationRenderers","_layoutRenderers","oldRenderData","rowHeight","invalidRowHeight","itemContainerTable","rows","length","_buildColumnHeader","_buildRowHeader","_buildGrid","_buildItemContainer","buttonContainer","owner","currentView","set","right","left","table","columnHeaderTable","count","_colTableSave","clone","columnHeader","removeChild","appendChild","tbody","tr","tbodies","trs","create","i","lastChild","forEach","td","className","_setText","styleColumnHeaderCell","yearColumnHeaderContent","node","date","_cssDays","isWeekEnd","list","pop","remove","_rowHeaderClick","index","rowHeaderTable","indexOf","currentTarget","_onRowHeaderClick","triggerEvent","h","hitch","_getRowHeight","styleRowHeaderCell","gridTable","currentTR","rowDiff","addRows","colDiff","_gridTableSave","grid","rowIndex","addCols","len","span","styleGridCell","styleGridCellFunc","defaultStyleGridCell","cal","isToday","compare","_itemTableSave","_recycleItemRenderers","_recycleExpandRenderers","div","childNodes","cells","resize","changeSize","_resizeHandler","apply","getExpandedRowIndex","_resizeRows","expandRow","expandedRow","expandedRowCol","setTimeout","undefined","_resizeTimer","clearTimeout","_resizeRowsImpl","resizeAnimationDuration","fadeIn","curve","play","collapseRow","duration","easing","oldSize","expandedRowHeight","size","_expandAnimation","Animation","onAnimate","_expandRowImpl","Math","floor","onEnd","_collapseRowImpl","onExpandAnimationEnd","colIndex","ceil","delay","layout","expand","max","rowHeightFirst","rowHeightLast","rhf","rhl","rh","diff","rhx","diffMin","diffMax","abs","sign","tableNode","dojo","_setHorizontalRendererAttr","_destroyRenderersByKind","_setLabelRendererAttr","_destroyExpandRenderer","renderer","destroyRecursive","_setExpandRendererAttr","pool","_getExpandRenderer","expanded","ir","parentNode","concat","_defaultItemToRendererKindFunc","item","difference","naturalRowsHeight","_roundItemToDay","s","isStartOfDay","_sortItemsFunction","a","b","res","_overlapLayoutPass3","lanes","pos","posEnd","refPos","position","x","stop","colPos","_getCellAt","w","lane","start","end","applyRendererZIndex","hovered","selected","edited","focused","container","zIndex","mobile","_layoutStep","gridTablePosX","decorationRendererManager","recycleItemRenderers","_hiddenItems","_offsets","_layoutInterval","itemsType","horizontalItems","labelItems","kind","_itemToRendererKind","expIndex","lItems","hiddenItems","hItems","hOffsets","_createHorizontalLayoutItems","hOverlapLayout","_computeHorizontalOverlapLayout","lOffsets","_createLabelLayoutItems","_computeLabelOffsets","hasHiddenItems","_computeColHasHiddenItems","_layoutHorizontalItemsImpl","_layoutLabelItemsImpl","_layoutExpandRenderers","layoutItems","isDecoration","overlap","computeRangeOverlap","startOffset","dayStart","celPos","isAllDay","allDay","computeProjectionOnDate","endOffset","t","litem","mixin","range","offsets","irHeight","overlapLayoutRes","computeOverlapping","vOverlap","numLanes","addedPassRes","comp","dayEnd","cellH","maxH","cell","posY","exp","off","_createRenderer","fullHeight","isItemBeingEdited","liveLayout","offsetWidth","top","width","height","_applyRendererLayout","createRenderer","place","maxW","getMarginBox","sort","j","isItemSelected","isItemHovered","isItemFocused","showFocus","isItemMoveEnabled","_item","getItemStoreState","isItemResizeEnabled","updateRendering","columnIndex","_layoutExpandRendererImpl","dim","layoutExpandRenderer","cellPosition","_onItemEditBeginGesture","p","_edProps","editedItem","refTime","editKind","rendererKind","dayOffset","_computeItemEditingTimes","times","eventSource","getTime","y","touchIndex","touches","pageX","pageY","r","getContentBox","colW","tm","_onGridMouseUp","_gridMouseDown","_onGridClick","_onGridTouchEnd","g","_gridProps","fromItem","editingOnStart","selectFromEvent","_pendingDoubleTap","_onGridDoubleClick","timer","doubleTapDelay","_dispatchCalendarEvt","onRowHeaderClick","expandRendererClickHandler","ri","ci","_onExpandRendererClick","_createItemEditEvent","onExpandRendererClick","isDefaultPrevented","snapUnit","snapSteps","minDurationUnit","minDurationSteps","triggerExtent","stayInView","allowStartEndSwap","allowResizeLessThan24H"],"mappings":"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","file":"../../calendar/MatrixView.js","sourcesContent":["define([\r\n\"dojo/_base/declare\", \r\n\"dojo/_base/array\", \r\n\"dojo/_base/event\", \r\n\"dojo/_base/lang\", \r\n\"dojo/_base/sniff\", \r\n\"dojo/_base/fx\", \r\n\"dojo/_base/html\",\r\n\"dojo/on\", \r\n\"dojo/dom\", \r\n\"dojo/dom-class\", \r\n\"dojo/dom-style\",\r\n\"dojo/dom-geometry\", \r\n\"dojo/dom-construct\", \r\n\"dojo/query\", \r\n\"dojox/html/metrics\", \r\n\"dojo/i18n\",\r\n\"./ViewBase\", \r\n\"dojo/text!./templates/MatrixView.html\", \r\n\"dijit/_TemplatedMixin\"],\r\n\t\r\nfunction(\r\n\tdeclare, \r\n\tarr, \r\n\tevent, \r\n\tlang, \r\n\thas, \r\n\tfx, \r\n\thtml,\r\n\ton, \r\n\tdom, \r\n\tdomClass, \r\n\tdomStyle,\r\n\tdomGeometry,\r\n\tdomConstruct, \r\n\tquery, \r\n\tmetrics, \r\n\ti18n,\r\n\tViewBase, \r\n\ttemplate, \r\n\t_TemplatedMixin){\r\n\t\r\n\t/*=====\r\n\tvar __HeaderClickEventArgs = {\r\n\t\t// summary:\r\n\t\t//\t\tA column click event.\r\n\t\t// index: Integer\r\n\t\t//\t\tThe column index. \r\n\t\t// date: Date\r\n\t\t//\t\tThe date displayed by the column.\r\n\t\t// triggerEvent: Event\r\n\t\t//\t\tThe origin event.\r\n\t};\r\n\t=====*/\r\n\t\r\n\t/*=====\r\n\tvar __ExpandRendererClickEventArgs = {\r\n\t\t// summary:\r\n\t\t//\t\tA expand renderer click event.\r\n\t\t// columnIndex: Integer\r\n\t\t//\t\tThe column index of the cell. \r\n\t\t// rowIndex: Integer\r\n\t\t//\t\tThe row index of the cell.\r\n\t\t// date: Date\r\n\t\t//\t\tThe date displayed by the cell.\r\n\t\t// triggerEvent: Event\r\n\t\t//\t\tThe origin event.\r\n\t};\r\n\t=====*/\r\n\t\r\n\treturn declare(\"dojox.calendar.MatrixView\", [ViewBase, _TemplatedMixin], {\r\n\t\t\r\n\t\t// summary:\r\n\t\t//\t\tThe matrix view is a calendar view that displaying a matrix where each cell is a day.\r\n\r\n\t\ttemplateString: template,\r\n\t\r\n\t\tbaseClass: \"dojoxCalendarMatrixView\",\r\n\t\t\r\n\t\t_setTabIndexAttr: \"domNode\",\r\n\t\t\r\n\t\t// viewKind: String\r\n\t\t//\t\tType of the view. Used by the calendar widget to determine how to configure the view.\r\n\t\t//\t\tThis view kind is \"matrix\".\r\n\t\tviewKind: \"matrix\",\r\n\r\n\t\t// renderData: Object\r\n\t\t//\t\tThe render data object contains all the data needed to render the widget.\r\n\t\trenderData: null,\r\n\t\t\r\n\t\t// startDate: Date\r\n\t\t//\t\tThe start date of the time interval displayed.\r\n\t\t//\t\tIf not set at initialization time, will be set to current day.\r\n\t\tstartDate: null,\r\n\t\t\r\n\t\t// refStartTime: Date?\r\n\t\t//\t\t(Optional) Start of the time interval of interest. \r\n\t\t//\t\tIt is used to style differently the displayed rows out of the \r\n\t\t//\t\ttime interval of interest.  \t\t\r\n\t\trefStartTime: null,\r\n\t\t\r\n\t\t// refStartTime: Date?\r\n\t\t//\t\t(Optional) End of the time interval of interest. \r\n\t\t//\t\tIt is used to style differently the displayed rows out of the \r\n\t\t//\t\ttime interval of interest.  \r\n\t\trefEndTime: null,\r\n\t\t\t\t\r\n\t\t// columnCount: Integer\r\n\t\t//\t\tThe number of column to display (from the startDate).\r\n\t\tcolumnCount: 7,\r\n\t\t\r\n\t\t// rowCount: Integer\r\n\t\t//\t\tThe number of rows to display (from the startDate).\r\n\t\trowCount: 5,\r\n\t\t\t\r\n\t\t// horizontalRenderer: Class\r\n\t\t//\t\tThe class use to create horizontal renderers.\r\n\t\thorizontalRenderer: null,\r\n\t\t\r\n\t\t// labelRenderer: Class\r\n\t\t//\t\tThe class use to create label renderers.\r\n\t\tlabelRenderer: null,\r\n\r\n\t\t// expandRenderer: Class\r\n\t\t//\t\tThe class use to create drill down renderers.\t\t\r\n\t\texpandRenderer: null,\r\n\t\t\r\n\t\t// expandRenderer: Class\r\n\t\t//\t\tThe class use to create horizontal decoration renderers.\r\n\t\thorizontalDecorationRenderer: null,\r\n\t\t\r\n\t\t// percentOverlap: Integer\r\n\t\t//\t\tThe percentage of the renderer width used to superimpose one item renderers on another \r\n\t\t//\t\twhen two events are overlapping. By default 0.\r\n\t\tpercentOverlap: 0,\r\n\t\t\r\n\t\t// verticalGap: Integer\r\n\t\t//\t\tThe number of pixels between two item renderers that are overlapping each other if the percentOverlap property is 0.\r\n\t\tverticalGap: 2,\r\n\t\t\r\n\t\t// horizontalRendererHeight: Integer\r\n\t\t//\t\tThe height in pixels of the horizontal and label renderers that is applied by the layout.\r\n\t\thorizontalRendererHeight: 17,\r\n\t\t\r\n\t\t// horizontalRendererHeight: Integer\r\n\t\t//\t\tThe height in pixels of the horizontal and label renderers that is applied by the layout.\r\n\t\tlabelRendererHeight: 14,\r\n\t\t\r\n\t\t// expandRendererHeight: Integer\r\n\t\t//\t\tThe height in pixels of the expand/collapse renderers that is applied by the layout.\r\n\t\texpandRendererHeight: 15,\r\n\t\t\r\n\t\t// cellPaddingTop: Integer\r\n\t\t//\t\tThe top offset in pixels of each cell applied by the layout.\r\n\t\tcellPaddingTop: 16,\r\n\t\t\r\n\t\t// expandDuration: Integer\r\n\t\t//\t\tDuration of the animation when expanding or collapsing a row.\r\n\t\texpandDuration: 300,\r\n\t\t\r\n\t\t// expandEasing: Function\r\n\t\t//\t\tEasing function of the animation when expanding or collapsing a row (null by default).\r\n\t\texpandEasing: null,\r\n\t\t\r\n\t\t// layoutDuringResize: Boolean\r\n\t\t//\t\tIndicates if the item renderers' position and size is updated or if they are hidden during a resize of the widget. \r\n\t\tlayoutDuringResize: false,\r\n\t\t\r\n\t\t// roundToDay: Boolean\r\n\t\t//\t\tFor horizontal renderers that are not filling entire days, whether fill the day or not.\r\n\t\troundToDay: true,\r\n\t\t\r\n\t\t// showCellLabel: Boolean\r\n\t\t//\t\tWhether display or not the grid cells label (usually the day of month).\r\n\t\tshowCellLabel: true,\r\n\t\t\r\n\t\t// scrollable: [private] Boolean\r\n\t\tscrollable: false,\r\n\r\n\t\t// resizeCursor: [private] Boolean\r\n\t\tresizeCursor: \"e-resize\",\r\n\t\t\r\n\t\tconstructor: function(){\r\n\t\t\tthis.invalidatingProperties = \r\n\t\t\t\t[\"columnCount\", \"rowCount\", \"startDate\", \"horizontalRenderer\", \"horizontalDecaorationRenderer\", \r\n\t\t\t\t \"labelRenderer\", \"expandRenderer\", \"rowHeaderDatePattern\", \"columnHeaderLabelLength\", \r\n\t\t\t\t \"cellHeaderShortPattern\", \"cellHeaderLongPattern\", \"percentOverlap\",\t\"verticalGap\", \r\n\t\t\t\t \"horizontalRendererHeight\", \"labelRendererHeight\", \"expandRendererHeight\", \"cellPaddingTop\", \r\n\t\t\t\t \"roundToDay\", \"itemToRendererKindFunc\", \"layoutPriorityFunction\", \"formatItemTimeFunc\", \"textDir\", \"items\"];\r\n\t\t\t\r\n\t\t\tthis._ddRendererList = [];\r\n\t\t\tthis._ddRendererPool = [];\r\n\t\t\tthis._rowHeaderHandles = [];\t\t\t\r\n\t\t},\r\n\t\t\r\n\t\tdestroy: function(preserveDom){\r\n\t\t\tthis._cleanupRowHeader();\r\n\t\t\tthis.inherited(arguments);\r\n\t\t},\r\n\t\t\t\r\n\t\tpostCreate: function(){\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\tthis._initialized = true;\r\n\t\t\tif(!this.invalidRendering){\r\n\t\t\t\tthis.refreshRendering();\r\n\t\t\t}\t\t\t\r\n\t\t},\r\n\t\t\t\t\t\t\r\n\t\t_createRenderData: function(){\r\n\t\t\t\r\n\t\t\tvar rd = {};\r\n\t\t\t\r\n\t\t\trd.dateLocaleModule = this.dateLocaleModule;\r\n\t\t\trd.dateClassObj = this.dateClassObj;\r\n\t\t\trd.dateModule = this.dateModule; // arithmetics on Dates\r\n\t\t\t\r\n\t\t\trd.dates = [];\r\n\t\t\t\r\n\t\t\trd.columnCount = this.get(\"columnCount\");\r\n\t\t\trd.rowCount = this.get(\"rowCount\");\r\n\t\t\t\r\n\t\t\trd.sheetHeight = this.itemContainer.offsetHeight;\r\n\t\t\t\r\n\t\t\tthis._computeRowsHeight(rd);\r\n\t\t\t\r\n\t\t\tvar d = this.get(\"startDate\");\r\n\t\t\r\n\t\t\tif(d == null){\r\n\t\t\t\td = new rd.dateClassObj();\t\t\t\t\r\n\t\t\t}\r\n\r\n\t\t\td = this.floorToDay(d, false, rd);\r\n\t\t\t\r\n\t\t\tthis.startDate = d;\t\t\t\t\t\r\n\t\t\t\r\n\t\t\tfor(var row = 0; row < rd.rowCount ; row++){\r\n\t\t\t\trd.dates.push([]);\r\n\t\t\t\tfor(var col = 0; col < rd.columnCount ; col++){\r\n\t\t\t\t\trd.dates[row].push(d);\r\n\t\t\t\t\td = this.addAndFloor(d, \"day\", 1);\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\trd.startTime = this.newDate(rd.dates[0][0], rd);\r\n\t\t\trd.endTime = this.newDate(rd.dates[rd.rowCount-1][rd.columnCount-1], rd);\t\t\t\r\n\t\t\trd.endTime = rd.dateModule.add(rd.endTime, \"day\", 1);\r\n\t\t\trd.endTime = this.floorToDay(rd.endTime, true);\r\n\t\t\t\r\n\t\t\tif(this.displayedItemsInvalidated && !this._isEditing){\r\n\t\t\t\t// while editing in no live layout we must not to recompute items (duplicate renderers)\r\n\t\t\t\tthis.displayedItemsInvalidated = false;\r\n\t\t\t\tthis._computeVisibleItems(rd);\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t}else if(this.renderData){\r\n\t\t\t\trd.items = this.renderData.items;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(this.displayedDecorationItemsInvalidated){\t\t\t\t \r\n\t\t\t\trd.decorationItems = this.decorationStoreManager._computeVisibleItems(rd);\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t}else if (this.renderData){\r\n\t\t\t\trd.decorationItems = this.renderData.decorationItems;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\trd.rtl = !this.isLeftToRight();\r\n\t\t\t\r\n\t\t\treturn rd;\r\n\t\t},\r\n\t\t\t\t\r\n\t\t_validateProperties: function(){\r\n\t\t\t\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\t\t\t\t\r\n\t\t\tif(this.columnCount<1 || isNaN(this.columnCount)){\r\n\t\t\t\tthis.columnCount = 1;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(this.rowCount<1 || isNaN(this.rowCount)){\r\n\t\t\t\tthis.rowCount = 1;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(isNaN(this.percentOverlap) || this.percentOverlap < 0 || this.percentOverlap > 100){\r\n\t\t\t\tthis.percentOverlap = 0;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(isNaN(this.verticalGap) || this.verticalGap < 0){\r\n\t\t\t\tthis.verticalGap = 2;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(isNaN(this.horizontalRendererHeight) || this.horizontalRendererHeight < 1){\r\n\t\t\t\tthis.horizontalRendererHeight = 17;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(isNaN(this.labelRendererHeight) || this.labelRendererHeight < 1){\r\n\t\t\t\tthis.labelRendererHeight = 14;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(isNaN(this.expandRendererHeight) || this.expandRendererHeight < 1){\r\n\t\t\t\tthis.expandRendererHeight = 15;\r\n\t\t\t}\r\n\t\t\r\n\t\t},\r\n\t\t\r\n\t\t_setStartDateAttr: function(value){\r\n\t\t\tthis.displayedItemsInvalidated = true;\r\n\t\t\tthis._set(\"startDate\", value);\r\n\t\t},\r\n\t\t\r\n\t\t_setColumnCountAttr: function(value){\r\n\t\t\tthis.displayedItemsInvalidated = true;\r\n\t\t\tthis._set(\"columnCount\", value);\r\n\t\t},\r\n\t\t\r\n\t\t_setRowCountAttr: function(value){\r\n\t\t\tthis.displayedItemsInvalidated = true;\r\n\t\t\tthis._set(\"rowCount\", value);\r\n\t\t},\r\n\t\t\r\n\t\t__fixEvt:function(e){\r\n\t\t\te.sheet = \"primary\";\r\n\t\t\te.source = this;\r\n\t\t\treturn e;\r\n\t\t},\r\n\r\n\t\t//////////////////////////////////////////\r\n\t\t//\r\n\t\t// Formatting functions\r\n\t\t//\r\n\t\t//////////////////////////////////////////\r\n\r\n\t\t_formatRowHeaderLabel: function(/*Date*/d){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tComputes the row header label for the specified time of day.\r\n\t\t\t//\t\tBy default the getWeekNumberLabel() function is called. \r\n\t\t\t//\t\tThe rowHeaderDatePattern property can be used to set a \r\n\t\t\t//\t\tcustom date pattern to the formatter.\r\n\t\t\t// d: Date\r\n\t\t\t//\t\tThe date to format\t\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\r\n\r\n\t\t\tif(this.rowHeaderDatePattern){\r\n\t\t\t\treturn this.renderData.dateLocaleModule.format(d, {\r\n\t\t\t\t\tselector: 'date',\r\n\t\t\t\t\tdatePattern: this.rowHeaderDatePattern\r\n\t\t\t\t});\r\n\t\t\t}else{\r\n\t\t\t\treturn this.getWeekNumberLabel(d);\r\n\t\t\t}\r\n\r\n\t\t},\r\n\t\t\r\n\t\t_formatColumnHeaderLabel: function(d){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tComputes the column header label for the specified date.\r\n\t\t\t//\t\tBy default a formatter is used, optionally the <code>columnHeaderLabelLength</code> \r\n\t\t\t//\t\tproperty can be used to specify the length of the string.\r\n\t\t\t// d: Date\r\n\t\t\t//\t\tThe date to format \r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\r\n\r\n\t\t\treturn this.renderData.dateLocaleModule.getNames('days', this.columnHeaderLabelLength ? this.columnHeaderLabelLength : 'wide', 'standAlone')[d.getDay()];\r\n\t\t},\r\n\t\t\r\n\t\t// cellHeaderShortPattern: String\r\n\t\t//\t\tCustom date/time pattern for grid cell label to override default one coming from the CLDR.\r\n\t\t//\t\tSee dojo/date/locale documentation for format string.\r\n\t\tcellHeaderShortPattern: null,\r\n\t\t\r\n\t\t// cellHeaderLongPattern: String\r\n\t\t//\t\tCustom date/time pattern for grid cell label to override default one coming from the CLDR.\r\n\t\t//\t\tThe long pattern is used for the first day of month or the first displayed day of a month.\r\n\t\t//\t\tSee dojo/date/locale documentation for format string.\r\n\t\tcellHeaderLongPattern: null,\r\n\t\t\r\n\t\t_formatGridCellLabel: function(d, row, col){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tComputes the column header label for the specified date.\r\n\t\t\t//\t\tBy default a formatter is used, optionally the <code>cellHeaderLongPattern</code> and <code>cellHeaderShortPattern</code> \r\n\t\t\t//\t\tproperties can be used to set a custom date pattern to the formatter.\r\n\t\t\t// d: Date\r\n\t\t\t//\t\tThe date to format.\r\n\t\t\t// row: Integer\r\n\t\t\t//\t\tThe row that displays the current date.\r\n\t\t\t// col: Integer\r\n\t\t\t//\t\tThe column that displays the current date.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\r\n\r\n\t\t\tvar isFirstDayOfMonth = row == 0 && col == 0 || d.getDate() == 1;\r\n\t\t\tvar format, rb;\r\n\t\t\tif(isFirstDayOfMonth){\r\n\t\t\t\tif(this.cellHeaderLongPattern){\r\n\t\t\t\t\tformat = this.cellHeaderLongPattern;\r\n\t\t\t\t}else{\r\n\t\t\t\t\trb = i18n.getLocalization(\"dojo.cldr\", this._calendar);\r\n\t\t\t\t\tformat = rb[\"dateFormatItem-MMMd\"];\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\tif(this.cellHeaderShortPattern){\r\n\t\t\t\t\tformat = this.cellHeaderShortPattern;\r\n\t\t\t\t}else{\r\n\t\t\t\t\trb = i18n.getLocalization(\"dojo.cldr\", this._calendar);\r\n\t\t\t\t\tformat = rb[\"dateFormatItem-d\"];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn this.renderData.dateLocaleModule.format(d, {\r\n\t\t\t\tselector: 'date',\r\n\t\t\t\tdatePattern: format\r\n\t\t\t});\r\n\t\t},\r\n\t\t\r\n\t\t////////////////////////////////////////////\r\n\t\t//\r\n\t\t// HTML structure management\r\n\t\t//\r\n\t\t///////////////////////////////////////////\r\n\t\r\n\t\trefreshRendering: function(){\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\t\r\n\t\t\tif(!this.domNode){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\tthis._validateProperties();\r\n\r\n\t\t\tvar oldRd = this.renderData;\r\n\t\t\tvar rd = this.renderData = this._createRenderData();\r\n\r\n\t\t\tthis._createRendering(rd, oldRd);\r\n\t\t\t\r\n\t\t\tthis._layoutDecorationRenderers(rd);\r\n\t\t\tthis._layoutRenderers(rd);\r\n\t\t},\r\n\t\t\r\n\t\t_createRendering: function(renderData, oldRenderData){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tCreates the HTML structure (grid, place holders, headers, etc)\r\n\t\t\t// renderData: Object\r\n\t\t\t//\t\tThe new render data\r\n\t\t\t// oldRenderData: Object\r\n\t\t\t//\t\tThe previous render data\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\t\r\n\t\t\tif(renderData.rowHeight <= 0){\r\n\t\t\t\trenderData.columnCount = 1;\r\n\t\t\t\trenderData.rowCount = 1;\r\n\t\t\t\trenderData.invalidRowHeight = true;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(oldRenderData){\r\n\t\t\t\t// make sure to have correct rowCount\r\n\t\t\t\tif(this.itemContainerTable){\r\n\t\t\t\t\tvar rows = query(\".dojoxCalendarItemContainerRow\", this.itemContainerTable);\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\toldRenderData.rowCount = rows.length;\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis._buildColumnHeader(renderData, oldRenderData);\r\n\t\t\tthis._buildRowHeader(renderData, oldRenderData);\r\n\t\t\tthis._buildGrid(renderData, oldRenderData);\r\n\t\t\tthis._buildItemContainer(renderData, oldRenderData);\r\n\t\t\t\r\n\t\t\tif(this.buttonContainer && this.owner != null && this.owner.currentView == this){\r\n\t\t\t\tdomStyle.set(this.buttonContainer, {\"right\":0, \"left\":0});\r\n\t\t\t}\r\n\t\t},\t\r\n\t\t\r\n\t\t_buildColumnHeader: function(/*Object*/ renderData, /*Object*/oldRenderData){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tCreates incrementally the HTML structure of the column header and configures its content.\r\n\t\t\t//\r\n\t\t\t// renderData:\r\n\t\t\t//\t\tThe render data to display.\r\n\t\t\t//\r\n\t\t\t// oldRenderData:\r\n\t\t\t//\t\tThe previously render data displayed, if any.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\tvar table = this.columnHeaderTable;\r\n\t\t\t\r\n\t\t\tif(!table){\r\n\t\t\t\treturn;\r\n\t\t\t}\t\r\n\t\t\t\t\t\t\r\n\t\t\tvar count = renderData.columnCount - (oldRenderData ? oldRenderData.columnCount : 0);\r\n\t\t\t\r\n\t\t\tif(has(\"ie\") == 8){\r\n\t\t\t\t// workaround Internet Explorer 8 bug.\r\n\t\t\t\t// if on the table, width: 100% and table-layout: fixed are set\r\n\t\t\t\t// and columns are removed, width of remaining columns is not \r\n\t\t\t\t// recomputed: must rebuild all. \r\n\t\t\t\tif(this._colTableSave == null){\r\n\t\t\t\t\tthis._colTableSave = lang.clone(table);\r\n\t\t\t\t}else if(count < 0){\r\n\t\t\t\t\tthis.columnHeader.removeChild(table);\r\n\t\t\t\t\tdomConstruct.destroy(table);\r\n\t\t\t\t\ttable = lang.clone(this._colTableSave);\r\n\t\t\t\t\tthis.columnHeaderTable = table;\r\n\t\t\t\t\tthis.columnHeader.appendChild(table);\r\n\t\t\t\t\tcount = renderData.columnCount;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t} // else incremental dom add/remove for real browsers.\r\n\t\t\r\n\t\t\tvar tbodies = query(\"tbody\", table);\r\n\t\t\tvar trs = query(\"tr\", table);\r\n\t\t\tvar tbody, tr, td;\r\n\t\t\t\r\n\t\t\tif(tbodies.length == 1){\r\n\t\t\t\ttbody = tbodies[0];\r\n\t\t\t}else{ \r\n\t\t\t\ttbody = html.create(\"tbody\", null, table);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(trs.length == 1){\r\n\t\t\t\ttr = trs[0];\r\n\t\t\t}else{ \r\n\t\t\t\ttr = domConstruct.create(\"tr\", null, tbody);\r\n\t\t\t}\t\t\t\r\n\t\t\t\t\t\t \r\n\t\t\t// Build HTML structure (incremental)\r\n\t\t\tif(count > 0){ // creation\t\t\t\t\r\n\t\t\t\tfor(var i=0; i < count; i++){\r\n\t\t\t\t\ttd = domConstruct.create(\"td\", null, tr);\r\n\t\t\t\t}\r\n\t\t\t}else{ // deletion\r\n\t\t\t\tcount = -count;\r\n\t\t\t\tfor(var i=0; i < count; i++){\r\n\t\t\t\t\ttr.removeChild(tr.lastChild);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// fill & configure\t\t\r\n\t\t\tquery(\"td\", table).forEach(function(td, i){\r\n\t\t\t\ttd.className = \"\";\r\n\t\t\t\tvar d = renderData.dates[0][i];\r\n\t\t\t\tthis._setText(td, this._formatColumnHeaderLabel(d));\r\n\t\t\t\tif(i == 0){\r\n\t\t\t\t\tdomClass.add(td, \"first-child\");\r\n\t\t\t\t}else if(i == this.renderData.columnCount-1){\r\n\t\t\t\t\tdomClass.add(td, \"last-child\");\r\n\t\t\t\t}\r\n\t\t\t\tthis.styleColumnHeaderCell(td, d, renderData);\r\n\t\t\t}, this);\r\n\t\t\t\r\n\t\t\tif(this.yearColumnHeaderContent){\r\n\t\t\t\tvar d = renderData.dates[0][0];\r\n\t\t\t\t\tthis._setText(this.yearColumnHeaderContent, renderData.dateLocaleModule.format(d,\r\n\t\t\t\t\t\t{selector: \"date\", datePattern:\"yyyy\"}));\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\tstyleColumnHeaderCell: function(node, date, renderData){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tStyles the CSS classes to the node that displays a column header cell.\r\n\t\t\t//\t\tBy default this method is setting the \"dojoxCalendarWeekend\" if the day of week represents a weekend.\r\n\t\t\t// node: Node\r\n\t\t\t//\t\tThe DOM node that displays the column in the grid.\r\n\t\t\t// date: Date\r\n\t\t\t//\t\tThe date displayed by this column\r\n\t\t\t// renderData: Object\t\t\t\r\n\t\t\t//\t\tThe render data.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\r\n\t\t\t\r\n\t\t\tdomClass.add(node, this._cssDays[date.getDay()]);\r\n\r\n\t\t\tif(this.isWeekEnd(date)){\r\n\t\t\t\tdomClass.add(node, \"dojoxCalendarWeekend\");\r\n\t\t\t}\t\r\n\t\t},\t\t\r\n\t\t\r\n\t\t_rowHeaderHandles: null,\r\n\t\t\r\n\t\t_cleanupRowHeader: function(){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\twhile(this._rowHeaderHandles.length > 0){\r\n\t\t\t\tvar list = this._rowHeaderHandles.pop();\r\n\t\t\t\twhile(list.length>0){\r\n\t\t\t\t\tlist.pop().remove();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t\r\n\t\t_rowHeaderClick: function(e){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\tvar index = query(\"td\", this.rowHeaderTable).indexOf(e.currentTarget);\r\n\t\t\tthis._onRowHeaderClick({\r\n\t\t\t\tindex: index,\r\n\t\t\t\tdate: this.renderData.dates[index][0],\r\n\t\t\t\ttriggerEvent: e\r\n\t\t\t});\r\n\t\t},\r\n\t\t \r\n\t\t_buildRowHeader: function(renderData, oldRenderData){\r\n\t\t\t\r\n\t\t\t// summary:\r\n\t\t\t//\t\tCreates incrementally the HTML structure of the row header and configures its content.\t\t\t\r\n\t\t\t//\r\n\t\t\t// renderData:\r\n\t\t\t//\t\tThe render data to display.\r\n\t\t\t//\r\n\t\t\t// oldRenderData:\r\n\t\t\t//\t\tThe previously render data displayed, if any.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\t\r\n\t\t\tvar rowHeaderTable = this.rowHeaderTable;\r\n\t\t\t\r\n\t\t\tif(!rowHeaderTable){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar tbodies = query(\"tbody\", rowHeaderTable);\t\t\t\r\n\t\t\tvar tbody, tr, td;\r\n\t\t\t\r\n\t\t\tif(tbodies.length == 1){\r\n\t\t\t\ttbody = tbodies[0];\r\n\t\t\t}else{ \r\n\t\t\t\ttbody = domConstruct.create(\"tbody\", null, rowHeaderTable);\r\n\t\t\t}\t\t\t\t\r\n\t\t\t\r\n\t\t\tvar count = renderData.rowCount - (oldRenderData ? oldRenderData.rowCount : 0);\r\n\t\t\t\r\n\t\t\t// Build HTML structure\r\n\t\t\tif(count>0){ // creation\r\n\t\t\t\tfor(var i=0; i < count; i++){\r\n\t\t\t\t\ttr = domConstruct.create(\"tr\", null, tbody);\r\n\t\t\t\t\ttd = domConstruct.create(\"td\", null, tr);\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar h = [];\r\n\t\t\t\t\t\t\r\n\t\t\t\t\th.push(on(td, \"click\", lang.hitch(this, this._rowHeaderClick)));\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(!has(\"touch\")){\r\n\t\t\t\t\t\th.push(on(td, \"mousedown\", function(e){\r\n\t\t\t\t\t\t\tdomClass.add(e.currentTarget, \"Active\");\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\th.push(on(td, \"mouseup\", function(e){\r\n\t\t\t\t\t\t\tdomClass.remove(e.currentTarget, \"Active\");\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\th.push(on(td, \"mouseover\", function(e){\r\n\t\t\t\t\t\t\tdomClass.add(e.currentTarget, \"Hover\");\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\th.push(on(td, \"mouseout\", function(e){\r\n\t\t\t\t\t\t\tdomClass.remove(e.currentTarget, \"Hover\");\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis._rowHeaderHandles.push(h);\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\tcount = -count;\r\n\t\t\t\t// deletion of existing nodes\r\n\t\t\t\tfor(var i=0; i < count; i++){\r\n\t\t\t\t\ttbody.removeChild(tbody.lastChild);\r\n\t\t\t\t\tvar list = this._rowHeaderHandles.pop();\r\n\t\t\t\t\twhile(list.length>0){\r\n\t\t\t\t\t\tlist.pop().remove();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// fill labels\r\n\r\n\t\t\tquery(\"tr\", rowHeaderTable).forEach(function(tr, i){\r\n\r\n\t\t\t\tdomStyle.set(tr, \"height\", this._getRowHeight(i) + \"px\");\r\n\t\t\t\t\r\n\t\t\t\tvar d = renderData.dates[i][0];\r\n\t\t\t\t\r\n\t\t\t\tvar td = query(\"td\", tr)[0];\r\n\t\t\t\ttd.className = \"\";\r\n\t\t\t\tif(i == 0){\r\n\t\t\t\t\tdomClass.add(td, \"first-child\");\r\n\t\t\t\t}\t\r\n\t\t\t\tif(i == this.renderData.rowCount-1){\r\n\t\t\t\t\tdomClass.add(td, \"last-child\");\r\n\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\tthis.styleRowHeaderCell(td, d, renderData);\r\n\r\n\t\t\t\tthis._setText(td, this._formatRowHeaderLabel(d));\r\n\t\t\t}, this);\r\n\r\n\t\t},\t\t\r\n\t\t\r\n\t\tstyleRowHeaderCell: function(node, date, renderData){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tStyles the CSS classes to the node that displays a row header cell.\r\n\t\t\t//\t\tBy default this method is doing nothing.\r\n\t\t\t// node: Node\r\n\t\t\t//\t\tThe DOM node that displays the column in the grid.\r\n\t\t\t// date: Date\r\n\t\t\t//\t\tThe date in the week.\r\n\t\t\t// renderData: Object\r\n\t\t\t//\t\tThe render data.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\r\n\r\n\t\t\t\t\r\n\t\t},\r\n\t\r\n\t\t_buildGrid: function (renderData, oldRenderData){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tCreates incrementally the HTML structure of the grid and configures its content.\r\n\t\t\t//\r\n\t\t\t// renderData:\r\n\t\t\t//\t\tThe render data to display.\r\n\t\t\t//\r\n\t\t\t// oldRenderData:\r\n\t\t\t//\t\tThe previously render data displayed, if any.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\tvar table = this.gridTable;\r\n\t\t\t\r\n\t\t\tif(!table){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar currentTR = query(\"tr\", table);\r\n\r\n\t\t\tvar rowDiff = renderData.rowCount - currentTR.length;\r\n\t\t\tvar addRows = rowDiff > 0;\r\n\t\t\t\t\t\t\r\n\t\t\tvar colDiff  = renderData.columnCount - (currentTR ? query(\"td\", currentTR[0]).length : 0);\r\n\t\t\t\r\n\t\t\tif(has(\"ie\") == 8){\r\n\t\t\t\t// workaround Internet Explorer 8 bug.\r\n\t\t\t\t// if on the table, width: 100% and table-layout: fixed are set\r\n\t\t\t\t// and columns are removed, width of remaining columns is not \r\n\t\t\t\t// recomputed: must rebuild all. \r\n\t\t\t\tif(this._gridTableSave == null){\r\n\t\t\t\t\tthis._gridTableSave = lang.clone(table);\r\n\t\t\t\t}else if(colDiff < 0){\t\t\t\t\t\r\n\t\t\t\t\tthis.grid.removeChild(table);\r\n\t\t\t\t\tdomConstruct.destroy(table);\r\n\t\t\t\t\ttable = lang.clone(this._gridTableSave);\r\n\t\t\t\t\tthis.gridTable = table;\r\n\t\t\t\t\tthis.grid.appendChild(table);\r\n\t\t\t\t\tcolDiff = renderData.columnCount;\r\n\t\t\t\t\trowDiff = renderData.rowCount;\r\n\t\t\t\t\taddRows = true;\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar tbodies = query(\"tbody\", table);\r\n\t\t\tvar tbody;\r\n\r\n\t\t\tif(tbodies.length == 1){\r\n\t\t\t\ttbody = tbodies[0];\r\n\t\t\t}else{ \r\n\t\t\t\ttbody = domConstruct.create(\"tbody\", null, table);\r\n\t\t\t}\r\n\r\n\t\t\t// Build rows HTML structure (incremental)\r\n\t\t\tif(addRows){ // creation\r\n\t\t\t\tfor(var i=0; i<rowDiff; i++){\r\n\t\t\t\t\tdomConstruct.create(\"tr\", null, tbody);\r\n\t\t\t\t}\t\t \r\n\t\t\t}else{ // deletion\t\t \r\n\t\t\t\trowDiff = -rowDiff;\r\n\t\t\t\tfor(var i=0; i<rowDiff; i++){\r\n\t\t\t\t\ttbody.removeChild(tbody.lastChild);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar rowIndex = renderData.rowCount - rowDiff;\r\n\t\t\t\r\n\t\t\tvar addCols = addRows || colDiff >0; \r\n\t\t\tcolDiff = addCols ? colDiff : -colDiff;\r\n\t\t\t\r\n\t\t\tquery(\"tr\", table).forEach(function(tr, i){\r\n\t\t\t\t\r\n\t\t\t\tif(addCols){ // creation\r\n\t\t\t\t\tvar len = i >= rowIndex ? renderData.columnCount : colDiff;\r\n\t\t\t\t\tfor(var i=0; i<len; i++){\r\n\t\t\t\t\t\tvar td = domConstruct.create(\"td\", null, tr);\r\n\t\t\t\t\t\tdomConstruct.create(\"span\", null, td);\r\n\t\t\t\t\t}\r\n\t\t\t\t}else{ // deletion\r\n\t\t\t\t\tfor(var i=0; i<colDiff; i++){\r\n\t\t\t\t\t\ttr.removeChild(tr.lastChild);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t// Set the CSS classes\r\n\r\n\t\t\tquery(\"tr\", table).forEach(function (tr, row){\r\n\t\t\t\t\r\n\t\t\t\tdomStyle.set(tr, \"height\", this._getRowHeight(row) + \"px\");\r\n\t\t\t\t\r\n\t\t\t\ttr.className = \"\";\r\n\t\t\t\t// compatibility layer for IE7 & 8 that does not support :first-child and :last-child pseudo selectors\r\n\t\t\t\tif(row == 0){\r\n\t\t\t\t\tdomClass.add(tr, \"first-child\");\r\n\t\t\t\t}\r\n\t\t\t\tif(row == renderData.rowCount-1){\r\n\t\t\t\t\tdomClass.add(tr, \"last-child\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tquery(\"td\", tr).forEach(function (td, col){\r\n\t\t\t\t\t\r\n\t\t\t\t\ttd.className = \"\";\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(col == 0){\r\n\t\t\t\t\t\tdomClass.add(td, \"first-child\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(col == renderData.columnCount-1){\r\n\t\t\t\t\t\tdomClass.add(td, \"last-child\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar d = renderData.dates[row][col];\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar span = query(\"span\", td)[0];\r\n\t\t\t\t\tthis._setText(span, this.showCellLabel ? this._formatGridCellLabel(d, row, col): null);\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis.styleGridCell(td, d, renderData);\r\n\t\t\t\t}, this);\r\n\t\t\t}, this); \r\n\r\n\t\t},\r\n\t\t\r\n\t\t// styleGridCellFunc: Function\r\n\t\t//\t\tCustom function to customize the appearance of a grid cell by installing custom CSS class on the node.\r\n\t\t//\t\tThe signature of the function must be the same then the styleGridCell one.\r\n\t\t//\t\tBy default the defaultStyleGridCell function is used.\r\n\t\tstyleGridCellFunc: null,\r\n\t\t\r\n\t\tdefaultStyleGridCell: function(node, date, renderData){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tStyles the CSS classes to the node that displays a cell.\r\n\t\t\t//\t\tBy default this method is setting the following CSS classes:\r\n\t\t\t//\t\t- \"dojoxCalendarToday\" class name if the date displayed is the current date, \r\n\t\t\t//\t\t- \"dojoxCalendarWeekend\" if the date represents a weekend or\r\n\t\t\t//\t\t- \"dojoxCalendarDayDisabled\" if the date is out of the [refStartTime, refEndTime] interval.\r\n\t\t\t//\t\t- the CSS class corresponding of the displayed day of week (\"Sun\", \"Mon\" and so on).\t\t\t\r\n\t\t\t// node: Node\r\n\t\t\t//\t\tThe DOM node that displays the cell in the grid.\r\n\t\t\t// date: Date\r\n\t\t\t//\t\tThe date displayed by this cell.\r\n\t\t\t// renderData: Object\r\n\t\t\t//\t\tThe render data.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\r\n\t\t\t\r\n\t\t\tdomClass.add(node, this._cssDays[date.getDay()]);\r\n\t\t\t\r\n\t\t\tvar cal = this.dateModule;\r\n\t\t\tif(this.isToday(date)){\t\t\t\t\r\n\t\t\t\tdomClass.add(node, \"dojoxCalendarToday\");\r\n\t\t\t}else if(this.refStartTime != null && this.refEndTime != null && \r\n\t\t\t\t\t\t\t\t(cal.compare(date, this.refEndTime) >= 0 || \r\n\t\t\t\t \t\t\t\t cal.compare(cal.add(date, \"day\", 1), this.refStartTime) <= 0)){\r\n\t\t\t\tdomClass.add(node, \"dojoxCalendarDayDisabled\");\r\n\t\t\t}else if(this.isWeekEnd(date)){\r\n\t\t\t\tdomClass.add(node, \"dojoxCalendarWeekend\");\r\n\t\t\t}\t\r\n\t\t},\r\n\t\t\r\n\t\tstyleGridCell: function(node, date, renderData){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tStyles the CSS classes to the node that displays a cell.\r\n\t\t\t//\t\tDelegates to styleGridCellFunc if defined or defaultStyleGridCell otherwise.\r\n\t\t\t// node: Node\r\n\t\t\t//\t\tThe DOM node that displays the cell in the grid.\r\n\t\t\t// date: Date\r\n\t\t\t//\t\tThe date displayed by this cell.\r\n\t\t\t// renderData: Object\r\n\t\t\t//\t\tThe render data.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\r\n\t\t\tif(this.styleGridCellFunc){\r\n\t\t\t\tthis.styleGridCellFunc(node, date, renderData);\r\n\t\t\t}else{\r\n\t\t\t\tthis.defaultStyleGridCell(node, date, renderData);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_buildItemContainer: function(renderData, oldRenderData){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tCreates the HTML structure of the item container and configures its content.\r\n\t\t\t//\r\n\t\t\t// renderData:\r\n\t\t\t//\t\tThe render data to display.\r\n\t\t\t//\r\n\t\t\t// oldRenderData:\r\n\t\t\t//\t\tThe previously render data displayed, if any.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\t\r\n\t\t\tvar table = this.itemContainerTable;\r\n\t\t\t\r\n\t\t\tif(!table){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar rows = [];\r\n\t\r\n\t\t\tvar count = renderData.rowCount - (oldRenderData ? oldRenderData.rowCount : 0)\r\n\t\t\t\r\n\t\t\tif(has(\"ie\") == 8){\r\n\t\t\t\t// workaround Internet Explorer 8 bug.\r\n\t\t\t\t// if on the table, width: 100% and table-layout: fixed are set\r\n\t\t\t\t// and columns are removed, width of remaining columns is not \r\n\t\t\t\t// recomputed: must rebuild all. \r\n\t\t\t\tif(this._itemTableSave == null){\r\n\t\t\t\t\tthis._itemTableSave = lang.clone(table);\r\n\t\t\t\t}else if(count < 0){\r\n\t\t\t\t\tthis.itemContainer.removeChild(table);\r\n\t\t\t\t\tthis._recycleItemRenderers(true);\r\n\t\t\t\t\tthis._recycleExpandRenderers(true);\r\n\t\t\t\t\tdomConstruct.destroy(table);\r\n\t\t\t\t\ttable = lang.clone(this._itemTableSave);\r\n\t\t\t\t\tthis.itemContainerTable = table;\r\n\t\t\t\t\tthis.itemContainer.appendChild(table);\r\n\t\t\t\t\tcount = renderData.columnCount;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t} // else incremental dom add/remove for real browsers.\r\n\t\t\t\r\n\t\t\tvar tbodies = query(\"tbody\", table);\r\n\t\t\tvar tbody, tr, td, div;\r\n\t\t\t\r\n\t\t\tif(tbodies.length == 1){\r\n\t\t\t\ttbody = tbodies[0];\r\n\t\t\t}else{ \r\n\t\t\t\ttbody = domConstruct.create(\"tbody\", null, table);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Build HTML structure (incremental)\r\n\t\t\tif(count>0){ // creation\r\n\t\t\t\tfor(var i=0; i < count; i++){\r\n\t\t\t\t\ttr = domConstruct.create(\"tr\", null, tbody);\r\n\t\t\t\t\tdomClass.add(tr, \"dojoxCalendarItemContainerRow\");\r\n\t\t\t\t\ttd = domConstruct.create(\"td\", null, tr);\t\r\n\t\t\t\t\tdiv = domConstruct.create(\"div\", null, td);\r\n\t\t\t\t\tdomClass.add(div, \"dojoxCalendarContainerRow\");\r\n\t\t\t\t}\r\n\t\t\t}else{ // deletion\t\t \r\n\t\t\t\tcount = -count;\r\n\t\t\t\tfor(var i=0; i < count; i++){\r\n\t\t\t\t\ttbody.removeChild(tbody.lastChild);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tquery(\".dojoxCalendarItemContainerRow\", table).forEach(function(tr, i){\r\n\t\t\t\tdomStyle.set(tr, \"height\", this._getRowHeight(i) + \"px\");\r\n\t\t\t\trows.push(tr.childNodes[0].childNodes[0]);\r\n\t\t\t}, this); \r\n\r\n\t\t\trenderData.cells = rows;\r\n\t\t},\r\n\t\t\r\n\t\tresize: function(changeSize){\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\tthis._resizeHandler(null, false);\r\n\t\t},\r\n\r\n\t\t_resizeHandler: function(e, apply){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tRefreshes and apply the row height according to the widget height.\r\n\t\t\t// e: Event\r\n\t\t\t//\t\tThe resize event (optional)\r\n\t\t\t// apply: Boolean\r\n\t\t\t//\t\tWhether take into account the layoutDuringResize flag to relayout item while resizing or not.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\tvar rd = this.renderData;\r\n\t\t\t\r\n\t\t\tif(rd == null){\r\n\t\t\t\tthis.refreshRendering();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif(rd.sheetHeight != this.itemContainer.offsetHeight){\r\n\t\t\t\t// refresh values\r\n\t\t\t\trd.sheetHeight = this.itemContainer.offsetHeight;\r\n\t\t\t\tvar expRow = this.getExpandedRowIndex();\r\n\t\t\t\tif(expRow == -1){\r\n\t\t\t\t\tthis._computeRowsHeight();\r\n\t\t\t\t\tthis._resizeRows();\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis.expandRow(rd.expandedRow, rd.expandedRowCol, 0, null, true);\r\n\t\t\t\t}\r\n\t\t\t\tif(rd.invalidRowHeight){\r\n\t\t\t\t\t// complete recompute \r\n\t\t\t\t\tdelete rd.invalidRowHeight;\r\n\t\t\t\t\tthis.renderData = null;\r\n\t\t\t\t\tthis.displayedItemsInvalidated = true;\r\n\t\t\t\t\tthis.refreshRendering();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(this.layoutDuringResize || apply){\r\n\t\t\t\t// Use a time for FF (at least). In FF the cell size and position info are not ready yet. \r\n\t\t\t\tsetTimeout(lang.hitch(this, function(){\r\n\t\t\t\t\tthis._layoutRenderers(this.renderData);\r\n\t\t\t\t\tthis._layoutDecorationRenderers(this.renderData);\r\n\t\t\t\t  }), 20);\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t}else{\r\n\t\t\t\tdomStyle.set(this.itemContainer, \"opacity\", 0);\r\n\t\t\t\tthis._recycleItemRenderers();\r\n\t\t\t\tthis._recycleExpandRenderers();\r\n\t\t\t\tif(this._resizeTimer != undefined){\r\n\t\t\t\t\tclearTimeout(this._resizeTimer);\r\n\t\t\t\t}\r\n\t\t\t\tthis._resizeTimer = setTimeout(lang.hitch(this, function(){\r\n\t\t\t\t\tdelete this._resizeTimer;\r\n\t\t\t\t\tthis._resizeRowsImpl(this.itemContainer, \"tr\");\r\n\t\t\t\t\tthis._layoutRenderers(this.renderData);\r\n\t\t\t\t\tthis._layoutDecorationRenderers(this.renderData);\r\n\t\t\t\t\tif(this.resizeAnimationDuration == 0){\r\n\t\t\t\t\t\tdomStyle.set(this.itemContainer, \"opacity\", 1);\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tfx.fadeIn({node:this.itemContainer, curve:[0, 1]}).play(this.resizeAnimationDuration);\r\n\t\t\t\t\t}\t\t\t\t\t\r\n\t\t\t\t}), 200);\r\n\t\t\t}\r\n\r\n\t\t},\r\n\t\t\r\n\t\t// resizeAnimationDuration: Integer\r\n\t\t//\t\tDuration, in milliseconds, of the fade animation showing the item renderers after a widget resize.\r\n\t\tresizeAnimationDuration: 0,\r\n\t\t\r\n\t\t/////////////////////////////////////////////\r\n\t\t//\r\n\t\t// Row height management\r\n\t\t//\r\n\t\t//////////////////////////////////////////////\r\n\t\t\r\n\t\tgetExpandedRowIndex: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tReturns the index of the expanded row or -1 if there's no row expanded.\r\n\t\t\treturn this.renderData.expandedRow == null ? -1 : this.renderData.expandedRow;\r\n\t\t},\r\n\t\t\r\n\t\tcollapseRow: function(duration, easing, apply){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tCollapses the expanded row, if any.\r\n\t\t\t// duration: Integer\r\n\t\t\t//\t\tDuration in milliseconds of the optional animation.\r\n\t\t\t// easing: Function\r\n\t\t\t//\t\tEasing function of the optional animation.\r\n\t\t\t\r\n\t\t\tvar rd = this.renderData;\r\n\t\t\t\r\n\t\t\tif(apply == undefined){\r\n\t\t\t\tapply = true;\r\n\t\t\t}\r\n\t\t\tif(duration == undefined){\r\n\t\t\t\tduration = this.expandDuration;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(rd && rd.expandedRow != null && rd.expandedRow != -1){\r\n\t\t\t\tif(apply && duration){\r\n\t\t\t\t\tvar index = rd.expandedRow;\r\n\t\t\t\t\tvar oldSize = rd.expandedRowHeight;\r\n\t\t\t\t\tdelete rd.expandedRow;\r\n\t\t\t\t\tthis._computeRowsHeight(rd);\r\n\t\t\t\t\tvar size = this._getRowHeight(index);\r\n\t\t\t\t\trd.expandedRow = index;\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis._recycleExpandRenderers();\r\n\t\t\t\t\tthis._recycleItemRenderers();\r\n\t\t\t\t\tdomStyle.set(this.itemContainer, \"display\", \"none\");\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis._expandAnimation = new fx.Animation({\r\n\t\t\t\t\t\tcurve: [oldSize, size],\r\n\t\t\t\t\t\tduration: duration,\r\n\t\t\t\t\t\teasing: easing,\r\n\t\t\t\t\t\tonAnimate: lang.hitch(this, function(size) {\r\n\t\t\t\t\t\t\tthis._expandRowImpl(Math.floor(size));\r\n\t\t\t\t\t\t}),\r\n\t\t\t\t\t\tonEnd: lang.hitch(this, function(size) {\r\n\t\t\t\t\t\t\tthis._expandAnimation = null;\r\n\t\t\t\t\t\t\tthis._collapseRowImpl(false);\r\n\t\t\t\t\t\t\tthis._resizeRows();\r\n\t\t\t\t\t\t\tdomStyle.set(this.itemContainer, \"display\", \"block\");\r\n\t\t\t\t\t\t\tsetTimeout(lang.hitch(this, function(){\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tthis._layoutRenderers(rd);\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}), 100);\r\n\t\t\t\t\t\t\tthis.onExpandAnimationEnd(false);\r\n\t\t\t\t\t\t}) \r\n\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\tthis._expandAnimation.play();\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis._collapseRowImpl(apply);\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t_collapseRowImpl: function(apply){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\tvar rd = this.renderData;\r\n\t\t\tdelete rd.expandedRow;\r\n\t\t\tdelete rd.expandedRowHeight;\r\n\t\t\tthis._computeRowsHeight(rd);\r\n\t\t\tif(apply == undefined || apply){\r\n\t\t\t\tthis._resizeRows();\r\n\t\t\t\tthis._layoutRenderers(rd);\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\texpandRow: function(rowIndex, colIndex, duration, easing, apply){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tExpands the specified row.\r\n\t\t\t// rowIndex: Integer\r\n\t\t\t//\t\tThe index of the row to expand.\r\n\t\t\t// colIndex: Integer?\r\n\t\t\t//\t\tThe column index of the expand renderer that triggers the action, optional. \r\n\t\t\t// duration: Integer?\r\n\t\t\t//\t\tDuration in milliseconds of the optional animation.\r\n\t\t\t// easing: Function?\r\n\t\t\t//\t\tEasing function of the optional animation.\r\n\t\t\t\r\n\t\t\tvar rd = this.renderData;\r\n\t\t\tif(!rd || rowIndex < 0 || rowIndex >= rd.rowCount){\r\n\t\t\t\treturn -1;\r\n\t\t\t}\r\n\t\t\tif(colIndex == undefined || colIndex < 0 || colIndex >= rd.columnCount){\r\n\t\t\t\tcolIndex = -1; // ignore invalid values\r\n\t\t\t}\r\n\t\t\tif(apply == undefined){\r\n\t\t\t\tapply = true;\r\n\t\t\t}\r\n\t\t\tif(duration == undefined){\r\n\t\t\t\tduration = this.expandDuration;\r\n\t\t\t}\r\n\t\t\tif(easing == undefined){\r\n\t\t\t\teasing = this.expandEasing;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar oldSize = this._getRowHeight(rowIndex);\r\n\t\t\tvar size = rd.sheetHeight - Math.ceil(this.cellPaddingTop * (rd.rowCount-1));\r\n\r\n\t\t\trd.expandedRow = rowIndex;\r\n\t\t\trd.expandedRowCol = colIndex;\r\n\t\t\trd.expandedRowHeight = size;\r\n\r\n\t\t\tif(apply){\r\n\t\t\t\tif(duration){\r\n\t\t\t\t\t//debugger;\r\n\t\t\t\t\tthis._recycleExpandRenderers();\r\n\t\t\t\t\tthis._recycleItemRenderers();\r\n\t\t\t\t\tdomStyle.set(this.itemContainer, \"display\", \"none\");\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis._expandAnimation = new fx.Animation({\r\n\t\t\t\t\t\tcurve: [oldSize, size],\r\n\t\t\t\t\t\tduration: duration,\r\n\t\t\t\t\t\tdelay:50,\r\n\t\t\t\t\t\teasing: easing,\r\n\t\t\t\t\t\tonAnimate: lang.hitch(this, function(size) {\r\n\t\t\t\t\t\t\tthis._expandRowImpl(Math.floor(size));\r\n\t\t\t\t\t\t}),\r\n\t\t\t\t\t\tonEnd: lang.hitch(this, function(){\r\n\t\t\t\t\t\t\tthis._expandAnimation = null;\r\n\t\t\t\t\t\t\tdomStyle.set(this.itemContainer, \"display\", \"block\");\r\n\t\t\t\t\t\t\tsetTimeout(lang.hitch(this, function(){\r\n\t\t\t\t\t\t\t\tthis._expandRowImpl(size, true);\r\n\t\t\t\t\t\t\t}), 100);\r\n\t\t\t\t\t\t\tthis.onExpandAnimationEnd(true);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis._expandAnimation.play();\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis._expandRowImpl(size, true);\r\n\t\t\t\t}\r\n\t\t\t}\t\t\t\r\n\t\t},\r\n\t\t\r\n\t\t_expandRowImpl: function(size, layout){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\tvar rd = this.renderData;\r\n\t\t\trd.expandedRowHeight = size;\r\n\t\t\tthis._computeRowsHeight(rd, rd.sheetHeight-size);\r\n\t\t\tthis._resizeRows();\r\n\t\t\tif(layout){\r\n\t\t\t\tthis._layoutRenderers(rd);\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\tonExpandAnimationEnd: function(expand){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tEvent dispatched at the end of an expand or collapse animation.\r\n\t\t\t// expand: Boolean\r\n\t\t\t//\t\tWhether the finished animation was an expand or a collapse animation.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tcallback\r\n\r\n\t\t},\r\n\t\t\r\n\t\t_resizeRows: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tRefreshes the height of the underlying HTML objects.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\t\r\n\t\t\tif(this._getRowHeight(0) <= 0){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(this.rowHeaderTable){\r\n\t\t\t\tthis._resizeRowsImpl(this.rowHeaderTable, \"tr\");\r\n\t\t\t}\r\n\t\t\tif(this.gridTable){\r\n\t\t\t\tthis._resizeRowsImpl(this.gridTable, \"tr\");\r\n\t\t\t}\r\n\t\t\tif(this.itemContainerTable){\r\n\t\t\t\tthis._resizeRowsImpl(this.itemContainerTable, \"tr\");\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t_computeRowsHeight:function(renderData, max){\r\n\t\t\t// summary:\r\n\t\t\t//\t\t1. Determine if it's better to add or remove pixels\r\n\t\t\t//\t\t2. distribute added/removed pixels on first and last rows.\r\n\t\t\t//\t\tif rows are not too small, it is not noticeable.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\tvar rd = renderData == null ? this.renderData : renderData;\r\n\t\t\t\r\n\t\t\tmax = max || rd.sheetHeight;\r\n\t\t\t\r\n\t\t\tmax--;\r\n\t\t\t\r\n\t\t\tif(has(\"ie\") == 7){\r\n\t\t\t\tmax -= rd.rowCount;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(rd.rowCount == 1){\r\n\t\t\t\trd.rowHeight = max;\r\n\t\t\t\trd.rowHeightFirst = max;\r\n\t\t\t\trd.rowHeightLast = max;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\tvar count = rd.expandedRow == null ? rd.rowCount : rd.rowCount-1;\r\n\t\t\tvar rhx = max / count;\r\n\t\t\tvar rhf, rhl, rh;\r\n\t\t\t\r\n\t\t\tvar diffMin = max - (Math.floor(rhx) * count);\r\n\t\t\tvar diffMax = Math.abs(max - (Math.ceil(rhx) * count));\r\n\t\t\tvar diff;\r\n\t\t\t\r\n\t\t\tvar sign = 1;\r\n\t\t\tif(diffMin < diffMax){\r\n\t\t\t\trh = Math.floor(rhx);\r\n\t\t\t\tdiff = diffMin;\r\n\t\t\t}else{\r\n\t\t\t\tsign = -1;\r\n\t\t\t\trh = Math.ceil(rhx);\r\n\t\t\t\tdiff = diffMax;\r\n\t\t\t}\r\n\t\t\trhf = rh + sign * Math.floor(diff/2);\r\n\t\t\trhl = rhf + sign * (diff%2);\r\n\r\n\t\t\trd.rowHeight = rh;\r\n\t\t\trd.rowHeightFirst = rhf;\r\n\t\t\trd.rowHeightLast = rhl;\r\n\t\t},\r\n\r\n\t\t_getRowHeight: function(index){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\tvar rd = this.renderData;\r\n\t\t\tif(index == rd.expandedRow){\r\n\t\t\t\treturn rd.expandedRowHeight;\r\n\t\t\t} else if(rd.expandedRow == 0 && index == 1 || index == 0){\r\n\t\t\t\treturn rd.rowHeightFirst;\r\n\t\t\t} else if(rd.expandedRow == this.renderData.rowCount-1 && \r\n\t\t\t\t\t\t\t\tindex == this.renderData.rowCount-2 || \r\n\t\t\t\t\t\t\t\tindex == this.renderData.rowCount-1){\r\n\t\t\t\treturn rd.rowHeightLast;\r\n\t\t\t}else{\r\n\t\t\t\treturn rd.rowHeight;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_resizeRowsImpl: function(tableNode, query){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\tdojo.query(query, tableNode).forEach(function(tr, i){\r\n\t\t\t\tdomStyle.set(tr, \"height\", this._getRowHeight(i)+\"px\");\r\n\t\t\t}, this);\r\n\t\t},\r\n\r\n\t\t////////////////////////////////////////////\r\n\t\t//\r\n\t\t// Item renderers\r\n\t\t//\r\n\t\t///////////////////////////////////////////\r\n\t\t\t\t\r\n\t\t_setHorizontalRendererAttr: function(value){\r\n\t\t\tthis._destroyRenderersByKind(\"horizontal\");\r\n\t\t\tthis._set(\"horizontalRenderer\", value);\t\t\t\r\n\t\t},\r\n\t\t\r\n\t\t_setLabelRendererAttr: function(value){\r\n\t\t\tthis._destroyRenderersByKind(\"label\");\t\t\t\r\n\t\t\tthis._set(\"labelRenderer\", value);\r\n\t\t},\r\n\t\t\r\n\t\t_destroyExpandRenderer: function(renderer){\r\n\t\t\t// summary: \r\n\t\t\t//\t\tDestroys the expand renderer.\r\n\t\t\t// renderer: dojox/calendar/_RendererMixin\r\n\t\t\t//\t\tThe item renderer to destroy.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\r\n\t\t\t\r\n\t\t\tif(renderer[\"destroyRecursive\"]){\r\n\t\t\t\trenderer.destroyRecursive();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\thtml.destroy(renderer.domNode);\t\r\n\t\t},\r\n\t\t\r\n\t\t_setExpandRendererAttr: function(value){\r\n\t\t\twhile(this._ddRendererList.length>0){\r\n\t\t\t\tthis._destroyExpandRenderer(this._ddRendererList.pop());\r\n\t\t\t}\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\tvar pool = this._ddRendererPool;\r\n\t\t\tif(pool){\r\n\t\t\t\twhile(pool.length > 0){\r\n\t\t\t\t\tthis._destroyExpandRenderer(pool.pop());\r\n\t\t\t\t}\r\n\t\t\t}\t\t\t\t\t\t\t\r\n\t\t\tthis._set(\"expandRenderer\", value);\r\n\t\t},\t\t\t\t\r\n\t\t\r\n\t\t_ddRendererList: null,\r\n\t\t_ddRendererPool: null,\r\n\r\n\t\t_getExpandRenderer: function(date, items, rowIndex, colIndex, expanded){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\t\r\n\t\t\tif(this.expandRenderer == null){\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar ir = this._ddRendererPool.pop();\r\n\t\t\tif(ir == null){\r\n\t\t\t\tir = new this.expandRenderer();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis._ddRendererList.push(ir);\r\n\t\t\t\r\n\t\t\tir.set(\"owner\", this);\r\n\t\t\tir.set(\"date\", date);\r\n\t\t\tir.set(\"items\", items);\r\n\t\t\tir.set(\"rowIndex\", rowIndex);\r\n\t\t\tir.set(\"columnIndex\", colIndex);\r\n\t\t\tir.set(\"expanded\", expanded);\r\n\t\t\treturn ir;\r\n\t\t},\r\n\t\t\r\n\t\t_recycleExpandRenderers: function(remove){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\t\r\n\t\t\tfor(var i=0; i<this._ddRendererList.length; i++){\r\n\t\t\t\tvar ir = this._ddRendererList[i];\r\n\t\t\t\tir.set(\"Up\", false);\r\n\t\t\t\tir.set(\"Down\", false);\r\n\t\t\t\tif(remove){\r\n\t\t\t\t\tir.domNode.parentNode.removeChild(ir.domNode);\r\n\t\t\t\t}\r\n\t\t\t\tdomStyle.set(ir.domNode, \"display\", \"none\");\r\n\t\t\t}\r\n\t\t\tthis._ddRendererPool = this._ddRendererPool.concat(this._ddRendererList);\r\n\t\t\tthis._ddRendererList = [];\r\n\t\t},\r\n\r\n\t\t_defaultItemToRendererKindFunc:function(item){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\tvar dur = Math.abs(this.renderData.dateModule.difference(item.startTime, item.endTime, \"minute\"));\r\n\t\t\treturn dur >= 1440 ? \"horizontal\" : \"label\";\r\n\t\t}, \r\n\t\t\r\n\t\t////////////////////////////////////////////\r\n\t\t//\r\n\t\t// Layout\r\n\t\t//\r\n\t\t///////////////////////////////////////////\r\n\t\t\r\n\t\t// naturalRowHeight: Integer[]\r\n\t\t//\t\tAfter an item layout has been done, contains for each row the natural height of the row. \r\n\t\t//\t\tIe. the height, in pixels, needed to display all the item renderers. \r\n\t\tnaturalRowsHeight: null,\r\n\t\t\r\n\t\t_roundItemToDay: function(item){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\t\r\n\t\t\tvar s = item.startTime, e = item.endTime;\r\n\t\t\t\r\n\t\t\tif(!this.isStartOfDay(s)){\r\n\t\t\t\ts = this.floorToDay(s, false, this.renderData);\r\n\t\t\t}\r\n\t\t\tif(!this.isStartOfDay(e)){\r\n\t\t\t\te = this.renderData.dateModule.add(e, \"day\", 1);\r\n\t\t\t\te = this.floorToDay(e, true);\r\n\t\t\t}\r\n\t\t\treturn {startTime:s, endTime:e};\r\n\t\t},\r\n\t\t\r\n\t\t_sortItemsFunction: function(a, b){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\t\r\n\t\t\tif(this.roundToDay){\r\n\t\t\t\ta = this._roundItemToDay(a);\r\n\t\t\t\tb = this._roundItemToDay(b);\r\n\t\t\t}\r\n\t\t\tvar res = this.dateModule.compare(a.startTime, b.startTime);\r\n\t\t\tif(res == 0){\r\n\t\t\t\tres = -1 * this.dateModule.compare(a.endTime, b.endTime);\r\n\t\t\t}\r\n\t\t\treturn res;\r\n\t\t},\r\n\t\t\r\n\t\t_overlapLayoutPass3: function(lanes){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tThird pass of the overlap layout (optional). Compute the number of lanes used by sub interval.\r\n\t\t\t// lanes: Object[]\r\n\t\t\t//\t\tThe array of lanes.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\tvar pos=0, posEnd=0;\r\n\t\t\tvar res = [];\r\n\t\t\t\r\n\t\t\tvar refPos = domGeometry.position(this.gridTable).x;\r\n\t\t\t\r\n\t\t\tfor(var col=0; col<this.renderData.columnCount; col++){\r\n\t\t\t\t\r\n\t\t\t\tvar stop = false;\r\n\t\t\t\tvar colPos = domGeometry.position(this._getCellAt(0, col));\r\n\t\t\t\tpos = colPos.x - refPos;\r\n\t\t\t\tposEnd = pos + colPos.w;\r\n\t\t\t\t\r\n\t\t\t\tfor(var lane=lanes.length-1; lane>=0 && !stop; lane--){\r\n\t\t\t\t\tfor (var i=0; i<lanes[lane].length; i++){\r\n\t\t\t\t\t\tvar item = lanes[lane][i];\r\n\t\t\t\t\t\tstop = item.start < posEnd && pos < item.end;\r\n\t\t\t\t\t\tif(stop){\r\n\t\t\t\t\t\t\tres[col] = lane + 1;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif(!stop){\r\n\t\t\t\t\tres[col] = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn res;\r\n\t\t},\r\n\t\t\r\n\t\tapplyRendererZIndex: function(item, renderer, hovered, selected, edited, focused){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tApplies the z-index to the renderer based on the state of the item.\r\n\t\t\t//\t\tThis methods is setting a z-index of 20 is the item is selected or edited \r\n\t\t\t//\t\tand the current lane value computed by the overlap layout (i.e. the renderers \r\n\t\t\t//\t\tare stacked according to their lane).\r\n\t\t\t// item: Object\r\n\t\t\t//\t\tThe render item.\r\n\t\t\t// renderer: Object\r\n\t\t\t//\t\tA renderer associated with the render item.\r\n\t\t\t// hovered: Boolean\r\n\t\t\t//\t\tWhether the item is hovered or not.\r\n\t\t\t// selected: Boolean\r\n\t\t\t//\t\tWhether the item is selected or not.\r\n\t\t\t// edited: Boolean\r\n\t\t\t//\t\tWhether the item is being edited not not.\r\n\t\t\t// focused: Boolean\r\n\t\t\t//\t\tWhether the item is focused not not.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\t\t\t\t\r\n\t\t\tdomStyle.set(renderer.container, {\"zIndex\": edited || selected ? renderer.renderer.mobile ? 100 : 0: item.lane == undefined ? 1 : item.lane+1});\r\n\t\t},\r\n\t\t\r\n\t\t_layoutDecorationRenderers: function(renderData){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\tif(renderData == null || renderData.decorationItems == null || renderData.rowHeight <= 0){\r\n\t\t\t\treturn;\r\n\t\t\t}\t\t\t\t\t\r\n\t\t\t\r\n\t\t\tif(!this.gridTable || this._expandAnimation != null || \r\n\t\t\t\tthis.horizontalDecorationRenderer == null){\r\n\t\t\t\tthis.decorationRendererManager.recycleItemRenderers();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis._layoutStep = renderData.columnCount;\r\n\t\t\tthis.renderData.gridTablePosX = domGeometry.position(this.gridTable).x;\t\r\n\t\t\t\r\n\t\t\tthis.inherited(arguments);\r\n\t\t},\r\n\r\n\t\t_layoutRenderers: function(renderData){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\tif(renderData == null || renderData.items == null || renderData.rowHeight <= 0){\r\n\t\t\t\treturn;\r\n\t\t\t}\t\t\t\t\t\r\n\t\t\t\r\n\t\t\tif(!this.gridTable || this._expandAnimation != null || \r\n\t\t\t\t(this.horizontalRenderer == null && this.labelRenderer == null)){\r\n\t\t\t\tthis._recycleItemRenderers();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.renderData.gridTablePosX = domGeometry.position(this.gridTable).x;\t\t\r\n\t\t\tthis._layoutStep = renderData.columnCount;\r\n\t\t\tthis._recycleExpandRenderers();\r\n\t\t\tthis._hiddenItems = [];\r\n\t\t\tthis._offsets = [];\r\n\t\t\tthis.naturalRowsHeight = [];\r\n\t\t\t\r\n\t\t\tthis.inherited(arguments);\r\n\t\t},\r\n\r\n\t\t_offsets: null,\r\n\r\n\t\t_layoutInterval: function(/*Object*/renderData, /*Integer*/index, /*Date*/start, /*Date*/end, /*Object[]*/items, /*String*/itemsType){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\t\r\n\t\t\tif(this.renderData.cells == null){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(itemsType === \"dataItems\"){\r\n\t\t\t\t\r\n\t\t\t\tvar horizontalItems = [];\r\n\t\t\t\tvar labelItems = [];\r\n\t\r\n\t\t\t\tfor(var i=0; i<items.length; i++){\r\n\t\t\t\t\tvar item = items[i];\r\n\t\t\t\t\tvar kind = this._itemToRendererKind(item);\r\n\t\t\t\t\tif(kind == \"horizontal\"){\r\n\t\t\t\t\t\thorizontalItems.push(item);\r\n\t\t\t\t\t}else if(kind == \"label\"){\r\n\t\t\t\t\t\tlabelItems.push(item);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tvar expIndex = this.getExpandedRowIndex();\r\n\t\t\t\t\r\n\t\t\t\tif(expIndex != -1 && expIndex != index){\r\n\t\t\t\t\treturn; // when row is expanded, layout only expanded row\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tvar offsets;\r\n\t\t\t\t\r\n\t\t\t\tvar hiddenItems = [];\r\n\t\t\t\t\r\n\t\t\t\tvar hItems = null;\r\n\t\t\t\tvar hOffsets = [];\r\n\t\t\t\tif(horizontalItems.length > 0 && this.horizontalRenderer){\r\n\t\t\t\t\tvar hItems = this._createHorizontalLayoutItems(index, start, end, horizontalItems, itemsType);\r\n\t\t\t\t\tvar hOverlapLayout = this._computeHorizontalOverlapLayout(hItems, hOffsets);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tvar lItems;\r\n\t\t\t\tvar lOffsets = [];\r\n\t\t\t\tif(labelItems.length > 0 && this.labelRenderer){\r\n\t\t\t\t\tlItems = this._createLabelLayoutItems(index, start, end, labelItems);\r\n\t\t\t\t\tthis._computeLabelOffsets(lItems, lOffsets);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tvar hasHiddenItems = this._computeColHasHiddenItems(index, hOffsets, lOffsets);\r\n\t\t\t\t\r\n\t\t\t\tif(hItems != null){\r\n\t\t\t\t\tthis._layoutHorizontalItemsImpl(index, hItems, hOverlapLayout, hasHiddenItems, hiddenItems, itemsType);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif(lItems != null){\r\n\t\t\t\t\tthis._layoutLabelItemsImpl(index, lItems, hasHiddenItems, hiddenItems, hOffsets, itemsType);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tthis._layoutExpandRenderers(index, hasHiddenItems, hiddenItems);\r\n\t\t\t\t\r\n\t\t\t\tthis._hiddenItems[index] = hiddenItems;\r\n\t\t\t}else{ // itemsType === \"decorationItems\"\r\n\t\t\t\t\r\n\t\t\t\tif(this.horizontalDecorationRenderer){\r\n\t\t\t\t\tvar hItems = this._createHorizontalLayoutItems(index, start, end, items, itemsType);\r\n\t\t\t\t\tif(hItems != null){\t\t\t\t\t\r\n\t\t\t\t\t\tthis._layoutHorizontalItemsImpl(index, hItems, null, false, null, itemsType);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_createHorizontalLayoutItems: function(/*Integer*/index, /*Date*/startTime, /*Date*/endTime, /*Object[]*/items, /*String*/itemsType){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\t\r\n\t\t\t\t\t\tvar rd = this.renderData;\r\n\t\t\tvar cal = rd.dateModule;\r\n\t\t\tvar sign = rd.rtl ? -1 : 1;\r\n\t\t\tvar layoutItems = [];\r\n\t\t\tvar isDecoration = itemsType === \"decorationItems\";\r\n\r\n\t\t\t// step 1: compute projected position and size\r\n\t\t\tfor(var i = 0; i < items.length; i++){\r\n\t\t\t\t\r\n\t\t\t\tvar item = items[i];\r\n\t\t\t\tvar overlap = this.computeRangeOverlap(rd, item.startTime, item.endTime, startTime, endTime);\r\n\t\t\t\t\r\n\t\t\t\tvar startOffset = cal.difference(startTime, this.floorToDay(overlap[0], false, rd), \"day\");\r\n\t\t\t\tvar dayStart = rd.dates[index][startOffset];\r\n\t\t\t\t\r\n\t\t\t\tvar celPos = domGeometry.position(this._getCellAt(index, startOffset, false));\r\n\t\t\t\tvar start = celPos.x - rd.gridTablePosX;\r\n\t\t\t\tif(rd.rtl){\r\n\t\t\t\t\tstart += celPos.w;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif(isDecoration && !item.isAllDay || !isDecoration && !this.roundToDay && !item.allDay){\r\n\t\t\t\t\tstart += sign * this.computeProjectionOnDate(rd, dayStart, overlap[0], celPos.w);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tstart = Math.ceil(start);\r\n\t\t\t\t\r\n\t\t\t\tvar endOffset = cal.difference(startTime, this.floorToDay(overlap[1], false, rd), \"day\");\r\n\t\t\t\t\r\n\t\t\t\tvar end;\r\n\t\t\t\tif(endOffset > rd.columnCount-1){\r\n\t\t\t\t\tcelPos = domGeometry.position(this._getCellAt(index, rd.columnCount-1, false));\r\n\t\t\t\t\tif(rd.rtl){\r\n\t\t\t\t\t\tend = celPos.x - rd.gridTablePosX;\t\t\t\t\t\t\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tend = celPos.x - rd.gridTablePosX + celPos.w;\r\n\t\t\t\t\t}\t\t\t\t\r\n\t\t\t\t}else{ \r\n\t\t\t\t\tdayStart = rd.dates[index][endOffset];\r\n\t\t\t\t\tcelPos = domGeometry.position(this._getCellAt(index, endOffset, false));\r\n\t\t\t\t\tend = celPos.x - rd.gridTablePosX;\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(rd.rtl){\r\n\t\t\t\t\t\tend += celPos.w;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(!isDecoration && this.roundToDay){\r\n\t\t\t\t\t\tif(!this.isStartOfDay(overlap[1])){\r\n\t\t\t\t\t\t\tend += sign * celPos.w;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tend += sign * this.computeProjectionOnDate(rd, dayStart, overlap[1], celPos.w);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tend = Math.floor(end);\r\n\t\t\t\t\r\n\t\t\t\tif(rd.rtl){\r\n\t\t\t\t\tvar t = end;\r\n\t\t\t\t\tend = start;\r\n\t\t\t\t\tstart = t; \r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif(end > start){ // invalid items are not displayed\r\n\t\t\t\t\tvar litem = lang.mixin({\r\n\t\t\t\t\t\tstart: start,\r\n\t\t\t\t\t\tend: end,\r\n\t\t\t\t\t\trange: overlap,\r\n\t\t\t\t\t\titem: item,\r\n\t\t\t\t\t\tstartOffset: startOffset,\r\n\t\t\t\t\t\tendOffset: endOffset\r\n\t\t\t\t\t}, item);\r\n\t\t\t\t\tlayoutItems.push(litem);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn layoutItems;\r\n\t\t},\r\n\t\t\r\n\t\t_computeHorizontalOverlapLayout: function(layoutItems, offsets){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\t\r\n\t\t\tvar rd = this.renderData;\r\n\t\t\tvar irHeight = this.horizontalRendererHeight;\r\n\t\t\tvar overlapLayoutRes = this.computeOverlapping(layoutItems, this._overlapLayoutPass3);\r\n\t\t\tvar vOverlap = this.percentOverlap / 100;\r\n\t\t\r\n\t\t\tfor(var i=0; i<rd.columnCount; i++){\r\n\t\t\t\tvar numLanes = overlapLayoutRes.addedPassRes[i];\r\n\t\t\t\tvar index = rd.rtl ? rd.columnCount - i - 1 : i;\t\t\t\t\r\n\t\t\t\tif(vOverlap == 0){\r\n\t\t\t\t\toffsets[index] = numLanes == 0 ? 0 : numLanes == 1 ? irHeight : irHeight + (numLanes-1) * (irHeight + this.verticalGap);\r\n\t\t\t\t}else{\r\n\t\t\t\t\toffsets[index] = numLanes == 0 ? 0 : numLanes * irHeight - (numLanes-1) * (vOverlap * irHeight) + this.verticalGap;\r\n\t\t\t\t}\r\n\t\t\t\toffsets[index] += this.cellPaddingTop;\r\n\t\t\t}\r\n\t\t\treturn overlapLayoutRes;\r\n\t\t},\r\n\t\t\r\n\t\t_createLabelLayoutItems: function(/*Integer*/index, /*Date*/startTime, /*Date*/endTime, /*Object[]*/items){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\t\r\n\t\t\tif(this.labelRenderer == null){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar d;\r\n\t\t\tvar rd = this.renderData;\r\n\t\t\tvar cal = rd.dateModule;\r\n\t\t\t\r\n\t\t\tvar layoutItems = [];\r\n\t\t\t\r\n\t\t\tfor(var i = 0; i < items.length; i++){\r\n\t\t\t\tvar item = items[i];\r\n\t\t\t\t\r\n\t\t\t\td = this.floorToDay(item.startTime, false, rd);\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\tvar comp = this.dateModule.compare;\r\n\t\t\t\t\r\n\t\t\t\t// iterate on columns overlapped by this item to create one item per column\r\n\t\t\t\t//while(d < item.endTime && d < rd.endTime){\r\n\t\t\t\twhile(comp(d, item.endTime) == -1 && comp(d, endTime) == -1){\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar dayEnd = cal.add(d, \"day\", 1);\r\n\t\t\t\t\tdayEnd = this.floorToDay(dayEnd, true);\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar overlap = this.computeRangeOverlap(rd, item.startTime, item.endTime, d, dayEnd);\r\n\t\t\t\t\tvar startOffset = cal.difference(startTime, this.floorToDay(overlap[0], false, rd), \"day\");\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\tif(startOffset >= this.columnCount){\r\n\t\t\t\t\t\t// If the offset is greater than the column count\r\n\t\t\t\t\t\t// the item will be processed in another row.\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(startOffset >= 0){\t\t\t\t\t\r\n\t\t\t\t\t\tvar list = layoutItems[startOffset];\r\n\t\t\t\t\t\tif(list == null){\r\n\t\t\t\t\t\t\tlist = [];\r\n\t\t\t\t\t\t\tlayoutItems[startOffset] = list;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlist.push(lang.mixin(\r\n\t\t\t\t\t\t\t{\tstartOffset: startOffset,\r\n\t\t\t\t\t\t\t\trange: overlap,\r\n\t\t\t\t\t\t\t\titem: item\r\n\t\t\t\t\t\t\t}, item));\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\td = cal.add(d, \"day\", 1);\r\n\t\t\t\t\tthis.floorToDay(d, true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn layoutItems;\r\n\t\t},\r\n\r\n\t\t_computeLabelOffsets: function(layoutItems, offsets){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\t\r\n\t\t\tfor(var i=0; i<this.renderData.columnCount; i++){\r\n\t\t\t\toffsets[i] = layoutItems[i] == null ? 0 : layoutItems[i].length * (this.labelRendererHeight + this.verticalGap);\r\n\t\t\t}\r\n\t\t},\t\t\t\r\n\r\n\t\t_computeColHasHiddenItems: function(index, hOffsets, lOffsets){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\t\r\n\t\t\tvar res = [];\r\n\t\t\tvar cellH = this._getRowHeight(index);\r\n\t\t\tvar h;\r\n\t\t\tvar maxH = 0;\r\n\t\t\tfor(var i=0; i<this.renderData.columnCount; i++){\r\n\t\t\t\th = hOffsets == null || hOffsets[i] == null ? this.cellPaddingTop : hOffsets[i];\r\n\t\t\t\th += lOffsets == null || lOffsets[i] == null ? 0 : lOffsets[i];\r\n\t\t\t\tif(h > maxH){\r\n\t\t\t\t\tmaxH = h;\r\n\t\t\t\t}\r\n\t\t\t\tres[i] = h > cellH;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.naturalRowsHeight[index] = maxH;\r\n\t\t\treturn res;\r\n\t\t},\r\n\r\n\t\t_layoutHorizontalItemsImpl: function(index, layoutItems, hOverlapLayout, hasHiddenItems, hiddenItems, itemsType){\r\n\t\t\t\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\t\r\n\t\t\tvar rd = this.renderData;\r\n\t\t\tvar cell = rd.cells[index];\r\n\t\t\tvar cellH = this._getRowHeight(index);\r\n\t\t\tvar irHeight = this.horizontalRendererHeight;\r\n\t\t\tvar vOverlap = this.percentOverlap / 100;\r\n\r\n\t\t\tfor(var i=0; i<layoutItems.length; i++){\r\n\r\n\t\t\t\tvar item = layoutItems[i];\r\n\t\t\t\tvar lane = item.lane;\r\n\t\t\t\t\r\n\t\t\t\tif(itemsType === \"dataItems\"){\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar posY = this.cellPaddingTop;\r\n\t\r\n\t\t\t\t\tif(vOverlap == 0) {\r\n\t\t\t\t\t\t//no overlap and a padding between each event\r\n\t\t\t\t\t\tposY += lane * (irHeight + this.verticalGap);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// an overlap\t\r\n\t\t\t\t\t\tposY += lane * (irHeight - vOverlap * irHeight);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar exp = false;\r\n\t\t\t\t\tvar maxH = cellH;\r\n\t\t\t\t\tif(this.expandRenderer){\t\t\t\t\r\n\t\t\t\t\t\tfor(var off=item.startOffset; off<=item.endOffset; off++){\r\n\t\t\t\t\t\t\tif(hasHiddenItems[off]){\r\n\t\t\t\t\t\t\t\texp = true;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tmaxH = exp ? cellH - this.expandRendererHeight : cellH;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(posY + irHeight <= maxH){\r\n\t\r\n\t\t\t\t\t\tvar ir = this._createRenderer(item, \"horizontal\", this.horizontalRenderer, \"dojoxCalendarHorizontal\");\r\n\t\t\r\n\t\t\t\t\t\tvar fullHeight = this.isItemBeingEdited(item) && !this.liveLayout && this._isEditing;\r\n\t\t\t\t\t\tvar h = fullHeight ? cellH - this.cellPaddingTop : irHeight;\r\n\t\t\t\t\t\tvar w = item.end - item.start;\r\n\t\t\t\t\t\tif (has(\"ie\") >= 9 && item.start + w < this.itemContainer.offsetWidth) {\r\n\t\t\t\t\t\t\tw++;\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\tdomStyle.set(ir.container, {\r\n\t\t\t\t\t\t\t\"top\": (fullHeight ? this.cellPaddingTop : posY) + \"px\",\r\n\t\t\t\t\t\t\t\"left\": item.start + \"px\",\r\n\t\t\t\t\t\t\t\"width\": w + \"px\",\r\n\t\t\t\t\t\t\t\"height\": h + \"px\"\r\n\t\t\t\t\t\t});\r\n\t\r\n\t\t\t\t\t\tthis._applyRendererLayout(item, ir, cell, w, h, \"horizontal\");\r\n\t\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\t// The items does not fit in view, fill hidden items per column\r\n\t\t\t\t\t\tfor(var d=item.startOffset;d<item.endOffset;d++){\r\n\t\t\t\t\t\t\tif(hiddenItems[d] == null){\r\n\t\t\t\t\t\t\t\thiddenItems[d] = [item.item];\r\n\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\thiddenItems[d].push(item.item);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t}else{ //itemsType === \"decorationItems\"\r\n\t\t\t\t\tvar ir = this.decorationRendererManager.createRenderer(item, \"horizontal\", this.horizontalDecorationRenderer, \"dojoxCalendarDecoration\");\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\tvar h = cellH;\r\n\t\t\t\t\tvar w = item.end - item.start;\r\n\t\t\t\t\tif (has(\"ie\") >= 9 && item.start + w < this.itemContainer.offsetWidth) {\r\n\t\t\t\t\t\tw++;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tdomStyle.set(ir.container, {\r\n\t\t\t\t\t\t\"top\": \"0\",\r\n\t\t\t\t\t\t\"left\": item.start + \"px\",\r\n\t\t\t\t\t\t\"width\": w + \"px\",\r\n\t\t\t\t\t\t\"height\": h + \"px\"\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tdomConstruct.place(ir.container, cell);\r\n\t\t\t\t\tdomStyle.set(ir.container, \"display\", \"block\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t_layoutLabelItemsImpl: function(index, layoutItems, hasHiddenItems, hiddenItems, hOffsets){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\tvar list, posY;\r\n\t\t\tvar rd = this.renderData;\r\n\t\t\tvar cell = rd.cells[index];\r\n\t\t\tvar cellH = this._getRowHeight(index);\r\n\t\t\tvar irHeight = this.labelRendererHeight;\r\n\t\t\tvar maxW = domGeometry.getMarginBox(this.itemContainer).w;\r\n\r\n\t\t\tfor(var i=0; i<layoutItems.length; i++){\r\n\t\t\t\tlist = layoutItems[i];\r\n\t\t\t\t\r\n\t\t\t\tif(list != null){\r\n\t\t\t\t\t\r\n\t\t\t\t\t// sort according to start time the list of label renderers\r\n\t\t\t\t\tlist.sort(lang.hitch(this, function(a, b){\t\t\t\t\t\t\r\n\t\t\t\t\t\treturn this.dateModule.compare(a.range[0], b.range[0]);\t\t\t\t\t\t\r\n\t\t\t\t\t}));\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar maxH = this.expandRenderer ? (hasHiddenItems[i] ? cellH - this.expandRendererHeight: cellH) : cellH;\r\n\t\t\t\t\tposY = hOffsets == null || hOffsets[i] == null ? this.cellPaddingTop : hOffsets[i] + this.verticalGap;\r\n\t\t\t\t\tvar celPos = domGeometry.position(this._getCellAt(index, i));\r\n\t\t\t\t\tvar left = celPos.x - rd.gridTablePosX;\r\n\t\t\t\t\t\r\n\t\t\t\t\tfor(var j=0; j<list.length; j++){\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif(posY + irHeight + this.verticalGap <= maxH){\r\n\t\t\t\t\t\t\tvar item = list[j];\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tlang.mixin(item, {\r\n\t\t\t\t\t\t\t\tstart: left,\r\n\t\t\t\t\t\t\t\tend: left + celPos.w\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tvar ir = this._createRenderer(item, \"label\", this.labelRenderer, \"dojoxCalendarLabel\");\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tvar fullHeight = this.isItemBeingEdited(item) && !this.liveLayout && this._isEditing;\r\n\t\t\t\t\t\t\tvar h = fullHeight ? this._getRowHeight(index) - this.cellPaddingTop : irHeight;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif(rd.rtl){\r\n\t\t\t\t\t\t\t\titem.start = maxW - item.end;\r\n\t\t\t\t\t\t\t\titem.end = item.start + celPos.w;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\tdomStyle.set(ir.container, {\r\n\t\t\t\t\t\t\t\t\"top\": (fullHeight ? this.cellPaddingTop : posY) + \"px\",\r\n\t\t\t\t\t\t\t\t\"left\": item.start + \"px\",\r\n\t\t\t\t\t\t\t\t\"width\": celPos.w + \"px\",\r\n\t\t\t\t\t\t\t\t\"height\": h + \"px\"\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tthis._applyRendererLayout(item, ir, cell, celPos.w, h, \"label\");\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tposY += irHeight + this.verticalGap;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tfor(var j; j<list.length; j++){\r\n\t\t\t\t\t\tif(hiddenItems[i] == null){\r\n\t\t\t\t\t\t\thiddenItems[i] = [list[j]];\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\thiddenItems[i].push(list[j]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t_applyRendererLayout: function(item, ir, cell, w, h, kind){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\t\r\n\t\t\tvar edited = this.isItemBeingEdited(item);\r\n\t\t\tvar selected = this.isItemSelected(item);\r\n\t\t\tvar hovered = this.isItemHovered(item);\r\n\t\t\tvar focused = this.isItemFocused(item);\r\n\t\t\t\r\n\t\t\tvar renderer = ir.renderer;\t\t\t\r\n\r\n\t\t\trenderer.set(\"hovered\", hovered);\r\n\t\t\trenderer.set(\"selected\", selected);\r\n\t\t\trenderer.set(\"edited\", edited);\r\n\t\t\trenderer.set(\"focused\", this.showFocus ? focused : false);\r\n\t\t\trenderer.set(\"moveEnabled\", this.isItemMoveEnabled(item._item, kind));\r\n\t\t\trenderer.set(\"storeState\", this.getItemStoreState(item));\r\n\t\t\t\r\n\t\t\tif(kind != \"label\"){\r\n\t\t\t\trenderer.set(\"resizeEnabled\", this.isItemResizeEnabled(item, kind));\r\n\t\t\t}\r\n\r\n\t\t\tthis.applyRendererZIndex(item, ir, hovered, selected, edited, focused);\r\n\r\n\t\t\tif(renderer.updateRendering){\r\n\t\t\t\trenderer.updateRendering(w, h);\r\n\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\tdomConstruct.place(ir.container, cell);\r\n\t\t\tdomStyle.set(ir.container, \"display\", \"block\");\r\n\t\t},\r\n\t\t\r\n\t\t_getCellAt: function(rowIndex, columnIndex, rtl){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\t\r\n\t\t\tif((rtl == undefined || rtl == true) && !this.isLeftToRight()){\r\n\t\t\t\tcolumnIndex = this.renderData.columnCount -1 - columnIndex;\r\n\t\t\t}\r\n\t\t\treturn this.gridTable.childNodes[0].childNodes[rowIndex].childNodes[columnIndex];\r\n\t\t},\r\n\t\r\n\t\t_layoutExpandRenderers: function(index, hasHiddenItems, hiddenItems){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\t\r\n\t\t\tif(!this.expandRenderer){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar rd = this.renderData;\r\n\t\t\tif(rd.expandedRow == index){\r\n\t\t\t\tif(rd.expandedRowCol != null && rd.expandedRowCol != -1){\r\n\t\t\t\t\tthis._layoutExpandRendererImpl(rd.expandedRow, rd.expandedRowCol, null, true);\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\tif(rd.expandedRow == null){\r\n\t\t\t\t\tfor(var i=0; i<rd.columnCount; i++){\r\n\t\t\t\t\t\tif(hasHiddenItems[i]){\r\n\t\t\t\t\t\t\tthis._layoutExpandRendererImpl(index, rd.rtl ? rd.columnCount -1 -i: i, hiddenItems[i], false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t_layoutExpandRendererImpl: function(rowIndex, colIndex, items, expanded){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\t\r\n\t\t\tvar rd = this.renderData;\r\n\t\t\tvar d = lang.clone(rd.dates[rowIndex][colIndex]);\r\n\t\t\tvar ir = null;\r\n\t\t\tvar cell = rd.cells[rowIndex];\t\t\t\t\t\r\n\t\t\t\r\n\t\t\tir = this._getExpandRenderer(d,\titems, rowIndex, colIndex, expanded);\r\n\t\t\t\t\r\n\t\t\tvar dim = domGeometry.position(this._getCellAt(rowIndex, colIndex));\r\n\t\t\tdim.x -= rd.gridTablePosX;\r\n\t\t\tthis.layoutExpandRenderer(ir, d, items, dim, this.expandRendererHeight);\r\n\t\t\tdomConstruct.place(ir.domNode, cell);\r\n\t\t\tdomStyle.set(ir.domNode, \"display\", \"block\");\r\n\t\t},\r\n\t\t\r\n\t\tlayoutExpandRenderer: function(renderer, date, items, cellPosition, height){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tComputes and sets the position of the expand/collapse renderers.\r\n\t\t\t//\t\tBy default the renderer is set to take the width of the cell and is placed at the bottom of the cell.\r\n\t\t\t//\t\tThe renderer DOM node is in a row that takes all the grid width. \r\n\t\t\t// renderer: Object\r\n\t\t\t//\t\tThe renderer used in specified cell that indicates that some items cannot be displayed.\r\n\t\t\t// date: Date\r\n\t\t\t//\t\tThe date displayed by the cell.\r\n\t\t\t// items: Object[]\r\n\t\t\t//\t\tThe list of non visible items.\r\n\t\t\t// cellPosition: Object\r\n\t\t\t//\t\tAn object that contains the position (x and y properties) and size of the cell (w and h properties).\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\tdomStyle.set(renderer.domNode, {\r\n\t\t\t\t\"left\": cellPosition.x + \"px\",\r\n\t\t\t\t\"width\": cellPosition.w + \"px\",\r\n\t\t\t\t\"height\": height + \"px\",\r\n\t\t\t\t\"top\":  (cellPosition.h - height -1) + \"px\"\r\n\t\t\t});\r\n\t\t},\r\n\t\t\r\n\t\t/////////////////////////////////////////////\r\n\t\t//\r\n\t\t// Editing\r\n\t\t//\r\n\t\t//////////////////////////////////////////////\r\n\t\t\r\n\t\t_onItemEditBeginGesture: function(e){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\tvar p = this._edProps;\r\n\t\t\t\r\n\t\t\tvar item = p.editedItem;\r\n\t\t\tvar dates = e.dates;\r\n\t\t\t\r\n\t\t\tvar refTime = this.newDate(p.editKind == \"resizeEnd\" ? item.endTime : item.startTime);\r\n\t\t\t\r\n\t\t\tif(p.rendererKind == \"label\"){\r\n\t\t\t\t// noop\r\n\t\t\t}else if(e.editKind == \"move\" && (item.allDay || this.roundToDay)){\t\t\t\t\t\t\t\r\n\t\t\t\tvar cal = this.renderData.dateModule;\r\n\t\t\t\tp.dayOffset = cal.difference(\r\n\t\t\t\t\tthis.floorToDay(dates[0], false, this.renderData), \r\n\t\t\t\t\trefTime, \"day\");\r\n\t\t\t} // else managed in super\r\n\t\t\t\r\n\t\t\tthis.inherited(arguments);\r\n\t\t},\r\n\t\t\r\n\t\t_computeItemEditingTimes: function(item, editKind, rendererKind, times, eventSource){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\tvar cal = this.renderData.dateModule;\r\n\t\t\tvar p = this._edProps;\r\n\t\t\t\r\n\t\t\tif(rendererKind == \"label\"){ // noop\r\n\t\t\t}else\tif(item.allDay || this.roundToDay){\t\t\r\n\t\t\t\tvar isStartOfDay = this.isStartOfDay(times[0]);\t\r\n\t\t\t\tswitch(editKind){\r\n\t\t\t\t\tcase \"resizeEnd\":\r\n\t\t\t\t\t\tif(!isStartOfDay && item.allDay){\r\n\t\t\t\t\t\t\ttimes[0] = cal.add(times[0], \"day\", 1); // no break;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\tcase \"resizeStart\":\r\n\t\t\t\t\t\tif(!isStartOfDay){\r\n\t\t\t\t\t\t\ttimes[0] = this.floorToDay(times[0], true);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"move\":\r\n\t\t\t\t\t\ttimes[0] = cal.add(times[0], \"day\", p.dayOffset);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"resizeBoth\":\r\n\t\t\t\t\t\tif(!isStartOfDay){\r\n\t\t\t\t\t\t\ttimes[0] = this.floorToDay(times[0], true);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(!this.isStartOfDay(times[1])){\r\n\t\t\t\t\t\t\ttimes[1] = this.floorToDay(cal.add(times[1], \"day\", 1), true);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak; \r\n\t\t\t\t}\t\r\n\t\t\t\t\r\n\t\t\t}else{\r\n\t\t\t\ttimes = this.inherited(arguments); \r\n\t\t\t}\t\t\t\r\n\t\t\t\r\n\t\t\treturn times;\t\t\t\r\n\t\t},\r\n\t\t\t\r\n\t\t\r\n\t\t/////////////////////////////////////////////\r\n\t\t//\r\n\t\t// Pixel to Time projection\r\n\t\t//\r\n\t\t//////////////////////////////////////////////\r\n\t\t\r\n\t\tgetTime: function(e, x, y, touchIndex){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tReturns the time displayed at the specified point by this component.\r\n\t\t\t// e: Event\r\n\t\t\t//\t\tOptional mouse event.\r\n\t\t\t// x: Number\r\n\t\t\t//\t\tPosition along the x-axis with respect to the sheet container used if event is not defined.\r\n\t\t\t// y: Number\r\n\t\t\t//\t\tPosition along the y-axis with respect to the sheet container (scroll included) used if event is not defined.\r\n\t\t\t// touchIndex: Integer\r\n\t\t\t//\t\tIf parameter 'e' is not null and a touch event, the index of the touch to use.\r\n\t\t\t// returns: Date\r\n\t\t\t\r\n\t\t\tvar rd = this.renderData;\r\n\t\t\t\r\n\t\t\tif(e != null){\t\t\t\t\r\n\t\t\t\tvar refPos = domGeometry.position(this.itemContainer, true);\r\n\t\t\t\t\r\n\t\t\t\tif(e.touches){\r\n\r\n\t\t\t\t\ttouchIndex = touchIndex==undefined ? 0 : touchIndex;\r\n\r\n\t\t\t\t\tx = e.touches[touchIndex].pageX - refPos.x;\r\n\t\t\t\t\ty = e.touches[touchIndex].pageY - refPos.y;\r\n\t\t\t\t\t\r\n\t\t\t\t}else{\r\n\r\n\t\t\t\t\tx = e.pageX - refPos.x;\r\n\t\t\t\t\ty = e.pageY - refPos.y;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar r = domGeometry.getContentBox(this.itemContainer);\r\n\t\t\t\r\n\t\t\tif(x < 0){\r\n\t\t\t\tx = 0;\r\n\t\t\t}else if(x > r.w){\r\n\t\t\t\tx = r.w-1;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(y < 0){\r\n\t\t\t\ty = 0;\r\n\t\t\t}else if(y > r.h){\r\n\t\t\t\ty = r.h-1;\r\n\t\t\t}\r\n\r\n\t\t\t// compute the date from column the time in day instead of time from start date of row to prevent DST hour offset.\r\n\t\t\t\r\n\t\t\tvar w = domGeometry.getMarginBox(this.itemContainer).w;\r\n\t\t\tvar colW = w / rd.columnCount;\r\n\t\t\t \r\n\t\t\tvar row;\r\n\t\t\tif(rd.expandedRow == null){\r\n\t\t\t\trow = Math.floor(y / (domGeometry.getMarginBox(this.itemContainer).h / rd.rowCount));\r\n\t\t\t}else{\r\n\t\t\t\trow = rd.expandedRow; //other rows are not usable\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar r = domGeometry.getContentBox(this.itemContainer);\r\n\t\t\t\r\n\t\t\tif(rd.rtl){\r\n\t\t\t\tx = r.w - x;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar col = Math.floor(x / colW);\r\n\t\t\t\r\n\t\t\tvar tm = Math.floor((x-(col*colW)) * 1440 / colW);\r\n\t\t\t\r\n\t\t\tvar date = null;\r\n\t\t\tif(row < rd.dates.length && col < this.renderData.dates[row].length){\r\n\t\t\t\tdate = this.newDate(this.renderData.dates[row][col]); \r\n\t\t\t\tdate = this.renderData.dateModule.add(date, \"minute\", tm);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn date;\r\n\t\t},\r\n\t\t\r\n\t\t/////////////////////////////////////////////\r\n\t\t//\r\n\t\t// Event management\r\n\t\t//\r\n\t\t//////////////////////////////////////////////\r\n\t\t\r\n\t\t_onGridMouseUp: function(e){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\t\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\t\r\n\t\t\tif(this._gridMouseDown){\r\n\t\t\t\tthis._gridMouseDown = false;\r\n\t\t\t\t\r\n\t\t\t\tthis._onGridClick({\r\n\t\t\t\t\tdate: this.getTime(e),\r\n\t\t\t\t\ttriggerEvent: e\r\n\t\t\t\t});\r\n\t\t\t}\t\t\t\r\n\t\t},\r\n\t\t\r\n\t\t_onGridTouchEnd: function(e){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\tthis.inherited(arguments);\r\n\r\n\t\t\tvar g = this._gridProps;\r\n\t\t\t\r\n\t\t\tif(g){\r\n\t\t\t\t\r\n\t\t\t\tif(!this._isEditing){\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t// touched on grid and on touch start editing was ongoing.\r\n\t\t\t\t\tif(!g.fromItem && !g.editingOnStart){\r\n\t\t\t\t\t\tthis.selectFromEvent(e, null, null, true);\r\n\t\t\t\t\t}\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(!g.fromItem){\r\n\t\t\t\t\t\r\n\t\t\t\t\t\tif(this._pendingDoubleTap && this._pendingDoubleTap.grid){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tthis._onGridDoubleClick({\r\n\t\t\t\t\t\t\t\tdate: this.getTime(this._gridProps.event),\r\n\t\t\t\t\t\t\t\ttriggerEvent: this._gridProps.event\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tclearTimeout(this._pendingDoubleTap.timer);\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\tdelete this._pendingDoubleTap;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}else{\r\n\r\n\t\t\t\t\t\t\tthis._onGridClick({\r\n\t\t\t\t\t\t\t\tdate: this.getTime(this._gridProps.event),\r\n\t\t\t\t\t\t\t\ttriggerEvent: this._gridProps.event\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tthis._pendingDoubleTap = {\r\n\t\t\t\t\t\t\t\tgrid: true,\r\n\t\t\t\t\t\t\t\ttimer: setTimeout(lang.hitch(this, function(){\r\n\t\t\t\t\t\t\t\t\t\tdelete this._pendingDoubleTap;\r\n\t\t\t\t\t\t\t\t}), this.doubleTapDelay)\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\t\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tthis._gridProps = null;\r\n\t\t\t}\t\t\t\t\t\r\n\t\t},\r\n\t\t\r\n\t\t\t\t\r\n\t\t/////////////////////////////////////////////\r\n\t\t//\r\n\t\t// Events\r\n\t\t//\r\n\t\t//////////////////////////////////////////////\r\n\t\t\r\n\t\t_onRowHeaderClick: function(e){\r\n\t\t\tthis._dispatchCalendarEvt(e, \"onRowHeaderClick\");\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t},\r\n\t\t\r\n\t\tonRowHeaderClick: function(e){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tEvent dispatched when a row header cell is clicked.\r\n\t\t\t// e: __HeaderClickEventArgs\r\n\t\t\t//\t\tHeader click event.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tcallback\r\n\t\t},\r\n\t\t\r\n\t\texpandRendererClickHandler: function(e, renderer){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tDefault action when an expand renderer is clicked.\r\n\t\t\t// e: Event\r\n\t\t\t//\t\tThe mouse event.\r\n\t\t\t// renderer: Object\r\n\t\t\t//\t\tThe expand renderer.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\r\n\t\t\t\r\n\t\t\tevent.stop(e);\r\n\t\t\t\r\n\t\t\tvar ri = renderer.get(\"rowIndex\");\r\n\t\t\tvar ci = renderer.get(\"columnIndex\");\r\n\t\t\t\r\n\t\t\tthis._onExpandRendererClick(lang.mixin(this._createItemEditEvent(), {\r\n\t\t\t\trowIndex: ri,\r\n\t\t\t\tcolumnIndex: ci,\r\n\t\t\t\trenderer: renderer,\r\n\t\t\t\ttriggerEvent: e,\r\n\t\t\t\tdate: this.renderData.dates[ri][ci]\r\n\t\t\t}));\r\n\t\t},\r\n\t\t\r\n\t\tonExpandRendererClick: function(e){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tEvent dispatched when an expand renderer is clicked.\r\n\t\t\t// e: __ExpandRendererClickEventArgs\r\n\t\t\t//\t\tExpand renderer click event.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tcallback\r\n\t\t},\r\n\t\t\r\n\t\t_onExpandRendererClick: function(e){\r\n\t\t\t\r\n\t\t\tthis._dispatchCalendarEvt(e, \"onExpandRendererClick\");\r\n\t\t\t\r\n\t\t\tif(!e.isDefaultPrevented()){\r\n\t\t\t\r\n\t\t\t\tif(this.getExpandedRowIndex() != -1){\r\n\t\t\t\t\tthis.collapseRow();\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis.expandRow(e.rowIndex, e.columnIndex);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t\r\n\t\t////////////////////////////////////////////\r\n\t\t//\r\n\t\t// Editing\r\n\t\t//\r\n\t\t///////////////////////////////////////////\r\n\t\t\t\t\t\t\t\t\r\n\t\tsnapUnit: \"minute\",\r\n\t\tsnapSteps: 15,\r\n\t\tminDurationUnit: \"minute\",\r\n\t\tminDurationSteps: 15,\r\n\t\ttriggerExtent: 3,\r\n\t\tliveLayout: false,\r\n\t\tstayInView: true,\r\n\t\tallowStartEndSwap: true,\r\n\t\tallowResizeLessThan24H: false\t\t\r\n\r\n\t});\r\n});\r\n"]}