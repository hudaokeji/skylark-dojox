{"version":3,"sources":["calendar/MonthColumnView.js"],"names":["define","ViewBase","_TemplatedMixin","_ScrollBarBase","template","declare","event","lang","arr","has","fx","html","on","dom","domClass","domStyle","domGeometry","domConstruct","mouse","query","i18n","metrics","baseClass","templateString","viewKind","_setTabIndexAttr","renderData","startDate","columnCount","daySize","showCellLabel","showHiddenItems","verticalRenderer","verticalDecorationRenderer","percentOverlap","horizontalGap","columnHeaderFormatLength","gridCellDatePattern","roundToDay","_layoutUnit","_columnHeaderHandlers","constructor","this","invalidatingProperties","postCreate","inherited","arguments","keyboardUpDownUnit","keyboardUpDownSteps","keyboardLeftRightUnit","keyboardLeftRightSteps","allDayKeyboardUpDownUnit","allDayKeyboardUpDownSteps","allDayKeyboardLeftRightUnit","allDayKeyboardLeftRightSteps","destroy","preserveDom","_cleanupColumnHeader","scrollBar","_scrollBar_onScroll","value","scrollContainer","scrollTop","buildRendering","vScrollBar","content","vScrollBarContent","hitch","_viewHandles","push","wheel","dojo","_mouseWheelScrollHander","postscript","_initialized","invalidRendering","refreshRendering","_setVerticalRendererAttr","_destroyRenderersByKind","_set","_createRenderData","rd","get","scrollbarWidth","getScrollbar","w","dateLocaleModule","dateClassObj","dateModule","dates","d","floorToMonth","currentMonth","getMonth","maxDayCount","col","addAndFloor","length","startTime","endTime","add","sheetHeight","displayedItemsInvalidated","_isEditing","_computeVisibleItems","items","displayedDecorationItemsInvalidated","decorationItems","decorationStoreManager","_validateProperties","isNaN","_setStartDateAttr","_setColumnCountAttr","__fixEvt","e","sheet","source","_formatColumnHeaderLabel","len","getNames","_formatGridCellLabel","row","format","gridCellPattern","selector","datePattern","getLocalization","_calendar","getDay","substring","scrollPosition","scrollBarRTLPosition","_setScrollPositionAttr","_setScrollPosition","date","duration","easing","_getScrollPositionAttr","maxDuration","position","_scrollAnimation","stop","Math","abs","Animation","curve","onAnimate","_setScrollImpl","play","v","set","ensureVisibility","start","end","visibilityTarget","margin","undefined","scrollable","autoScroll","s","getDate","isStartOfDay","_waDojoxAddIssue","viewStart","r","getContentBox","viewEnd","h","visible","target","scrollView","dir","pos","wheelDelta","oldRd","_createRendering","_layoutDecorationRenderers","_layoutRenderers","oldRenderData","sheetContainer","_configureScrollBar","_buildColumnHeader","_buildGrid","_buildItemContainer","domNode","atRight","isLeftToRight","rPos","lPos","columnHeader","buttonContainer","owner","currentView","_columnHeaderClick","index","columnHeaderTable","indexOf","currentTarget","_onColumnHeaderClick","triggerEvent","table","count","_colTableSave","clone","removeChild","appendChild","tbody","tr","td","tbodies","trs","create","i","remove","lastChild","list","pop","forEach","className","_setText","styleColumnHeaderCell","node","gridTable","rowDiff","addRows","colDiff","_gridTableSave","grid","rowIndex","addCols","span","styleGridCell","styleGridCellFunc","defaultStyleGridCell","_cssDays","isToday","isWeekEnd","itemContainerTable","bgCols","_itemTableSave","itemContainer","_recycleItemRenderers","div","height","cells","_overlapLayoutPass2","lanes","lane","layoutItem","j","extent","space","k","ccol","l","layoutItem2","_defaultItemToRendererKindFunc","item","allDay","difference","hiddenEvents","_layoutInterval","itemsType","verticalItems","hiddenItems","colW","offsetWidth","_itemToRendererKind","_layoutVerticalItems","_layoutBgItems","_dateToYCoordinate","getHours","getMinutes","d2","cell","layoutItems","overlap","computeRangeOverlap","top","bottom","litem","mixin","range","numLanes","computeOverlapping","hOverlap","ir","posX","_createRenderer","container","left","width","edited","isItemBeingEdited","selected","isItemSelected","hovered","isItemHovered","focused","isItemFocused","renderer","showFocus","getItemStoreState","isItemMoveEnabled","_item","isItemResizeEnabled","applyRendererZIndex","updateRendering","decorationRendererManager","createRenderer","place","_getCellAt","columnIndex","rtl","childNodes","invalidateLayout","bgItems","_sortItemsFunction","a","b","res","compare","getTime","x","y","touchIndex","refPos","touches","pageX","pageY","floor","newDate","_onGridMouseUp","_gridMouseDown","_onGridClick","_onGridTouchStart","g","_gridProps","moved","screenY","_onGridTouchMove","touch","screenX","p","_edProps","max","offsetHeight","_onGridTouchEnd","fromItem","editingOnStart","selectFromEvent","_pendingDoubleTap","_onGridDoubleClick","clearTimeout","timer","setTimeout","doubleTapDelay","_dispatchCalendarEvt","onColumnHeaderClick","_onScrollTimer_tick","_scrollProps","scrollStep","snapUnit","snapSteps","minDurationUnit","minDurationSteps","liveLayout","stayInView","allowStartEndSwap","allowResizeLessThan24H"],"mappings":";;;;;;;AAAAA,QACA,aACA,wBACA,mBACA,6CACA,qBACA,mBACA,kBACA,mBACA,mBACA,gBACA,kBACA,UACA,WACA,iBACA,iBACA,oBACA,qBACA,aACA,aACA,YACA,sBAEA,SACCC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,GAeA,OAAOhB,EAAQ,kCAAmCJ,EAAUC,IAK3DoB,UAAW,+BAEXC,eAAgBnB,EAKhBoB,SAAU,eAGVC,iBAAkB,UAIlBC,WAAY,KAKZC,UAAW,KAIXC,YAAa,EAKbC,QAAS,GAITC,eAAe,EAMfC,iBAAiB,EAIjBC,iBAAkB,KAIlBC,2BAA4B,KAK5BC,eAAgB,EAIhBC,cAAe,EAIfC,yBAA0B,KAI1BC,oBAAqB,KAGrBC,YAAY,EAIZC,YAAa,QAEbC,sBAAuB,KAEvBC,YAAa,WACZC,KAAKC,wBAA0B,cAAe,YAAa,UAAW,iBAAkB,mBAAoB,6BAC3G,0BAA2B,gBAAiB,uBAAwB,yBACpE,yBAA0B,UAAW,QAAS,gBAAiB,mBAChED,KAAKF,0BAGNI,WAAY,WACXF,KAAKG,UAAUC,WACfJ,KAAKK,mBAAqB,MAC1BL,KAAKM,oBAAuB,EAC5BN,KAAKO,sBAAwB,QAC7BP,KAAKQ,uBAAyB,EAC9BR,KAAKS,yBAA2B,MAChCT,KAAKU,0BAA4B,EACjCV,KAAKW,4BAA8B,QACnCX,KAAKY,6BAA+B,GAGrCC,QAAS,SAASC,GACjBd,KAAKe,uBACFf,KAAKgB,WACPhB,KAAKgB,UAAUH,QAAQC,GAExBd,KAAKG,UAAUC,YAGhBa,oBAAqB,SAASC,GAG7BlB,KAAKmB,gBAAgBC,UAAYF,GAGlCG,eAAgB,WAGfrB,KAAKG,UAAUC,WACZJ,KAAKsB,aACPtB,KAAKgB,UAAY,IAAIvD,GACnB8D,QAASvB,KAAKwB,mBACfxB,KAAKsB,YAENtB,KAAKgB,UAAU9C,GAAG,SAAUL,EAAK4D,MAAMzB,KAAMA,KAAKiB,sBAClDjB,KAAK0B,aAAaC,KACjBzD,EAAG8B,KAAKmB,gBAAiB3C,EAAMoD,MAC9BC,KAAKJ,MAAMzB,KAAMA,KAAK8B,6BAI1BC,WAAY,WACX/B,KAAKG,UAAUC,WACfJ,KAAKgC,cAAe,EAChBhC,KAAKiC,kBACRjC,KAAKkC,oBAIPC,yBAA0B,SAASjB,GAClClB,KAAKoC,wBAAwB,YAC7BpC,KAAKqC,KAAK,mBAAoBnB,IAG/BoB,kBAAmB,WAElB,IAAIC,KAEJA,EAAGpD,QAAUa,KAAKwC,IAAI,WACtBD,EAAGE,eAAiB9D,EAAQ+D,eAAeC,EAAI,EAE/CJ,EAAGK,iBAAmB5C,KAAK4C,iBAC3BL,EAAGM,aAAe7C,KAAK6C,aACvBN,EAAGO,WAAa9C,KAAK8C,WAErBP,EAAGQ,SAEHR,EAAGrD,YAAcc,KAAKwC,IAAI,eAE1B,IAAIQ,EAAIhD,KAAKwC,IAAI,aAER,MAALQ,IACHA,EAAI,IAAIT,EAAGM,cAGZG,EAAIhD,KAAKiD,aAAaD,GAAG,EAAOT,GAEhCvC,KAAKf,UAAY+D,EAIjB,IAHA,IAAIE,EAAeF,EAAEG,WACjBC,EAAc,EAEVC,EAAM,EAAGA,EAAMd,EAAGrD,YAAcmE,IAAM,CAE7C,IAAIN,KAGJ,IAFAR,EAAGQ,MAAMpB,KAAKoB,GAERC,EAAEG,YAAcD,GACrBH,EAAMpB,KAAKqB,GACXA,EAAIhD,KAAKsD,YAAYN,EAAG,MAAO,GAGhCE,EAAeF,EAAEG,WAEdC,EAAcL,EAAMQ,SACtBH,EAAcL,EAAMQ,QA2BtB,OAvBAhB,EAAGiB,UAAY,IAAIjB,EAAGM,aAAaN,EAAGQ,MAAM,GAAG,IAC/CR,EAAGkB,QAAU,IAAIlB,EAAGM,aAAaE,EAAMA,EAAMQ,OAAO,IACpDhB,EAAGkB,QAAUlB,EAAGO,WAAWY,IAAInB,EAAGkB,QAAS,MAAO,GAElDlB,EAAGa,YAAcA,EACjBb,EAAGoB,YAAcpB,EAAGpD,QAAUiE,EAE3BpD,KAAK4D,4BAA8B5D,KAAK6D,YAC1C7D,KAAK4D,2BAA4B,EACjC5D,KAAK8D,qBAAqBvB,IAEjBvC,KAAKhB,aACduD,EAAGwB,MAAQ/D,KAAKhB,WAAW+E,OAGzB/D,KAAKgE,oCAEPzB,EAAG0B,gBAAkBjE,KAAKkE,uBAAuBJ,qBAAqBvB,GAE7DvC,KAAKhB,aACduD,EAAG0B,gBAAkBjE,KAAKhB,WAAWiF,iBAG/B1B,GAGR4B,oBAAqB,WAEpBnE,KAAKG,UAAUC,YAEXJ,KAAKd,YAAY,GAAKkF,MAAMpE,KAAKd,gBACpCc,KAAKd,YAAc,IAGjBc,KAAKb,QAAQ,GAAKiF,MAAMpE,KAAKb,YAC/Ba,KAAKb,QAAU,IAKjBkF,kBAAmB,SAASnD,GAC3BlB,KAAK4D,2BAA4B,EACjC5D,KAAKqC,KAAK,YAAanB,IAGxBoD,oBAAqB,SAASpD,GAC7BlB,KAAK4D,2BAA4B,EACjC5D,KAAKqC,KAAK,cAAenB,IAG1BqD,SAAS,SAASC,GAGjB,OAFAA,EAAEC,MAAQ,UACVD,EAAEE,OAAS1E,KACJwE,GASRG,yBAA0B,SAAiB3B,GAQ1C,IAAI4B,EAAM,OAQV,OANG5E,KAAKN,2BACPkF,EAAM5E,KAAKN,0BAGCM,KAAKhB,WAAW4D,iBAAiBiC,SAAS,SAAUD,EAAK,cAExD5B,EAAEG,aAMjBxD,oBAAqB,KAErBmF,qBAAsB,SAAS9B,EAAG+B,EAAK1B,GActC,IAAI2B,EAEJ,OAAQ,MAALhC,EACK,GAGLhD,KAAKiF,gBACAjF,KAAKhB,WAAW4D,iBAAiBoC,OAAOhC,GAC9CkC,SAAU,OACVC,YAAanF,KAAKL,uBAInBqF,EADKtG,EAAK0G,gBAAgB,YAAapF,KAAKqF,WAChC,oBAEDrF,KAAKhB,WAAW4D,iBAAiBiC,SAAS,OAAQ,OAAQ,cAEzD7B,EAAEsC,UAAUC,UAAU,EAAG,GAAK,IAAMvF,KAAKhB,WAAW4D,iBAAiBoC,OAAOhC,GACvFkC,SAAU,OACVC,YAAaH,MAahBQ,eAAgB,KAKhBC,qBAAsB,OAEtBC,uBAAwB,SAASxE,GAChClB,KAAK2F,mBAAmBzE,EAAM0E,KAAM1E,EAAM2E,SAAU3E,EAAM4E,SAG3DC,uBAAwB,WACvB,OAAQH,KAAO5F,KAAKmB,gBAAgBC,UAAYpB,KAAKb,QAAW,IAGjEwG,mBAAoB,SAASC,EAAMI,EAAaF,GAI5CF,EAAO,EACTA,EAAO,EACCA,EAAK,KACbA,EAAO,IAGR,IAAIK,GAAYL,EAAK,GAAK5F,KAAKb,QAE/B,GAAG6G,EAAa,CAEZhG,KAAKkG,kBACPlG,KAAKkG,iBAAiBC,OAGvB,IAAIN,EAAWO,KAAKC,KAAMJ,EAAWjG,KAAKmB,gBAAgBC,WAAa4E,EAAehG,KAAKhB,WAAW2E,aAEtG3D,KAAKkG,iBAAmB,IAAIlI,EAAGsI,WAC9BC,OAAQvG,KAAKmB,gBAAgBC,UAAW6E,GACxCJ,SAAUA,EACVC,OAAQA,EACRU,UAAW3I,EAAK4D,MAAMzB,KAAM,SAASiG,GACpCjG,KAAKyG,eAAeR,OAItBjG,KAAKkG,iBAAiBQ,YAGtB1G,KAAKyG,eAAeR,IAItBQ,eAAgB,SAASE,GAIxB3G,KAAKmB,gBAAgBC,UAAYuF,EAC9B3G,KAAKgB,WACPhB,KAAKgB,UAAU4F,IAAI,QAASD,IAI9BE,iBAAkB,SAASC,EAAOC,EAAKC,EAAkBC,EAAQpB,GAkBhE,GAFAoB,OAAmBC,GAAVD,EAAsB,EAAIA,EAEhCjH,KAAKmH,YAAcnH,KAAKoH,WAAW,CAErC,IAAIC,EAAIP,EAAMQ,UAAYL,EACvBjH,KAAKuH,aAAaR,KACpBA,EAAM/G,KAAKwH,iBAAiBT,EAAK,OAAQ,IAE1C,IAAIvC,EAAIuC,EAAIO,UAAYL,EAEpBQ,EAAYzH,KAAKwC,IAAI,kBAAkBoD,KACvC8B,EAAIpJ,EAAYqJ,cAAc3H,KAAKmB,iBACnCyG,EAAW5H,KAAKwC,IAAI,kBAAkBoD,KAAQ8B,EAAEG,EAAE7H,KAAKb,QAEvD2I,GAAU,EACVC,EAAS,KAEb,OAAOf,GACN,IAAK,QACJc,EAAUT,GAAKI,GAAaJ,GAAKO,EACjCG,EAASV,EACT,MACD,IAAK,MACJS,EAAUtD,GAAKiD,GAAajD,GAAKoD,EACjCG,EAASvD,GAAKoD,EAAUH,GACxB,MACD,IAAK,OACJK,EAAUT,GAAKI,GAAajD,GAAKoD,EACjCG,EAASV,EAIPS,GACH9H,KAAK2F,mBAAmBoC,EAAQlC,KAKnCmC,WAAY,SAASC,GAMpB,IAAIC,EAAMlI,KAAKwC,IAAI,kBAAkBoD,KAAOqC,EAC5CjI,KAAK2F,mBAAmBuC,IAGzBpG,wBAAyB,SAAS0C,GAKjCxE,KAAKgI,WAAWxD,EAAE2D,WAAa,GAAK,EAAI,IASzCjG,iBAAkB,WACjB,GAAIlC,KAAKgC,aAAT,CAIAhC,KAAKmE,sBAEL,IAAIiE,EAAQpI,KAAKhB,WACbuD,EAAKvC,KAAKhB,WAAagB,KAAKsC,oBAEhCtC,KAAKqI,iBAAiB9F,EAAI6F,GAC1BpI,KAAKsI,2BAA2B/F,GAChCvC,KAAKuI,iBAAiBhG,KAGvB8F,iBAAkB,SAAmBrJ,EAAsBwJ,GAG1DnK,EAASuI,IAAI5G,KAAKyI,eAAgB,SAAUzJ,EAAW2E,YAAc,MAErE3D,KAAK0I,oBAAoB1J,GACzBgB,KAAK2I,mBAAmB3J,EAAYwJ,GACpCxI,KAAK4I,WAAW5J,EAAYwJ,GAC5BxI,KAAK6I,oBAAoB7J,EAAYwJ,IAGtCE,oBAAqB,SAAS1J,GAQ1BjB,EAAI,OAASiC,KAAKgB,WACpB3C,EAASuI,IAAI5G,KAAKgB,UAAU8H,QAAS,QAAU9J,EAAWyD,eAAiB,EAAK,MAGjF,IAAIsG,IAAU/I,KAAKgJ,iBAAsD,SAA7BhJ,KAAKyF,qBAC7CwD,EAAOF,EAAU,QAAU,OAC3BG,EAAOH,EAAS,OAAS,QAE1B/I,KAAKgB,YACPhB,KAAKgB,UAAU4F,IAAI,UAAW5H,EAAW2E,aACzCtF,EAASuI,IAAI5G,KAAKgB,UAAU8H,QAASG,EAAM,GAC3C5K,EAASuI,IAAI5G,KAAKgB,UAAU8H,QAASI,EAAM,SAE5C7K,EAASuI,IAAI5G,KAAKmB,gBAAiB8H,EAAMjK,EAAWyD,eAAiB,MACrEpE,EAASuI,IAAI5G,KAAKmB,gBAAiB+H,EAAM,KACzC7K,EAASuI,IAAI5G,KAAKmJ,aAAcF,EAAMjK,EAAWyD,eAAiB,MAClEpE,EAASuI,IAAI5G,KAAKmJ,aAAcD,EAAM,KACnClJ,KAAKoJ,iBAAiC,MAAdpJ,KAAKqJ,OAAiBrJ,KAAKqJ,MAAMC,aAAetJ,OAC1E3B,EAASuI,IAAI5G,KAAKoJ,gBAAiBH,EAAMjK,EAAWyD,eAAiB,MACrEpE,EAASuI,IAAI5G,KAAKoJ,gBAAiBF,EAAM,OAI3CK,mBAAoB,SAAS/E,GAI5B5G,EAAMuI,KAAK3B,GACX,IAAIgF,EAAQ/K,EAAM,KAAMuB,KAAKyJ,mBAAmBC,QAAQlF,EAAEmF,eAC1D3J,KAAK4J,sBACJJ,MAAOA,EACP5D,KAAM5F,KAAKhB,WAAW+D,MAAMyG,GAAO,GACnCK,aAAcrF,KAIhBmE,mBAAoB,SAAS3J,EAAYwJ,GAaxC,IAAIsB,EAAQ9J,KAAKyJ,kBAEjB,GAAKK,EAAL,CAIA,IAAIC,EAAQ/K,EAAWE,aAAesJ,EAAgBA,EAActJ,YAAc,GAElE,GAAbnB,EAAI,QAKmB,MAAtBiC,KAAKgK,cACPhK,KAAKgK,cAAgBnM,EAAKoM,MAAMH,GACxBC,EAAQ,IAChB/J,KAAKe,uBACLf,KAAKmJ,aAAae,YAAYJ,GAC9BvL,EAAasC,QAAQiJ,GACrBA,EAAQjM,EAAKoM,MAAMjK,KAAKgK,eACxBhK,KAAKyJ,kBAAoBK,EACzB9J,KAAKmJ,aAAagB,YAAYL,GAC9BC,EAAQ/K,EAAWE,cAKrB,IAGIkL,EAAOC,EAAIC,EAHXC,EAAU9L,EAAM,QAASqL,GAEzBU,EAAM/L,EAAM,KAAMqL,GAgBtB,GAZCM,EADqB,GAAlBG,EAAQhH,OACHgH,EAAQ,GAERtM,EAAKwM,OAAO,QAAS,KAAMX,GAInCO,EADiB,GAAdG,EAAIjH,OACFiH,EAAI,GAEJjM,EAAakM,OAAO,KAAM,KAAML,GAInCL,EAAQ,EACV,IAAI,IAAIW,EAAE,EAAGA,EAAIX,EAAOW,IAAI,CAE3BJ,EAAK/L,EAAakM,OAAO,KAAM,KAAMJ,GAErC,IAAIxC,KACJA,EAAElG,KAAKzD,EAAGoM,EAAI,QAASzM,EAAK4D,MAAMzB,KAAMA,KAAKuJ,sBAE1CxL,EAAI,iBACN8J,EAAElG,KAAKzD,EAAGoM,EAAI,aAAc,SAAS9F,GACpC5G,EAAMuI,KAAK3B,GACXpG,EAASsF,IAAIc,EAAEmF,cAAe,aAG/B9B,EAAElG,KAAKzD,EAAGoM,EAAI,WAAY,SAAS9F,GAClC5G,EAAMuI,KAAK3B,GACXpG,EAASuM,OAAOnG,EAAEmF,cAAe,eAGlC9B,EAAElG,KAAKzD,EAAGoM,EAAI,YAAa,SAAS9F,GACnC5G,EAAMuI,KAAK3B,GACXpG,EAASsF,IAAIc,EAAEmF,cAAe,aAG/B9B,EAAElG,KAAKzD,EAAGoM,EAAI,UAAW,SAAS9F,GACjC5G,EAAMuI,KAAK3B,GACXpG,EAASuM,OAAOnG,EAAEmF,cAAe,aAGlC9B,EAAElG,KAAKzD,EAAGoM,EAAI,YAAa,SAAS9F,GACnC5G,EAAMuI,KAAK3B,GACXpG,EAASsF,IAAIc,EAAEmF,cAAe,YAG/B9B,EAAElG,KAAKzD,EAAGoM,EAAI,WAAY,SAAS9F,GAClC5G,EAAMuI,KAAK3B,GACXpG,EAASuM,OAAOnG,EAAEmF,cAAe,aAKnC3J,KAAKF,sBAAsB6B,KAAKkG,OAG7B,CACJkC,GAASA,EACT,IAAQW,EAAE,EAAGA,EAAIX,EAAOW,IAAI,CAC3BJ,EAAKD,EAAGO,UACRP,EAAGH,YAAYI,GACf/L,EAAasC,QAAQyJ,GAErB,IADA,IAAIO,EAAO7K,KAAKF,sBAAsBgL,MAChCD,EAAKtH,OAAO,GACjBsH,EAAKC,MAAMH,UAMdlM,EAAM,KAAMqL,GAAOiB,QAAQ,SAAST,EAAII,GACvCJ,EAAGU,UAAY,GACP,GAALN,EACFtM,EAASsF,IAAI4G,EAAI,eACTI,GAAK1K,KAAKhB,WAAWE,YAAY,GACzCd,EAASsF,IAAI4G,EAAI,cAElB,IAAItH,EAAIhE,EAAW+D,MAAM2H,GAAG,GAC5B1K,KAAKiL,SAASX,EAAItK,KAAK2E,yBAAyB3B,IAChDhD,KAAKkL,sBAAsBZ,EAAItH,EAAGhE,IAChCgB,QAIJe,qBAAsB,WAIrB,KAAMf,KAAKF,sBAAsByD,OAAS,GAEzC,IADA,IAAIsH,EAAO7K,KAAKF,sBAAsBgL,MAChCD,EAAKtH,OAAS,GACnBsH,EAAKC,MAAMH,UAKdO,sBAAuB,SAASC,EAAMvF,EAAM5G,KAe5C4J,WAAY,SAAU5J,EAAYwJ,GAajC,IAAIsB,EAAQ9J,KAAKoL,UAEjB,GAAItB,EAAJ,CAIAzL,EAASuI,IAAIkD,EAAO,SAAU9K,EAAW2E,YAAc,MAEvD,IAAI0H,EAAUrM,EAAWoE,aAAeoF,EAAgBA,EAAcpF,YAAc,GAChFkI,EAAUD,EAAU,EAEpBE,EAAWvM,EAAWE,aAAesJ,EAAgBA,EAActJ,YAAc,GAErE,GAAbnB,EAAI,QAKoB,MAAvBiC,KAAKwL,eACPxL,KAAKwL,eAAiB3N,EAAKoM,MAAMH,GACzByB,EAAU,IAClBvL,KAAKyL,KAAKvB,YAAYJ,GACtBvL,EAAasC,QAAQiJ,GACrBA,EAAQjM,EAAKoM,MAAMjK,KAAKwL,gBACxBxL,KAAKoL,UAAYtB,EACjB9J,KAAKyL,KAAKtB,YAAYL,GACtByB,EAAUvM,EAAWE,YACrBmM,EAAUrM,EAAWoE,YACrBkI,GAAU,IAIZ,IACIlB,EADAG,EAAU9L,EAAM,QAASqL,GAU7B,GANCM,EADoB,GAAlBG,EAAQhH,OACFgH,EAAQ,GAERhM,EAAakM,OAAO,QAAS,KAAMX,GAIzCwB,EACF,IAAI,IAAIZ,EAAE,EAAGA,EAAEW,EAASX,IACvBnM,EAAakM,OAAO,KAAM,KAAML,OAE7B,CACJiB,GAAWA,EACX,IAAQX,EAAE,EAAGA,EAAEW,EAASX,IACvBN,EAAMF,YAAYE,EAAMQ,WAI1B,IAAIc,EAAW1M,EAAWoE,YAAciI,EAEpCM,EAAUL,GAAWC,EAAS,EAClCA,EAAUI,EAAUJ,GAAWA,EAE/B9M,EAAM,KAAMqL,GAAOiB,QAAQ,SAASV,EAAIK,GAEvC,GAAGiB,EACF,CAAA,IAAI/G,EAAM8F,GAAKgB,EAAW1M,EAAWE,YAAcqM,EACnD,IAAQb,EAAE,EAAGA,EAAE9F,EAAK8F,IAAI,CACvB,IAAIJ,EAAK/L,EAAakM,OAAO,KAAM,KAAMJ,GACzC9L,EAAakM,OAAO,OAAQ,KAAMH,SAGnC,IAAQI,EAAE,EAAGA,EAAEa,EAASb,IACvBL,EAAGH,YAAYG,EAAGO,aAOrBnM,EAAM,KAAMqL,GAAOiB,QAAQ,SAAUV,EAAItF,GAExCsF,EAAGW,UAAY,GAEL,GAAPjG,GACF3G,EAASsF,IAAI2G,EAAI,eAEftF,GAAO/F,EAAWoE,YAAY,GAChChF,EAASsF,IAAI2G,EAAI,cAGlB5L,EAAM,KAAM4L,GAAIU,QAAQ,SAAUT,EAAIjH,GAErCiH,EAAGU,UAAY,GAEL,GAAP3H,GACFjF,EAASsF,IAAI4G,EAAI,eAGfjH,GAAOrE,EAAWE,YAAY,GAChCd,EAASsF,IAAI4G,EAAI,cAGlB,IAAItH,EAAI,KACL+B,EAAM/F,EAAW+D,MAAMM,GAAKE,SAC9BP,EAAIhE,EAAW+D,MAAMM,GAAK0B,IAG3B,IAAI6G,EAAOnN,EAAM,OAAQ6L,GAAI,GAC7BtK,KAAKiL,SAASW,EAAM5L,KAAKZ,cAAgBY,KAAK8E,qBAAqB9B,EAAG+B,EAAK1B,GAAM,MAEjFrD,KAAK6L,cAAcvB,EAAItH,EAAGK,EAAK0B,EAAK/F,IAElCgB,OACDA,QAQJ8L,kBAAmB,KAEnBC,qBAAsB,SAASZ,EAAMvF,EAAMvC,EAAK0B,EAAK/F,GAoBzC,MAAR4G,IAGHxH,EAASsF,IAAIyH,EAAMnL,KAAKgM,SAASpG,EAAKN,WACnCtF,KAAKiM,QAAQrG,GACfxH,EAASsF,IAAIyH,EAAM,sBACXnL,KAAKkM,UAAUtG,IACvBxH,EAASsF,IAAIyH,EAAM,0BAIrBU,cAAe,SAASV,EAAMvF,EAAMvC,EAAK0B,EAAK/F,GAiB1CgB,KAAK8L,kBACP9L,KAAK8L,kBAAkBX,EAAMvF,EAAMvC,EAAK0B,EAAK/F,GAE7CgB,KAAK+L,qBAAqBZ,EAAMvF,EAAMvC,EAAK0B,EAAK/F,IAIlD6J,oBAAqB,SAAS7J,EAAYwJ,GAWzC,IAAIsB,EAAQ9J,KAAKmM,mBAEjB,GAAKrC,EAAL,CAIA,IAAIsC,KAEJ/N,EAASuI,IAAIkD,EAAO,SAAU9K,EAAW2E,YAAc,MAEvD,IAAIoG,EAAQ/K,EAAWE,aAAesJ,EAAgBA,EAActJ,YAAc,GAElE,GAAbnB,EAAI,QAKoB,MAAvBiC,KAAKqM,eACPrM,KAAKqM,eAAiBxO,EAAKoM,MAAMH,GACzBC,EAAQ,IAChB/J,KAAKsM,cAAcpC,YAAYJ,GAC/B9J,KAAKuM,uBAAsB,GAC3BhO,EAAasC,QAAQiJ,GACrBA,EAAQjM,EAAKoM,MAAMjK,KAAKqM,gBACxBrM,KAAKmM,mBAAqBrC,EAC1B9J,KAAKsM,cAAcnC,YAAYL,GAC/BC,EAAQ/K,EAAWE,cAKrB,IAEIkL,EAAOC,EAAIC,EAFXC,EAAU9L,EAAM,QAASqL,GACzBU,EAAM/L,EAAM,KAAMqL,GAgBtB,GAZCM,EADqB,GAAlBG,EAAQhH,OACHgH,EAAQ,GAERhM,EAAakM,OAAO,QAAS,KAAMX,GAI3CO,EADiB,GAAdG,EAAIjH,OACFiH,EAAI,GAEJjM,EAAakM,OAAO,KAAM,KAAML,GAInCL,EAAM,EACR,IAAI,IAAIW,EAAE,EAAGA,EAAIX,EAAOW,IACvBJ,EAAK/L,EAAakM,OAAO,KAAM,KAAMJ,GACrC9L,EAAakM,OAAO,OAAQO,UAAa,gCAAiCV,OAEvE,CACJP,GAASA,EACT,IAAQW,EAAE,EAAGA,EAAIX,EAAOW,IACvBL,EAAGH,YAAYG,EAAGO,WAIpBnM,EAAM,SAAUqL,GAAOiB,QAAQ,SAASyB,EAAK9B,GAE5CrM,EAASuI,IAAI4F,GACZC,OAAUzN,EAAW2E,YAAc,OAEpCyI,EAAOzK,KAAK6K,IACVxM,MAEHhB,EAAW0N,MAAQN,IASpBO,oBAAqB,SAASC,GAO7B,IAAIlC,EAAImC,EAAMC,EAId,IAFAD,EAAOD,EAAMA,EAAMrJ,OAAO,GAEtBwJ,EAAI,EAAGA,EAAIF,EAAKtJ,OAAQwJ,IAC3BF,EAAKE,GAAGC,OAAS,EAGlB,IAAItC,EAAE,EAAGA,EAAEkC,EAAMrJ,OAAO,EAAGmH,IAAI,CAC9BmC,EAAOD,EAAMlC,GAEb,IAAI,IAAIqC,EAAE,EAAGA,EAAEF,EAAKtJ,OAAQwJ,IAI3B,IAAyB,IAHzBD,EAAaD,EAAKE,IAGJC,OAAa,CAC1BF,EAAWE,OAAS,EAKpB,IAJA,IAAIC,EAAQ,EAER9G,GAAO,EAEH+G,EAAIxC,EAAI,EAAGwC,EAAIN,EAAMrJ,SAAW4C,EAAM+G,IAAI,CAEjD,IADA,IAAIC,EAAOP,EAAMM,GACTE,EAAI,EAAGA,EAAID,EAAK5J,SAAW4C,EAAMiH,IAAI,CAC5C,IAAIC,EAAcF,EAAKC,GAEpBN,EAAWhG,MAAQuG,EAAYtG,KAAOsG,EAAYvG,MAAQgG,EAAW/F,MACvEZ,GAAO,GAGLA,GAEH8G,IAGFH,EAAWE,QAAUC,KAMzBK,+BAAgC,SAASC,GAIxC,OAAGA,EAAKC,OACA,WAEEpH,KAAKC,IAAIrG,KAAKhB,WAAW8D,WAAW2K,WAAWF,EAAK/J,UAAW+J,EAAK9J,QAAS,YACzE,KAAO,WAAa,MAGnC8E,iBAAkB,SAASvJ,GAC1BgB,KAAK0N,gBACL1N,KAAKG,UAAUC,YAGhBuN,gBAAiB,SAAmB3O,EAAuBwK,EAAe1C,EAAeC,EAAiBhD,EAAiB6J,GAI1H,IAAIC,KACAC,KAGJ,GAFA9O,EAAW+O,KAAO/N,KAAKsM,cAAc0B,YAAchP,EAAWE,YAE7C,cAAd0O,EAA0B,CAE5B,IAAI,IAAIlD,EAAE,EAAGA,EAAE3G,EAAMR,OAAQmH,IAAI,CAChC,IAAI6C,EAAOxJ,EAAM2G,GACoB,YAAlC1K,KAAKiO,oBAAoBV,GAC3BM,EAAclM,KAAK4L,GACXvN,KAAKX,iBACbyO,EAAYnM,KAAK4L,GAIhBM,EAActK,OAAS,GACzBvD,KAAKkO,qBAAqBlP,EAAYwK,EAAO1C,EAAOC,EAAK8G,EAAeD,GAEtEE,EAAYvK,OAAS,GACvBvD,KAAKmO,eAAenP,EAAYwK,EAAO1C,EAAOC,EAAK+G,QAGpD9N,KAAKkO,qBAAqBlP,EAAYwK,EAAO1C,EAAOC,EAAKhD,EAAO6J,IAIlEQ,mBAAoB,SAASpP,EAAYgE,EAAG8D,GAI3C,IAAIoB,EAAM,EACV,GAAGpB,GAAyB,GAAhB9D,EAAEqL,YAAqC,GAAlBrL,EAAEsL,aAClCpG,GAAOlF,EAAEsE,UAAU,GAAKtH,KAAKhB,WAAWG,YACpC,CACJ,IAAIoP,EAAKvO,KAAKwH,iBAAiBxE,EAAG,OAAQ,GAC1CkF,EAAMlI,KAAKhB,WAAWG,SAAYoP,EAAGjH,UAAU,GAAKtH,KAAKhB,WAAWG,QAIrE,OAFA+I,IAAqB,GAAblF,EAAEqL,WAAcrL,EAAEsL,cAActO,KAAKhB,WAAWG,QAAQ,MAKjE+O,qBAAsB,SAAmBlP,EAAuBwK,EAAehG,EAAmBC,EAAqBM,EAAiB6J,GAIvI,GAA4B,MAAzB5N,KAAKV,iBAAR,CAQA,IAJA,IAAIkP,EAAOxP,EAAW0N,MAAMlD,GACxBiF,KAGI/D,EAAI,EAAGA,EAAI3G,EAAMR,OAAQmH,IAAI,CAEpC,IAAI6C,EAAOxJ,EAAM2G,GACbgE,EAAU1O,KAAK2O,oBAAoB3P,EAAYuO,EAAK/J,UAAW+J,EAAK9J,QAASD,EAAWC,GAExFmL,EAAM5O,KAAKoO,mBAAmBpP,EAAY0P,EAAQ,IAAI,GACtDG,EAAS7O,KAAKoO,mBAAmBpP,EAAY0P,EAAQ,IAAI,GAE7D,GAAIG,EAASD,EAAI,CAChB,IAAIE,EAAQjR,EAAKkR,OAChBjI,MAAO8H,EACP7H,IAAK8H,EACLG,MAAON,EACPnB,KAAMA,GACJA,GACHkB,EAAY9M,KAAKmN,IAOnB,IAAIG,EAAyB,cAAdrB,EAA4B5N,KAAKkP,mBAAmBT,EAAazO,KAAK2M,qBAAqBsC,SAAW,EAEjHE,EAAWnP,KAAKR,eAAiB,IAGrC,IAAIkL,EAAE,EAAGA,EAAE+D,EAAYlL,OAAQmH,IAAI,CAGlC,IAAImC,GADJU,EAAOkB,EAAY/D,IACHmC,KACZG,EAASO,EAAKP,OAEdoC,EAAK,KAET,GAAiB,cAAdxB,EAA0B,CAC5B,IAAIjL,EACA0M,EAEW,GAAZF,GAGFE,EAAOxC,IADPlK,EAAgB,GAAZsM,EAAgBjQ,EAAW+O,MAAS/O,EAAW+O,MAAQkB,EAAW,GAAKjP,KAAKP,eAAgBwP,GAC7EjP,KAAKP,eAExBkD,EAAI,KADJA,EAAc,GAAVqK,EAAcrK,EAAIA,EAAIqK,GAAUA,EAAO,GAAKhN,KAAKP,eACvCT,EAAW+O,KACzBsB,EAAO,IAAMA,EAAOrQ,EAAW+O,OAI/BsB,EAAOxC,IADPlK,EAAgB,GAAZsM,EAAgB,IAAO,KAAOA,GAAYA,EAAW,GAAKE,IAC3CA,EAASxM,GAC5BA,EAAc,GAAVqK,EAAcrK,EAAIA,GAAMqK,GAAUA,EAAO,GAAKmC,IAGnDC,EAAKpP,KAAKsP,gBAAgB/B,EAAM,WAAYvN,KAAKV,iBAAkB,yBAEnEjB,EAASuI,IAAIwI,EAAGG,WACfX,IAAOrB,EAAKzG,MAAQ,KACpB0I,KAAQH,EAAO,IACfI,MAAS9M,EAAI,IACb8J,OAAWc,EAAKxG,IAAIwG,EAAKzG,MAAM,EAAK,OAGrC,IAAI4I,EAAS1P,KAAK2P,kBAAkBpC,GAChCqC,EAAW5P,KAAK6P,eAAetC,GAC/BuC,EAAU9P,KAAK+P,cAAcxC,GAC7ByC,EAAUhQ,KAAKiQ,cAAc1C,GAE7B2C,EAAWd,EAAGc,SAElBA,EAAStJ,IAAI,UAAWkJ,GACxBI,EAAStJ,IAAI,WAAYgJ,GACzBM,EAAStJ,IAAI,SAAU8I,GACvBQ,EAAStJ,IAAI,YAAW5G,KAAKmQ,WAAYH,GAEzCE,EAAStJ,IAAI,aAAc5G,KAAKoQ,kBAAkB7C,IAElD2C,EAAStJ,IAAI,cAAe5G,KAAKqQ,kBAAkB9C,EAAK+C,MAAO,aAC/DJ,EAAStJ,IAAI,gBAAiB5G,KAAKuQ,oBAAoBhD,EAAK+C,MAAO,aAEnEtQ,KAAKwQ,oBAAoBjD,EAAM6B,EAAIU,EAASF,EAAUF,EAAQM,GAE3DE,EAASO,iBACXP,EAASO,gBAAgB9N,EAAG4K,EAAKxG,IAAIwG,EAAKzG,MAAM,QAKjDsI,EAAKpP,KAAK0Q,0BAA0BC,eAAepD,EAAM,WAAYvN,KAAKT,2BAA4B,2BAEtGlB,EAASuI,IAAIwI,EAAGG,WACfX,IAAOrB,EAAKzG,MAAQ,KACpB0I,KAAQ,IACRC,MAAS,OACThD,OAAWc,EAAKxG,IAAIwG,EAAKzG,MAAM,EAAK,OAItCvI,EAAaqS,MAAMxB,EAAGG,UAAWf,GACjCnQ,EAASuI,IAAIwI,EAAGG,UAAW,UAAW,YAIxCsB,WAAY,SAASnF,EAAUoF,EAAaC,GAO3C,YAHW7J,GAAP6J,GAA2B,GAAPA,GAAiB/Q,KAAKgJ,kBAC7C8H,EAAc9Q,KAAKhB,WAAWE,YAAa,EAAI4R,GAEzC9Q,KAAKoL,UAAU4F,WAAW,GAAGA,WAAWtF,GAAUsF,WAAWF,IAGrEG,iBAAkB,WAEjBxS,EAAM,KAAMuB,KAAKoL,WAAWL,QAAQ,SAAST,GAC5ClM,EAASuM,OAAOL,EAAI,+BAErBtK,KAAKG,UAAUC,YAGhB+N,eAAgB,SAAmBnP,EAAuBqE,EAAaG,EAAmBC,EAAqBM,GAK9G,IADA,IAAImN,KACIxG,EAAI,EAAGA,EAAI3G,EAAMR,OAAQmH,IAAI,CAEpC,IAII3D,EAJAwG,EAAOxJ,EAAM2G,GACbgE,EAAU1O,KAAK2O,oBAAoB3P,EAAYuO,EAAK/J,UAAW+J,EAAK9J,QAASD,EAAWC,GACxFqD,EAAQ4H,EAAQ,GAAGpH,UAAU,EAKhCP,EAFE/G,KAAKuH,aAAamH,EAAQ,KAC5B3H,EAAM/G,KAAKwH,iBAAiBkH,EAAQ,GAAI,OAAQ,IACtCpH,UAAU,EAEdoH,EAAQ,GAAGpH,UAAU,EAG5B,IAAK,IAAItE,EAAE8D,EAAO9D,GAAG+D,EAAK/D,IACzBkO,EAAQlO,IAAK,EAIf,IAAI,IAAI+B,KAAOmM,EACd,GAAGA,EAAQnM,GAAK,CACf,IAAIoG,EAAOnL,KAAK6Q,WAAW9L,EAAK1B,GAAK,GACrCjF,EAASsF,IAAIyH,EAAM,+BAKtBgG,mBAAoB,SAASC,EAAGC,GAI/B,IAAIC,EAAMtR,KAAK8C,WAAWyO,QAAQH,EAAE5N,UAAW6N,EAAE7N,WAIjD,OAHU,GAAP8N,IACFA,GAAO,EAAItR,KAAK8C,WAAWyO,QAAQH,EAAE3N,QAAS4N,EAAE5N,UAE1CzD,KAAKgJ,gBAAkBsI,GAAOA,GAStCE,QAAS,SAAShN,EAAGiN,EAAGC,EAAGC,GAa1B,GAAS,MAALnN,EAAU,CACb,IAAIoN,EAAStT,EAAY2H,SAASjG,KAAKsM,eAAe,GAEnD9H,EAAEqN,SAEJF,OAAyBzK,GAAZyK,EAAwB,EAAIA,EAEzCF,EAAIjN,EAAEqN,QAAQF,GAAYG,MAAQF,EAAOH,EACzCC,EAAIlN,EAAEqN,QAAQF,GAAYI,MAAQH,EAAOF,IAIzCD,EAAIjN,EAAEsN,MAAQF,EAAOH,EACrBC,EAAIlN,EAAEuN,MAAQH,EAAOF,GAIvB,IAAIhK,EAAIpJ,EAAYqJ,cAAc3H,KAAKsM,eAEnCtM,KAAKgJ,kBACRyI,EAAI/J,EAAE/E,EAAI8O,GAGPA,EAAI,EACPA,EAAI,EACIA,EAAI/J,EAAE/E,IACd8O,EAAI/J,EAAE/E,EAAE,GAGL+O,EAAI,EACPA,EAAI,EACIA,EAAIhK,EAAEG,IACd6J,EAAIhK,EAAEG,EAAE,GAGT,IAAIxE,EAAM+C,KAAK4L,MAAMP,GAAK/J,EAAE/E,EAAI3C,KAAKhB,WAAWE,cAC5C6F,EAAMqB,KAAK4L,MAAMN,GAAKhK,EAAEG,EAAI7H,KAAKhB,WAAWoE,cAE5CwC,EAAO,KAMX,OALGvC,EAAMrD,KAAKhB,WAAW+D,MAAMQ,QAC7BwB,EAAM/E,KAAKhB,WAAW+D,MAAMM,GAAKE,SAClCqC,EAAO5F,KAAKiS,QAAQjS,KAAKhB,WAAW+D,MAAMM,GAAK0B,KAGzCa,GASRsM,eAAgB,SAAS1N,GAMxBxE,KAAKG,UAAUC,WAEXJ,KAAKmS,iBACRnS,KAAKmS,gBAAiB,EAEtBnS,KAAKoS,cACJxM,KAAM5F,KAAKwR,QAAQhN,GACnBqF,aAAcrF,MAKjB6N,kBAAmB,SAAS7N,GAK3BxE,KAAKG,UAAUC,WAEf,IAAIkS,EAAItS,KAAKuS,WAEbD,EAAEE,OAAO,EACTF,EAAExL,MAAOtC,EAAEqN,QAAQ,GAAGY,QACtBH,EAAElR,UAAWpB,KAAKmB,gBAAgBC,WAGnCsR,iBAAkB,SAASlO,GAM1B,GAFAxE,KAAKG,UAAUC,WAEXoE,EAAEqN,QAAQtO,OAAS,IAAMvD,KAAK6D,WACjCjG,EAAMuI,KAAK3B,QAIZ,GAAGxE,KAAKuS,aAAevS,KAAK6D,WAAW,CAEtC,IAAI8O,GAASlB,EAAGjN,EAAEqN,QAAQ,GAAGe,QAASlB,EAAGlN,EAAEqN,QAAQ,GAAGY,SAElDI,EAAI7S,KAAK8S,SAEb,IAAKD,GAAKA,IACRzM,KAAKC,IAAIsM,EAAMlB,EAAIoB,EAAE/L,MAAM2K,GAAK,IAChCrL,KAAKC,IAAIsM,EAAMjB,EAAImB,EAAE/L,MAAM4K,GAAK,IAAK,CAEtC1R,KAAKuS,WAAWC,OAAQ,EACxB,IAAIxP,EAAIwB,EAAEqN,QAAQ,GAAGY,QAAUzS,KAAKuS,WAAWzL,MAC3C5F,EAAQlB,KAAKuS,WAAWnR,UAAY4B,EACpC+P,EAAM/S,KAAKsM,cAAc0G,aAAehT,KAAKmB,gBAAgB6R,aAC7D9R,EAAQ,GACXlB,KAAKuS,WAAWzL,MAAQtC,EAAEqN,QAAQ,GAAGY,QACrCzS,KAAKyG,eAAe,GACpBzG,KAAKuS,WAAWnR,UAAY,GACpBF,EAAQ6R,GAChB/S,KAAKuS,WAAWzL,MAAQtC,EAAEqN,QAAQ,GAAGY,QACrCzS,KAAKyG,eAAesM,GACpB/S,KAAKuS,WAAWnR,UAAY2R,GAE5B/S,KAAKyG,eAAevF,MAMxB+R,gBAAiB,SAASzO,GAMzBxE,KAAKG,UAAUC,WAEf,IAAIkS,EAAItS,KAAKuS,WAEVD,IACEtS,KAAK6D,YACJyO,EAAEE,QAGDF,EAAEY,UAAaZ,EAAEa,gBACpBnT,KAAKoT,gBAAgB5O,EAAG,KAAM,MAAM,GAGjC8N,EAAEY,WAEFlT,KAAKqT,mBAAqBrT,KAAKqT,kBAAkB5H,MAEnDzL,KAAKsT,oBACJ1N,KAAM5F,KAAKwR,QAAQxR,KAAKuS,WAAW3U,OACnCiM,aAAc7J,KAAKuS,WAAW3U,QAG/B2V,aAAavT,KAAKqT,kBAAkBG,cAE7BxT,KAAKqT,oBAIZrT,KAAKoS,cACJxM,KAAM5F,KAAKwR,QAAQxR,KAAKuS,WAAW3U,OACnCiM,aAAc7J,KAAKuS,WAAW3U,QAG/BoC,KAAKqT,mBACJ5H,MAAM,EACN+H,MAAOC,WAAW5V,EAAK4D,MAAMzB,KAAM,kBAC1BA,KAAKqT,oBACVrT,KAAK0T,oBAOd1T,KAAKuS,WAAa,OAIpB3I,qBAAsB,SAASpF,GAI9BxE,KAAK2T,qBAAqBnP,EAAG,wBAG9BoP,oBAAqB,SAASpP,KAgB9BqP,oBAAqB,WAIpB7T,KAAKyG,eAAezG,KAAKmB,gBAAgBC,UAAYpB,KAAK8T,aAAaC,aASxEC,SAAU,MACVC,UAAW,EACXC,gBAAiB,MACjBC,iBAAkB,EAClBC,YAAY,EACZC,YAAY,EACZC,mBAAmB,EACnBC,wBAAwB","file":"../../calendar/MonthColumnView.js","sourcesContent":["define([\r\n\"./ViewBase\", \r\n\"dijit/_TemplatedMixin\", \r\n\"./_ScrollBarBase\", \r\n\"dojo/text!./templates/MonthColumnView.html\",\r\n\"dojo/_base/declare\", \r\n\"dojo/_base/event\", \r\n\"dojo/_base/lang\", \r\n\"dojo/_base/array\",\r\n\"dojo/_base/sniff\",\r\n\"dojo/_base/fx\", \r\n\"dojo/_base/html\",\r\n\"dojo/on\",\r\n\"dojo/dom\", \r\n\"dojo/dom-class\", \r\n\"dojo/dom-style\", \r\n\"dojo/dom-geometry\", \r\n\"dojo/dom-construct\", \r\n\"dojo/mouse\",\r\n\"dojo/query\", \r\n\"dojo/i18n\",\r\n\"dojox/html/metrics\"],\r\n\r\nfunction(\r\n\tViewBase, \r\n\t_TemplatedMixin, \r\n\t_ScrollBarBase, \r\n\ttemplate, \r\n\tdeclare, \r\n\tevent, \r\n\tlang, \r\n\tarr, \r\n\thas,\r\n\tfx, \r\n\thtml,\r\n\ton,\r\n\tdom, \r\n\tdomClass, \r\n\tdomStyle,\r\n\tdomGeometry, \r\n\tdomConstruct,\r\n\tmouse,\r\n\tquery, \r\n\ti18n,\r\n\tmetrics){\r\n\t\r\n\t/*=====\r\n\tvar __ColumnClickEventArgs = {\r\n\t\t// summary:\r\n\t\t//\t\tA column click event.\r\n\t\t// index: Integer\r\n\t\t//\t\tThe column index. \r\n\t\t// date: Date\r\n\t\t//\t\tThe date displayed by the column.\r\n\t\t// triggerEvent: Event\r\n\t\t//\t\tThe origin event.\r\n\t};\r\n\t=====*/\r\n\t\t\t\t\r\n\treturn declare(\"dojox.calendar.MonthColumnView\", [ViewBase, _TemplatedMixin], {\r\n\r\n\t\t// summary:\r\n\t\t//\t\tThe month column view is a calendar view used to display a month per column where each cell of the column is a day.\r\n\r\n\t\tbaseClass: \"dojoxCalendarMonthColumnView\",\r\n\t\t\r\n\t\ttemplateString: template,\r\n\t\t\r\n\t\t// viewKind: String\r\n\t\t//\t\tType of the view. Used by the calendar widget to determine how to configure the view.\r\n\t\t//\t\tThis view kind is \"columns\".\r\n\t\tviewKind: \"monthColumns\",\r\n\t\t\r\n\t\t// scroll container is the focusable item to enable scrolling using up and down arrows\r\n\t\t_setTabIndexAttr: \"domNode\",\r\n\t\t\r\n\t\t// renderData: Object\r\n\t\t//\t\tThe render data is the object that contains all the properties needed to render the component.\r\n\t\trenderData: null,\t\t\r\n\t\t\t\t\r\n\t\t// startDate: Date\r\n\t\t//\t\tThe start date of the time interval displayed.\r\n\t\t//\t\tIf not set at initialization time, will be set to current day.\r\n\t\tstartDate: null,\r\n\t\t\t\r\n\t\t// columnCount: Integer\r\n\t\t//\t\tThe number of column to display (from the startDate).\r\n\t\tcolumnCount: 6,\r\n\t\t\r\n\t\t// daySize: Integer\r\n\t\t//\t\tThe desired size in pixels of an hour on the screen.\r\n\t\t//\t\tNote that the effective size may be different as the time slot size must be an integer.\r\n\t\tdaySize: 30,\r\n\t\t\r\n\t\t// showCellLabel: Boolean\r\n\t\t//\t\tWhether display or not the grid cells label (usually the day of month).\r\n\t\tshowCellLabel: true,\r\n\t\t\r\n\t\t// showHiddenItems: Boolean\r\n\t\t//\t\tWhether show or not the hidden items.\r\n\t\t//\t\tBy default the events that are shorter than a day are not displayed using vertical renderers by this widget.\r\n\t\t//\t\tBut the grid cells that contains one or several hidden items display a decoration.\r\n\t\tshowHiddenItems: true,\r\n\t\t\t\r\n\t\t// verticalRenderer: Class\r\n\t\t//\t\tThe class use to create vertical renderers.\r\n\t\tverticalRenderer: null,\r\n\t\t\r\n\t\t// verticalDecorationRenderer: Class\r\n\t\t//\t\tThe class use to create vertical decoration renderers.\r\n\t\tverticalDecorationRenderer: null,\r\n\t\t\r\n\t\t// percentOverlap: Integer\r\n\t\t//\t\tThe percentage of the renderer width used to superimpose one item renderer on another \r\n\t\t//\t\twhen two events are overlapping.\r\n\t\tpercentOverlap: 0,\r\n\t\t\t\t\r\n\t\t// horizontalGap: Integer\r\n\t\t//\t\tThe number of pixels between two item renderers.\r\n\t\thorizontalGap: 4,\r\n\t\t\r\n\t\t// columnHeaderFormatLength: String\r\n\t\t//\t\tLength of the column labels. Valid values are \"wide\" or \"abbr\".\r\n\t\tcolumnHeaderFormatLength: null,\r\n\t\t\r\n\t\t// gridCellDatePattern: String\r\n\t\t//\t\tThe date pattern of the cell labels. By default a custom function is used to compute the label.\r\n\t\tgridCellDatePattern: null,\r\n\t\t\r\n\t\t// roundToDay: [private] Boolean\r\n\t\troundToDay: true,\r\n\t\t\r\n\t\t// _layoutUnit: String\r\n\t\t//\t\tUnit of layout: each column is displaying a month. \r\n\t\t_layoutUnit: \"month\",\r\n\t\t\r\n\t\t_columnHeaderHandlers: null,\r\n\t\t\r\n\t\tconstructor: function(){\r\n\t\t\tthis.invalidatingProperties = [\"columnCount\", \"startDate\", \"daySize\", \"percentOverlap\", \"verticalRenderer\", \"verticalDecorationRenderer\",\r\n\t\t\t\t\"columnHeaderDatePattern\", \"horizontalGap\", \"scrollBarRTLPosition\", \"itemToRendererKindFunc\", \r\n\t\t\t\t\"layoutPriorityFunction\", \"textDir\", \"items\", \"showCellLabel\", \"showHiddenItems\"];\r\n\t\t\tthis._columnHeaderHandlers = [];\r\n\t\t},\r\n\t\t\r\n\t\tpostCreate: function(){\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\tthis.keyboardUpDownUnit = \"day\";\t\r\n\t\t\tthis.keyboardUpDownSteps =  1;\t\t\t\r\n\t\t\tthis.keyboardLeftRightUnit = \"month\";\t\t\t\r\n\t\t\tthis.keyboardLeftRightSteps = 1;\r\n\t\t\tthis.allDayKeyboardUpDownUnit = \"day\";\t\t\t\r\n\t\t\tthis.allDayKeyboardUpDownSteps = 1;\t\r\n\t\t\tthis.allDayKeyboardLeftRightUnit = \"month\";\t\t\t\r\n\t\t\tthis.allDayKeyboardLeftRightSteps = 1;\r\n\t\t},\r\n\t\t\r\n\t\tdestroy: function(preserveDom){\r\n\t\t\tthis._cleanupColumnHeader();\r\n\t\t\tif(this.scrollBar){\r\n\t\t\t\tthis.scrollBar.destroy(preserveDom);\r\n\t\t\t}\r\n\t\t\tthis.inherited(arguments);\r\n\t\t},\r\n\t\t\r\n\t\t_scrollBar_onScroll: function(value){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\tthis.scrollContainer.scrollTop = value;\r\n\t\t},\r\n\t\t\r\n\t\tbuildRendering: function(){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\tif(this.vScrollBar){\r\n\t\t\t\tthis.scrollBar = new _ScrollBarBase(\r\n\t\t\t\t\t{content: this.vScrollBarContent}, \r\n\t\t\t\t\tthis.vScrollBar);\r\n\t\t\t\t\t\r\n\t\t\t\tthis.scrollBar.on(\"scroll\", lang.hitch(this, this._scrollBar_onScroll));\r\n\t\t\t\tthis._viewHandles.push(\r\n\t\t\t\t\ton(this.scrollContainer, mouse.wheel,  \r\n\t\t\t\t\t\tdojo.hitch(this, this._mouseWheelScrollHander)));\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\tpostscript: function(){\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\tthis._initialized = true;\r\n\t\t\tif(!this.invalidRendering){\r\n\t\t\t\tthis.refreshRendering();\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t_setVerticalRendererAttr: function(value){\r\n\t\t\tthis._destroyRenderersByKind(\"vertical\");\r\n\t\t\tthis._set(\"verticalRenderer\", value);\t\r\n\t\t},\r\n\t\t\t\t\r\n\t\t_createRenderData: function(){\r\n\t\t\t\r\n\t\t\tvar rd = {};\r\n\t\t\t\t\t\t\r\n\t\t\trd.daySize = this.get(\"daySize\");\t\t\t\t\r\n\t\t\trd.scrollbarWidth = metrics.getScrollbar().w + 1;\r\n\t\t\t\t\t\r\n\t\t\trd.dateLocaleModule = this.dateLocaleModule;\r\n\t\t\trd.dateClassObj = this.dateClassObj;\r\n\t\t\trd.dateModule = this.dateModule; // arithmetics on Dates\r\n\t\t\t\r\n\t\t\trd.dates = [];\r\n\t\t\t\t\t\t\r\n\t\t\trd.columnCount = this.get(\"columnCount\");\r\n\r\n\t\t\tvar d = this.get(\"startDate\");\r\n\t\t\r\n\t\t\tif (d == null){\r\n\t\t\t\td = new rd.dateClassObj();\r\n\t\t\t}\r\n\r\n\t\t\td = this.floorToMonth(d, false, rd);\r\n\t\t\t\r\n\t\t\tthis.startDate = d;\r\n\t\t\tvar currentMonth = d.getMonth();\r\n\t\t\tvar maxDayCount = 0;\t\t\t\r\n\t\t\t\r\n\t\t\tfor(var col = 0; col < rd.columnCount ; col++){\r\n\t\t\t\t\r\n\t\t\t\tvar dates = [];\r\n\t\t\t\trd.dates.push(dates);\r\n\t\t\t\t\r\n\t\t\t\twhile(d.getMonth() == currentMonth){\t\t\t\t\t\t\t\r\n\t\t\t\t\tdates.push(d);\r\n\t\t\t\t\td = this.addAndFloor(d, \"day\", 1);\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tcurrentMonth = d.getMonth();\r\n\t\t\t\t\r\n\t\t\t\tif(maxDayCount < dates.length){\r\n\t\t\t\t\tmaxDayCount = dates.length;\r\n\t\t\t\t}\t\t\t\t\t\t\r\n\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\trd.startTime = new rd.dateClassObj(rd.dates[0][0]);\t\t\t\r\n\t\t\trd.endTime = new rd.dateClassObj(dates[dates.length-1]);\r\n\t\t\trd.endTime = rd.dateModule.add(rd.endTime, \"day\", 1);\r\n\t\t\t\t\t\t\r\n\t\t\trd.maxDayCount = maxDayCount;\r\n\t\t\trd.sheetHeight = rd.daySize * maxDayCount;\r\n\t\t\t\r\n\t\t\tif(this.displayedItemsInvalidated && !this._isEditing){\r\n\t\t\t\tthis.displayedItemsInvalidated = false;\r\n\t\t\t\tthis._computeVisibleItems(rd);\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t}else if (this.renderData){\r\n\t\t\t\trd.items = this.renderData.items;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(this.displayedDecorationItemsInvalidated){\r\n\t\t\t\t // while editing in no live layout we must not to recompute items (duplicate renderers)\r\n\t\t\t\trd.decorationItems = this.decorationStoreManager._computeVisibleItems(rd);\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t}else if (this.renderData){\r\n\t\t\t\trd.decorationItems = this.renderData.decorationItems;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn rd;\r\n\t\t},\r\n\t\t\r\n\t\t_validateProperties: function() {\r\n\t\t\t\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\t\t\t\t\r\n\t\t\tif (this.columnCount<1 || isNaN(this.columnCount)){\r\n\t\t\t\tthis.columnCount = 1;\t\t\t\t\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(this.daySize<5 || isNaN(this.daySize)){\r\n\t\t\t\tthis.daySize = 5;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t},\r\n\t\t\r\n\t\t_setStartDateAttr: function(value){\r\n\t\t\tthis.displayedItemsInvalidated = true;\t\t\t\r\n\t\t\tthis._set(\"startDate\", value);\r\n\t\t},\r\n\t\t\r\n\t\t_setColumnCountAttr: function(value){\t\t\t\r\n\t\t\tthis.displayedItemsInvalidated = true;\r\n\t\t\tthis._set(\"columnCount\", value);\r\n\t\t},\r\n\t\t\r\n\t\t__fixEvt:function(e){\r\n\t\t\te.sheet = \"primary\";\r\n\t\t\te.source = this;\r\n\t\t\treturn e;\r\n\t\t},\r\n\t\t\r\n\t\t//////////////////////////////////////////\r\n\t\t//\r\n\t\t// Formatting functions\r\n\t\t//\r\n\t\t//////////////////////////////////////////\r\n\t\t\r\n\t\t_formatColumnHeaderLabel: function(/*Date*/d){\t\t\t\r\n\t\t\t// summary:\r\n\t\t\t//\t\tComputes the column header label for the specified date.\r\n\t\t\t// d: Date\r\n\t\t\t//\t\tThe date to format\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\r\n\t\t\t\r\n\t\t\tvar len = \"wide\";\r\n\t\t\t\r\n\t\t\tif(this.columnHeaderFormatLength){\r\n\t\t\t\tlen = this.columnHeaderFormatLength;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar months = this.renderData.dateLocaleModule.getNames(\"months\", len, \"standAlone\");\r\n\t\t\t\r\n\t\t\treturn months[d.getMonth()];\r\n\t\t},\r\n\t\t\r\n\t\t// gridCellDatePattern: String\r\n\t\t//\t\tCustom date/time pattern for cell labels to override default one coming from the CLDR.\r\n\t\t//\t\tSee dojo/date/locale documentation for format string.\r\n\t\tgridCellDatePattern: null,\r\n\t\t\r\n\t\t_formatGridCellLabel: function(d, row, col){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tComputes the column header label for the specified date.\r\n\t\t\t//\t\tBy default a formatter is used, optionally the <code>gridCellDatePattern</code> \r\n\t\t\t//\t\tproperty can be used to set a custom date pattern to the formatter.\r\n\t\t\t// d: Date\r\n\t\t\t//\t\tThe date to format.\r\n\t\t\t// row: Integer\r\n\t\t\t//\t\tThe row that displays the current date.\r\n\t\t\t// col: Integer\r\n\t\t\t//\t\tThe column that displays the current date.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\r\n\r\n\t\t\tvar format, rb;\r\n\t\t\t\r\n\t\t\tif(d == null){\r\n\t\t\t\treturn \"\";\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(this.gridCellPattern){\r\n\t\t\t\treturn this.renderData.dateLocaleModule.format(d, {\r\n\t\t\t\t\tselector: 'date',\r\n\t\t\t\t\tdatePattern: this.gridCellDatePattern\r\n\t\t\t\t});\r\n\t\t\t}else{\r\n\t\t\t\trb = i18n.getLocalization(\"dojo.cldr\", this._calendar);\r\n\t\t\t\tformat = rb[\"dateFormatItem-d\"];\r\n\t\t\t\r\n\t\t\t\tvar days = this.renderData.dateLocaleModule.getNames(\"days\", \"abbr\", \"standAlone\");\r\n\t\t\t\t\t\r\n\t\t\t\treturn days[d.getDay()].substring(0, 1) + \" \" + this.renderData.dateLocaleModule.format(d, {\r\n\t\t\t\t\tselector: 'date',\r\n\t\t\t\t\tdatePattern: format\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t//////////////////////////////////////////\r\n\t\t//\r\n\t\t// Time of day management\r\n\t\t//\r\n\t\t//////////////////////////////////////////\r\n\t\t\r\n\t\t// scrollPosition: Integer\r\n\t\t//\t\tThe scroll position of the view. \r\n\t\tscrollPosition: null,\r\n\t\t\t\t\r\n\t\t// scrollBarRTLPosition: String\r\n\t\t//\t\tPosition of the scroll bar in right-to-left display.\r\n\t\t//\t\tValid values are \"left\" and \"right\", default value is \"left\".\r\n\t\tscrollBarRTLPosition: \"left\",\r\n\t\t\t\t\t\r\n\t\t_setScrollPositionAttr: function(value){\r\n\t\t\tthis._setScrollPosition(value.date, value.duration, value.easing);\r\n\t\t},\r\n\t\t\r\n\t\t_getScrollPositionAttr: function(){\r\n\t\t\treturn {date: (this.scrollContainer.scrollTop / this.daySize) + 1};\r\n\t\t},\r\n\t\t\r\n\t\t_setScrollPosition: function(date, maxDuration, easing){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\t\r\n\t\t\tif(date < 1){\r\n\t\t\t\tdate = 1;\r\n\t\t\t}else if(date>31){\r\n\t\t\t\tdate = 31;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar position = (date-1) * this.daySize;\r\n\t\t\t\r\n\t\t\tif(maxDuration) {\r\n\t\t\t\t\r\n\t\t\t\tif(this._scrollAnimation){\r\n\t\t\t\t\tthis._scrollAnimation.stop();\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tvar duration = Math.abs(((position - this.scrollContainer.scrollTop) * maxDuration) / this.renderData.sheetHeight);\r\n\t\t\t\t\r\n\t\t\t\tthis._scrollAnimation = new fx.Animation({\r\n\t\t\t\t\tcurve: [this.scrollContainer.scrollTop, position],\r\n\t\t\t\t\tduration: duration,\r\n\t\t\t\t\teasing: easing,\r\n\t\t\t\t\tonAnimate: lang.hitch(this, function(position) {\r\n\t\t\t\t\t\tthis._setScrollImpl(position);\r\n\t\t\t\t\t})\r\n\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\tthis._scrollAnimation.play();\r\n\r\n\t\t\t}else{\r\n\t\t\t\tthis._setScrollImpl(position);\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t_setScrollImpl: function(v){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\t\r\n\t\t\tthis.scrollContainer.scrollTop = v;\r\n\t\t\tif(this.scrollBar){\r\n\t\t\t\tthis.scrollBar.set(\"value\", v);\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\tensureVisibility: function(start, end, visibilityTarget, margin, duration){\r\n\t\t\t\r\n\t\t\t// summary:\r\n\t\t\t//\t\tScrolls the view if the [start, end] time range is not visible or only partially visible.\r\n\t\t\t// start: Date\r\n\t\t\t//\t\tStart time of the range of interest.\r\n\t\t\t// end: Date\r\n\t\t\t//\t\tEnd time of the range of interest.\r\n\t\t\t// margin: Integer\r\n\t\t\t//\t\tMargin in minutes around the time range.\r\n\t\t\t// visibilityTarget: String\r\n\t\t\t//\t\tThe end(s) of the time range to make visible.\r\n\t\t\t//\t\tValid values are: \"start\", \"end\", \"both\".\t\r\n\t\t\t// duration: Number\r\n\t\t\t//\t\tOptional, the maximum duration of the scroll animation.\r\n\t\t\t\r\n\t\t\tmargin = margin == undefined ? 1 : margin;\r\n\t\t\t\r\n\t\t\tif(this.scrollable && this.autoScroll){\r\n\t\t\t\t\t\t\t\r\n\t\t\t\tvar s = start.getDate() - margin; // -1 because day of months starts at 1 and not 0\r\n\t\t\t\tif(this.isStartOfDay(end)){\r\n\t\t\t\t\tend = this._waDojoxAddIssue(end, \"day\", -1);\r\n\t\t\t\t}\r\n\t\t\t\tvar e = end.getDate() + margin;\r\n\t\t\t\t\r\n\t\t\t\tvar viewStart = this.get(\"scrollPosition\").date;\r\n\t\t\t\tvar r = domGeometry.getContentBox(this.scrollContainer);\r\n\t\t\t\tvar viewEnd = (this.get(\"scrollPosition\").date + (r.h/this.daySize)); \r\n\t\t\t\t\r\n\t\t\t\tvar visible = false;\r\n\t\t\t\tvar target = null;\r\n\t\t\t\t\r\n\t\t\t\tswitch(visibilityTarget){\r\n\t\t\t\t\tcase \"start\":\r\n\t\t\t\t\t\tvisible = s >= viewStart && s <= viewEnd;\r\n\t\t\t\t\t\ttarget = s ;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"end\":\r\n\t\t\t\t\t\tvisible = e >= viewStart && e <= viewEnd;\r\n\t\t\t\t\t\ttarget = e - (viewEnd - viewStart);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"both\":\r\n\t\t\t\t\t\tvisible = s >= viewStart && e <= viewEnd;\r\n\t\t\t\t\t\ttarget = s;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif(!visible){\r\n\t\t\t\t\tthis._setScrollPosition(target, duration);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\tscrollView: function(dir){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tScrolls the view to the specified direction of one time slot duration.\r\n\t\t\t// dir: Integer\r\n\t\t\t//\t\tDirection of the scroll. Valid values are -1 and 1.\r\n\t\t\t//\r\n\t\t\tvar pos = this.get(\"scrollPosition\").date + dir;\r\n\t\t\tthis._setScrollPosition(pos);\r\n\t\t},\r\n\t\t\r\n\t\t_mouseWheelScrollHander: function(e){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tMouse wheel handler.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\r\n\t\t\tthis.scrollView(e.wheelDelta > 0 ? -1 : 1);\r\n\t\t},\t\t\r\n\t\t\r\n\t\t//////////////////////////////////////////\r\n\t\t//\r\n\t\t// HTML structure management\r\n\t\t//\r\n\t\t//////////////////////////////////////////\t\t\r\n\t\r\n\t\trefreshRendering: function(){\r\n\t\t\tif(!this._initialized){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\tthis._validateProperties();\r\n\r\n\t\t\tvar oldRd = this.renderData;\r\n\t\t\tvar rd = this.renderData = this._createRenderData();\r\n\r\n\t\t\tthis._createRendering(rd, oldRd);\r\n\t\t\tthis._layoutDecorationRenderers(rd);\r\n\t\t\tthis._layoutRenderers(rd);\r\n\t\t},\r\n\t\t\r\n\t\t_createRendering: function(/*Object*/renderData, /*Object*/oldRenderData){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\tdomStyle.set(this.sheetContainer, \"height\", renderData.sheetHeight + \"px\");\r\n\t\t\t// padding for the scroll bar.\r\n\t\t\tthis._configureScrollBar(renderData);\r\n\t\t\tthis._buildColumnHeader(renderData, oldRenderData);\t\t\t\r\n\t\t\tthis._buildGrid(renderData, oldRenderData);\r\n\t\t\tthis._buildItemContainer(renderData, oldRenderData);\r\n\t\t},\r\n\t\t\r\n\t\t_configureScrollBar: function(renderData){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tSets the scroll bar size and position.\r\n\t\t\t// renderData: Object\r\n\t\t\t//\t\tThe render data.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\r\n\t\t\t\r\n\t\t\tif(has(\"ie\") && this.scrollBar){\r\n\t\t\t\tdomStyle.set(this.scrollBar.domNode, \"width\", (renderData.scrollbarWidth + 1) + \"px\");\r\n\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\tvar atRight = this.isLeftToRight() ? true : this.scrollBarRTLPosition == \"right\";\r\n\t\t\tvar rPos = atRight ? \"right\" : \"left\";\r\n\t\t\tvar lPos = atRight? \"left\" : \"right\";\r\n\t\t\t\r\n\t\t\tif(this.scrollBar){\r\n\t\t\t\tthis.scrollBar.set(\"maximum\", renderData.sheetHeight);\t\t\t\r\n\t\t\t\tdomStyle.set(this.scrollBar.domNode, rPos, 0);\r\n\t\t\t\tdomStyle.set(this.scrollBar.domNode, lPos, \"auto\");\r\n\t\t\t}\r\n\t\t\tdomStyle.set(this.scrollContainer, rPos, renderData.scrollbarWidth + \"px\");\r\n\t\t\tdomStyle.set(this.scrollContainer, lPos, \"0\");\r\n\t\t\tdomStyle.set(this.columnHeader, rPos, renderData.scrollbarWidth + \"px\");\r\n\t\t\tdomStyle.set(this.columnHeader, lPos, \"0\");\r\n\t\t\tif(this.buttonContainer && this.owner != null && this.owner.currentView == this){\r\n\t\t\t\tdomStyle.set(this.buttonContainer, rPos, renderData.scrollbarWidth + \"px\");\r\n\t\t\t\tdomStyle.set(this.buttonContainer, lPos, \"0\");\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t_columnHeaderClick: function(e){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\tevent.stop(e);\r\n\t\t\tvar index = query(\"td\", this.columnHeaderTable).indexOf(e.currentTarget);\r\n\t\t\tthis._onColumnHeaderClick({\r\n\t\t\t\tindex: index,\r\n\t\t\t\tdate: this.renderData.dates[index][0],\r\n\t\t\t\ttriggerEvent: e\r\n\t\t\t});\t\t\t\t\t\t\r\n\t\t},\r\n\t\t\r\n\t\t_buildColumnHeader: function(renderData, oldRenderData){\t\t\t\t\r\n\t\t\t// summary:\r\n\t\t\t//\t\tCreates incrementally the HTML structure of the column header and configures its content.\r\n\t\t\t//\r\n\t\t\t// renderData:\r\n\t\t\t//\t\tThe render data to display.\r\n\t\t\t//\r\n\t\t\t// oldRenderData:\r\n\t\t\t//\t\tThe previously render data displayed, if any.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\r\n\t\t\tvar table = this.columnHeaderTable;\r\n\t\t\t\r\n\t\t\tif (!table){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\tvar count = renderData.columnCount - (oldRenderData ? oldRenderData.columnCount : 0);\r\n\t\t\t\r\n\t\t\tif(has(\"ie\") == 8){\r\n\t\t\t\t// workaround Internet Explorer 8 bug.\r\n\t\t\t\t// if on the table, width: 100% and table-layout: fixed are set\r\n\t\t\t\t// and columns are removed, width of remaining columns is not \r\n\t\t\t\t// recomputed: must rebuild all. \r\n\t\t\t\tif(this._colTableSave == null){\r\n\t\t\t\t\tthis._colTableSave = lang.clone(table);\r\n\t\t\t\t}else if(count < 0){\r\n\t\t\t\t\tthis._cleanupColumnHeader();\r\n\t\t\t\t\tthis.columnHeader.removeChild(table);\r\n\t\t\t\t\tdomConstruct.destroy(table);\r\n\t\t\t\t\ttable = lang.clone(this._colTableSave);\r\n\t\t\t\t\tthis.columnHeaderTable = table;\r\n\t\t\t\t\tthis.columnHeader.appendChild(table);\r\n\t\t\t\t\tcount = renderData.columnCount;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t} // else incremental dom add/remove for real browsers.\r\n\t\t\t\t\t\r\n\t\t\tvar tbodies = query(\"tbody\", table);\r\n\t\t\t\r\n\t\t\tvar trs = query(\"tr\", table);\r\n\t\t\tvar tbody, tr, td;\r\n\t\t\t\r\n\t\t\tif (tbodies.length == 1){\r\n\t\t\t\ttbody = tbodies[0];\r\n\t\t\t}else{ \r\n\t\t\t\ttbody = html.create(\"tbody\", null, table);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (trs.length == 1){\r\n\t\t\t\ttr = trs[0];\r\n\t\t\t}else{ \r\n\t\t\t\ttr = domConstruct.create(\"tr\", null, tbody);\r\n\t\t\t}\r\n\t\t\t\t\t\t \r\n\t\t\t// Build HTML structure (incremental)\r\n\t\t\tif(count > 0){ // creation\t\t\t\t\r\n\t\t\t\tfor(var i=0; i < count; i++){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\ttd = domConstruct.create(\"td\", null, tr);\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar h = [];\r\n\t\t\t\t\th.push(on(td, \"click\", lang.hitch(this, this._columnHeaderClick)));\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\tif(has(\"touch-events\")){\r\n\t\t\t\t\t\th.push(on(td, \"touchstart\", function(e){\r\n\t\t\t\t\t\t\tevent.stop(e);\r\n\t\t\t\t\t\t\tdomClass.add(e.currentTarget, \"Active\");\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\th.push(on(td, \"touchend\", function(e){\t\t\t\r\n\t\t\t\t\t\t\tevent.stop(e);\t\t\t\r\n\t\t\t\t\t\t\tdomClass.remove(e.currentTarget, \"Active\");\t\t\t\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\th.push(on(td, \"mousedown\", function(e){\r\n\t\t\t\t\t\t\tevent.stop(e);\r\n\t\t\t\t\t\t\tdomClass.add(e.currentTarget, \"Active\");\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\th.push(on(td, \"mouseup\", function(e){\r\n\t\t\t\t\t\t\tevent.stop(e);\r\n\t\t\t\t\t\t\tdomClass.remove(e.currentTarget, \"Active\");\r\n\t\t\t\t\t\t}));\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\th.push(on(td, \"mouseover\", function(e){\r\n\t\t\t\t\t\t\tevent.stop(e);\r\n\t\t\t\t\t\t\tdomClass.add(e.currentTarget, \"Hover\");\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\th.push(on(td, \"mouseout\", function(e){\r\n\t\t\t\t\t\t\tevent.stop(e);\r\n\t\t\t\t\t\t\tdomClass.remove(e.currentTarget, \"Hover\");\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis._columnHeaderHandlers.push(h);\t\t\t\t\t \r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}else{ // deletion\r\n\t\t\t\tcount = -count;\r\n\t\t\t\tfor(var i=0; i < count; i++){\r\n\t\t\t\t\ttd = tr.lastChild;\r\n\t\t\t\t\ttr.removeChild(td);\r\n\t\t\t\t\tdomConstruct.destroy(td);\r\n\t\t\t\t\tvar list = this._columnHeaderHandlers.pop();\r\n\t\t\t\t\twhile(list.length>0){\r\n\t\t\t\t\t\tlist.pop().remove();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// fill & configure\t\t\r\n\t\t\tquery(\"td\", table).forEach(function(td, i){\r\n\t\t\t\ttd.className = \"\";\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\tif(i == 0){\r\n\t\t\t\t\tdomClass.add(td, \"first-child\");\r\n\t\t\t\t}else if(i == this.renderData.columnCount-1){\r\n\t\t\t\t\tdomClass.add(td, \"last-child\");\r\n\t\t\t\t}\r\n\t\t\t\tvar d = renderData.dates[i][0];\r\n\t\t\t\tthis._setText(td, this._formatColumnHeaderLabel(d));\r\n\t\t\t\tthis.styleColumnHeaderCell(td, d, renderData);\t\t\t\t\t\t\r\n\t\t\t}, this);\r\n\t\t\t\t\t\t\r\n\t\t},\r\n\t\t\r\n\t\t_cleanupColumnHeader: function(){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\twhile(this._columnHeaderHandlers.length > 0){\r\n\t\t\t\tvar list = this._columnHeaderHandlers.pop();\r\n\t\t\t\twhile(list.length > 0){\r\n\t\t\t\t\tlist.pop().remove();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\tstyleColumnHeaderCell: function(node, date, renderData){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tStyles the CSS classes to the node that displays a column header cell.\r\n\t\t\t//\t\tBy default this method is does nothing and is designed to be overridden.\r\n\t\t\t// node: Node\r\n\t\t\t//\t\tThe DOM node that displays the column in the grid.\r\n\t\t\t// date: Date\r\n\t\t\t//\t\tThe date displayed by this column\r\n\t\t\t// renderData: Object\t\t\t\r\n\t\t\t//\t\tThe render data.\t\t\t\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\r\n\r\n\t\t},\r\n\t\t\r\n\t\t_buildGrid: function (renderData, oldRenderData){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tCreates incrementally the HTML structure of the grid and configures its content.\r\n\t\t\t//\r\n\t\t\t// renderData:\r\n\t\t\t//\t\tThe render data to display.\r\n\t\t\t//\r\n\t\t\t// oldRenderData:\r\n\t\t\t//\t\tThe previously render data displayed, if any.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\r\n\t\t\tvar table = this.gridTable;\r\n\t\t\t\r\n\t\t\tif(!table){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tdomStyle.set(table, \"height\", renderData.sheetHeight + \"px\");\t\t\t\t\r\n\r\n\t\t\tvar rowDiff = renderData.maxDayCount - (oldRenderData ? oldRenderData.maxDayCount : 0);\r\n\t\t\tvar addRows = rowDiff > 0;\r\n\t\t\t\r\n\t\t\tvar colDiff  = renderData.columnCount - (oldRenderData ? oldRenderData.columnCount : 0);\r\n\t\t\t\r\n\t\t\tif(has(\"ie\") == 8){\r\n\t\t\t\t// workaround Internet Explorer 8 bug.\r\n\t\t\t\t// if on the table, width: 100% and table-layout: fixed are set\r\n\t\t\t\t// and columns are removed, width of remaining columns is not \r\n\t\t\t\t// recomputed: must rebuild all. \r\n\t\t\t\tif(this._gridTableSave == null){\r\n\t\t\t\t\tthis._gridTableSave = lang.clone(table);\r\n\t\t\t\t}else if(colDiff < 0){\t\t\t\t\t\r\n\t\t\t\t\tthis.grid.removeChild(table);\r\n\t\t\t\t\tdomConstruct.destroy(table);\r\n\t\t\t\t\ttable = lang.clone(this._gridTableSave);\r\n\t\t\t\t\tthis.gridTable = table;\r\n\t\t\t\t\tthis.grid.appendChild(table);\r\n\t\t\t\t\tcolDiff = renderData.columnCount;\r\n\t\t\t\t\trowDiff = renderData.maxDayCount;\r\n\t\t\t\t\taddRows = true;\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar tbodies = query(\"tbody\", table);\r\n\t\t\tvar tbody;\r\n\r\n\t\t\tif(tbodies.length == 1){\r\n\t\t\t\ttbody = tbodies[0];\r\n\t\t\t}else{ \r\n\t\t\t\ttbody = domConstruct.create(\"tbody\", null, table);\r\n\t\t\t}\r\n\r\n\t\t\t// Build rows HTML structure (incremental)\r\n\t\t\tif(addRows){ // creation\r\n\t\t\t\tfor(var i=0; i<rowDiff; i++){\r\n\t\t\t\t\tdomConstruct.create(\"tr\", null, tbody);\r\n\t\t\t\t}\t\t \r\n\t\t\t}else{ // deletion\t\t \r\n\t\t\t\trowDiff = -rowDiff;\r\n\t\t\t\tfor(var i=0; i<rowDiff; i++){\r\n\t\t\t\t\ttbody.removeChild(tbody.lastChild);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar rowIndex = renderData.maxDayCount - rowDiff;\r\n\t\t\t\r\n\t\t\tvar addCols = addRows || colDiff >0; \r\n\t\t\tcolDiff = addCols ? colDiff : -colDiff;\r\n\t\t\t\r\n\t\t\tquery(\"tr\", table).forEach(function(tr, i){\r\n\t\t\t\t\r\n\t\t\t\tif(addCols){ // creation\r\n\t\t\t\t\tvar len = i >= rowIndex ? renderData.columnCount : colDiff;\r\n\t\t\t\t\tfor(var i=0; i<len; i++){\r\n\t\t\t\t\t\tvar td = domConstruct.create(\"td\", null, tr);\r\n\t\t\t\t\t\tdomConstruct.create(\"span\", null, td);\r\n\t\t\t\t\t}\r\n\t\t\t\t}else{ // deletion\r\n\t\t\t\t\tfor(var i=0; i<colDiff; i++){\r\n\t\t\t\t\t\ttr.removeChild(tr.lastChild);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t// Set the CSS classes\r\n\r\n\t\t\tquery(\"tr\", table).forEach(function (tr, row){\r\n\t\t\t\t\r\n\t\t\t\ttr.className = \"\";\r\n\t\t\t\t// compatibility layer for IE7 & 8 that does not support :first-child and :last-child pseudo selectors\r\n\t\t\t\tif(row == 0){\r\n\t\t\t\t\tdomClass.add(tr, \"first-child\");\r\n\t\t\t\t}\r\n\t\t\t\tif(row == renderData.maxDayCount-1){\r\n\t\t\t\t\tdomClass.add(tr, \"last-child\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tquery(\"td\", tr).forEach(function (td, col){\r\n\t\t\t\t\t\r\n\t\t\t\t\ttd.className = \"\";\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(col == 0){\r\n\t\t\t\t\t\tdomClass.add(td, \"first-child\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(col == renderData.columnCount-1){\r\n\t\t\t\t\t\tdomClass.add(td, \"last-child\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar d = null;\r\n\t\t\t\t\tif(row < renderData.dates[col].length) {\r\n\t\t\t\t\t\td = renderData.dates[col][row];\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar span = query(\"span\", td)[0];\r\n\t\t\t\t\tthis._setText(span, this.showCellLabel ? this._formatGridCellLabel(d, row, col): null);\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis.styleGridCell(td, d, col, row, renderData);\r\n\t\t\t\t\t\r\n\t\t\t\t}, this);\r\n\t\t\t}, this); \r\n\r\n\t\t},\r\n\t\t\r\n\t\t// styleGridCellFunc: Function\r\n\t\t//\t\tCustom function to customize the appearance of a grid cell by installing custom CSS class on the node.\r\n\t\t//\t\tThe signature of the function must be the same then the styleGridCell one.\r\n\t\t//\t\tBy default the defaultStyleGridCell function is used.\r\n\t\tstyleGridCellFunc: null,\r\n\t\t\r\n\t\tdefaultStyleGridCell: function(node, date, col, row, renderData){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tStyles the CSS classes to the node that displays a column.\r\n\t\t\t//\t\tBy default this method is setting the following CSS classes:\r\n\t\t\t//\t\t- \"dojoxCalendarToday\" class name if the date displayed is the current date,\r\n\t\t\t//\t\t- \"dojoxCalendarWeekend\" if the date represents a weekend,\r\n\t\t\t//\t\t- the CSS class corresponding of the displayed day of week (\"Sun\", \"Mon\" and so on),\r\n\t\t\t// node: Node\r\n\t\t\t//\t\tThe DOM node that displays the cell in the grid.\r\n\t\t\t// date: Date\r\n\t\t\t//\t\tThe date displayed by this cell.\r\n\t\t\t// col: Integer\r\n\t\t\t//\t\tThe column index of this cell.\r\n\t\t\t// row: Integer\r\n\t\t\t//\t\tThe row index of this cell.\r\n\t\t\t// renderData: Object\r\n\t\t\t//\t\tThe render data.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\r\n\t\t\t\r\n\t\t\tif(date == null){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tdomClass.add(node, this._cssDays[date.getDay()]);\r\n\t\t\tif(this.isToday(date)){\t\t\t\t\r\n\t\t\t\tdomClass.add(node, \"dojoxCalendarToday\");\r\n\t\t\t}else if(this.isWeekEnd(date)){\r\n\t\t\t\tdomClass.add(node, \"dojoxCalendarWeekend\");\r\n\t\t\t}\t\t\t\t\t\r\n\t\t},\r\n\t\t\r\n\t\tstyleGridCell: function(node, date, col, row, renderData){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tStyles the CSS classes to the node that displays a column.\r\n\t\t\t//\t\tDelegates to styleGridCellFunc if defined or defaultStyleGridCell otherwise.\r\n\t\t\t// node: Node\r\n\t\t\t//\t\tThe DOM node that displays the cell in the grid.\r\n\t\t\t// date: Date\r\n\t\t\t//\t\tThe date displayed by this cell.\r\n\t\t\t// col: Integer\r\n\t\t\t//\t\tThe column index of this cell.\r\n\t\t\t// row: Integer\r\n\t\t\t//\t\tThe row index of this cell.\r\n\t\t\t// renderData: Object\r\n\t\t\t//\t\tThe render data.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\r\n\r\n\t\t\tif(this.styleGridCellFunc){\r\n\t\t\t\tthis.styleGridCellFunc(node, date, col, row, renderData);\r\n\t\t\t}else{\r\n\t\t\t\tthis.defaultStyleGridCell(node, date, col, row, renderData);\r\n\t\t\t}\t\t\t\t\r\n\t\t},\r\n\t\t\t\t\t\t\t\r\n\t\t_buildItemContainer: function(renderData, oldRenderData){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tCreates the HTML structure of the item container and configures its content.\r\n\t\t\t// renderData:\r\n\t\t\t//\t\tThe render data to display.\r\n\t\t\t// oldRenderData:\r\n\t\t\t//\t\tThe previously render data displayed, if any.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\t\r\n\t\t\tvar table = this.itemContainerTable;\r\n\t\t\t\r\n\t\t\tif (!table){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar bgCols = [];\r\n\t\r\n\t\t\tdomStyle.set(table, \"height\", renderData.sheetHeight + \"px\");\t\t\t\r\n\t\t\t\r\n\t\t\tvar count = renderData.columnCount - (oldRenderData ? oldRenderData.columnCount : 0);\r\n\t\t\t\r\n\t\t\tif(has(\"ie\") == 8){\r\n\t\t\t\t// workaround Internet Explorer 8 bug.\r\n\t\t\t\t// if on the table, width: 100% and table-layout: fixed are set\r\n\t\t\t\t// and columns are removed, width of remaining columns is not \r\n\t\t\t\t// recomputed: must rebuild all. \r\n\t\t\t\tif(this._itemTableSave == null){\r\n\t\t\t\t\tthis._itemTableSave = lang.clone(table);\r\n\t\t\t\t}else if(count < 0){\r\n\t\t\t\t\tthis.itemContainer.removeChild(table);\r\n\t\t\t\t\tthis._recycleItemRenderers(true);\r\n\t\t\t\t\tdomConstruct.destroy(table);\r\n\t\t\t\t\ttable = lang.clone(this._itemTableSave);\r\n\t\t\t\t\tthis.itemContainerTable = table;\r\n\t\t\t\t\tthis.itemContainer.appendChild(table);\r\n\t\t\t\t\tcount = renderData.columnCount;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t} // else incremental dom add/remove for real browsers.\r\n\t\t\t\r\n\t\t\tvar tbodies = query(\"tbody\", table);\r\n\t\t\tvar trs = query(\"tr\", table);\r\n\t\t\tvar tbody, tr, td;\r\n\t\t\t\r\n\t\t\tif (tbodies.length == 1){\r\n\t\t\t\ttbody = tbodies[0];\r\n\t\t\t}else{ \r\n\t\t\t\ttbody = domConstruct.create(\"tbody\", null, table);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (trs.length == 1){\r\n\t\t\t\ttr = trs[0];\r\n\t\t\t}else{ \r\n\t\t\t\ttr = domConstruct.create(\"tr\", null, tbody);\r\n\t\t\t}\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t// Build HTML structure (incremental)\r\n\t\t\tif(count>0){ // creation\r\n\t\t\t\tfor(var i=0; i < count; i++){\r\n\t\t\t\t\ttd = domConstruct.create(\"td\", null, tr);\t\r\n\t\t\t\t\tdomConstruct.create(\"div\", {\"className\": \"dojoxCalendarContainerColumn\"}, td);\r\n\t\t\t\t}\r\n\t\t\t}else{ // deletion\t\t \r\n\t\t\t\tcount = -count;\r\n\t\t\t\tfor(var i=0; i < count; i++){\r\n\t\t\t\t\ttr.removeChild(tr.lastChild);\r\n\t\t\t\t}\r\n\t\t\t}\t\r\n\t\t\t\r\n\t\t\tquery(\"td>div\", table).forEach(function(div, i){\r\n\r\n\t\t\t\tdomStyle.set(div, {\r\n\t\t\t\t\t\"height\": renderData.sheetHeight + \"px\"\r\n\t\t\t\t});\r\n\t\t\t\tbgCols.push(div);\t\t\r\n\t\t\t}, this);\r\n\t\t\t\r\n\t\t\trenderData.cells = bgCols;\r\n\t\t},\t\t\t\r\n\t\t\r\n\t\t///////////////////////////////////////////////////////////////\r\n\t\t//\r\n\t\t// Layout\r\n\t\t//\r\n\t\t///////////////////////////////////////////////////////////////\r\n\t\t\r\n\t\t_overlapLayoutPass2: function(lanes){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tSecond pass of the overlap layout (optional). Compute the extent of each layout item.\r\n\t\t\t// lanes:\r\n\t\t\t//\t\tThe array of lanes.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\tvar i,j,lane, layoutItem;\r\n\t\t\t// last lane, no extent possible\r\n\t\t\tlane = lanes[lanes.length-1];\r\n\t\t\t\r\n\t\t\tfor(j = 0; j < lane.length; j++){\r\n\t\t\t\tlane[j].extent = 1;\r\n\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\tfor(i=0; i<lanes.length-1; i++){\r\n\t\t\t\tlane = lanes[i];\r\n\t\t\t\t\r\n\t\t\t\tfor(var j=0; j<lane.length; j++){\t \r\n\t\t\t\t\tlayoutItem = lane[j];\r\n\t\t\t\t\t\r\n\t\t\t\t\t// if item was already overlapping another one there is no extent possible.\r\n\t\t\t\t\tif(layoutItem.extent == -1){\r\n\t\t\t\t\t\tlayoutItem.extent = 1;\r\n\t\t\t\t\t\tvar space = 0;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tvar stop = false;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tfor(var k = i + 1; k < lanes.length && !stop; k++){\r\n\t\t\t\t\t\t\tvar ccol = lanes[k];\r\n\t\t\t\t\t\t\tfor(var l = 0; l < ccol.length && !stop; l++){\r\n\t\t\t\t\t\t\t\tvar layoutItem2 = ccol[l];\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tif(layoutItem.start < layoutItem2.end && layoutItem2.start < layoutItem.end){\r\n\t\t\t\t\t\t\t\t\tstop = true;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(!stop){\r\n\t\t\t\t\t\t\t\t//no hit in the entire lane\r\n\t\t\t\t\t\t\t\tspace++;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tlayoutItem.extent += space;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t_defaultItemToRendererKindFunc: function(item){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\tif(item.allDay){\r\n\t\t\t\treturn \"vertical\";\r\n\t\t\t}\r\n\t\t\tvar dur = Math.abs(this.renderData.dateModule.difference(item.startTime, item.endTime, \"minute\"));\r\n\t\t\treturn dur >= 1440 ? \"vertical\" : null;\r\n\t\t},\r\n\t\t\r\n\t\t_layoutRenderers: function(renderData){\r\n\t\t\tthis.hiddenEvents = {};\r\n\t\t\tthis.inherited(arguments);\r\n\t\t},\r\n\t\t\r\n\t\t_layoutInterval: function(/*Object*/renderData, /*Integer*/index, /*Date*/start, /*Date*/end, /*Object[]*/items, /*String*/itemsType){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\tvar verticalItems = [];\r\n\t\t\tvar hiddenItems = [];\r\n\t\t\trenderData.colW = this.itemContainer.offsetWidth / renderData.columnCount;\r\n\t\t\t\r\n\t\t\tif(itemsType === \"dataItems\"){\r\n\t\t\t\r\n\t\t\t\tfor(var i=0; i<items.length; i++){\r\n\t\t\t\t\tvar item = items[i];\r\n\t\t\t\t\tif(this._itemToRendererKind(item) == \"vertical\"){\r\n\t\t\t\t\t\tverticalItems.push(item);\r\n\t\t\t\t\t}else if(this.showHiddenItems){\t\r\n\t\t\t\t\t\thiddenItems.push(item);\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif(verticalItems.length > 0){\r\n\t\t\t\t\tthis._layoutVerticalItems(renderData, index, start, end, verticalItems, itemsType);\r\n\t\t\t\t}\r\n\t\t\t\tif(hiddenItems.length > 0){\r\n\t\t\t\t\tthis._layoutBgItems(renderData, index, start, end, hiddenItems);\r\n\t\t\t\t}\r\n\t\t\t}else{ // itemsType === \"decorationItems\"\r\n\t\t\t\tthis._layoutVerticalItems(renderData, index, start, end, items, itemsType);\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t_dateToYCoordinate: function(renderData, d, start){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\tvar pos = 0;\r\n\t\t\tif(start || d.getHours() != 0 || d.getMinutes() != 0){\r\n\t\t\t\tpos = (d.getDate()-1) * this.renderData.daySize;\r\n\t\t\t}else{\r\n\t\t\t\tvar d2 = this._waDojoxAddIssue(d, \"day\", -1);\r\n\t\t\t\tpos = this.renderData.daySize + ((d2.getDate()-1) * this.renderData.daySize);\r\n\t\t\t}\t\t\t \r\n\t\t\tpos += (d.getHours()*60+d.getMinutes())*this.renderData.daySize/1440;\r\n\t\t\t\r\n\t\t\treturn pos;\r\n\t\t},\r\n\t\t\r\n\t\t_layoutVerticalItems: function(/*Object*/renderData, /*Integer*/index, /*Date*/startTime, /*Date*/endTime, /*Object[]*/items, /*String*/itemsType){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\tif(this.verticalRenderer == null){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar cell = renderData.cells[index];\r\n\t\t\tvar layoutItems = [];\t\t\t\r\n\t\t\t\r\n\t\t\t// step 1 compute projected position and size\r\n\t\t\tfor(var i = 0; i < items.length; i++){\r\n\t\t\t\t\r\n\t\t\t\tvar item = items[i];\r\n\t\t\t\tvar overlap = this.computeRangeOverlap(renderData, item.startTime, item.endTime, startTime, endTime);\r\n\t\t\t\t\r\n\t\t\t\tvar top = this._dateToYCoordinate(renderData, overlap[0], true);\r\n\t\t\t\tvar bottom = this._dateToYCoordinate(renderData, overlap[1], false);\r\n\t\t\t\t\r\n\t\t\t\tif (bottom > top){\r\n\t\t\t\t\tvar litem = lang.mixin({\r\n\t\t\t\t\t\tstart: top,\r\n\t\t\t\t\t\tend: bottom,\r\n\t\t\t\t\t\trange: overlap,\r\n\t\t\t\t\t\titem: item\r\n\t\t\t\t\t}, item);\r\n\t\t\t\t\tlayoutItems.push(litem);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t// step 2: compute overlapping layout\r\n\t\t\tvar numLanes = itemsType === \"dataItems\" ? this.computeOverlapping(layoutItems, this._overlapLayoutPass2).numLanes : 1;\r\n\r\n\t\t\tvar hOverlap = this.percentOverlap / 100;\r\n\r\n\t\t\t// step 3: create renderers and apply layout\r\n\t\t\tfor(i=0; i<layoutItems.length; i++){\r\n\r\n\t\t\t\titem = layoutItems[i];\t\t\t\t\t\r\n\t\t\t\tvar lane = item.lane;\r\n\t\t\t\tvar extent = item.extent;\r\n\r\n\t\t\t\tvar ir = null;\r\n\t\t\t\t\r\n\t\t\t\tif(itemsType === \"dataItems\"){\r\n\t\t\t\t\tvar w;\r\n\t\t\t\t\tvar posX;\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(hOverlap == 0) {\r\n\t\t\t\t\t\t//no overlap and a padding between each event\r\n\t\t\t\t\t\tw = numLanes == 1 ? renderData.colW : ((renderData.colW - (numLanes - 1) * this.horizontalGap)/ numLanes);\r\n\t\t\t\t\t\tposX = lane * (w + this.horizontalGap);\r\n\t\t\t\t\t\tw = extent == 1 ? w : w * extent + (extent-1) * this.horizontalGap;\r\n\t\t\t\t\t\tw = 100 * w / renderData.colW;\r\n\t\t\t\t\t\tposX = 100 * posX / renderData.colW; \r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// an overlap\r\n\t\t\t\t\t\tw = numLanes == 1 ? 100 : (100 / (numLanes - (numLanes - 1) * hOverlap));\r\n\t\t\t\t\t\tposX = lane * (w - hOverlap*w);\r\n\t\t\t\t\t\tw = extent == 1 ? w : w * ( extent - (extent-1) * hOverlap);\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tir = this._createRenderer(item, \"vertical\", this.verticalRenderer, \"dojoxCalendarVertical\");\r\n\t\r\n\t\t\t\t\tdomStyle.set(ir.container, {\r\n\t\t\t\t\t\t\"top\": item.start + \"px\",\r\n\t\t\t\t\t\t\"left\": posX + \"%\",\r\n\t\t\t\t\t\t\"width\": w + \"%\",\r\n\t\t\t\t\t\t\"height\": (item.end-item.start+1) + \"px\"\r\n\t\t\t\t\t});\r\n\t\r\n\t\t\t\t\tvar edited = this.isItemBeingEdited(item);\r\n\t\t\t\t\tvar selected = this.isItemSelected(item);\r\n\t\t\t\t\tvar hovered = this.isItemHovered(item);\r\n\t\t\t\t\tvar focused = this.isItemFocused(item);\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar renderer = ir.renderer;\r\n\t\r\n\t\t\t\t\trenderer.set(\"hovered\", hovered);\r\n\t\t\t\t\trenderer.set(\"selected\", selected);\r\n\t\t\t\t\trenderer.set(\"edited\", edited);\r\n\t\t\t\t\trenderer.set(\"focused\", this.showFocus ? focused : false);\r\n\t\t\t\t\t\r\n\t\t\t\t\trenderer.set(\"storeState\", this.getItemStoreState(item));\r\n\t\t\t\t\t\r\n\t\t\t\t\trenderer.set(\"moveEnabled\", this.isItemMoveEnabled(item._item, \"vertical\"));\r\n\t\t\t\t\trenderer.set(\"resizeEnabled\", this.isItemResizeEnabled(item._item, \"vertical\"));\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis.applyRendererZIndex(item, ir, hovered, selected, edited, focused);\r\n\t\r\n\t\t\t\t\tif(renderer.updateRendering){\r\n\t\t\t\t\t\trenderer.updateRendering(w, item.end-item.start+1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t}else{ //itemsType === \"decorationItems\"\r\n\r\n\t\t\t\t\tir = this.decorationRendererManager.createRenderer(item, \"vertical\", this.verticalDecorationRenderer, \"dojoxCalendarDecoration\");\r\n\t\t\t\t\t\r\n\t\t\t\t\tdomStyle.set(ir.container, {\r\n\t\t\t\t\t\t\"top\": item.start + \"px\",\r\n\t\t\t\t\t\t\"left\": \"0\",\r\n\t\t\t\t\t\t\"width\": \"100%\",\r\n\t\t\t\t\t\t\"height\": (item.end-item.start+1) + \"px\"\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdomConstruct.place(ir.container, cell);\r\n\t\t\t\tdomStyle.set(ir.container, \"display\", \"block\");\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t_getCellAt: function(rowIndex, columnIndex, rtl){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\tif((rtl == undefined || rtl == true) && !this.isLeftToRight()){\r\n\t\t\t\tcolumnIndex = this.renderData.columnCount -1 - columnIndex;\r\n\t\t\t}\r\n\t\t\treturn this.gridTable.childNodes[0].childNodes[rowIndex].childNodes[columnIndex];\r\n\t\t},\r\n\t\t\r\n\t\tinvalidateLayout: function(){\r\n\t\t\t//make sure to clear hiddens object state\r\n\t\t\tquery(\"td\", this.gridTable).forEach(function(td){\r\n\t\t\t\tdomClass.remove(td, \"dojoxCalendarHiddenEvents\");\r\n\t\t\t});\r\n\t\t\tthis.inherited(arguments);\t\t\t\r\n\t\t},\r\n\t\t\r\n\t\t_layoutBgItems: function(/*Object*/renderData, /*Integer*/col, /*Date*/startTime, /*Date*/endTime, /*Object[]*/items){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\tvar bgItems = {};\r\n\t\t\tfor(var i = 0; i < items.length; i++){\r\n\t\t\t\t\r\n\t\t\t\tvar item = items[i];\r\n\t\t\t\tvar overlap = this.computeRangeOverlap(renderData, item.startTime, item.endTime, startTime, endTime);\r\n\t\t\t\tvar start = overlap[0].getDate()-1;\r\n\t\t\t\t// handle use case where end time is first day of next month.\r\n\t\t\t\tvar end;\r\n\t\t\t\tif(this.isStartOfDay(overlap[1])){\r\n\t\t\t\t\tend = this._waDojoxAddIssue(overlap[1], \"day\", -1);\r\n\t\t\t\t\tend = end.getDate()-1;\r\n\t\t\t\t}else{\r\n\t\t\t\t\tend = overlap[1].getDate()-1;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tfor (var d=start; d<=end; d++){\r\n\t\t\t\t\tbgItems[d] = true;\r\n\t\t\t\t}\r\n\t\t\t}\t\t\t\t\t\r\n\t\r\n\t\t\tfor(var row in bgItems) {\r\n\t\t\t\tif(bgItems[row]){\r\n\t\t\t\t\tvar node = this._getCellAt(row, col, false);\r\n\t\t\t\t\tdomClass.add(node, \"dojoxCalendarHiddenEvents\");\r\n\t\t\t\t}\r\n\t\t\t}\t\t\t\r\n\t\t},\r\n\t\t\r\n\t\t_sortItemsFunction: function(a, b){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\tvar res = this.dateModule.compare(a.startTime, b.startTime);\r\n\t\t\tif(res == 0){\r\n\t\t\t\tres = -1 * this.dateModule.compare(a.endTime, b.endTime);\r\n\t\t\t}\r\n\t\t\treturn this.isLeftToRight() ? res : -res;\r\n\t\t},\r\n\t\t\r\n\t\t///////////////////////////////////////////////////////////////\r\n\t\t//\r\n\t\t// View to time projection\r\n\t\t//\r\n\t\t///////////////////////////////////////////////////////////////\r\n\t\t\r\n\t\tgetTime: function(e, x, y, touchIndex){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tReturns the time displayed at the specified point by this component.\r\n\t\t\t// e: Event\r\n\t\t\t//\t\tOptional mouse event.\r\n\t\t\t// x: Number\r\n\t\t\t//\t\tPosition along the x-axis with respect to the sheet container used if event is not defined.\r\n\t\t\t// y: Number\r\n\t\t\t//\t\tPosition along the y-axis with respect to the sheet container (scroll included) used if event is not defined.\r\n\t\t\t// touchIndex: Integer\r\n\t\t\t//\t\tIf parameter 'e' is not null and a touch event, the index of the touch to use.\r\n\t\t\t// returns: Date\r\n\t\t\t\r\n\t\t\tif (e != null){\t\t\t\t\r\n\t\t\t\tvar refPos = domGeometry.position(this.itemContainer, true);\r\n\t\t\t\t\r\n\t\t\t\tif(e.touches){\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\ttouchIndex = touchIndex==undefined ? 0 : touchIndex;\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\tx = e.touches[touchIndex].pageX - refPos.x;\r\n\t\t\t\t\ty = e.touches[touchIndex].pageY - refPos.y;\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t}else{\r\n\t\t\t\t\t\r\n\t\t\t\t\tx = e.pageX - refPos.x;\t\t\t\t\t\r\n\t\t\t\t\ty = e.pageY - refPos.y;\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar r = domGeometry.getContentBox(this.itemContainer);\r\n\t\t\t\r\n\t\t\tif(!this.isLeftToRight()){\r\n\t\t\t\tx = r.w - x;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (x < 0){\r\n\t\t\t\tx = 0;\r\n\t\t\t}else if(x > r.w){\r\n\t\t\t\tx = r.w-1;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (y < 0){\r\n\t\t\t\ty = 0;\r\n\t\t\t}else if(y > r.h){\r\n\t\t\t\ty = r.h-1;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar col = Math.floor(x / (r.w / this.renderData.columnCount));\r\n\t\t\tvar row = Math.floor(y / (r.h / this.renderData.maxDayCount));\r\n\t\t\t\r\n\t\t\tvar date = null;\r\n\t\t\tif(col < this.renderData.dates.length && \r\n\t\t\t\t row < this.renderData.dates[col].length){\t\t\t\r\n\t\t\t\tdate = this.newDate(this.renderData.dates[col][row]); \t\t\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn date;\r\n\t\t},\r\n\t\t\r\n\t\t///////////////////////////////////////////////////////////////\r\n\t\t//\r\n\t\t// Events\r\n\t\t//\r\n\t\t///////////////////////////////////////////////////////////////\r\n\t\t\r\n\t\t_onGridMouseUp: function(e){\r\n\t\t\t\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\t\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\t\r\n\t\t\tif (this._gridMouseDown) {\r\n\t\t\t\tthis._gridMouseDown = false;\r\n\t\t\t\t\r\n\t\t\t\tthis._onGridClick({\r\n\t\t\t\t\tdate: this.getTime(e),\r\n\t\t\t\t\ttriggerEvent: e\r\n\t\t\t\t});\r\n\t\t\t}\t\t\t\r\n\t\t},\t\t\t\r\n\t\t\t\r\n\t\t_onGridTouchStart: function(e){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\t\r\n\t\t\tthis.inherited(arguments);\t\t\t\r\n\t\t\t\r\n\t\t\tvar g = this._gridProps;\t\t\t\t\t\t\r\n\r\n\t\t\tg.moved= false;\r\n\t\t\tg.start= e.touches[0].screenY;\r\n\t\t\tg.scrollTop= this.scrollContainer.scrollTop;\r\n\t\t},\r\n\t\t\r\n\t\t_onGridTouchMove: function(e){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\tthis.inherited(arguments);\t\t\t\t\t\t\r\n\t\t\t\r\n\t\t\tif (e.touches.length > 1 && !this._isEditing){\r\n\t\t\t\tevent.stop(e);\t\t\t\t\r\n\t\t\t\treturn;\r\n\t\t\t}\t\t\t\r\n\t\t\t\r\n\t\t\tif(this._gridProps && !this._isEditing){\r\n\t\t\t\t\r\n\t\t\t\tvar touch = {x: e.touches[0].screenX, y: e.touches[0].screenY};\r\n\t\t\t\t\r\n\t\t\t\tvar p = this._edProps;\r\n\t\t\t\t\r\n\t\t\t\tif (!p || p && \r\n\t\t\t\t\t(Math.abs(touch.x - p.start.x) > 25 || \r\n\t\t\t\t\t Math.abs(touch.y - p.start.y) > 25)) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\tthis._gridProps.moved = true;\r\n\t\t\t\t\tvar d = e.touches[0].screenY - this._gridProps.start; \r\n\t\t\t\t\tvar value = this._gridProps.scrollTop - d;\r\n\t\t\t\t\tvar max = this.itemContainer.offsetHeight - this.scrollContainer.offsetHeight;\r\n\t\t\t\t\tif (value < 0){\r\n\t\t\t\t\t\tthis._gridProps.start = e.touches[0].screenY;\r\n\t\t\t\t\t\tthis._setScrollImpl(0);\r\n\t\t\t\t\t\tthis._gridProps.scrollTop = 0;\r\n\t\t\t\t\t}else if(value > max){\r\n\t\t\t\t\t\tthis._gridProps.start = e.touches[0].screenY;\r\n\t\t\t\t\t\tthis._setScrollImpl(max);\r\n\t\t\t\t\t\tthis._gridProps.scrollTop = max;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tthis._setScrollImpl(value);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t_onGridTouchEnd: function(e){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\t//event.stop(e);\r\n\t\t\t\t\t\t\t\t\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\tvar g = this._gridProps;\t\t\t\t\t\r\n\t\t\t\r\n\t\t\tif(g){\r\n\t\t\t\tif(!this._isEditing){\r\n\t\t\t\t\tif(!g.moved){\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// touched on grid and on touch start editing was ongoing.\r\n\t\t\t\t\t\tif(!g.fromItem && !g.editingOnStart){\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tthis.selectFromEvent(e, null, null, true);\r\n\t\t\t\t\t\t}\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif(!g.fromItem){\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif(this._pendingDoubleTap && this._pendingDoubleTap.grid){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tthis._onGridDoubleClick({\r\n\t\t\t\t\t\t\t\t\tdate: this.getTime(this._gridProps.event),\r\n\t\t\t\t\t\t\t\t\ttriggerEvent: this._gridProps.event\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tclearTimeout(this._pendingDoubleTap.timer);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tdelete this._pendingDoubleTap;\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tthis._onGridClick({\r\n\t\t\t\t\t\t\t\t\tdate: this.getTime(this._gridProps.event),\r\n\t\t\t\t\t\t\t\t\ttriggerEvent: this._gridProps.event\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tthis._pendingDoubleTap = {\r\n\t\t\t\t\t\t\t\t\tgrid: true,\r\n\t\t\t\t\t\t\t\t\ttimer: setTimeout(lang.hitch(this, function(){\r\n\t\t\t\t\t\t\t\t\t\t\tdelete this._pendingDoubleTap;\r\n\t\t\t\t\t\t\t\t\t}), this.doubleTapDelay)\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\t\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tthis._gridProps = null;\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t_onColumnHeaderClick: function(e){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\tthis._dispatchCalendarEvt(e, \"onColumnHeaderClick\");\r\n\t\t},\r\n\t\t\r\n\t\tonColumnHeaderClick: function(e){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tEvent dispatched when a column header cell is dispatched.\r\n\t\t\t// e: __ColumnClickEventArgs\r\n\t\t\t// tags:\r\n\t\t\t//\t\tcallback\r\n\r\n\t\t},\r\n\t\t\r\n\r\n\t\t///////////////////////////////////////////////////////////////\r\n\t\t//\r\n\t\t// View limits\r\n\t\t//\r\n\t\t///////////////////////////////////////////////////////////////\r\n\t\t\t\t\t\t\r\n\t\t_onScrollTimer_tick: function(){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\tthis._setScrollImpl(this.scrollContainer.scrollTop + this._scrollProps.scrollStep);\r\n\t\t},\r\n\t\t\r\n\t\t////////////////////////////////////////////\r\n\t\t//\r\n\t\t// Editing\r\n\t\t//\r\n\t\t///////////////////////////////////////////\t\t\t\t\t\t\r\n\t\t\r\n\t\tsnapUnit: \"day\",\r\n\t\tsnapSteps: 1,\r\n\t\tminDurationUnit: \"day\",\r\n\t\tminDurationSteps: 1,\r\n\t\tliveLayout: false,\r\n\t\tstayInView: true,\r\n\t\tallowStartEndSwap: true,\r\n\t\tallowResizeLessThan24H: false\r\n\t\t\r\n\t});\r\n});\r\n"]}