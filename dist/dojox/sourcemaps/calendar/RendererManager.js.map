{"version":3,"sources":["calendar/RendererManager.js"],"names":["define","declare","arr","html","lang","domClass","domStyle","Stateful","Evented","when","owner","rendererPool","rendererList","itemToRenderer","constructor","args","this","destroy","length","destroyRenderer","pop","kind","_rendererPool","pool","recycleItemRenderers","remove","ir","recycleRenderer","getRenderers","item","id","list","concat","createRenderer","rendererClass","cssClass","res","renderer","shift","container","domNode","emit","source","set","push","parentNode","removeChild","destroyRenderersByKind","i"],"mappings":"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","file":"../../calendar/RendererManager.js","sourcesContent":["define([\r\n\t\"dojo/_base/declare\", \r\n\t\"dojo/_base/array\", \r\n\t\"dojo/_base/html\", \r\n\t\"dojo/_base/lang\", \r\n\t\"dojo/dom-class\",\r\n\t\"dojo/dom-style\",\r\n\t\"dojo/Stateful\", \r\n\t\"dojo/Evented\"],\r\n\t\r\n\tfunction(\r\n\t\tdeclare, \r\n\t\tarr, \r\n\t\thtml, \r\n\t\tlang, \r\n\t\tdomClass, \r\n\t\tdomStyle,\r\n\t\tStateful, \r\n\t\tEvented, \r\n\t\twhen){\r\n\r\n\treturn declare(\"dojox.calendar.RendererManager\", [Stateful, Evented], {\r\n\t\t\r\n\t\t// summary:\r\n\t\t//\t\tThis mixin contains the store management.\r\n\t\t\r\n\t\t// owner: Object\r\n\t\t//\tThe owner of the store manager: a view or a calendar widget.\r\n\t\towner: null,\r\n\t\t\r\n\t\t// rendererPool: [protected] Array\r\n\t\t//\t\tThe stack of recycled renderers available.\r\n\t\trendererPool: null,\r\n\t\t\r\n\t\t// rendererList: [protected] Array\r\n\t\t//\t\tThe list of used renderers\r\n\t\trendererList: null,\r\n\t\t\r\n\t\t// itemToRenderer: [protected] Object\r\n\t\t//\t\tThe associated array item to renderer list.\r\n\t\titemToRenderer: null,\r\n\t\t\t\t\r\n\t\tconstructor: function(/*Object*/ args){\r\n\t\t\targs = args || {};\r\n\t\t\t\r\n\t\t\tthis.rendererPool = [];\r\n\t\t\tthis.rendererList = [];\r\n\t\t\tthis.itemToRenderer = {};\r\n\t\t},\r\n\t\t\r\n\t\tdestroy: function(){\r\n\t\t\twhile(this.rendererList.length > 0){\r\n\t\t\t\tthis.destroyRenderer(this.rendererList.pop());\r\n\t\t\t}\t\t\t\r\n\t\t\tfor(var kind in this._rendererPool){\r\n\t\t\t\tvar pool = this._rendererPool[kind];\r\n\t\t\t\tif(pool){\r\n\t\t\t\t\twhile(pool.length > 0){\r\n\t\t\t\t\t\tthis.destroyRenderer(pool.pop());\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\trecycleItemRenderers: function(remove){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tRecycles all the item renderers.\r\n\t\t\t// remove: Boolean\r\n\t\t\t//\t\tWhether remove the DOM node from it parent.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\r\n\t\t\twhile(this.rendererList.length>0){\r\n\t\t\t\tvar ir = this.rendererList.pop();\r\n\t\t\t\tthis.recycleRenderer(ir, remove);\r\n\t\t\t}\r\n\t\t\tthis.itemToRenderer = {};\r\n\t\t},\r\n\t\t\r\n\t\tgetRenderers: function(item){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tReturns the renderers that are currently used to displayed the speficied item.\r\n\t\t\t//\t\tReturns an array of objects that contains two properties:\r\n\t\t\t//\t\t- container: The DOM node that contains the renderer.\r\n\t\t\t//\t\t- renderer: The dojox.calendar._RendererMixin instance.\r\n\t\t\t//\t\tDo not keep references on the renderers are they are recycled and reused for other items.\r\n\t\t\t// item: Object\r\n\t\t\t//\t\tThe data or render item.\r\n\t\t\t// returns: Object[]\r\n\t\t\tif(item == null || item.id == null){\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\tvar list = this.itemToRenderer[item.id];\r\n\t\t\treturn list == null ? null : list.concat();\r\n\t\t},\r\n\t\t\r\n\t\tcreateRenderer: function(item, kind, rendererClass, cssClass){\t\t\t\r\n\t\t\t// summary: \r\n\t\t\t//\t\tCreates an item renderer of the specified kind. A renderer is an object with the \"container\" and \"instance\" properties.\r\n\t\t\t// item: Object\r\n\t\t\t//\t\tThe data item.\r\n\t\t\t// kind: String\r\n\t\t\t//\t\tThe kind of renderer.\r\n\t\t\t// rendererClass: Object\r\n\t\t\t//\t\tThe class to instantiate to create the renderer.\r\n\t\t\t// returns: Object\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\tif(item != null && kind != null && rendererClass != null){\r\n\t\t\t\t\r\n\t\t\t\tvar res=null, renderer=null;\r\n\t\t\t\t\r\n\t\t\t\tvar pool = this.rendererPool[kind];\r\n\t\t\t\t\r\n\t\t\t\tif(pool != null){\r\n\t\t\t\t\tres = pool.shift();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (res == null){\r\n\r\n\t\t\t\t\trenderer = new rendererClass;\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\tres = {\r\n\t\t\t\t\t\trenderer: renderer,\r\n\t\t\t\t\t\tcontainer: renderer.domNode,\r\n\t\t\t\t\t\tkind: kind\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tthis.emit(\"rendererCreated\", {renderer:res, source:this.owner, item:item});\r\n\t\t\t\t\t\r\n\t\t\t\t} else {\r\n\t\t\t\t\trenderer = res.renderer; \r\n\t\t\t\t\t\r\n\t\t\t\t\tthis.emit(\"rendererReused\", {renderer:renderer, source:this.owner, item:item});\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\trenderer.owner = this.owner;\r\n\t\t\t\trenderer.set(\"rendererKind\", kind);\r\n\t\t\t\trenderer.set(\"item\", item);\r\n\t\t\t\t\r\n\t\t\t\tvar list = this.itemToRenderer[item.id];\r\n\t\t\t\tif (list == null) {\r\n\t\t\t\t\tthis.itemToRenderer[item.id] = list = [];\r\n\t\t\t\t}\r\n\t\t\t\tlist.push(res);\r\n\t\t\t\t\r\n\t\t\t\tthis.rendererList.push(res);\r\n\t\t\t\treturn res;\t\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\t\r\n\t\trecycleRenderer: function(renderer, remove){\r\n\t\t\t// summary: \r\n\t\t\t//\t\tRecycles the item renderer to be reused in the future.\r\n\t\t\t// renderer: dojox/calendar/_RendererMixin\r\n\t\t\t//\t\tThe item renderer to recycle.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\t\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\tthis.emit(\"rendererRecycled\", {renderer:renderer, source:this.owner});\r\n\t\t\t\r\n\t\t\tvar pool = this.rendererPool[renderer.kind];\r\n\t\t\t\r\n\t\t\tif(pool == null){\r\n\t\t\t\tthis.rendererPool[renderer.kind] = [renderer];\r\n\t\t\t}else{\r\n\t\t\t\tpool.push(renderer);\r\n\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\tif(remove){\r\n\t\t\t\trenderer.container.parentNode.removeChild(renderer.container);\r\n\t\t\t}\r\n\r\n\t\t\tdomStyle.set(renderer.container, \"display\", \"none\");\r\n\r\n\t\t\trenderer.renderer.owner = null;\r\n\t\t\trenderer.renderer.set(\"item\", null);\r\n\t\t},\r\n\t\t\t\t\t\t\t\r\n\t\tdestroyRenderer: function(renderer){\r\n\t\t\t// summary: \r\n\t\t\t//\t\tDestroys the item renderer.\r\n\t\t\t// renderer: dojox/calendar/_RendererMixin\r\n\t\t\t//\t\tThe item renderer to destroy.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\r\n\t\t\tthis.emit(\"rendererDestroyed\", {renderer:renderer, source:this.owner});\r\n\t\t\t\r\n\t\t\tvar ir = renderer.renderer;\t\t\r\n\t\t\t\r\n\t\t\tif(ir[\"destroy\"]){\r\n\t\t\t\tir.destroy();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\thtml.destroy(renderer.container);\t\r\n\t\t},\r\n\t\t\r\n\t\tdestroyRenderersByKind: function(kind){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\tvar list = [];\r\n\t\t\tfor(var i=0;i<this.rendererList.length;i++){\r\n\t\t\t\tvar ir = this.rendererList[i];\r\n\t\t\t\tif(ir.kind == kind){\r\n\t\t\t\t\tthis.destroyRenderer(ir);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tlist.push(ir);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.rendererList = list;\r\n\t\t\t\r\n\t\t\tvar pool = this.rendererPool[kind];\r\n\t\t\tif(pool){\r\n\t\t\t\twhile(pool.length > 0){\r\n\t\t\t\t\tthis.destroyRenderer(pool.pop());\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\t\r\n\t});\r\n\r\n});\r\n"]}