{"version":3,"sources":["calendar/SimpleColumnView.js"],"names":["define","ViewBase","_TemplatedMixin","_ScrollBarBase","template","declare","event","lang","arr","has","fx","html","on","dom","domClass","domStyle","domGeometry","domConstruct","mouse","query","metrics","baseClass","templateString","viewKind","_setTabIndexAttr","renderData","startDate","columnCount","subColumns","minHours","maxHours","hourSize","timeSlotDuration","rowHeaderGridSlotDuration","rowHeaderLabelSlotDuration","rowHeaderLabelOffset","rowHeaderFirstLabelOffset","verticalRenderer","verticalDecorationRenderer","minColumnWidth","percentOverlap","horizontalGap","_showSecondarySheet","_columnHeaderHandlers","constructor","this","invalidatingProperties","destroy","preserveDom","_cleanupColumnHeader","scrollBar","inherited","arguments","_scrollBar_onScroll","value","_setScrollPosition","_hscrollBar_onScroll","_setHScrollPosition","buildRendering","vScrollBar","content","vScrollBarContent","hitch","hScrollBar","hScrollBarW","hScrollBarContent","direction","_hScrollNodes","columnHeaderTable","subColumnHeaderTable","gridTable","itemContainerTable","_viewHandles","push","scrollContainer","wheel","dojo","_mouseWheelScrollHander","postscript","_initialized","invalidRendering","refreshRendering","_setVerticalRendererAttr","_destroyRenderersByKind","_set","_createRenderData","rd","get","hourCount","slotDuration","slotSize","Math","ceil","sheetHeight","_rowHeaderWidth","getMarginBox","rowHeader","w","rowHeaderWidth","sbMetrics","getScrollbar","scrollbarWidth","scrollbarHeight","h","dateLocaleModule","dateClassObj","dateModule","dates","subColumnCount","length","hScrollPaneWidth","grid","minSheetWidth","hScrollBarEnabled","d","floorToDay","col","addAndFloor","startTime","setHours","endTime","displayedItemsInvalidated","_isEditing","items","storeManager","_computeVisibleItems","displayedDecorationItemsInvalidated","decorationItems","decorationStoreManager","_validateProperties","v","isNaN","t","_setStartDateAttr","_setColumnCountAttr","__fixEvt","e","sheet","source","rowHeaderTimePattern","_formatRowHeaderLabel","format","selector","timePattern","columnHeaderDatePattern","_formatColumnHeaderLabel","datePattern","formatLength","scrollBarRTLPosition","_getStartTimeOfDay","_getScrollPosition","hours","floor","minutes","_getEndTimeOfDay","offsetHeight","startTimeOfDay","_setStartTimeOfDayAttr","_setStartTimeOfDay","duration","easing","_startTimeOfDayInvalidated","_getStartTimeOfDayAttr","_get","hour","maxDuration","timeInMinutes","minH","maxH","pos","min","_scrollToPosition","position","_scrollAnimation","stop","scrollPos","abs","Animation","curve","onAnimate","_setScrollImpl","play","set","ensureVisibility","start","end","visibilityTarget","margin","undefined","scrollable","autoScroll","s","getHours","getMinutes","vs","ve","viewStart","viewEnd","visible","target","scrollView","dir","scrollViewHorizontal","_getHScrollPosition","_setHScrollPositionImpl","useDom","cssProp","elts","css","forEach","elt","scrollLeft","altKey","wheelDelta","oldRd","_createRendering","_layoutDecorationRenderers","_layoutRenderers","oldRenderData","sheetContainer","_configureVisibleParts","_configureScrollBar","_buildColumnHeader","_buildSubColumnHeader","_buildRowHeader","_buildGrid","_buildItemContainer","_layoutTimeIndicator","_commitProperties","secondarySheetNode","domNode","atRight","isLeftToRight","rPos","lPos","header","subHeader","buttonContainer","owner","currentView","parentNode","display","height","left","right","_configureHScrollDomNodes","styleWidth","resize","_resizeHandler","apply","_resizeTimer","clearTimeout","setTimeout","_columnHeaderClick","index","indexOf","currentTarget","_onColumnHeaderClick","date","triggerEvent","table","count","_colTableSave","clone","columnHeader","removeChild","appendChild","tbody","tr","td","tbodies","trs","create","i","add","remove","lastChild","list","pop","className","_setText","styleColumnHeaderCell","yearColumnHeaderContent","node","_cssDays","getDay","isToday","isWeekEnd","_colSubTableSave","subColumnHeader","subCount","div","len","childNodes","j","colW","subColIdx","width","subColumnLabelFunc","styleSubColumnHeaderCell","_addMinutesClasses","rowHeaderTable","_rowHeaderLabelContainer","class","size","Date","m","styleRowHeaderCell","span","lc","setMinutes","_configureRowHeaderLabel","nbRows","rowDiff","addRows","colDiff","_gridTableSave","rowIndex","addCols","styleGridCell","styleGridCellFunc","defaultStyleGridCell","bgCols","decoCols","oldCount","_itemTableSave","itemContainer","_recycleItemRenderers","subdiv","eventContainer","decoContainer","cells","decorationCells","showTimeIndicator","timeIndicatorRefreshInterval","_setShowTimeIndicatorAttr","now","isOverlapping","_timeIndicator","column","isSameDay","top","computeProjectionOnDate","_timeIndicatorTimer","setInterval","clearInterval","beforeDeactivate","_overlapLayoutPass2","lanes","lane","layoutItem","extent","space","k","ccol","l","layoutItem2","_defaultItemToRendererKindFunc","item","_layoutInterval","itemsType","verticalItems","offsetWidth","_itemToRendererKind","_layoutRendererWithSubColumns","rendererKind","computeOverlap","subColumnItems","subCols","subCol","subColumn","clonedItem","mixin","subColIndex","_layoutVerticalItems","_getColumn","subIndex","cell","layoutItems","overlap","computeRangeOverlap","bottom","litem","range","numLanes","computeOverlapping","hOverlap","posX","ir","renderer","_createRenderer","edited","isItemBeingEdited","selected","isItemSelected","hovered","isItemHovered","focused","isItemFocused","showFocus","getItemStoreState","isItemMoveEnabled","_item","isItemResizeEnabled","applyRendererZIndex","decorationRendererManager","createRenderer","container","updateRendering","place","_sortItemsFunction","a","b","res","compare","_getNormalizedCoords","x","y","touchIndex","refPos","touches","pageX","pageY","r","getContentBox","getTime","o","getTimeOfDay","newDate","getSubColumn","idx","_onGridMouseUp","_gridMouseDown","_onGridClick","_onGridTouchStart","g","_gridProps","moved","screenY","scrollTop","_onGridTouchMove","touch","screenX","p","_edProps","max","_onGridTouchEnd","fromItem","editingOnStart","selectFromEvent","_pendingDoubleTap","_onGridDoubleClick","timer","doubleTapDelay","_dispatchCalendarEvt","onColumnHeaderClick","_isItemInView","difference","sMin","eMin","sV","eV","_ensureItemInView","fixed","cal","_onScrollTimer_tick","_scrollProps","scrollStep","snapUnit","snapSteps","minDurationUnit","minDurationSteps","liveLayout","stayInView","allowStartEndSwap","allowResizeLessThan24H"],"mappings":"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","file":"../../calendar/SimpleColumnView.js","sourcesContent":["define([\r\n\"./ViewBase\",\r\n\"dijit/_TemplatedMixin\",\r\n\"./_ScrollBarBase\",\r\n\"dojo/text!./templates/ColumnView.html\",\r\n\"dojo/_base/declare\",\r\n\"dojo/_base/event\",\r\n\"dojo/_base/lang\",\r\n\"dojo/_base/array\",\r\n\"dojo/_base/sniff\",\r\n\"dojo/_base/fx\",\r\n\"dojo/_base/html\",\r\n\"dojo/on\",\r\n\"dojo/dom\",\r\n\"dojo/dom-class\",\r\n\"dojo/dom-style\",\r\n\"dojo/dom-geometry\",\r\n\"dojo/dom-construct\",\r\n\"dojo/mouse\",\r\n\"dojo/query\",\r\n\"dojox/html/metrics\"],\r\n\r\nfunction(\r\n\tViewBase,\r\n\t_TemplatedMixin,\r\n\t_ScrollBarBase,\r\n\ttemplate,\r\n\tdeclare,\r\n\tevent,\r\n\tlang,\r\n\tarr,\r\n\thas,\r\n\tfx,\r\n\thtml,\r\n\ton,\r\n\tdom,\r\n\tdomClass,\r\n\tdomStyle,\r\n\tdomGeometry,\r\n\tdomConstruct,\r\n\tmouse,\r\n\tquery,\r\n\tmetrics){\r\n\r\n\t/*=====\r\n\tvar __ColumnClickEventArgs = {\r\n\t\t// summary:\r\n\t\t//\t\tA column click event.\r\n\t\t// index: Integer\r\n\t\t//\t\tThe column index.\r\n\t\t// date: Date\r\n\t\t//\t\tThe date displayed by the column.\r\n\t\t// triggerEvent: Event\r\n\t\t//\t\tThe origin event.\r\n\t};\r\n\t=====*/\r\n\r\n\treturn declare(\"dojox.calendar.SimpleColumnView\", [ViewBase, _TemplatedMixin], {\r\n\r\n\t\t// summary:\r\n\t\t//\t\tThe simple column view is displaying a day per column. Each cell of a column is a time slot.\r\n\r\n\t\tbaseClass: \"dojoxCalendarColumnView\",\r\n\r\n\t\ttemplateString: template,\r\n\r\n\t\t// viewKind: String\r\n\t\t//\t\tType of the view. Used by the calendar widget to determine how to configure the view.\r\n\t\t//\t\tThis view kind is \"columns\".\r\n\t\tviewKind: \"columns\",\r\n\r\n\t\t// scroll container is the focusable item to enable scrolling using up and down arrows\r\n\t\t_setTabIndexAttr: \"domNode\",\r\n\r\n\t\t// renderData: Object\r\n\t\t//\t\tThe render data is the object that contains all the properties needed to render the component.\r\n\t\trenderData: null,\r\n\r\n\t\t// startDate: Date\r\n\t\t//\t\tThe start date of the time interval displayed.\r\n\t\t//\t\tIf not set at initialization time, will be set to current day.\r\n\t\tstartDate: null,\r\n\r\n\t\t// columnCount: Integer\r\n\t\t//\t\tThe number of column to display (from the startDate).\r\n\t\tcolumnCount: 7,\r\n\r\n\t\t// subcolumns: String[]\r\n\t\t//\t\tArray of sub columns values.\r\n\t\tsubColumns: null,\r\n\r\n\t\t// minHours: Integer\r\n\t\t//\t\tThe minimum hour to be displayed. It must be in the [0,23] interval and must be lower than the maxHours.\r\n\t\tminHours: 8,\r\n\r\n\t\t// maxHours: Integer\r\n\t\t//\t\tThe maximum hour to be displayed. It must be in the [1,36] interval and must be greater than the minHours.\r\n\t\tmaxHours: 18,\r\n\r\n\t\t// hourSize: Integer\r\n\t\t//\t\tThe desired size in pixels of an hour on the screen.\r\n\t\t//\t\tNote that the effective size may be different as the time slot size must be an integer.\r\n\t\thourSize: 100,\r\n\r\n\t\t// timeSlotDuration: Integer\r\n\t\t//\t\tDuration of the time slot in minutes. Must be a divisor of 60.\r\n\t\ttimeSlotDuration: 15,\r\n\r\n\t\t// rowHeaderGridSlotDuration: Integer\r\n\t\t//\t\tDuration of the time slot in minutes in the row header. Must be a divisor of 60 and a multiple/divisor of timeSlotDuration.\r\n\t\trowHeaderGridSlotDuration: 60,\r\n\r\n\t\t// rowHeaderLabelSlotDuration: Integer\r\n\t\t//\t\tDuration of the time slot in minutes in the row header labels. Must be a divisor of 60 and a multiple/divisor of timeSlotDuration.\r\n\t\trowHeaderLabelSlotDuration: 60,\r\n\r\n\t\t// rowHeaderLabelOffset: Integer\r\n\t\t//\t\tOffset of the row label from the top of the row header cell in pixels.\r\n\t\trowHeaderLabelOffset: 2,\r\n\r\n\t\t// rowHeaderFirstLabelOffset: Integer\r\n\t\t//\t\tOffset of the first row label from the top of the first row header cell in pixels.\r\n\t\trowHeaderFirstLabelOffset: 2,\r\n\r\n\t\t// verticalRenderer: Class\r\n\t\t//\t\tThe class use to create vertical renderers.\r\n\t\tverticalRenderer: null,\r\n\r\n\t\t// verticalDecorationRenderer: Class\r\n\t\t//\t\tThe class use to create decoration renderers.\r\n\t\tverticalDecorationRenderer: null,\r\n\r\n\t\t// minColumnWidth: Integer\r\n\t\t//\t\tThe minimum column width. If the number of columns and sub columns displayed makes the\r\n\t\t//\t\twidth of a column greater than this property, a horizontal scroll bar is displayed.\r\n\t\t//\t\tIf value <= 0, this constraint is ignored and the columns are using the available space.\r\n\t\tminColumnWidth: -1,\r\n\r\n\t\t// percentOverlap: Integer\r\n\t\t//\t\tThe percentage of the renderer width used to superimpose one item renderer on another\r\n\t\t//\t\twhen two events are overlapping.\r\n\t\tpercentOverlap: 70,\r\n\r\n\t\t// horizontalGap: Integer\r\n\t\t//\t\tThe number of pixels between two item renderers that are overlapping each other if the percentOverlap property is 0.\r\n\t\thorizontalGap: 4,\r\n\r\n\t\t_showSecondarySheet: false,\r\n\r\n\t\t_columnHeaderHandlers: null,\r\n\r\n\t\tconstructor: function(){\r\n\t\t\tthis.invalidatingProperties = [\"columnCount\", \"startDate\", \"minHours\", \"maxHours\", \"hourSize\", \"verticalRenderer\", \"verticalDecorationRenderer\",\r\n\t\t\t\t\"rowHeaderTimePattern\", \"columnHeaderDatePattern\", \"timeSlotDuration\", \"rowHeaderGridSlotDuration\", \"rowHeaderLabelSlotDuration\",\r\n\t\t\t\t\"rowHeaderLabelOffset\", \"rowHeaderFirstLabelOffset\",\"percentOverlap\", \"horizontalGap\", \"scrollBarRTLPosition\",\"itemToRendererKindFunc\",\r\n\t\t\t\t\"layoutPriorityFunction\", \"formatItemTimeFunc\", \"textDir\", \"items\", \"subColumns\", \"minColumnWidth\"];\r\n\t\t\tthis._columnHeaderHandlers = [];\r\n\t\t},\r\n\r\n\t\tdestroy: function(preserveDom){\r\n\t\t\tthis._cleanupColumnHeader();\r\n\t\t\tif(this.scrollBar){\r\n\t\t\t\tthis.scrollBar.destroy(preserveDom);\r\n\t\t\t}\r\n\t\t\tthis.inherited(arguments);\r\n\t\t},\r\n\r\n\t\t_scrollBar_onScroll: function(value){\r\n\t\t\tthis._setScrollPosition(value);\r\n\t\t},\r\n\r\n\t\t_hscrollBar_onScroll: function(value){\r\n\t\t\tthis._setHScrollPosition(value);\r\n\t\t},\r\n\r\n\t\tbuildRendering: function(){\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\tif(this.vScrollBar){\r\n\t\t\t\tthis.scrollBar = new _ScrollBarBase(\r\n\t\t\t\t\t{content: this.vScrollBarContent},\r\n\t\t\t\t\tthis.vScrollBar);\r\n\r\n\t\t\t\tthis.scrollBar.on(\"scroll\", lang.hitch(this, this._scrollBar_onScroll));\r\n\t\t\t}\r\n\r\n\t\t\tif(this.hScrollBar){\r\n\t\t\t\tthis.hScrollBarW = new _ScrollBarBase(\r\n\t\t\t\t\t{content: this.hScrollBarContent, direction: \"horizontal\", value: 0},\r\n\t\t\t\t\tthis.hScrollBar);\r\n\r\n\t\t\t\tthis.hScrollBarW.on(\"scroll\", lang.hitch(this, this._hscrollBar_onScroll));\r\n\r\n\t\t\t\tthis._hScrollNodes = [this.columnHeaderTable, this.subColumnHeaderTable, this.gridTable, this.itemContainerTable];\r\n\t\t\t}\r\n\r\n\t\t\tthis._viewHandles.push(\r\n\t\t\t\t\ton(this.scrollContainer, mouse.wheel,\r\n\t\t\t\t\t\tdojo.hitch(this, this._mouseWheelScrollHander)));\r\n\r\n\r\n\t\t},\r\n\r\n\t\tpostscript: function(){\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\tthis._initialized = true;\r\n\t\t\tif(!this.invalidRendering){\r\n\t\t\t\tthis.refreshRendering();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_setVerticalRendererAttr: function(value){\r\n\t\t\tthis._destroyRenderersByKind(\"vertical\");\r\n\t\t\tthis._set(\"verticalRenderer\", value);\r\n\t\t},\r\n\r\n\t\t_createRenderData: function(){\r\n\r\n\t\t\tvar rd = {};\r\n\r\n\t\t\trd.minHours = this.get(\"minHours\");\r\n\t\t\trd.maxHours = this.get(\"maxHours\");\r\n\t\t\trd.hourSize = this.get(\"hourSize\");\r\n\t\t\trd.hourCount = rd.maxHours - rd.minHours;\r\n\t\t\trd.slotDuration = this.get(\"timeSlotDuration\"); // must be consistent with previous statement\r\n\t\t\trd.rowHeaderGridSlotDuration = this.get(\"rowHeaderGridSlotDuration\");\r\n\t\t\trd.slotSize = Math.ceil(rd.hourSize / (60 / rd.slotDuration));\r\n\t\t\trd.hourSize = rd.slotSize * (60 / rd.slotDuration);\r\n\t\t\trd.sheetHeight = rd.hourSize * rd.hourCount;\r\n\r\n\t\t\tif(!this._rowHeaderWidth){\r\n\t\t\t\tthis._rowHeaderWidth = domGeometry.getMarginBox(this.rowHeader).w;\r\n\t\t\t}\r\n\t\t\trd.rowHeaderWidth = this._rowHeaderWidth;\r\n\r\n\t\t\tvar sbMetrics = metrics.getScrollbar();\r\n\t\t\trd.scrollbarWidth = sbMetrics.w + 1;\r\n\t\t\trd.scrollbarHeight = sbMetrics.h + 1;\r\n\r\n\t\t\trd.dateLocaleModule = this.dateLocaleModule;\r\n\t\t\trd.dateClassObj = this.dateClassObj;\r\n\t\t\trd.dateModule = this.dateModule; // arithmetics on Dates\r\n\r\n\t\t\trd.dates = [];\r\n\r\n\t\t\trd.columnCount = this.get(\"columnCount\");\r\n\t\t\trd.subColumns = this.get(\"subColumns\");\r\n\t\t\trd.subColumnCount =  rd.subColumns ? rd.subColumns.length : 1;\r\n\r\n\t\t\trd.hScrollPaneWidth = domGeometry.getMarginBox(this.grid).w;\r\n\t\t\trd.minSheetWidth = this.minColumnWidth < 0 ? -1 : this.minColumnWidth * rd.subColumnCount * rd.columnCount;\r\n\t\t\trd.hScrollBarEnabled = this.minColumnWidth > 0 && rd.hScrollPaneWidth < rd.minSheetWidth;\r\n\r\n\t\t\tvar d = this.get(\"startDate\");\r\n\r\n\t\t\tif (d == null){\r\n\t\t\t\td = new rd.dateClassObj();\r\n\t\t\t}\r\n\r\n\t\t\td = this.floorToDay(d, false, rd);\r\n\r\n\t\t\tthis.startDate = d;\r\n\r\n\t\t\tfor(var col = 0; col < rd.columnCount ; col++){\r\n\t\t\t\trd.dates.push(d);\r\n\t\t\t\td = this.addAndFloor(d, \"day\", 1);\r\n\t\t\t}\r\n\r\n\t\t\trd.startTime = new rd.dateClassObj(rd.dates[0]);\r\n\t\t\trd.startTime.setHours(rd.minHours);\r\n\t\t\trd.endTime = new rd.dateClassObj(rd.dates[rd.columnCount-1]);\r\n\t\t\trd.endTime.setHours(rd.maxHours);\r\n\r\n\t\t\tif(this.displayedItemsInvalidated && !this._isEditing){\r\n\t\t\t\t // while editing in no live layout we must not to recompute items (duplicate renderers)\r\n\t\t\t\trd.items = this.storeManager._computeVisibleItems(rd);\r\n\r\n\t\t\t}else if (this.renderData){\r\n\t\t\t\trd.items = this.renderData.items;\r\n\t\t\t}\r\n\r\n\t\t\tif(this.displayedDecorationItemsInvalidated){\r\n\t\t\t\t // while editing in no live layout we must not to recompute items (duplicate renderers)\r\n\t\t\t\trd.decorationItems = this.decorationStoreManager._computeVisibleItems(rd);\r\n\r\n\t\t\t}else if (this.renderData){\r\n\t\t\t\trd.decorationItems = this.renderData.decorationItems;\r\n\t\t\t}\r\n\r\n\t\t\treturn rd;\r\n\t\t},\r\n\r\n\t\t_validateProperties: function() {\r\n\r\n\t\t\tthis.inherited(arguments);\r\n\r\n\t\t\tvar v = this.minHours;\r\n\t\t\tif(v < 0 || v>23 || isNaN(v)){\r\n\t\t\t\tthis.minHours = 0;\r\n\t\t\t}\r\n\t\t\tv = this.maxHours;\r\n\t\t\tif (v < 1 || v>36 || isNaN(v)){\r\n\t\t\t\tthis.minHours = 36;\r\n\t\t\t}\r\n\r\n\t\t\tif(this.minHours > this.maxHours){\r\n\t\t\t\tvar t = this.maxHours;\r\n\t\t\t\tthis.maxHours = this.minHours;\r\n\t\t\t\tthis.minHours = t;\r\n\t\t\t}\r\n\t\t\tif (this.maxHours - this.minHours < 1){\r\n\t\t\t\tthis.minHours = 0;\r\n\t\t\t\tthis.maxHours = 24;\r\n\t\t\t}\r\n\t\t\tif (this.columnCount<1 || isNaN(this.columnCount)){\r\n\t\t\t\tthis.columnCount = 1;\r\n\t\t\t}\r\n\r\n\t\t\tv = this.percentOverlap;\r\n\t\t\tif(v < 0 ||v > 100 || isNaN(v)){\r\n\t\t\t\tthis.percentOverlap = 70;\r\n\t\t\t}\r\n\t\t\tif(this.hourSize<5 || isNaN(this.hourSize)){\r\n\t\t\t\tthis.hourSize = 10;\r\n\t\t\t}\r\n\t\t\tv = this.timeSlotDuration;\r\n            if (v < 1 || v > 60 || isNaN(v)) {\r\n                this.timeSlotDuration = 15;\r\n            }\r\n\t\t},\r\n\r\n\t\t_setStartDateAttr: function(value){\r\n\t\t\tthis.displayedItemsInvalidated = true;\r\n\t\t\tthis._set(\"startDate\", value);\r\n\t\t},\r\n\r\n\t\t_setColumnCountAttr: function(value){\r\n\t\t\tthis.displayedItemsInvalidated = true;\r\n\t\t\tthis._set(\"columnCount\", value);\r\n\t\t},\r\n\r\n\t\t__fixEvt:function(e){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\te.sheet = \"primary\";\r\n\t\t\te.source = this;\r\n\t\t\treturn e;\r\n\t\t},\r\n\r\n\t\t//////////////////////////////////////////\r\n\t\t//\r\n\t\t// Formatting functions\r\n\t\t//\r\n\t\t//////////////////////////////////////////\r\n\r\n\t\t// rowHeaderTimePattern: String\r\n\t\t//\t\tCustom date/time pattern for the row header labels to override default one coming from the CLDR.\r\n\t\t//\t\tSee dojo/date/locale documentation for format string.\r\n\t\trowHeaderTimePattern: null,\r\n\r\n\t\t_formatRowHeaderLabel: function(/*Date*/d){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tComputes the row header label for the specified time of day.\r\n\t\t\t//\t\tBy default a formatter is used, optionally the <code>rowHeaderTimePattern</code> property can be used to set a custom time pattern to the formatter.\r\n\t\t\t// d: Date\r\n\t\t\t//\t\tThe date to format\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\r\n\r\n\t\t\treturn this.renderData.dateLocaleModule.format(d, {\r\n\t\t\t\tselector: \"time\",\r\n\t\t\t\ttimePattern: this.rowHeaderTimePattern\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t// columnHeaderDatePattern: String\r\n\t\t//\t\tCustom date/time pattern for column header labels to override default one coming from the CLDR.\r\n\t\t//\t\tSee dojo/date/locale documentation for format string.\r\n\t\tcolumnHeaderDatePattern: null,\r\n\r\n\t\t_formatColumnHeaderLabel: function(/*Date*/d){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tComputes the column header label for the specified date.\r\n\t\t\t//\t\tBy default a formatter is used, optionally the <code>columnHeaderDatePattern</code> property can be used to set a custom date pattern to the formatter.\r\n\t\t\t// d: Date\r\n\t\t\t//\t\tThe date to format\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\r\n\r\n\t\t\treturn this.renderData.dateLocaleModule.format(d, {\r\n\t\t\t\tselector: \"date\",\r\n\t\t\t\tdatePattern: this.columnHeaderDatePattern,\r\n\t\t\t\tformatLength: \"medium\"\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t//////////////////////////////////////////\r\n\t\t//\r\n\t\t// Time of day management\r\n\t\t//\r\n\t\t//////////////////////////////////////////\r\n\r\n\t\t// scrollBarRTLPosition: String\r\n\t\t//\t\tPosition of the scroll bar in right-to-left display.\r\n\t\t//\t\tValid values are \"left\" and \"right\", default value is \"left\".\r\n\t\tscrollBarRTLPosition: \"left\",\r\n\r\n\t\t_getStartTimeOfDay: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tReturns the visible first time of day.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\r\n\t\t\t// returns: Object\r\n\r\n\t\t\tvar v = (this.get(\"maxHours\") - this.get(\"minHours\")) *\r\n\t\t\t\tthis._getScrollPosition() / this.renderData.sheetHeight;\r\n\r\n\t\t\treturn {\r\n\t\t\t\thours: this.renderData.minHours + Math.floor(v),\r\n\t\t\t\tminutes: (v - Math.floor(v)) * 60\r\n\t\t\t};\r\n\t\t},\r\n\r\n\t\t_getEndTimeOfDay: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tReturns the visible last time of day.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\r\n\t\t\t// returns: Integer[]\r\n\r\n\t\t\tvar v = (this.get(\"maxHours\") - this.get(\"minHours\")) *\r\n\t\t\t\t(this._getScrollPosition() + this.scrollContainer.offsetHeight) / this.renderData.sheetHeight;\r\n\r\n\t\t\treturn {\r\n\t\t\t\thours: this.renderData.minHours + Math.floor(v),\r\n\t\t\t\tminutes: (v - Math.floor(v)) * 60\r\n\t\t\t};\r\n\t\t},\r\n\r\n\t\t// startTimeOfDay: Object\r\n\t\t//\t\tFirst time (hour/minute) of day displayed, if reachable.\r\n\t\t//\t\tAn object containing \"hours\" and \"minutes\" properties.\r\n\t\tstartTimeOfDay: 0,\r\n\r\n\t\t_setStartTimeOfDayAttr: function(value){\r\n\t\t\tif(this.renderData){\r\n\t\t\t\tthis._setStartTimeOfDay(value.hours, value.minutes, value.duration, value.easing);\r\n\t\t\t}else{\r\n\t\t\t\tthis._startTimeOfDayInvalidated = true;\r\n\t\t\t}\r\n\t\t\tthis._set(\"startTimeOfDay\", value);\r\n\r\n\t\t},\r\n\r\n\t\t_getStartTimeOfDayAttr: function(){\r\n\t\t\tif(this.renderData){\r\n\t\t\t\treturn this._getStartTimeOfDay();\r\n\t\t\t}else{\r\n\t\t\t\treturn this._get(\"startTimeOfDay\");\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_setStartTimeOfDay: function(hour, minutes, maxDuration, easing){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tScrolls the view to show the specified first time of day.\r\n\t\t\t// hour: Integer\r\n\t\t\t//\t\tThe hour of the start time of day.\r\n\t\t\t// minutes: Integer\r\n\t\t\t//\t\tThe minutes part of the start time of day.\r\n\t\t\t// maxDuration: Integer\r\n\t\t\t//\t\tThe max duration of the scroll animation.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\r\n\r\n\t\t\tvar rd = this.renderData;\r\n\r\n\t\t\thour = hour || rd.minHours;\r\n\t\t\tminutes = minutes || 0;\r\n\t\t\tmaxDuration = maxDuration || 0;\r\n\r\n\t\t\tif (minutes < 0){\r\n\t\t\t\tminutes = 0;\r\n\t\t\t}else if (minutes > 59){\r\n\t\t\t\tminutes = 59;\r\n\t\t\t}\r\n\r\n\t\t\tif (hour < 0){\r\n\t\t\t\thour = 0;\r\n\t\t\t}else if (hour > rd.maxHours){\r\n\t\t\t\thour = rd.maxHours;\r\n\t\t\t}\r\n\r\n\t\t\tvar timeInMinutes = hour * 60 + minutes;\r\n\r\n\t\t\tvar minH = rd.minHours*60;\r\n\t\t\tvar maxH = rd.maxHours*60;\r\n\r\n\t\t\tif (timeInMinutes < minH){\r\n\t\t\t\ttimeInMinutes = minH;\r\n\t\t\t}else if(timeInMinutes > maxH){\r\n\t\t\t\ttimeInMinutes = maxH;\r\n\t\t\t}\r\n\r\n\t\t\tvar pos = (timeInMinutes - minH) * rd.sheetHeight / (maxH - minH);\r\n\t\t\tpos = Math.min(rd.sheetHeight - this.scrollContainer.offsetHeight, pos);\r\n\r\n\t\t\tthis._scrollToPosition(pos, maxDuration, easing);\r\n\t\t},\r\n\r\n\t\t_scrollToPosition: function(position, maxDuration, easing){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tScrolls the view to show the specified first time of day.\r\n\t\t\t// position: Integer\r\n\t\t\t//\t\tThe position in pixels.\r\n\t\t\t// maxDuration: Integer\r\n\t\t\t//\t\tThe max duration of the scroll animation.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\r\n\r\n\t\t\tif (maxDuration) {\r\n\r\n\t\t\t\tif(this._scrollAnimation){\r\n\t\t\t\t\tthis._scrollAnimation.stop();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar scrollPos = this._getScrollPosition();\r\n\r\n\t\t\t\tvar duration = Math.abs(((position - scrollPos) * maxDuration) / this.renderData.sheetHeight);\r\n\r\n\t\t\t\tthis._scrollAnimation = new fx.Animation({\r\n\t\t\t\t\tcurve: [scrollPos, position],\r\n\t\t\t\t\tduration: duration,\r\n\t\t\t\t\teasing: easing,\r\n\t\t\t\t\tonAnimate: lang.hitch(this, function(position) {\r\n\t\t\t\t\t\tthis._setScrollImpl(position);\r\n\t\t\t\t\t})\r\n\t\t\t\t});\r\n\r\n\t\t\t\tthis._scrollAnimation.play();\r\n\r\n\t\t\t}else{\r\n\t\t\t\tthis._setScrollImpl(position);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_setScrollImpl: function(v){\r\n\t\t\tthis._setScrollPosition(v);\r\n\t\t\tif(this.scrollBar){\r\n\t\t\t\tthis.scrollBar.set(\"value\", v);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tensureVisibility: function(start, end, visibilityTarget, margin, duration){\r\n\r\n\t\t\t// summary:\r\n\t\t\t//\t\tScrolls the view if the [start, end] time range is not visible or only partially visible.\r\n\t\t\t// start: Date\r\n\t\t\t//\t\tStart time of the range of interest.\r\n\t\t\t// end: Date\r\n\t\t\t//\t\tEnd time of the range of interest.\r\n\t\t\t// margin: Integer\r\n\t\t\t//\t\tMargin in minutes around the time range.\r\n\t\t\t// visibilityTarget: String\r\n\t\t\t//\t\tThe end(s) of the time range to make visible.\r\n\t\t\t//\t\tValid values are: \"start\", \"end\", \"both\".\r\n\t\t\t// duration: Number\r\n\t\t\t//\t\tOptional, the maximum duration of the scroll animation.\r\n\r\n\t\t\tmargin = margin == undefined ? this.renderData.slotDuration : margin;\r\n\r\n\t\t\tif(this.scrollable && this.autoScroll){\r\n\r\n\t\t\t\tvar s = start.getHours() * 60 + start.getMinutes() - margin;\r\n\t\t\t\tvar e = end.getHours() * 60 + end.getMinutes() + margin;\r\n\r\n\t\t\t\tvar vs = this._getStartTimeOfDay();\r\n\t\t\t\tvar ve = this._getEndTimeOfDay();\r\n\r\n\t\t\t\tvar viewStart = vs.hours * 60 + vs.minutes;\r\n\t\t\t\tvar viewEnd = ve.hours * 60 + ve.minutes;\r\n\r\n\t\t\t\tvar visible = false;\r\n\t\t\t\tvar target = null;\r\n\r\n\t\t\t\tswitch(visibilityTarget){\r\n\t\t\t\t\tcase \"start\":\r\n\t\t\t\t\t\tvisible = s >= viewStart && s <= viewEnd;\r\n\t\t\t\t\t\ttarget = s ;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"end\":\r\n\t\t\t\t\t\tvisible = e >= viewStart && e <= viewEnd;\r\n\t\t\t\t\t\ttarget = e - (viewEnd - viewStart);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"both\":\r\n\t\t\t\t\t\tvisible = s >= viewStart && e <= viewEnd;\r\n\t\t\t\t\t\ttarget = s;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(!visible){\r\n\t\t\t\t\tthis._setStartTimeOfDay(Math.floor(target/60), target%60, duration);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tscrollView: function(dir){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tScrolls the view to the specified direction of one time slot duration.\r\n\t\t\t// dir: Integer\r\n\t\t\t//\t\tDirection of the scroll. Valid values are -1 and 1.\r\n\t\t\t//\r\n\t\t\tvar t = this._getStartTimeOfDay();\r\n\t\t\tt = t.hours*60 + t.minutes + (dir * this.timeSlotDuration);\r\n\t\t\tthis._setStartTimeOfDay(Math.floor(t/60), t%60);\r\n\t\t},\r\n\r\n\t\tscrollViewHorizontal: function(dir){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tScrolls the view horizontally to the specified direction of one column or sub column (if set).\r\n\t\t\t// dir: Integer\r\n\t\t\t//\t\tDirection of the scroll. Valid values are -1 and 1.\r\n\t\t\t//\r\n\t\t\tthis._setHScrollPosition(this._getHScrollPosition() + (dir * this.minColumnWidth));\r\n\t\t\tif(this.hScrollBarW){\r\n\t\t\t\tthis.hScrollBarW.set(\"value\", this._getHScrollPosition());\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_hScrollNodes: null,\r\n\r\n\t\t_setHScrollPositionImpl: function(pos, useDom, cssProp){\r\n\t\t\tvar elts = [this.columnHeaderTable, this.subColumnHeaderTable, this.gridTable, this.itemContainerTable];\r\n\t\t\tvar css = useDom ? null : \"translateX(-\"+pos+\"px)\";\r\n\t\t\tarr.forEach(elts, function(elt){\r\n\t\t\t\tif(useDom){\r\n\t\t\t\t\telt.scrollLeft = pos;\r\n\t\t\t\t\tdomStyle.set(elt, \"left\", (-pos) + \"px\");\r\n\t\t\t\t}else{\r\n\t\t\t\t\tdomStyle.set(elt, cssProp, css);\r\n\t\t\t\t}\r\n\t\t\t}, this);\r\n\t\t},\r\n\r\n\t\t_mouseWheelScrollHander: function(e){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tMouse wheel handler.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\r\n\t\t\tif(this.renderData.hScrollBarEnabled && e.altKey){\r\n\t\t\t\tthis.scrollViewHorizontal(e.wheelDelta > 0 ? -1 : 1);\r\n\t\t\t}else{\r\n\t\t\t\tthis.scrollView(e.wheelDelta > 0 ? -1 : 1);\r\n\t\t\t}\r\n\t\t\tevent.stop(e);\r\n\t\t},\r\n\r\n\t\t//////////////////////////////////////////\r\n\t\t//\r\n\t\t// HTML structure management\r\n\t\t//\r\n\t\t//////////////////////////////////////////\r\n\r\n\t\trefreshRendering: function(){\r\n\t\t\tif(!this._initialized){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis._validateProperties();\r\n\r\n\t\t\tvar oldRd = this.renderData;\r\n\t\t\tvar rd = this._createRenderData();\r\n\t\t\tthis.renderData = rd;\r\n\t\t\tthis._createRendering(rd, oldRd);\r\n\t\t\tthis._layoutDecorationRenderers(rd);\r\n\t\t\tthis._layoutRenderers(rd);\r\n\t\t},\r\n\r\n\t\t_createRendering: function(/*Object*/renderData, /*Object*/oldRenderData){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\tdomStyle.set(this.sheetContainer, \"height\", renderData.sheetHeight + \"px\");\r\n\t\t\t// padding for the scroll bar.\r\n\t\t\tthis._configureVisibleParts(renderData);\r\n\t\t\tthis._configureScrollBar(renderData);\r\n\t\t\tthis._buildColumnHeader(renderData, oldRenderData);\r\n\t\t\tthis._buildSubColumnHeader(renderData, oldRenderData);\r\n\t\t\tthis._buildRowHeader(renderData, oldRenderData);\r\n\t\t\tthis._buildGrid(renderData, oldRenderData);\r\n\t\t\tthis._buildItemContainer(renderData, oldRenderData);\r\n\t\t\tthis._layoutTimeIndicator(renderData);\r\n\t\t\tthis._commitProperties(renderData);\r\n\t\t},\r\n\r\n\t\t_configureVisibleParts: function(renderData){\r\n\r\n\t\t\tif(this.secondarySheetNode){\r\n\t\t\t\tdomStyle.set(this.secondarySheetNode, \"display\", this._showSecondarySheet ? \"block\" : \"none\");\r\n\t\t\t}\r\n\r\n\t\t\tdomClass[this.subColumns == null?\"remove\":\"add\"](this.domNode, \"subColumns\");\r\n\t\t\tdomClass[this._showSecondarySheet?\"add\":\"remove\"](this.domNode, \"secondarySheet\");\r\n\t\t},\r\n\r\n\t\t_commitProperties: function(renderData){\r\n\t\t\tif(this._startTimeOfDayInvalidated){\r\n\t\t\t\tthis._startTimeOfDayInvalidated = false;\r\n\t\t\t\tvar v = this.startTimeOfDay;\r\n\t\t\t\tif(v != null){\r\n\t\t\t\t\tthis._setStartTimeOfDay(v.hours, v.minutes == undefined ? 0 : v.minutes); // initial position, no animation\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_configureScrollBar: function(renderData){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tSets the scroll bar size and position.\r\n\t\t\t// renderData: Object\r\n\t\t\t//\t\tThe render data.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\r\n\r\n\t\t\tif(has(\"ie\") && this.scrollBar){\r\n\t\t\t\tdomStyle.set(this.vScrollBar, \"width\", (renderData.scrollbarWidth + 1) + \"px\");\r\n\t\t\t}\r\n\r\n\t\t\tvar atRight = this.isLeftToRight() ? true : this.scrollBarRTLPosition == \"right\";\r\n\t\t\tvar rPos = atRight ? \"right\" : \"left\";\r\n\t\t\tvar lPos = atRight ? \"left\" : \"right\";\r\n\r\n\t\t\tif(this.scrollBar){\r\n\t\t\t\tthis.scrollBar.set(\"maximum\", renderData.sheetHeight);\r\n\t\t\t\tdomStyle.set(this.vScrollBar, rPos, 0);\r\n\t\t\t\tdomStyle.set(this.vScrollBar, atRight? \"left\" : \"right\", \"auto\");\r\n\t\t\t\tdomStyle.set(this.vScrollBar, \"bottom\", renderData.hScrollBarEnabled? renderData.scrollbarHeight + \"px\" : \"0\");\r\n\t\t\t}\r\n\t\t\tdomStyle.set(this.scrollContainer, rPos, renderData.scrollbarWidth + \"px\");\r\n\t\t\tdomStyle.set(this.scrollContainer, lPos, \"0\");\r\n\t\t\tdomStyle.set(this.header, rPos, renderData.scrollbarWidth + \"px\");\r\n\t\t\tdomStyle.set(this.header, lPos, \"0\");\r\n\t\t\tdomStyle.set(this.subHeader, rPos, renderData.scrollbarWidth + \"px\");\r\n\t\t\tdomStyle.set(this.subHeader, lPos, \"0\");\r\n\t\t\tif(this.buttonContainer && this.owner != null && this.owner.currentView == this){\r\n\t\t\t\tdomStyle.set(this.buttonContainer, rPos, renderData.scrollbarWidth + \"px\");\r\n\t\t\t\tdomStyle.set(this.buttonContainer, lPos, \"0\");\r\n\t\t\t}\r\n\r\n\t\t\tif(this.hScrollBar){\r\n\r\n\t\t\t\tarr.forEach(this._hScrollNodes, function(elt){\r\n\t\t\t\t\tdomClass[renderData.hScrollBarEnabled ? \"add\" : \"remove\"](elt.parentNode, \"dojoxCalendarHorizontalScroll\");\r\n\t\t\t\t}, this);\r\n\r\n\t\t\t\tif(!renderData.hScrollBarEnabled){\r\n\t\t\t\t\tthis._setHScrollPosition(0);\r\n\t\t\t\t\tthis.hScrollBarW.set(\"value\", 0);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdomStyle.set(this.hScrollBar, {\r\n\t\t\t\t\t\"display\": renderData.hScrollBarEnabled ? \"block\" : \"none\",\r\n\t\t\t\t\t\"height\": renderData.scrollbarHeight + \"px\",\r\n\t\t\t\t\t\"left\": (atRight ? renderData.rowHeaderWidth : renderData.scrollbarWidth) + \"px\",\r\n\t\t\t\t\t\"right\": (atRight ? renderData.scrollbarWidth : renderData.rowHeaderWidth) + \"px\"\r\n\t\t\t\t});\r\n\r\n\t\t\t\tdomStyle.set(this.scrollContainer, \"bottom\", renderData.hScrollBarEnabled ? (renderData.scrollbarHeight + 1) + \"px\" : \"0\");\r\n\t\t\t\tthis._configureHScrollDomNodes(renderData.hScrollBarEnabled ? renderData.minSheetWidth + \"px\" : \"100%\");\r\n\r\n\t\t\t\tthis.hScrollBarW.set(\"maximum\", renderData.minSheetWidth);\r\n\t\t\t\tthis.hScrollBarW.set(\"containerSize\", renderData.hScrollPaneWidth);\r\n\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_configureHScrollDomNodes: function(styleWidth){\r\n\t\t\tarr.forEach(this._hScrollNodes, function(elt){\r\n\t\t\t\tdomStyle.set(elt, \"width\", styleWidth);\r\n\t\t\t}, this);\r\n\t\t},\r\n\r\n\t\tresize: function(e){\r\n\t\t\tthis._resizeHandler(e);\r\n\t\t},\r\n\r\n\t\t_resizeHandler: function(e, apply){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tRefreshes the scroll bars after a resize of the widget.\r\n\t\t\t// e: Event\r\n\t\t\t//\t\tThe resize event (optional)\r\n\t\t\t// apply: Boolean\r\n\t\t\t//\t\tWhether apply the changes or wait for 100 ms\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\tvar rd = this.renderData;\r\n\r\n\t\t\tif(rd == null){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\r\n\t\t\tif(apply){\r\n\r\n\t\t\t\tvar hScrollPaneWidth = domGeometry.getMarginBox(this.grid).w;\r\n\r\n\t\t\t\tif(rd.hScrollPaneWidth != hScrollPaneWidth){\r\n\t\t\t\t\t// refresh values\r\n\t\t\t\t\trd.hScrollPaneWidth = hScrollPaneWidth;\r\n\t\t\t\t\trd.minSheetWidth = this.minColumnWidth < 0 ? -1 : this.minColumnWidth * rd.subColumnCount * rd.columnCount;\r\n\t\t\t\t\trd.hScrollBarEnabled = this.minColumnWidth > 0 && domGeometry.getMarginBox(this.grid).w < rd.minSheetWidth;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._configureScrollBar(rd);\r\n\r\n\t\t\t}else{\r\n\t\t\t\tif(this._resizeTimer != undefined){\r\n\t\t\t\t\tclearTimeout(this._resizeTimer);\r\n\t\t\t\t}\r\n\t\t\t\tthis._resizeTimer = setTimeout(lang.hitch(this, function(){\r\n\t\t\t\t\tthis._resizeHandler(e, true);\r\n\t\t\t\t}), 100);\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t_columnHeaderClick: function(e){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\tevent.stop(e);\r\n\t\t\tvar index = query(\"td\", this.columnHeaderTable).indexOf(e.currentTarget);\r\n\t\t\tthis._onColumnHeaderClick({\r\n\t\t\t\tindex: index,\r\n\t\t\t\tdate: this.renderData.dates[index],\r\n\t\t\t\ttriggerEvent: e\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t_buildColumnHeader: function(renderData, oldRenderData){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tCreates incrementally the HTML structure of the column header and configures its content.\r\n\t\t\t//\r\n\t\t\t// renderData:\r\n\t\t\t//\t\tThe render data to display.\r\n\t\t\t//\r\n\t\t\t// oldRenderData:\r\n\t\t\t//\t\tThe previously render data displayed, if any.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\tvar table = this.columnHeaderTable;\r\n\r\n\t\t\tif (!table){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar count = renderData.columnCount - (oldRenderData ? oldRenderData.columnCount : 0);\r\n\r\n\t\t\tif(has(\"ie\") == 8){\r\n\t\t\t\t// workaround Internet Explorer 8 bug.\r\n\t\t\t\t// if on the table, width: 100% and table-layout: fixed are set\r\n\t\t\t\t// and columns are removed, width of remaining columns is not\r\n\t\t\t\t// recomputed: must rebuild all.\r\n\t\t\t\tif(this._colTableSave == null){\r\n\t\t\t\t\tthis._colTableSave = lang.clone(table);\r\n\t\t\t\t}else if(count < 0){\r\n\t\t\t\t\tthis._cleanupColumnHeader();\r\n\t\t\t\t\tthis.columnHeader.removeChild(table);\r\n\t\t\t\t\tdomConstruct.destroy(table);\r\n\t\t\t\t\ttable = lang.clone(this._colTableSave);\r\n\t\t\t\t\tthis.columnHeaderTable = table;\r\n\t\t\t\t\tthis.columnHeader.appendChild(table);\r\n\t\t\t\t\tcount = renderData.columnCount;\r\n\t\t\t\t}\r\n\r\n\t\t\t} // else incremental dom add/remove for real browsers.\r\n\r\n\t\t\tvar tbodies = query(\"tbody\", table);\r\n\r\n\t\t\tvar trs = query(\"tr\", table);\r\n\t\t\tvar tbody, tr, td;\r\n\r\n\t\t\tif (tbodies.length == 1){\r\n\t\t\t\ttbody = tbodies[0];\r\n\t\t\t}else{\r\n\t\t\t\ttbody = html.create(\"tbody\", null, table);\r\n\t\t\t}\r\n\r\n\t\t\tif (trs.length == 1){\r\n\t\t\t\ttr = trs[0];\r\n\t\t\t}else{\r\n\t\t\t\ttr = domConstruct.create(\"tr\", null, tbody);\r\n\t\t\t}\r\n\r\n\t\t\t// Build HTML structure (incremental)\r\n\t\t\tif(count > 0){ // creation\r\n\t\t\t\tfor(var i=0; i < count; i++){\r\n\r\n\t\t\t\t\ttd = domConstruct.create(\"td\", null, tr);\r\n\r\n\t\t\t\t\tvar h = [];\r\n\t\t\t\t\th.push(on(td, \"click\", lang.hitch(this, this._columnHeaderClick)));\r\n\r\n\t\t\t\t\tif(has(\"touch-events\")){\r\n\t\t\t\t\t\th.push(on(td, \"touchstart\", function(e){\r\n\t\t\t\t\t\t\tevent.stop(e);\r\n\t\t\t\t\t\t\tdomClass.add(e.currentTarget, \"Active\");\r\n\t\t\t\t\t\t}));\r\n\r\n\t\t\t\t\t\th.push(on(td, \"touchend\", function(e){\r\n\t\t\t\t\t\t\tevent.stop(e);\r\n\t\t\t\t\t\t\tdomClass.remove(e.currentTarget, \"Active\");\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\th.push(on(td, \"mousedown\", function(e){\r\n\t\t\t\t\t\t\tevent.stop(e);\r\n\t\t\t\t\t\t\tdomClass.add(e.currentTarget, \"Active\");\r\n\t\t\t\t\t\t}));\r\n\r\n\t\t\t\t\t\th.push(on(td, \"mouseup\", function(e){\r\n\t\t\t\t\t\t\tevent.stop(e);\r\n\t\t\t\t\t\t\tdomClass.remove(e.currentTarget, \"Active\");\r\n\t\t\t\t\t\t}));\r\n\r\n\t\t\t\t\t\th.push(on(td, \"mouseover\", function(e){\r\n\t\t\t\t\t\t\tevent.stop(e);\r\n\t\t\t\t\t\t\tdomClass.add(e.currentTarget, \"Hover\");\r\n\t\t\t\t\t\t}));\r\n\r\n\t\t\t\t\t\th.push(on(td, \"mouseout\", function(e){\r\n\t\t\t\t\t\t\tevent.stop(e);\r\n\t\t\t\t\t\t\tdomClass.remove(e.currentTarget, \"Hover\");\r\n\t\t\t\t\t\t}));\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis._columnHeaderHandlers.push(h);\r\n\r\n\t\t\t\t}\r\n\t\t\t}else{ // deletion\r\n\t\t\t\tcount = -count;\r\n\t\t\t\tfor(var i=0; i < count; i++){\r\n\t\t\t\t\ttd = tr.lastChild;\r\n\t\t\t\t\ttr.removeChild(td);\r\n\t\t\t\t\tdomConstruct.destroy(td);\r\n\t\t\t\t\tvar list = this._columnHeaderHandlers.pop();\r\n\t\t\t\t\twhile(list.length>0){\r\n\t\t\t\t\t\tlist.pop().remove();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// fill & configure\r\n\t\t\tquery(\"td\", table).forEach(function(td, i){\r\n\t\t\t\ttd.className = \"\";\r\n\t\t\t\tif(i == 0){\r\n\t\t\t\t\tdomClass.add(td, \"first-child\");\r\n\t\t\t\t}else if(i == this.renderData.columnCount-1){\r\n\t\t\t\t\tdomClass.add(td, \"last-child\");\r\n\t\t\t\t}\r\n\t\t\t\tvar d = renderData.dates[i];\r\n\t\t\t\tthis._setText(td, this._formatColumnHeaderLabel(d));\r\n\t\t\t\tthis.styleColumnHeaderCell(td, d, renderData);\r\n\t\t\t}, this);\r\n\r\n\t\t\tif(this.yearColumnHeaderContent){\r\n\t\t\t\tvar d = renderData.dates[0];\r\n\t\t\t\t\tthis._setText(this.yearColumnHeaderContent, renderData.dateLocaleModule.format(d,\r\n\t\t\t\t\t\t{selector: \"date\", datePattern:\"yyyy\"}));\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_cleanupColumnHeader: function(){\r\n\t\t\twhile(this._columnHeaderHandlers.length > 0){\r\n\t\t\t\tvar list = this._columnHeaderHandlers.pop();\r\n\t\t\t\twhile(list.length > 0){\r\n\t\t\t\t\tlist.pop().remove();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tstyleColumnHeaderCell: function(node, date, renderData){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tStyles the CSS classes to the node that displays a column header cell.\r\n\t\t\t//\t\tBy default this method is setting:\r\n\t\t\t//\t\t- \"dojoxCalendarToday\" class name if the date displayed is the current date,\r\n\t\t\t//\t\t- \"dojoxCalendarWeekend\" if the date represents a weekend,\r\n\t\t\t//\t\t- the CSS class corresponding of the displayed day of week (\"Sun\", \"Mon\" and so on).\r\n\t\t\t// node: Node\r\n\t\t\t//\t\tThe DOM node that displays the column in the grid.\r\n\t\t\t// date: Date\r\n\t\t\t//\t\tThe date displayed by this column\r\n\t\t\t// renderData: Object\r\n\t\t\t//\t\tThe render data.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\r\n\r\n\t\t\tdomClass.add(node, this._cssDays[date.getDay()]);\r\n\r\n\t\t\tif(this.isToday(date)){\r\n\t\t\t\tdomClass.add(node, \"dojoxCalendarToday\");\r\n\t\t\t} else if(this.isWeekEnd(date)){\r\n\t\t\t\tdomClass.add(node, \"dojoxCalendarWeekend\");\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_buildSubColumnHeader: function(renderData, oldRenderData){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tCreates incrementally the HTML structure of the column header and configures its content.\r\n\t\t\t//\r\n\t\t\t// renderData:\r\n\t\t\t//\t\tThe render data to display.\r\n\t\t\t//\r\n\t\t\t// oldRenderData:\r\n\t\t\t//\t\tThe previously render data displayed, if any.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\tvar table = this.subColumnHeaderTable;\r\n\r\n\t\t\tif (!table || this.subColumns == null){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar count = renderData.columnCount - query(\"td\", table).length;\r\n\r\n\t\t\tif(has(\"ie\") == 8){\r\n\t\t\t\t// workaround Internet Explorer 8 bug.\r\n\t\t\t\t// if on the table, width: 100% and table-layout: fixed are set\r\n\t\t\t\t// and columns are removed, width of remaining columns is not\r\n\t\t\t\t// recomputed: must rebuild all.\r\n\t\t\t\tif(this._colSubTableSave == null){\r\n\t\t\t\t\tthis._colSubTableSave = lang.clone(table);\r\n\t\t\t\t}else if(count < 0){\r\n\t\t\t\t\tthis.subColumnHeader.removeChild(table);\r\n\t\t\t\t\tdomConstruct.destroy(table);\r\n\t\t\t\t\ttable = lang.clone(this._colSubTableSave);\r\n\t\t\t\t\tthis.subColumnHeaderTable = table;\r\n\t\t\t\t\tthis.subColumnHeader.appendChild(table);\r\n\t\t\t\t\tcount = renderData.columnCount;\r\n\t\t\t\t}\r\n\r\n\t\t\t} // else incremental dom add/remove for real browsers.\r\n\r\n\t\t\tvar tbodies = query(\">tbody\", table);\r\n\r\n\t\t\tvar tbody, tr, td;\r\n\r\n\t\t\tif (tbodies.length == 1){\r\n\t\t\t\ttbody = tbodies[0];\r\n\t\t\t}else{\r\n\t\t\t\ttbody = html.create(\"tbody\", null, table);\r\n\t\t\t}\r\n\r\n\t\t\tvar trs = query(\">tr\", tbody);\r\n\t\t\tif (trs.length == 1){\r\n\t\t\t\ttr = trs[0];\r\n\t\t\t}else{\r\n\t\t\t\ttr = domConstruct.create(\"tr\", null, tbody);\r\n\t\t\t}\r\n\r\n\t\t\tvar subCount = renderData.subColumnCount;\r\n\r\n\t\t\t// Build HTML structure (incremental)\r\n\t\t\tif(count > 0){ // creation\r\n\t\t\t\tfor(var i=0; i < count; i++){\r\n\t\t\t\t\ttd = domConstruct.create(\"td\", null, tr);\r\n\t\t\t\t\tdomConstruct.create(\"div\", {\"className\": \"dojoxCalendarSubHeaderContainer\"}, td);\r\n\t\t\t\t}\r\n\t\t\t}else{ // deletion\r\n\t\t\t\tcount = -count;\r\n\t\t\t\tfor(var i=0; i < count; i++){\r\n\t\t\t\t\ttd = tr.lastChild;\r\n\t\t\t\t\ttr.removeChild(td);\r\n\t\t\t\t\tdomConstruct.destroy(td);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// fill & configure\r\n\t\t\tquery(\"td\", table).forEach(function(td, i){\r\n\t\t\t\ttd.className = \"\";\r\n\t\t\t\tif(i == 0){\r\n\t\t\t\t\tdomClass.add(td, \"first-child\");\r\n\t\t\t\t}else if(i == this.renderData.columnCount-1){\r\n\t\t\t\t\tdomClass.add(td, \"last-child\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tquery(\".dojoxCalendarSubHeaderContainer\", td).forEach(function(div, i){\r\n\r\n\t\t\t\t\tvar count = query(\".dojoxCalendarSubHeaderContainer\", div).length - subCount;\r\n\t\t\t\t\tif(count != 0){\r\n\t\t\t\t\t\tvar len = div.childNodes.length;\r\n\t\t\t\t\t\tfor(var i=0; i<len; i++){\r\n\t\t\t\t\t\t\tdiv.removeChild(div.lastChild);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor(var j=0; j<subCount; j++){\r\n\t\t\t\t\t\t\tdomConstruct.create(\"div\", {\"className\": \"dojoxCalendarSubHeaderCell dojoxCalendarSubHeaderLabel\"}, div);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar colW = (100/subCount) + \"%\";\r\n\t\t\t\t\tquery(\".dojoxCalendarSubHeaderCell\", div).forEach(function(div, i){\r\n\t\t\t\t\t\tdiv.className = \"dojoxCalendarSubHeaderCell dojoxCalendarSubHeaderLabel\";\r\n\t\t\t\t\t\tvar col = subCount == 1 ? i : Math.floor(i / subCount);\r\n\t\t\t\t\t\tsubColIdx = subCount == 1 ? 0 : i - col * subCount;\r\n\t\t\t\t\t\tdomStyle.set(div, {width: colW, left: ((subColIdx * 100)/subCount)+\"%\"});\r\n\t\t\t\t\t\tdomClass[subColIdx<subCount-1 && subCount !== 1?\"add\":\"remove\"](div, \"subColumn\");\r\n\t\t\t\t\t\tdomClass.add(div, this.subColumns[subColIdx]);\r\n\t\t\t\t\t\tthis._setText(div, this.subColumnLabelFunc(this.subColumns[subColIdx]));\r\n\t\t\t\t\t}, this);\r\n\r\n\t\t\t\t}, this);\r\n\r\n\t\t\t\tvar d = renderData.dates[i];\r\n\r\n\t\t\t\tthis.styleSubColumnHeaderCell(td, d, renderData);\r\n\r\n\t\t\t}, this);\r\n\r\n\t\t},\r\n\r\n\r\n\t\tsubColumnLabelFunc: function(value){\r\n\t\t\t// summary:\r\n\t\t\t//\tComputes the label for a sub column from the subColumns property.\r\n\t\t\t//\tBy default, return the value.\r\n\t\t\treturn value;\r\n\t\t},\r\n\r\n\t\tstyleSubColumnHeaderCell: function(node, date, renderData){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tStyles the CSS classes to the node that displays a sub column header cell.\r\n\t\t\t//\t\tBy default this method is not setting anythin:\r\n\t\t\t// node: Node\r\n\t\t\t//\t\tThe DOM node that displays the column in the grid.\r\n\t\t\t// subColumnIndex: Integer\r\n\t\t\t//\t\tThe cub column index.\r\n\t\t\t// renderData: Object\r\n\t\t\t//\t\tThe render data.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\r\n\t\t\tdomClass.add(node, this._cssDays[date.getDay()]);\r\n\r\n\t\t\tif(this.isToday(date)){\r\n\t\t\t\tdomClass.add(node, \"dojoxCalendarToday\");\r\n\t\t\t} else if(this.isWeekEnd(date)){\r\n\t\t\t\tdomClass.add(node, \"dojoxCalendarWeekend\");\r\n\t\t\t}\r\n\t\t},\r\n\r\n        _addMinutesClasses: function(node, minutes){\r\n            switch(minutes){\r\n                case 0:\r\n                    domClass.add(node, \"hour\");\r\n                    break;\r\n                case 30:\r\n                    domClass.add(node, \"halfhour\");\r\n                    break;\r\n                case 15:\r\n                case 45:\r\n                    domClass.add(node, \"quarterhour\");\r\n                    break;\r\n            }\r\n        },\r\n\r\n\t\t_buildRowHeader: function(renderData, oldRenderData){\r\n\r\n\t\t\t// summary:\r\n\t\t\t//\t\tCreates incrementally the HTML structure of the row header and configures its content.\r\n\t\t\t//\r\n\t\t\t// renderData:\r\n\t\t\t//\t\tThe render data to display.\r\n\t\t\t//\r\n\t\t\t// oldRenderData:\r\n\t\t\t//\t\tThe previously render data displayed, if any.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\r\n\t\t\tvar rowHeaderTable = this.rowHeaderTable;\r\n\r\n\t\t\tif (!rowHeaderTable){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif(this._rowHeaderLabelContainer == null){\r\n\t\t\t\tthis._rowHeaderLabelContainer = domConstruct.create(\"div\", {\"class\": \"dojoxCalendarRowHeaderLabelContainer\"}, this.rowHeader);\r\n\t\t\t}\r\n\r\n\r\n\t\t\tdomStyle.set(rowHeaderTable, \"height\", renderData.sheetHeight + \"px\");\r\n\r\n\t\t\tvar tbodies = query(\"tbody\", rowHeaderTable);\r\n\t\t\tvar tbody, tr, td;\r\n\r\n\t\t\tif (tbodies.length == 1){\r\n\t\t\t\ttbody = tbodies[0];\r\n\t\t\t}else{\r\n\t\t\t\ttbody = domConstruct.create(\"tbody\", null, rowHeaderTable);\r\n\t\t\t}\r\n\r\n\t\t\tvar nbRows = Math.floor(60 / renderData.rowHeaderGridSlotDuration) * renderData.hourCount;\r\n\r\n\t\t\tvar count = nbRows -\r\n\t\t\t\t(oldRenderData ? Math.floor(60 / oldRenderData.rowHeaderGridSlotDuration) * oldRenderData.hourCount : 0);\r\n\r\n\t\t\t// Build HTML structure\r\n\t\t\tif(count>0){ // creation\r\n\t\t\t\tfor(var i=0; i < count; i++){\r\n\t\t\t\t\ttr = domConstruct.create(\"tr\", null, tbody);\r\n\t\t\t\t\ttd = domConstruct.create(\"td\", null, tr);\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\tcount = -count;\r\n\t\t\t\t// deletion of existing nodes\r\n\t\t\t\tfor(var i=0; i < count; i++){\r\n\t\t\t\t\ttbody.removeChild(tbody.lastChild);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// fill labels\r\n\r\n\r\n\t\t\tvar rd = this.renderData;\r\n\t\t\tvar size = Math.ceil(renderData.hourSize / (60 / renderData.rowHeaderGridSlotDuration));\r\n\t\t\tvar d = new Date(2000, 0, 1, 0, 0, 0);\r\n\r\n\t\t\tquery(\"tr\", rowHeaderTable).forEach(function(tr, i){\r\n\t\t\t\tvar td = query(\"td\", tr)[0];\r\n\t\t\t\ttd.className = \"\";\r\n\r\n\t\t\t\tdomStyle.set(tr, \"height\", (has(\"ie\") == 7)?size-2*(60 / renderData.rowHeaderGridSlotDuration):size + \"px\");\r\n\r\n\t\t\t\tvar h = renderData.minHours + (i * this.renderData.rowHeaderGridSlotDuration) / 60;\r\n\t\t\t\tvar m = (i * this.renderData.rowHeaderGridSlotDuration) % 60;\r\n\r\n\t\t\t\tthis.styleRowHeaderCell(td, h, m, rd);\r\n\r\n                this._addMinutesClasses(td, m);\r\n\r\n\t\t\t}, this);\r\n\r\n\t\t\tvar lc = this._rowHeaderLabelContainer;\r\n\t\t\tcount = (Math.floor(60 / this.rowHeaderLabelSlotDuration) * renderData.hourCount) - lc.childNodes.length;\r\n\r\n\t\t\tvar span;\r\n\t\t\tif(count>0){ // creation\r\n\t\t\t\tfor(var i=0; i < count; i++){\r\n\t\t\t\t\tspan = domConstruct.create(\"span\", null, lc);\r\n\t\t\t\t\tdomClass.add(span, \"dojoxCalendarRowHeaderLabel\");\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\tcount = -count;\r\n\t\t\t\t// deletion of existing nodes\r\n\t\t\t\tfor(var i=0; i < count; i++){\r\n\t\t\t\t\tlc.removeChild(lc.lastChild);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tsize = Math.ceil(renderData.hourSize / (60 / this.rowHeaderLabelSlotDuration));\r\n\r\n\t\t\tquery(\">span\", lc).forEach(function(span, i){\r\n\t\t\t\td.setHours(0);\r\n\t\t\t\td.setMinutes(renderData.minHours * 60 + (i*this.rowHeaderLabelSlotDuration));\r\n\t\t\t\tthis._configureRowHeaderLabel(span, d, i, size*i, rd);\r\n\t\t\t}, this);\r\n\r\n\t\t},\r\n\r\n\t\t_configureRowHeaderLabel: function(node, d, index, pos, renderData){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tConfigures the label of a row header cell.\r\n\t\t\t// node: DOMNode\r\n\t\t\t//\t\tThe DOM node that is the parent of the label.\r\n\t\t\t// d:Date\r\n\t\t\t//\t\tA date object that contains the hours and minutes displayed by this row header cell.\r\n\t\t\t// index: Integer\r\n\t\t\t//\t\tThe index of this row header cell\r\n\t\t\t// pos: Integer\r\n\t\t\t//\t\tThe computed position of the row header cell\r\n\t\t\t// renderData: Object\r\n\t\t\t//\t\tThe render data.\r\n\r\n\t\t\tthis._setText(node, this._formatRowHeaderLabel(d));\r\n\t\t\tdomStyle.set(node, \"top\", (pos + (index==0?this.rowHeaderFirstLabelOffset:this.rowHeaderLabelOffset))+\"px\");\r\n\t\t\tvar h = renderData.minHours + (index * this.rowHeaderLabelSlotDuration) / 60;\r\n\t\t\tvar m = (index * this.rowHeaderLabelSlotDuration) % 60;\r\n\t\t\tdomClass.remove(node, [\"hour\", \"halfhour\", \"quarterhour\"]);\r\n            this._addMinutesClasses(node, m);\r\n            this.styleRowHeaderCell(node, h, m, renderData);\r\n\t\t},\r\n\r\n\t\tstyleRowHeaderCell: function(node, h, m, renderData){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tStyles the CSS classes to the node that displays a row header cell.\r\n\t\t\t//\t\tBy default this method is doing nothing.\r\n\t\t\t// node: Node\r\n\t\t\t//\t\tThe DOM node that displays the column in the grid.\r\n\t\t\t// h: Integer\r\n\t\t\t//\t\tThe time of day displayed by this row header cell.\r\n\t\t\t// renderData: Object\r\n\t\t\t//\t\tThe render data.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\r\n\t\t},\r\n\r\n\t\t_buildGrid: function (renderData, oldRenderData){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tCreates incrementally the HTML structure of the grid and configures its content.\r\n\t\t\t//\r\n\t\t\t// renderData:\r\n\t\t\t//\t\tThe render data to display.\r\n\t\t\t//\r\n\t\t\t// oldRenderData:\r\n\t\t\t//\t\tThe previously render data displayed, if any.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\r\n\t\t\tvar table = this.gridTable;\r\n\r\n\t\t\tif (!table){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tdomStyle.set(table, \"height\", renderData.sheetHeight + \"px\");\r\n\r\n\t\t\tvar nbRows = Math.floor(60 / renderData.slotDuration) * renderData.hourCount;\r\n\r\n\t\t\tvar rowDiff = nbRows -\r\n\t\t\t\t(oldRenderData ? Math.floor(60 / oldRenderData.slotDuration) * oldRenderData.hourCount : 0);\r\n\r\n\t\t\tvar addRows = rowDiff > 0;\r\n\r\n\t\t\tvar colDiff  = (renderData.columnCount - (oldRenderData ? oldRenderData.columnCount : 0));\r\n\r\n\t\t\tif(has(\"ie\") == 8){\r\n\t\t\t\t// workaround Internet Explorer 8 bug.\r\n\t\t\t\t// if on the table, width: 100% and table-layout: fixed are set\r\n\t\t\t\t// and columns are removed, width of remaining columns is not\r\n\t\t\t\t// recomputed: must rebuild all.\r\n\t\t\t\tif(this._gridTableSave == null){\r\n\t\t\t\t\tthis._gridTableSave = lang.clone(table);\r\n\t\t\t\t}else if(colDiff < 0){\r\n\t\t\t\t\tthis.grid.removeChild(table);\r\n\t\t\t\t\tdomConstruct.destroy(table);\r\n\t\t\t\t\ttable = lang.clone(this._gridTableSave);\r\n\t\t\t\t\tthis.gridTable = table;\r\n\t\t\t\t\tthis.grid.appendChild(table);\r\n\t\t\t\t\tcolDiff = renderData.columnCount;\r\n\t\t\t\t\trowDiff = nbRows;\r\n\t\t\t\t\taddRows = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar tbodies = query(\"tbody\", table);\r\n\t\t\tvar tbody;\r\n\r\n\t\t\tif (tbodies.length == 1){\r\n\t\t\t\ttbody = tbodies[0];\r\n\t\t\t}else{\r\n\t\t\t\ttbody = domConstruct.create(\"tbody\", null, table);\r\n\t\t\t}\r\n\r\n\t\t\t// Build time slots (lines) HTML structure (incremental)\r\n\t\t\tif(addRows){ // creation\r\n\t\t\t\tfor(var i=0; i<rowDiff; i++){\r\n\t\t\t\t\tdomConstruct.create(\"tr\", null, tbody);\r\n\t\t\t\t}\r\n\t\t\t}else{ // deletion\r\n\t\t\t\trowDiff = -rowDiff;\r\n\t\t\t\tfor(var i=0; i<rowDiff; i++){\r\n\t\t\t\t\ttbody.removeChild(tbody.lastChild);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar rowIndex = Math.floor(60 / renderData.slotDuration) * renderData.hourCount - rowDiff;\r\n\r\n\t\t\tvar addCols = addRows || colDiff >0;\r\n\t\t\tcolDiff = addCols ? colDiff : -colDiff;\r\n\r\n\t\t\tquery(\"tr\", table).forEach(function(tr, i){\r\n\r\n\t\t\t\tif(addCols){ // creation\r\n\t\t\t\t\tvar len = i >= rowIndex ? renderData.columnCount : colDiff;\r\n\t\t\t\t\tfor(var i=0; i<len; i++){\r\n\t\t\t\t\t\tdomConstruct.create(\"td\", null, tr);\r\n\t\t\t\t\t}\r\n\t\t\t\t}else{ // deletion\r\n\t\t\t\t\tfor(var i=0; i<colDiff; i++){\r\n\t\t\t\t\t\ttr.removeChild(tr.lastChild);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t// Set the CSS classes\r\n\r\n\t\t\tquery(\"tr\", table).forEach(function (tr, i){\r\n\r\n\t\t\t\tdomStyle.set(tr, \"height\", renderData.slotSize + \"px\");\r\n\r\n\t\t\t\tif(i == 0){\r\n\t\t\t\t\tdomClass.add(tr, \"first-child\");\r\n\t\t\t\t}else if(i == nbRows-1){\r\n\t\t\t\t\tdomClass.add(tr, \"last-child\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// the minutes part of the time of day displayed by the current tr\r\n\t\t\t\tvar m = (i * this.renderData.slotDuration) % 60;\r\n\t\t\t\tvar h = this.minHours + Math.floor((i * this.renderData.slotDuration) / 60);\r\n\t\t\t\tquery(\"td\", tr).forEach(function (td, col){\r\n\r\n\t\t\t\t\ttd.className = \"\";\r\n\r\n\t\t\t\t\tif(col == 0){\r\n\t\t\t\t\t\tdomClass.add(td, \"first-child\");\r\n\t\t\t\t\t}else if(col == this.renderData.columnCount-1){\r\n\t\t\t\t\t\tdomClass.add(td, \"last-child\");\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar d = renderData.dates[col];\r\n\r\n\t\t\t\t\tthis.styleGridCell(td, d, h, m, renderData);\r\n\r\n                    this._addMinutesClasses(td, m);\r\n\r\n\t\t\t\t}, this);\r\n\t\t\t}, this);\r\n\r\n\t\t},\r\n\r\n\t\t// styleGridCellFunc: Function\r\n\t\t//\t\tCustom function to customize the appearance of a grid cell by installing custom CSS class on the node.\r\n\t\t//\t\tThe signature of the function must be the same then the styleGridCell one.\r\n\t\t//\t\tBy default the defaultStyleGridCell function is used.\r\n\t\tstyleGridCellFunc: null,\r\n\r\n\t\tdefaultStyleGridCell: function(node, date, hours, minutes, renderData){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tStyles the CSS classes to the node that displays a cell.\r\n\t\t\t//\t\tBy default this method is setting:\r\n\t\t\t//\t\t- \"dojoxCalendarToday\" class name if the date displayed is the current date,\r\n\t\t\t//\t\t- \"dojoxCalendarWeekend\" if the date represents a weekend,\r\n\t\t\t//\t\t- the CSS class corresponding of the displayed day of week (\"Sun\", \"Mon\" and so on),\r\n\t\t\t//\t\t- the CSS classes corresponfing to the time of day (e.g. \"H14\" and \"M30\" for for 2:30pm).\r\n\t\t\t// node: Node\r\n\t\t\t//\t\tThe DOM node that displays the cell in the grid.\r\n\t\t\t// date: Date\r\n\t\t\t//\t\tThe date displayed by this cell.\r\n\t\t\t// hours: Integer\r\n\t\t\t//\t\tThe hours part of time of day displayed by the start of this cell.\r\n\t\t\t// minutes: Integer\r\n\t\t\t//\t\tThe minutes part of time of day displayed by the start of this cell.\r\n\t\t\t// renderData: Object\r\n\t\t\t//\t\tThe render data object.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\r\n\r\n\t\t\tdomClass.add(node, [this._cssDays[date.getDay()], \"H\"+hours, \"M\"+minutes]);\r\n\r\n\t\t\tif(this.isToday(date)){\r\n\t\t\t\treturn domClass.add(node, \"dojoxCalendarToday\");\r\n\t\t\t} else if(this.isWeekEnd(date)){\r\n\t\t\t\treturn domClass.add(node, \"dojoxCalendarWeekend\");\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tstyleGridCell: function(node, date, hours, minutes, renderData){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tStyles the CSS classes to the node that displays a cell.\r\n\t\t\t//\t\tDelegates to styleGridCellFunc if defined or defaultStyleGridCell otherwise.\r\n\t\t\t// node: Node\r\n\t\t\t//\t\tThe DOM node that displays the cell in the grid.\r\n\t\t\t// date: Date\r\n\t\t\t//\t\tThe date displayed by this column\r\n\t\t\t// renderData: Object\r\n\t\t\t//\t\tThe render data object.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\r\n\r\n\t\t\tif(this.styleGridCellFunc){\r\n\t\t\t\tthis.styleGridCellFunc(node, date, hours, minutes, renderData);\r\n\t\t\t}else{\r\n\t\t\t\tthis.defaultStyleGridCell(node, date, hours, minutes, renderData);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_buildItemContainer: function(renderData, oldRenderData){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tCreates the HTML structure of the item container and configures its content.\r\n\t\t\t// renderData:\r\n\t\t\t//\t\tThe render data to display.\r\n\t\t\t// oldRenderData:\r\n\t\t\t//\t\tThe previously render data displayed, if any.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\tvar table = this.itemContainerTable;\r\n\r\n\t\t\tif (!table){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar bgCols = [], decoCols = [];\r\n\r\n\t\t\tdomStyle.set(table, \"height\", renderData.sheetHeight + \"px\");\r\n\t\t\tvar oldCount = oldRenderData ? oldRenderData.columnCount : 0;\r\n\t\t\tvar count = renderData.columnCount - oldCount;\r\n\r\n\t\t\tif(has(\"ie\") == 8){\r\n\t\t\t\t// workaround Internet Explorer 8 bug.\r\n\t\t\t\t// if on the table, width: 100% and table-layout: fixed are set\r\n\t\t\t\t// and columns are removed, width of remaining columns is not\r\n\t\t\t\t// recomputed: must rebuild all.\r\n\t\t\t\tif(this._itemTableSave == null){\r\n\t\t\t\t\tthis._itemTableSave = lang.clone(table);\r\n\t\t\t\t}else if(count < 0){\r\n\t\t\t\t\tthis.itemContainer.removeChild(table);\r\n\t\t\t\t\tthis._recycleItemRenderers(true);\r\n\t\t\t\t\tdomConstruct.destroy(table);\r\n\t\t\t\t\ttable = lang.clone(this._itemTableSave);\r\n\t\t\t\t\tthis.itemContainerTable = table;\r\n\t\t\t\t\tthis.itemContainer.appendChild(table);\r\n\t\t\t\t\tcount = renderData.columnCount;\r\n\t\t\t\t}\r\n\r\n\t\t\t} // else incremental dom add/remove for real browsers.\r\n\r\n\t\t\tvar tbodies = query(\"tbody\", table);\r\n\t\t\tvar trs = query(\"tr\", table);\r\n\t\t\tvar tbody, tr, td;\r\n\r\n\t\t\tif (tbodies.length == 1){\r\n\t\t\t\ttbody = tbodies[0];\r\n\t\t\t}else{\r\n\t\t\t\ttbody = domConstruct.create(\"tbody\", null, table);\r\n\t\t\t}\r\n\r\n\t\t\tif (trs.length == 1){\r\n\t\t\t\ttr = trs[0];\r\n\t\t\t}else{\r\n\t\t\t\ttr = domConstruct.create(\"tr\", null, tbody);\r\n\t\t\t}\r\n\r\n\t\t\tvar subCount = renderData.subColumnCount;\r\n\r\n\t\t\t// Build HTML structure (incremental)\r\n\t\t\tif(count>0){ // creation\r\n\t\t\t\tfor(var i=0; i < count; i++){\r\n\t\t\t\t\ttd = domConstruct.create(\"td\", null, tr);\r\n\t\t\t\t\tdomConstruct.create(\"div\", {\"className\": \"dojoxCalendarContainerColumn\"}, td);\r\n\t\t\t\t}\r\n\t\t\t}else{ // deletion\r\n\t\t\t\tcount = -count;\r\n\t\t\t\tfor(var i=0; i < count; i++){\r\n\t\t\t\t\ttr.removeChild(tr.lastChild);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\r\n\t\t\tquery(\"td\", table).forEach(function(td, i){\r\n\r\n\t\t\t\tquery(\".dojoxCalendarContainerColumn\", td).forEach(function(div, i){\r\n\t\t\t\t\tdomStyle.set(div, \"height\", renderData.sheetHeight + \"px\");\r\n\t\t\t\t\tvar count = query(\".dojoxCalendarSubContainerColumn\", td).length - subCount;\r\n\t\t\t\t\tif(count != 0){\r\n\t\t\t\t\t\tvar len = div.childNodes.length;\r\n\t\t\t\t\t\tfor(var i=0; i<len; i++){\r\n\t\t\t\t\t\t\tdiv.removeChild(div.lastChild);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor(var j=0; j<subCount; j++){\r\n\t\t\t\t\t\t\tvar subdiv = domConstruct.create(\"div\", {\"className\": \"dojoxCalendarSubContainerColumn\"}, div);\r\n\t\t\t\t\t\t\tdomConstruct.create(\"div\", {\"className\": \"dojoxCalendarDecorationContainerColumn\"}, subdiv);\r\n\t\t\t\t\t\t\tdomConstruct.create(\"div\", {\"className\": \"dojoxCalendarEventContainerColumn\"}, subdiv);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}, this);\r\n\r\n\t\t\t\tvar colW = (100/subCount) + \"%\";\r\n\t\t\t\tquery(\".dojoxCalendarSubContainerColumn\", td).forEach(function(div, i){\r\n\t\t\t\t\tvar col = subCount == 1 ? i : Math.floor(i / subCount);\r\n\t\t\t\t\tsubColIdx = subCount == 1 ? 0 : i - col * subCount;\r\n\t\t\t\t\tdomStyle.set(div, {width: colW, left: ((subColIdx * 100)/subCount)+\"%\"});\r\n\t\t\t\t\tdomClass[subColIdx<subCount-1 && subCount !== 1?\"add\":\"remove\"](div, \"subColumn\");\r\n\r\n\t\t\t\t\tquery(\".dojoxCalendarEventContainerColumn\", div).forEach(function(eventContainer, i){\r\n\t\t\t\t\t\tbgCols.push(eventContainer);\r\n\t\t\t\t\t}, this);\r\n\r\n\t\t\t\t\tquery(\".dojoxCalendarDecorationContainerColumn\", div).forEach(function(decoContainer, i){\r\n\t\t\t\t\t\tdecoCols.push(decoContainer);\r\n\t\t\t\t\t}, this);\r\n\t\t\t\t}, this);\r\n\r\n\r\n\r\n\t\t\t}, this);\r\n\r\n\t\t\trenderData.cells = bgCols;\r\n\t\t\trenderData.decorationCells = decoCols;\r\n\t\t},\r\n\r\n\t\t// showTimeIndicator: Boolean\r\n\t\t//\t\tWhether show or not an indicator (default a red line) at the current time.\r\n\t\tshowTimeIndicator: true,\r\n\r\n\t\t// timeIndicatorRefreshInterval: Integer\r\n\t\t//\t\tMaximal interval between two refreshes of time indicator, in milliseconds.\r\n\t\ttimeIndicatorRefreshInterval: 60000,\r\n\r\n\t\t_setShowTimeIndicatorAttr: function(value){\r\n\t\t\tthis._set(\"showTimeIndicator\", value);\r\n\t\t\tthis._layoutTimeIndicator(this.renderData);\r\n\t\t},\r\n\r\n\t\t_layoutTimeIndicator: function(renderData){\r\n\t\t\tif(!renderData){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif(this.showTimeIndicator){\r\n\r\n\t\t\t\tvar now = new renderData.dateClassObj();\r\n\r\n\t\t\t\tvar visible = this.isOverlapping(renderData, renderData.startTime, renderData.endTime, now, now) &&\r\n\t\t\t\t \tnow.getHours() >= this.get(\"minHours\") &&\r\n\t\t\t\t\t(now.getHours()*60+now.getMinutes() < this.get(\"maxHours\")*60);\r\n\r\n\t\t\t\tif(visible){\r\n\r\n\t\t\t\t\tif(!this._timeIndicator){\r\n\t\t\t\t\t\tthis._timeIndicator = domConstruct.create(\"div\",\r\n\t\t\t\t\t\t\t\t{\"className\": \"dojoxCalendarTimeIndicator\"});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar node = this._timeIndicator;\r\n\r\n\t\t\t\t\tfor(var column=0; column<this.renderData.columnCount; column++){\r\n\t\t\t\t\t\tif(this.isSameDay(now, this.renderData.dates[column])){\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar top = this.computeProjectionOnDate(renderData, this.floorToDay(now), now, renderData.sheetHeight);\r\n\r\n\t\t\t\t\tif(top != renderData.sheetHeight){\r\n\r\n\t\t\t\t\t\tdomStyle.set(node, {top: top+\"px\", display: \"block\"});\r\n\t\t\t\t\t\tvar parentNode = renderData.cells[column*renderData.subColumnCount].parentNode.parentNode;\r\n\t\t\t\t\t\tif(parentNode != node.parentNode){\r\n\t\t\t\t\t\t\tif(node.parentNode != null){\r\n\t\t\t\t\t\t\t\tnode.parentNode.removeChild(node);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tparentNode.appendChild(node);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif(this._timeIndicatorTimer == null){\r\n\t\t\t\t\t\t\tthis._timeIndicatorTimer = setInterval(lang.hitch(this, function(){\r\n\t\t\t\t\t\t\t\tthis._layoutTimeIndicator(this.renderData);\r\n\t\t\t\t\t\t\t}), this.timeIndicatorRefreshInterval);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// not visible or specifically not shown fallback\r\n\r\n\t\t\tif(this._timeIndicatorTimer){\r\n\t\t\t\tclearInterval(this._timeIndicatorTimer);\r\n\t\t\t\tthis._timeIndicatorTimer = null;\r\n\t\t\t}\r\n\t\t\tif(this._timeIndicator){\r\n\t\t\t\tdomStyle.set(this._timeIndicator, \"display\", \"none\");\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tbeforeDeactivate: function(){\r\n\t\t\tif(this._timeIndicatorTimer){\r\n\t\t\t\tclearInterval(this._timeIndicatorTimer);\r\n\t\t\t\tthis._timeIndicatorTimer = null;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t///////////////////////////////////////////////////////////////\r\n\t\t//\r\n\t\t// Layout\r\n\t\t//\r\n\t\t///////////////////////////////////////////////////////////////\r\n\r\n\t\t_overlapLayoutPass2: function(lanes){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tSecond pass of the overlap layout (optional). Compute the extent of each layout item.\r\n\t\t\t// lanes:\r\n\t\t\t//\t\tThe array of lanes.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\tvar i,j,lane, layoutItem;\r\n\t\t\t// last lane, no extent possible\r\n\t\t\tlane = lanes[lanes.length-1];\r\n\r\n\t\t\tfor(j = 0; j < lane.length; j++){\r\n\t\t\t\tlane[j].extent = 1;\r\n\t\t\t}\r\n\r\n\t\t\tfor(i=0; i<lanes.length-1; i++){\r\n\t\t\t\tlane = lanes[i];\r\n\r\n\t\t\t\tfor(var j=0; j<lane.length; j++){\r\n\t\t\t\t\tlayoutItem = lane[j];\r\n\r\n\t\t\t\t\t// if item was already overlapping another one there is no extent possible.\r\n\t\t\t\t\tif(layoutItem.extent == -1){\r\n\t\t\t\t\t\tlayoutItem.extent = 1;\r\n\t\t\t\t\t\tvar space = 0;\r\n\r\n\t\t\t\t\t\tvar stop = false;\r\n\r\n\t\t\t\t\t\tfor(var k = i + 1; k < lanes.length && !stop; k++){\r\n\t\t\t\t\t\t\tvar ccol = lanes[k];\r\n\t\t\t\t\t\t\tfor(var l = 0; l < ccol.length && !stop; l++){\r\n\t\t\t\t\t\t\t\tvar layoutItem2 = ccol[l];\r\n\r\n\t\t\t\t\t\t\t\tif(layoutItem.start < layoutItem2.end && layoutItem2.start < layoutItem.end){\r\n\t\t\t\t\t\t\t\t\tstop = true;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(!stop){\r\n\t\t\t\t\t\t\t\t//no hit in the entire lane\r\n\t\t\t\t\t\t\t\tspace++;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tlayoutItem.extent += space;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_defaultItemToRendererKindFunc: function(item){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\treturn \"vertical\"; // String\r\n\t\t},\r\n\r\n\t\t_layoutInterval: function(/*Object*/renderData, /*Integer*/index, /*Date*/start, /*Date*/end, /*Object[]*/items, /*String*/itemsType){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\tvar verticalItems = [];\r\n\r\n\t\t\trenderData.colW = this.itemContainer.offsetWidth / renderData.columnCount;\r\n\r\n\t\t\tif(itemsType === \"dataItems\"){\r\n\r\n\t\t\t\tfor(var i=0; i<items.length; i++){\r\n\t\t\t\t\tvar item = items[i];\r\n\t\t\t\t\tvar kind = this._itemToRendererKind(item);\r\n\t\t\t\t\tif(kind === \"vertical\"){\r\n\t\t\t\t\t\tverticalItems.push(item);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._layoutRendererWithSubColumns(renderData, \"vertical\", true, index, start, end, verticalItems, itemsType);\r\n\r\n\t\t\t}else{ // itemsType === \"decorationItems\"\r\n\r\n\t\t\t\t// no different rendererKind for decoration yet\r\n\t\t\t\tthis._layoutRendererWithSubColumns(renderData, \"decoration\", false, index, start, end, items, itemsType);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_layoutRendererWithSubColumns: function(renderData, rendererKind, computeOverlap, index, start, end, items, itemsType){\r\n\t\t\tif(items.length > 0){\r\n\t\t\t\tif(renderData.subColumnCount > 1){\r\n\t\t\t\t\tvar subColumnItems = {};\r\n\t\t\t\t\tvar subCols = this.subColumns;\r\n\t\t\t\t\tarr.forEach(subCols, function(subCol){\r\n\t\t\t\t\t\tsubColumnItems[subCol] = [];\r\n\t\t\t\t\t});\r\n\t\t\t\t\tarr.forEach(items, function(item){\r\n\t\t\t\t\t\tif(itemsType === \"decorationItems\"){\r\n\t\t\t\t\t\t\tif(item.subColumn){\r\n\t\t\t\t\t\t\t\tif(subColumnItems[item.subColumn]){\r\n\t\t\t\t\t\t\t\t\tsubColumnItems[item.subColumn].push(item);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}else{ // for decorations, if no sub column is set, apply to all sub columns\r\n\t\t\t\t\t\t\t\tarr.forEach(subCols, function(subCol){\r\n\t\t\t\t\t\t\t\t\tvar clonedItem = lang.mixin({}, item);\r\n\t\t\t\t\t\t\t\t\tclonedItem.subColumn = subCol;\r\n\t\t\t\t\t\t\t\t\tsubColumnItems[subCol].push(clonedItem);\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}else if(item.subColumn && subColumnItems[item.subColumn]){\r\n\t\t\t\t\t\t\tsubColumnItems[item.subColumn].push(item);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tvar subColIndex = 0;\r\n\t\t\t\t\tarr.forEach(this.subColumns, function(subCol){\r\n\t\t\t\t\t\tthis._layoutVerticalItems(renderData, rendererKind, computeOverlap, index, subColIndex++, start, end, subColumnItems[subCol], itemsType);\r\n\t\t\t\t\t}, this);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis._layoutVerticalItems(renderData, rendererKind, computeOverlap, index, 0, start, end, items, itemsType);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_getColumn: function(renderData, index, subIndex, itemsType){\r\n\t\t\tvar cols = itemsType === \"dataItems\" ? renderData.cells : renderData.decorationCells;\r\n\t\t\treturn cols[index * renderData.subColumnCount + subIndex];\r\n\t\t},\r\n\r\n\t\t_layoutVerticalItems: function(/*Object*/renderData, /*String*/ rendererKind, /*boolean*/ computeOverlap,\r\n\t\t\t\t/*Integer*/index, /*Integer*/subIndex, /*Date*/startTime, /*Date*/endTime, /*Object[]*/items, /*String*/itemsType){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\tif(itemsType === \"dataItems\" && this.verticalRenderer == null ||\r\n\t\t\t\titemsType === \"decorationItems\" && this.verticalDecorationRenderer == null){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar cell = this._getColumn(renderData, index, subIndex, itemsType);\r\n\r\n\t\t\tvar layoutItems = [];\r\n\r\n\t\t\t// step 1 compute projected position and size\r\n\t\t\tfor(var i = 0; i < items.length; i++){\r\n\r\n\t\t\t\tvar item = items[i];\r\n\t\t\t\tvar overlap = this.computeRangeOverlap(renderData, item.startTime, item.endTime, startTime, endTime);\r\n\r\n\t\t\t\tvar top = this.computeProjectionOnDate(renderData, startTime, overlap[0], renderData.sheetHeight);\r\n\t\t\t\tvar bottom = this.computeProjectionOnDate(renderData, startTime, overlap[1], renderData.sheetHeight);\r\n\r\n\t\t\t\tif (bottom > top){\r\n\t\t\t\t\tvar litem = lang.mixin({\r\n\t\t\t\t\t\tstart: top,\r\n\t\t\t\t\t\tend: bottom,\r\n\t\t\t\t\t\trange: overlap,\r\n\t\t\t\t\t\titem: item\r\n\t\t\t\t\t}, item);\r\n\t\t\t\t\tlayoutItems.push(litem);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// step 2: compute overlapping layout\r\n\t\t\tvar numLanes = itemsType === \"dataItems\" ? this.computeOverlapping(layoutItems, this._overlapLayoutPass2).numLanes : 1;\r\n\r\n\t\t\tvar hOverlap = this.percentOverlap / 100;\r\n\r\n\t\t\t// step 3: create renderers and apply layout\r\n\t\t\tfor(i=0; i<layoutItems.length; i++){\r\n\r\n\t\t\t\titem = layoutItems[i];\r\n\t\t\t\tvar w, posX, ir, renderer;\r\n\r\n\t\t\t\tif(itemsType === \"dataItems\"){\r\n\r\n\t\t\t\t\tvar lane = item.lane;\r\n\t\t\t\t\tvar extent = item.extent;\r\n\r\n\t\t\t\t\tif(hOverlap == 0) {\r\n\t\t\t\t\t\t//no overlap and a padding between each event\r\n\t\t\t\t\t\tw = numLanes == 1 ? renderData.colW : ((renderData.colW - (numLanes - 1) * this.horizontalGap)/ numLanes);\r\n\t\t\t\t\t\tposX = lane * (w + this.horizontalGap);\r\n\t\t\t\t\t\tw = extent == 1 ? w : w * extent + (extent-1) * this.horizontalGap;\r\n\t\t\t\t\t\tw = 100 * w / renderData.colW;\r\n\t\t\t\t\t\tposX = 100 * posX / renderData.colW;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// an overlap\r\n\t\t\t\t\t\tw = numLanes == 1 ? 100 : (100 / (numLanes - (numLanes - 1) * hOverlap));\r\n\t\t\t\t\t\tposX = lane * (w - hOverlap*w);\r\n\t\t\t\t\t\tw = extent == 1 ? w : w * ( extent - (extent-1) * hOverlap);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tir = this._createRenderer(item, \"vertical\", this.verticalRenderer, \"dojoxCalendarVertical\");\r\n\r\n\t\t\t\t\tvar edited = this.isItemBeingEdited(item);\r\n\t\t\t\t\tvar selected = this.isItemSelected(item);\r\n\t\t\t\t\tvar hovered = this.isItemHovered(item);\r\n\t\t\t\t\tvar focused = this.isItemFocused(item);\r\n\r\n\t\t\t\t\trenderer = ir.renderer;\r\n\r\n\t\t\t\t\trenderer.set(\"hovered\", hovered);\r\n\t\t\t\t\trenderer.set(\"selected\", selected);\r\n\t\t\t\t\trenderer.set(\"edited\", edited);\r\n\t\t\t\t\trenderer.set(\"focused\", this.showFocus ? focused : false);\r\n\t\t\t\t\trenderer.set(\"storeState\", this.getItemStoreState(item));\r\n\r\n\t\t\t\t\trenderer.set(\"moveEnabled\", this.isItemMoveEnabled(item._item, \"vertical\"));\r\n\t\t\t\t\trenderer.set(\"resizeEnabled\", this.isItemResizeEnabled(item._item, \"vertical\"));\r\n\r\n\t\t\t\t\tthis.applyRendererZIndex(item, ir, hovered, selected, edited, focused);\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\tw = 100;\r\n\t\t\t\t\tposX = 0;\r\n\t\t\t\t\tir = this.decorationRendererManager.createRenderer(item, \"vertical\", this.verticalDecorationRenderer, \"dojoxCalendarDecoration\");\r\n\t\t\t\t\trenderer = ir.renderer;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdomStyle.set(ir.container, {\r\n\t\t\t\t\t\"top\": item.start + \"px\",\r\n\t\t\t\t\t\"left\": posX + \"%\",\r\n\t\t\t\t\t\"width\": w + \"%\",\r\n\t\t\t\t\t\"height\": (item.end-item.start+1) + \"px\"\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif(renderer.updateRendering){\r\n\t\t\t\t\trenderer.updateRendering(w, item.end-item.start+1);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdomConstruct.place(ir.container, cell);\r\n\t\t\t\tdomStyle.set(ir.container, \"display\", \"block\");\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_sortItemsFunction: function(a, b){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\tvar res = this.dateModule.compare(a.startTime, b.startTime);\r\n\t\t\tif(res == 0){\r\n\t\t\t\tres = -1 * this.dateModule.compare(a.endTime, b.endTime);\r\n\t\t\t}\r\n\t\t\treturn this.isLeftToRight() ? res : -res;\r\n\t\t},\r\n\r\n\t\t///////////////////////////////////////////////////////////////\r\n\t\t//\r\n\t\t// View to time projection\r\n\t\t//\r\n\t\t///////////////////////////////////////////////////////////////\r\n\r\n\t\t_getNormalizedCoords: function(e, x, y, touchIndex){\r\n\t\t\tif (e != null){\r\n\t\t\t\tvar refPos = domGeometry.position(this.itemContainer, true);\r\n\r\n\t\t\t\tif(e.touches){\r\n\r\n\t\t\t\t\ttouchIndex = touchIndex==undefined ? 0 : touchIndex;\r\n\r\n\t\t\t\t\tx = e.touches[touchIndex].pageX - refPos.x;\r\n\t\t\t\t\ty = e.touches[touchIndex].pageY - refPos.y;\r\n\r\n\t\t\t\t}else{\r\n\r\n\t\t\t\t\tx = e.pageX - refPos.x;\r\n\t\t\t\t\ty = e.pageY - refPos.y;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar r = domGeometry.getContentBox(this.itemContainer);\r\n\r\n\t\t\tif(!this.isLeftToRight()){\r\n\t\t\t\tx = r.w - x;\r\n\t\t\t}\r\n\r\n\t\t\tif (x < 0){\r\n\t\t\t\tx = 0;\r\n\t\t\t}else if(x > r.w){\r\n\t\t\t\tx = r.w-1;\r\n\t\t\t}\r\n\r\n\t\t\tif (y < 0){\r\n\t\t\t\ty = 0;\r\n\t\t\t}else if(y > r.h){\r\n\t\t\t\ty = r.h-1;\r\n\t\t\t}\r\n\r\n\t\t\treturn {x: x, y: y};\r\n\t\t},\r\n\r\n\t\tgetTime: function(e, x, y, touchIndex){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tReturns the time displayed at the specified point by this component.\r\n\t\t\t// e: Event\r\n\t\t\t//\t\tOptional mouse event.\r\n\t\t\t// x: Number\r\n\t\t\t//\t\tPosition along the x-axis with respect to the sheet container used if event is not defined.\r\n\t\t\t// y: Number\r\n\t\t\t//\t\tPosition along the y-axis with respect to the sheet container (scroll included) used if event is not defined.\r\n\t\t\t// touchIndex: Integer\r\n\t\t\t//\t\tIf parameter 'e' is not null and a touch event, the index of the touch to use.\r\n\t\t\t// returns: Date\r\n\r\n\t\t\tvar o = this._getNormalizedCoords(e, x, y, touchIndex);\r\n\t\t\tvar t = this.getTimeOfDay(o.y, this.renderData);\r\n\t\t\tvar colW = domGeometry.getMarginBox(this.itemContainer).w / this.renderData.columnCount;\r\n\t\t\tvar col = Math.floor(o.x / colW);\r\n\r\n\t\t\tvar date = null;\r\n\t\t\tif(col < this.renderData.dates.length){\r\n\t\t\t\tdate = this.newDate(this.renderData.dates[col]);\r\n\t\t\t\tdate = this.floorToDay(date, true);\r\n\t\t\t\tdate.setHours(t.hours);\r\n\t\t\t\tdate.setMinutes(t.minutes);\r\n\t\t\t}\r\n\r\n\t\t\treturn date;\r\n\t\t},\r\n\r\n\t\tgetSubColumn: function(e, x, y, touchIndex){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tReturns the sub column at the specified point by this component.\r\n\t\t\t// e: Event\r\n\t\t\t//\t\tOptional mouse event.\r\n\t\t\t// x: Number\r\n\t\t\t//\t\tPosition along the x-axis with respect to the sheet container used if event is not defined.\r\n\t\t\t// y: Number\r\n\t\t\t//\t\tPosition along the y-axis with respect to the sheet container (scroll included) used if event is not defined.\r\n\t\t\t// touchIndex: Integer\r\n\t\t\t//\t\tIf parameter 'e' is not null and a touch event, the index of the touch to use.\r\n\t\t\t// returns: Object\r\n\r\n\t\t\tif(this.subColumns == null || this.subColumns.length == 1){\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\tvar o = this._getNormalizedCoords(e, x, y, touchIndex);\r\n\t\t\tvar rd = this.renderData;\r\n\t\t\tvar colW = domGeometry.getMarginBox(this.itemContainer).w / this.renderData.columnCount;\r\n\t\t\tvar col = Math.floor(o.x / colW);\r\n\t\t\tvar idx = Math.floor((o.x - col*colW) / (colW / rd.subColumnCount));\r\n\t\t\treturn this.subColumns[idx];\r\n\t\t},\r\n\r\n\t\t///////////////////////////////////////////////////////////////\r\n\t\t//\r\n\t\t// Events\r\n\t\t//\r\n\t\t///////////////////////////////////////////////////////////////\r\n\r\n\t\t_onGridMouseUp: function(e){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\tthis.inherited(arguments);\r\n\r\n\t\t\tif (this._gridMouseDown) {\r\n\t\t\t\tthis._gridMouseDown = false;\r\n\r\n\t\t\t\tthis._onGridClick({\r\n\t\t\t\t\tdate: this.getTime(e),\r\n\t\t\t\t\ttriggerEvent: e\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_onGridTouchStart: function(e){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\tthis.inherited(arguments);\r\n\r\n\t\t\tvar g = this._gridProps;\r\n\r\n\t\t\tg.moved= false;\r\n\t\t\tg.start= e.touches[0].screenY;\r\n\t\t\tg.scrollTop= this._getScrollPosition();\r\n\t\t},\r\n\r\n\t\t_onGridTouchMove: function(e){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\tthis.inherited(arguments);\r\n\r\n\t\t\tif (e.touches.length > 1 && !this._isEditing){\r\n\t\t\t\tevent.stop(e);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif(this._gridProps && !this._isEditing){\r\n\r\n\t\t\t\tvar touch = {x: e.touches[0].screenX, y: e.touches[0].screenY};\r\n\r\n\t\t\t\tvar p = this._edProps;\r\n\r\n\t\t\t\tif (!p || p &&\r\n\t\t\t\t\t(Math.abs(touch.x - p.start.x) > 25 ||\r\n\t\t\t\t\t Math.abs(touch.y - p.start.y) > 25)) {\r\n\r\n\t\t\t\t\tthis._gridProps.moved = true;\r\n\t\t\t\t\tvar d = e.touches[0].screenY - this._gridProps.start;\r\n\t\t\t\t\tvar value = this._gridProps.scrollTop - d;\r\n\t\t\t\t\tvar max = this.itemContainer.offsetHeight - this.scrollContainer.offsetHeight;\r\n\t\t\t\t\tif (value < 0){\r\n\t\t\t\t\t\tthis._gridProps.start = e.touches[0].screenY;\r\n\t\t\t\t\t\tthis._setScrollImpl(0);\r\n\t\t\t\t\t\tthis._gridProps.scrollTop = 0;\r\n\t\t\t\t\t}else if(value > max){\r\n\t\t\t\t\t\tthis._gridProps.start = e.touches[0].screenY;\r\n\t\t\t\t\t\tthis._setScrollImpl(max);\r\n\t\t\t\t\t\tthis._gridProps.scrollTop = max;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tthis._setScrollImpl(value);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_onGridTouchEnd: function(e){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\t//event.stop(e);\r\n\r\n\t\t\tthis.inherited(arguments);\r\n\r\n\t\t\tvar g = this._gridProps;\r\n\r\n\t\t\tif(g){\r\n\t\t\t\tif(!this._isEditing){\r\n\t\t\t\t\tif(!g.moved){\r\n\r\n\t\t\t\t\t\t// touched on grid and on touch start editing was ongoing.\r\n\t\t\t\t\t\tif(!g.fromItem && !g.editingOnStart){\r\n\t\t\t\t\t\t\tthis.selectFromEvent(e, null, null, true);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif(!g.fromItem){\r\n\r\n\t\t\t\t\t\t\tif(this._pendingDoubleTap && this._pendingDoubleTap.grid){\r\n\r\n\t\t\t\t\t\t\t\tthis._onGridDoubleClick({\r\n\t\t\t\t\t\t\t\t\tdate: this.getTime(this._gridProps.event),\r\n\t\t\t\t\t\t\t\t\ttriggerEvent: this._gridProps.event\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\tclearTimeout(this._pendingDoubleTap.timer);\r\n\r\n\t\t\t\t\t\t\t\tdelete this._pendingDoubleTap;\r\n\r\n\t\t\t\t\t\t\t}else{\r\n\r\n\t\t\t\t\t\t\t\tthis._onGridClick({\r\n\t\t\t\t\t\t\t\t\tdate: this.getTime(this._gridProps.event),\r\n\t\t\t\t\t\t\t\t\ttriggerEvent: this._gridProps.event\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\tthis._pendingDoubleTap = {\r\n\t\t\t\t\t\t\t\t\tgrid: true,\r\n\t\t\t\t\t\t\t\t\ttimer: setTimeout(lang.hitch(this, function(){\r\n\t\t\t\t\t\t\t\t\t\t\tdelete this._pendingDoubleTap;\r\n\t\t\t\t\t\t\t\t\t}), this.doubleTapDelay)\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._gridProps = null;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_onColumnHeaderClick: function(e){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\tthis._dispatchCalendarEvt(e, \"onColumnHeaderClick\");\r\n\t\t},\r\n\r\n\r\n\r\n\t\tonColumnHeaderClick: function(e){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tEvent dispatched when a column header cell is dispatched.\r\n\t\t\t// e: __ColumnClickEventArgs\r\n\t\t\t//\t\tThe event has the following properties\r\n\t\t\t// tags:\r\n\t\t\t//\t\tcallback\r\n\t\t},\r\n\r\n\r\n\t\tgetTimeOfDay: function (pos, rd) {\r\n\t\t\t// summary:\r\n\t\t\t//\t\tReturn the time of day associated to the specified position.\r\n\t\t\t// pos: Integer\r\n\t\t\t//\t\tThe position in pixels.\r\n\t\t\t// rd: Object\r\n\t\t\t//\t\tThe render data.\r\n\t\t\tvar minH = rd.minHours*60;\r\n\t\t\tvar maxH = rd.maxHours*60;\r\n\t\t\tvar minutes = minH + (pos * (maxH - minH) / rd.sheetHeight);\r\n\t\t\treturn {\r\n\t\t\t\thours: Math.floor(minutes / 60),\r\n\t\t\t\tminutes: Math.floor(minutes % 60)\r\n\t\t\t};\r\n\t\t},\r\n\r\n\t\t///////////////////////////////////////////////////////////////\r\n\t\t//\r\n\t\t// View limits\r\n\t\t//\r\n\t\t///////////////////////////////////////////////////////////////\r\n\r\n\t\t_isItemInView: function(item){\r\n\r\n\t\t\t// subclassed to add some tests\r\n\r\n\t\t\tvar res = this.inherited(arguments);\r\n\r\n\t\t\tif(res){\r\n\r\n\t\t\t\t// test if time range is overlapping [maxHours, next day min hours]\r\n\t\t\t\tvar rd = this.renderData;\r\n\r\n\t\t\t\tvar len = rd.dateModule.difference(item.startTime, item.endTime, \"millisecond\");\r\n\t\t\t\tvar vLen = (24 - rd.maxHours + rd.minHours) * 3600000; // 60 * 60 * 1000, number of milliseconds in 1 minute\r\n\r\n\t\t\t\tif(len > vLen){ // longer events are always visible\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar sMin = item.startTime.getHours()*60 + item.startTime.getMinutes();\r\n\t\t\t\tvar eMin = item.endTime.getHours()*60 + item.endTime.getMinutes();\r\n\t\t\t\tvar sV = rd.minHours * 60;\r\n\t\t\t\tvar eV = rd.maxHours * 60;\r\n\r\n\t\t\t\tif(sMin > 0 && sMin < sV || sMin > eV && sMin <= 1440){\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(eMin > 0 && eMin < sV || eMin > eV && eMin <= 1440){\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn res;\r\n\t\t},\r\n\r\n\t\t_ensureItemInView: function(item){\r\n\r\n\t\t\tvar fixed;\r\n\r\n\t\t\tvar startTime = item.startTime;\r\n\t\t\tvar endTime = item.endTime;\r\n\r\n\t\t\t// test if time range is overlapping [maxHours, next day min hours]\r\n\t\t\tvar rd = this.renderData;\r\n\t\t\tvar cal = rd.dateModule;\r\n\r\n\t\t\tvar len = Math.abs(cal.difference(item.startTime, item.endTime, \"millisecond\"));\r\n\t\t\tvar vLen = (24 - rd.maxHours + rd.minHours) * 3600000;\r\n\r\n\t\t\tif(len > vLen){ // longer events are always visible\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tvar sMin = startTime.getHours()*60 + startTime.getMinutes();\r\n\t\t\tvar eMin = endTime.getHours()*60 + endTime.getMinutes();\r\n\t\t\tvar sV = rd.minHours * 60;\r\n\t\t\tvar eV = rd.maxHours * 60;\r\n\r\n\t\t\tif(sMin > 0 && sMin < sV){\r\n\t\t\t\tthis.floorToDay(item.startTime, true, rd);\r\n\t\t\t\titem.startTime.setHours(rd.minHours);\r\n\t\t\t\titem.endTime = cal.add(item.startTime, \"millisecond\", len);\r\n\t\t\t\tfixed = true;\r\n\t\t\t}else if(sMin > eV && sMin <= 1440){\r\n\t\t\t\t// go on next visible time\r\n\t\t\t\tthis.floorToDay(item.startTime, true, rd);\r\n\t\t\t\titem.startTime = cal.add(item.startTime, \"day\", 1);\r\n\t\t\t\t// if we are going out of the view, the super() will fix it\r\n\t\t\t\titem.startTime.setHours(rd.minHours);\r\n\t\t\t\titem.endTime = cal.add(item.startTime, \"millisecond\", len);\r\n\t\t\t\tfixed = true;\r\n\t\t\t}\r\n\r\n\t\t\tif(eMin > 0 && eMin < sV){\r\n\t\t\t\t// go on previous day\r\n\t\t\t\tthis.floorToDay(item.endTime, true, rd);\r\n\t\t\t\titem.endTime = cal.add(item.endTime, \"day\", -1);\r\n\t\t\t\titem.endTime.setHours(rd.maxHours);\r\n\t\t\t\titem.startTime = cal.add(item.endTime, \"millisecond\", -len);\r\n\t\t\t\tfixed = true;\r\n\t\t\t}else if(eMin > eV && eMin <= 1440){\r\n\t\t\t\tthis.floorToDay(item.endTime, true, rd);\r\n\t\t\t\titem.endTime.setHours(rd.maxHours);\r\n\t\t\t\titem.startTime = cal.add(item.endTime, \"millisecond\", -len);\r\n\t\t\t\tfixed = true;\r\n\t\t\t}\r\n\r\n\t\t\tfixed = fixed || this.inherited(arguments);\r\n\r\n\t\t\treturn fixed;\r\n\t\t},\r\n\r\n\t\t_onScrollTimer_tick: function(){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\tthis._scrollToPosition(this._getScrollPosition() + this._scrollProps.scrollStep);\r\n\t\t},\r\n\r\n\t\t////////////////////////////////////////////\r\n\t\t//\r\n\t\t// Editing\r\n\t\t//\r\n\t\t///////////////////////////////////////////\r\n\r\n\t\tsnapUnit: \"minute\",\r\n\t\tsnapSteps: 15,\r\n\t\tminDurationUnit: \"minute\",\r\n\t\tminDurationSteps: 15,\r\n\t\tliveLayout: false,\r\n\t\tstayInView: true,\r\n\t\tallowStartEndSwap: true,\r\n\t\tallowResizeLessThan24H: true\r\n\r\n\t});\r\n});\r\n"]}