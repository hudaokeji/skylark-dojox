{"version":3,"sources":["calendar/ColumnViewSecondarySheet.js"],"names":["define","arr","declare","event","lang","domGeometry","domStyle","MatrixView","template","templateString","rowCount","cellPaddingTop","roundToDay","_defaultHeight","layoutDuringResize","buildRendering","this","inherited","arguments","_hScrollNodes","gridTable","itemContainerTable","_configureHScrollDomNodes","styleWidth","forEach","elt","set","_defaultItemToRendererKindFunc","item","allDay","_formatGridCellLabel","_formatRowHeaderLabel","__fixEvt","e","sheet","source","_dispatchCalendarEvt","name","owner","_layoutExpandRenderers","index","hasHiddenItems","hiddenItems","expandRenderer","_expandedRowCol","h","getMarginBox","domNode","_getExpandedHeight","undefined","col","renderData","columnCount","_layoutExpandRendererImpl","expandRendererClickHandler","renderer","stop","expandedH","columnIndex","resizeSecondarySheet","naturalRowsHeight","length","expandRendererHeight","verticalGap","_layoutRenderers","_domReady","items"],"mappings":";;;;;;;AAAAA,QACA,mBACA,qBACA,mBACA,kBACA,oBACA,iBACA,4BACA,uDAEA,SAASC,EACPC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,GAED,OAAON,EAAQ,0CAA2CK,GAMzDE,eAAgBD,EAEhBE,SAAU,EAEVC,eAAgB,EAEhBC,YAAY,EAEZC,gBAAiB,EAEjBC,oBAAoB,EAEpBC,eAAgB,WACfC,KAAKC,UAAUC,WACfF,KAAKG,eAAiBH,KAAKI,UAAWJ,KAAKK,qBAG5CC,0BAA2B,SAASC,GACnCtB,EAAIuB,QAAQR,KAAKG,cAAe,SAASM,GACxCnB,EAASoB,IAAID,EAAK,QAASF,IACzBP,OAGJW,+BAAgC,SAASC,GAGxC,OAAOA,EAAKC,OAAS,aAAe,MAGrCC,qBAAsB,WAAW,OAAO,MAExCC,sBAAuB,WAAW,OAAO,MAIzCC,SAAS,SAASC,GAGjB,OAFAA,EAAEC,MAAQ,YACVD,EAAEE,OAASnB,KACJiB,GAGRG,qBAAsB,SAASH,EAAGI,GACjCJ,EAAIjB,KAAKC,UAAUC,WAChBF,KAAKsB,MAAMA,OACbtB,KAAKsB,MAAMA,MAAMD,GAAMJ,IAIzBM,uBAAwB,SAASC,EAAOC,EAAgBC,GACvD,GAAI1B,KAAK2B,iBAA2C,GAAzB3B,KAAK4B,gBAAhC,CAGA,IAAIC,EAAIxC,EAAYyC,aAAa9B,KAAK+B,SAASF,EAM/C,IAL2B,GAAxB7B,KAAKH,gBACiB,IAAxBG,KAAKH,iBACLG,KAAKH,eAAiBgC,GAGpB7B,KAAKH,gBAAkBgC,GAAKA,GAAK7B,KAAKgC,2BACfC,IAAzBjC,KAAK4B,kBAA2D,IAA1B5B,KAAK4B,gBAAuB,CAClE,IAAIM,EAAMlC,KAAK4B,gBACZM,GAAOlC,KAAKmC,WAAWC,cACzBF,EAAM,GAEPlC,KAAKqC,0BAA0B,EAAGH,EAAK,MAAM,QAE7ClC,KAAKC,UAAUC,aAIjBoC,2BAA4B,SAASrB,EAAGsB,GAWvCpD,EAAMqD,KAAKvB,GAEX,IAAIY,EAAIxC,EAAYyC,aAAa9B,KAAK+B,SAASF,EAC3CY,EAAYzC,KAAKgC,qBAClBhC,KAAKH,gBAAkBgC,GAAKA,EAAIY,GAClCzC,KAAK4B,gBAAkBW,EAASG,YAChC1C,KAAKsB,MAAMqB,qBAAqBF,YAEzBzC,KAAK4B,gBACZ5B,KAAKsB,MAAMqB,qBAAqB3C,KAAKH,kBAKvCmC,mBAAoB,WAInB,OAAQhC,KAAK4C,mBAAqB5C,KAAK4C,kBAAkBC,OAAS,EAAI7C,KAAK4C,kBAAkB,GAAK,GACjG5C,KAAK8C,qBAAuB9C,KAAK+C,YAAc/C,KAAK+C,aAGtDC,iBAAkB,SAASb,GACtBnC,KAAKiD,YAGTjD,KAAKC,UAAUC,WAEXiC,EAAWe,OAAqC,IAA5Bf,EAAWe,MAAML,QACxC7C,KAAKuB,uBAAuB,GAAG,EAAO","file":"../../calendar/ColumnViewSecondarySheet.js","sourcesContent":["define([\r\n\"dojo/_base/array\",\r\n\"dojo/_base/declare\",\r\n\"dojo/_base/event\",\r\n\"dojo/_base/lang\",\r\n\"dojo/dom-geometry\",\r\n\"dojo/dom-style\",\r\n\"dojox/calendar/MatrixView\",\r\n\"dojo/text!./templates/ColumnViewSecondarySheet.html\"],\r\n\r\nfunction(arr,\r\n\t\tdeclare,\r\n\t\tevent,\r\n\t\tlang,\r\n\t\tdomGeometry,\r\n\t\tdomStyle,\r\n\t\tMatrixView,\r\n\t\ttemplate){\r\n\r\n\treturn declare(\"dojox.calendar.ColumnViewSecondarySheet\", MatrixView, {\r\n\r\n\t\t// summary:\r\n\t\t//\t\tThis class defines a matrix view designed to be embedded in a column view,\r\n\t\t//\t\tusually to display long or all day events on one row.\r\n\r\n\t\ttemplateString: template,\r\n\r\n\t\trowCount: 1,\r\n\r\n\t\tcellPaddingTop: 4,\r\n\r\n\t\troundToDay: false,\r\n\r\n\t\t_defaultHeight: -1,\r\n\r\n\t\tlayoutDuringResize: true,\r\n\r\n\t\tbuildRendering: function(){\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\tthis._hScrollNodes = [this.gridTable, this.itemContainerTable];\r\n\t\t},\r\n\r\n\t\t_configureHScrollDomNodes: function(styleWidth){\r\n\t\t\tarr.forEach(this._hScrollNodes, function(elt){\r\n\t\t\t\tdomStyle.set(elt, \"width\", styleWidth);\r\n\t\t\t}, this);\r\n\t\t},\r\n\r\n\t\t_defaultItemToRendererKindFunc: function(item){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\treturn item.allDay ? \"horizontal\" : null;\r\n\t\t},\r\n\r\n\t\t_formatGridCellLabel: function(){return null;},\r\n\r\n\t\t_formatRowHeaderLabel: function(){return null;},\r\n\r\n\r\n\t\t// events redispatch\r\n\t\t__fixEvt:function(e){\r\n\t\t\te.sheet = \"secondary\";\r\n\t\t\te.source = this;\r\n\t\t\treturn e;\r\n\t\t},\r\n\r\n\t\t_dispatchCalendarEvt: function(e, name){\r\n\t\t\te = this.inherited(arguments);\r\n\t\t\tif(this.owner.owner){ // the calendar\r\n\t\t\t\tthis.owner.owner[name](e);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_layoutExpandRenderers: function(index, hasHiddenItems, hiddenItems){\r\n\t\t\tif(!this.expandRenderer || this._expandedRowCol == -1){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar h = domGeometry.getMarginBox(this.domNode).h;\r\n\t\t\tif(this._defaultHeight == -1 ||  // not set\r\n\t\t\t\tthis._defaultHeight === 0){  // initialized at 0, must be reset\r\n\t\t\t\tthis._defaultHeight = h;\r\n\t\t\t}\r\n\r\n\t\t\tif(this._defaultHeight != h && h >= this._getExpandedHeight() ||\r\n\t\t\t\tthis._expandedRowCol !== undefined && this._expandedRowCol !== -1){\r\n\t\t\t\tvar col = this._expandedRowCol;\r\n\t\t\t\tif(col >= this.renderData.columnCount){\r\n\t\t\t\t\tcol = 0;\r\n\t\t\t\t}\r\n\t\t\t\tthis._layoutExpandRendererImpl(0, col, null, true);\r\n\t\t\t}else{\r\n\t\t\t\tthis.inherited(arguments);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\texpandRendererClickHandler: function(e, renderer){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tDefault action when an expand renderer is clicked.\r\n\t\t\t//\t\tThis method will expand the secondary sheet to show all the events.\r\n\t\t\t// e: Event\r\n\t\t\t//\t\tThe mouse event.\r\n\t\t\t// renderer: Object\r\n\t\t\t//\t\tThe renderer that was clicked.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tcallback\r\n\r\n\t\t\tevent.stop(e);\r\n\r\n\t\t\tvar h = domGeometry.getMarginBox(this.domNode).h;\r\n\t\t\tvar expandedH = this._getExpandedHeight();\r\n\t\t\tif(this._defaultHeight == h || h < expandedH){\r\n\t\t\t\tthis._expandedRowCol = renderer.columnIndex;\r\n\t\t\t\tthis.owner.resizeSecondarySheet(expandedH);\r\n\t\t\t}else{\r\n\t\t\t\tdelete this._expandedRowCol;\r\n\t\t\t\tthis.owner.resizeSecondarySheet(this._defaultHeight);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\r\n\t\t_getExpandedHeight: function(){\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\r\n\t\t\treturn (this.naturalRowsHeight && this.naturalRowsHeight.length > 0 ? this.naturalRowsHeight[0] : 0) +\r\n\t\t\t\tthis.expandRendererHeight + this.verticalGap + this.verticalGap;\r\n\t\t},\r\n\r\n\t\t_layoutRenderers: function(renderData){\r\n\t\t\tif(!this._domReady){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\t// make sure to show the expand/collapse renderer if no item is displayed but the row was expanded.\r\n\t\t\tif(!renderData.items || renderData.items.length === 0){\r\n\t\t\t\tthis._layoutExpandRenderers(0, false, null);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t});\r\n});\r\n"]}