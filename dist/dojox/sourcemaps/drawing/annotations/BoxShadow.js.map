{"version":3,"sources":["drawing/annotations/BoxShadow.js"],"names":["define","dojo","Color","oo","declare","options","this","stencil","util","mouse","style","mixin","size","mult","alpha","place","color","a","shortType","method","console","warn","type","render","connectMult","showing","container","removeShape","createGroup","moveToBack","o","d","points","data","r","p","c","hide","show","add","createForPath","pts","sh","shy","test","shx","i","lineWidth","dojox","gfx","renderer","strAr","forEach","push","x","y","cmd","t","createPath","join","setStroke","width","cap","pth","moveTo","closePath","lineTo","createForLine","createLine","x1","y1","x2","y2","createForEllipse","createEllipse","cx","cy","rx","ry","createForRect","createRect","height","arrowPoints","radius","getRadius","angle","zAngle","pt","pointOnCircle","obj","start","lineLength","length","al","arrows","aw","p1","p2","createForZArrow","cosphi","setFill","sp","onTransform","onRender","destroy"],"mappings":"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","file":"../../../drawing/annotations/BoxShadow.js","sourcesContent":["define([\"dojo\", \"dojo/_base/Color\", \"../util/oo\"], \r\nfunction(dojo, Color, oo){\r\n\r\nreturn oo.declare(\r\n\tfunction(/*Object*/options){\r\n\t\tthis.stencil = options.stencil;\r\n\t\tthis.util = options.stencil.util;\r\n\t\tthis.mouse = options.stencil.mouse;\r\n\t\tthis.style = options.stencil.style;\r\n\t\t\r\n\t\tvar shadowDefaults = {\r\n\t\t\t// summary:\r\n\t\t\t//\t\tWhen passing a shadow object into a stencil, that shadow\r\n\t\t\t//\t\tobject will be mixed in with these defaults.\r\n\r\n\t\t\t// size: Number\r\n\t\t\t//\t\tWorks together with mult. Both affect the size and quality\r\n\t\t\t//\t\tof the shadow. size affects the actual size and mult affects the\r\n\t\t\t//\t\tlineWidths that overlap to make the shadow. Generally you want a\r\n\t\t\t//\t\tbigger 'size' than 'mult'. The defaults are good for a shadow, but\r\n\t\t\t//\t\tyou will want to increase them when making a glow.\r\n\t\t\t//\t\tTODO: Make this more clear or use other properties.\r\n\t\t\tsize:6,\r\n\r\n\t\t\t// mult: Number\r\n\t\t\t//\t\tWorks together with size.  Both affect the size and quality\r\n\t\t\t//\t\tof the shadow. size affects the actual size and mult affects the\r\n\t\t\t//\t\tlineWidths that overlap to make the shadow. Generally you want a\r\n\t\t\t//\t\tbigger 'size' than 'mult'. The defaults are good for a shadow, but\r\n\t\t\t//\t\tyou will want to increase them when making a glow.\r\n\t\t\t//\t\tTODO: Make this more clear or use other properties.\r\n\t\t\tmult:4,\r\n\r\n\t\t\t// alpha: Float\r\n\t\t\t//\t\tAffects the alpha of the shadow. Because this is multiple shapes\r\n\t\t\t//\t\toverlapped, you want much less than you may think. .1 is pretty\r\n\t\t\t//\t\tdark and . is black. Higher numbers also give a sharper edge.\r\n\t\t\talpha:.05,\r\n\r\n\t\t\t// place: String\r\n\t\t\t//\t\tTells the position of the shadow:\r\n\t\t\t//\r\n\t\t\t//\t\t- B: bottom\r\n\t\t\t//\t\t- T: top\r\n\t\t\t//\t\t- L: left\r\n\t\t\t//\t\t- R: right\r\n\t\t\t//\t\t- C: center, or a glow\r\n\t\t\t//\r\n\t\t\t//\t\tCan be used in combinations such as BR, BL, L, T, etc. 'C' should\r\n\t\t\t//\t\tbe used by itself.\r\n\t\t\tplace:\"BR\",\r\n\r\n\t\t\t// color: String\r\n\t\t\t//\t\tThe color of the shadow or glow.\r\n\t\t\tcolor:\"#646464\"\r\n\t\t};\r\n\t\t\r\n\t\tdelete options.stencil;\r\n\t\tthis.options = dojo.mixin(shadowDefaults, options);\r\n\t\tthis.options.color = new Color(this.options.color)\r\n\t\tthis.options.color.a = this.options.alpha;\r\n\t\tswitch(this.stencil.shortType){\r\n\t\t\tcase \"image\":\r\n\t\t\tcase \"rect\":\r\n\t\t\t\tthis.method = \"createForRect\"; break;\r\n\t\t\tcase \"ellipse\":\r\n\t\t\t\tthis.method = \"createForEllipse\"; break;\r\n\t\t\tcase \"line\":\r\n\t\t\t\tthis.method = \"createForLine\"; break;\r\n\t\t\tcase \"path\":\r\n\t\t\t\tthis.method = \"createForPath\"; break;\r\n\t\t\t\t// \tpath is a bit of a hassle. Plus I think in IE it would be\r\n\t\t\t\t//slower than the political process. Maybe TODO.\r\n\t\t\tcase \"vector\":\r\n\t\t\t\tthis.method = \"createForZArrow\"; break;\r\n\t\t\tdefault:\r\n\t\t\t\tconsole.warn(\"A shadow cannot be made for Stencil type \", this.stencil.type);\r\n\t\t}\r\n\t\t\r\n\t\tif(this.method){\r\n\t\t\tthis.render();\r\n\t\t\tthis.stencil.connectMult([\r\n\t\t\t\t[this.stencil, \"onTransform\", this, \"onTransform\"],\r\n\t\t\t\tthis.method==\"createForZArrow\"?[this.stencil, \"render\", this, \"render\"]:[this.stencil, \"render\", this, \"onRender\"],\r\n\t\t\t\t[this.stencil, \"onDelete\", this, \"destroy\"]\r\n\t\t\t]);\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t// summary:\r\n\t\t//\t\tCreates a box shadow under solid objects. Can change the\r\n\t\t//\t\tshadow direction, color, size, and intensity. Can center\r\n\t\t//\t\tthe shadow and make it a Glow.\r\n\t\t// description:\r\n\t\t//\t\tThis is a pseudo shadow, created by duplicating the\r\n\t\t//\t\toriginal stencil and increasing the line weight while\r\n\t\t//\t\treducing the opacity. Therefore it will not work with\r\n\t\t//\t\ttext. Also won't look very good if the Stencil has no\r\n\t\t//\t\tfill or is transparent. Can't do knockouts or inner\r\n\t\t//\t\tshadows. Currently can't do paths - while doable, it\r\n\t\t//\t\twill most likely choke IE into certain death.\r\n\r\n\t\tshowing:true,\r\n\t\trender: function(){\r\n\t\t\tif(this.container){\r\n\t\t\t\tthis.container.removeShape();\r\n\t\t\t}\r\n\t\t\tthis.container = this.stencil.container.createGroup();\r\n\t\t\tthis.container.moveToBack();\r\n\t\t\t\r\n\t\t\tvar o = this.options,\r\n\t\t\t\tsize = o.size,\r\n\t\t\t\tmult = o.mult,\r\n\t\t\t\td = this.method == \"createForPath\"\r\n\t\t\t\t\t? this.stencil.points\r\n\t\t\t\t\t: this.stencil.data,\r\n\t\t\t\tr = d.r || 1,\r\n\t\t\t\tp = o.place,\r\n\t\t\t\tc = o.color;\r\n\t\t\t\t\r\n\t\t\tthis[this.method](o, size, mult, d, r, p, c);\r\n\t\t},\r\n\t\t\r\n\t\thide: function(){\r\n\t\t\tif(this.showing){\r\n\t\t\t\tthis.showing = false;\r\n\t\t\t\tthis.container.removeShape();\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\tshow: function(){\r\n\t\t\tif(!this.showing){\r\n\t\t\t\tthis.showing = true;\r\n\t\t\t\tthis.stencil.container.add(this.container);\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\tcreateForPath: function(o, size, mult, pts, r, p, c){\r\n\t\t\tvar sh = size * mult / 4,\r\n\t\t\t\tshy = /B/.test(p) ? sh : /T/.test(p) ? sh*-1 : 0,\r\n\t\t\t\tshx = /R/.test(p) ? sh : /L/.test(p) ? sh*-1 : 0;\r\n\t\t\t\r\n\t\t\tvar closePath = true;\r\n\t\t\t\r\n\t\t\tfor(var i=1;i<=size;i++){\r\n\t\t\t\tvar lineWidth = i * mult;\r\n\t\t\t\t//var rect = this.container.createLine({x1:d.x1+shx, y1:d.y1+shy, x2:d.x2+shx, y2:d.y2+shy})\r\n\t\t\t\t//\t.setStroke({width:lineWidth, color:c, cap:\"round\"})\r\n\t\t\t\r\n\t\t\t\tif(dojox.gfx.renderer==\"svg\"){\r\n\t\t\t\t\tvar strAr = [];\r\n\t\t\t\t\tdojo.forEach(pts, function(o, i){\r\n\t\t\t\t\t\tif(i==0){\r\n\t\t\t\t\t\t\tstrAr.push(\"M \" + (o.x+shx) +\" \"+ (o.y+shy));\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tvar cmd = o.t || \"L \";\r\n\t\t\t\t\t\t\tstrAr.push(cmd + (o.x+shx) +\" \"+ (o.y+shy)); // Z + undefined works here\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this);\r\n\t\t\t\t\tif(closePath){\r\n\t\t\t\t\t\tstrAr.push(\"Z\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.container.createPath(strAr.join(\", \")).setStroke({width:lineWidth, color:c, cap:\"round\"})\r\n\t\t\t\t\t\r\n\t\t\t\t}else{\r\n\t\t\t\t\t// Leaving this code for VML. It seems slightly faster but times vary.\r\n\t\t\t\t\tvar pth = this.container.createPath({}).setStroke({width:lineWidth, color:c, cap:\"round\"})\r\n\t\t\t\t\t\r\n\t\t\t\t\tdojo.forEach(this.points, function(o, i){\r\n\t\t\t\t\t\tif(i==0 || o.t==\"M\"){\r\n\t\t\t\t\t\t\tpth.moveTo(o.x+shx, o.y+shy);\r\n\t\t\t\t\t\t}else if(o.t==\"Z\"){\r\n\t\t\t\t\t\t\tclosePath && pth.closePath();\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tpth.lineTo(o.x+shx, o.y+shy);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this);\r\n\t\t\t\t\t\r\n\t\t\t\t\tclosePath && pth.closePath();\r\n\t\t\t\t}\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\tcreateForLine: function(o, size, mult, d, r, p, c){\r\n\t\t\t\r\n\t\t\tvar sh = size * mult / 4,\r\n\t\t\t\tshy = /B/.test(p) ? sh : /T/.test(p) ? sh*-1 : 0,\r\n\t\t\t\tshx = /R/.test(p) ? sh : /L/.test(p) ? sh*-1 : 0;\r\n\t\t\tfor(var i=1;i<=size;i++){\r\n\t\t\t\tvar lineWidth = i * mult;\r\n\t\t\t\tthis.container.createLine({x1:d.x1+shx, y1:d.y1+shy, x2:d.x2+shx, y2:d.y2+shy})\r\n\t\t\t\t\t.setStroke({width:lineWidth, color:c, cap:\"round\"})\r\n\t\t\t}\r\n\t\t},\r\n\t\tcreateForEllipse: function(o, size, mult, d, r, p, c){\r\n\t\t\r\n\t\t\tvar sh = size * mult / 8,\r\n\t\t\t\tshy = /B/.test(p) ? sh : /T/.test(p) ? sh*-1 : 0,\r\n\t\t\t\tshx = /R/.test(p) ? sh*.8 : /L/.test(p) ? sh*-.8 : 0;\r\n\t\t\t\r\n\t\t\tfor(var i=1;i<=size;i++){\r\n\t\t\t\tvar lineWidth = i * mult;\r\n\t\t\t\tthis.container.createEllipse({cx:d.cx+shx, cy:d.cy+shy, rx:d.rx-sh, ry:d.ry-sh, r:r})\r\n\t\t\t\t\t.setStroke({width:lineWidth, color:c})\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\tcreateForRect: function(o, size, mult, d, r, p, c){\r\n\t\t\t\r\n\t\t\tvar sh = size * mult / 2,\r\n\t\t\t\tshy = /B/.test(p) ? sh : /T/.test(p) ? 0 : sh /2,\r\n\t\t\t\tshx = /R/.test(p) ? sh : /L/.test(p) ? 0 : sh /2;\r\n\t\t\t\r\n\t\t\tfor(var i=1;i<=size;i++){\r\n\t\t\t\tvar lineWidth = i * mult;\r\n\t\t\t\tthis.container.createRect({x:d.x+shx, y:d.y+shy, width:d.width-sh, height:d.height-sh, r:r})\r\n\t\t\t\t\t.setStroke({width:lineWidth, color:c})\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\tarrowPoints: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tCreates data used to draw arrow head.\r\n\r\n\t\t\tvar d = this.stencil.data;\r\n\t\t\tvar radius = this.stencil.getRadius();\r\n\t\t\tvar angle = this.style.zAngle + 30;\r\n\r\n\t\t\tvar pt = this.util.pointOnCircle(d.x1, d.y1, radius*.75, angle);\r\n\t\t\t\r\n\t\t\tvar obj = {\r\n\t\t\t\tstart:{\r\n\t\t\t\t\tx:d.x1,\r\n\t\t\t\t\ty:d.y1\r\n\t\t\t\t},\r\n\t\t\t\tx:pt.x,\r\n\t\t\t\ty:pt.y\r\n\t\t\t}\r\n\t\t\tvar angle = this.util.angle(obj);\r\n\t\t\tvar lineLength = this.util.length(obj);\r\n\t\t\tvar al = this.style.arrows.length;\r\n\t\t\tvar aw = this.style.arrows.width/3;\r\n\t\t\tif(lineLength<al){\r\n\t\t\t\tal = lineLength/2;\r\n\t\t\t}\r\n\r\n\t\t\tvar p1 = this.util.pointOnCircle(obj.x, obj.y, -al, angle-aw);\r\n\t\t\tvar p2 = this.util.pointOnCircle(obj.x, obj.y, -al, angle+aw);\r\n\t\t\treturn [\r\n\t\t\t\t{x:obj.x, y:obj.y},\r\n\t\t\t\tp1,\r\n\t\t\t\tp2\r\n\t\t\t];\r\n\t\t},\r\n\t\t\r\n\t\tcreateForZArrow: function(o, size, mult, pts, r, p, c){\r\n\t\t\tif(this.stencil.data.cosphi<1 || !this.stencil.points[0]){ return; }\r\n\t\t\tvar sh = size * mult / 4,\r\n\t\t\t\tshy = /B/.test(p) ? sh : /T/.test(p) ? sh*-1 : 0,\r\n\t\t\t\tshx = /R/.test(p) ? sh : /L/.test(p) ? sh*-1 : 0;\r\n\t\t\tvar closePath = true;\r\n\t\t\tfor(var i=1;i<=size;i++){\r\n\t\t\t\tvar lineWidth = i * mult;\r\n\t\t\t\tpts = this.arrowPoints();\r\n\t\t\t\tif(!pts){ return; }\r\n\t\t\t\tif(dojox.gfx.renderer==\"svg\"){\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar strAr = [];\r\n\t\t\t\t\tdojo.forEach(pts, function(o, i){\r\n\t\t\t\t\t\tif(i==0){\r\n\t\t\t\t\t\t\tstrAr.push(\"M \" + (o.x+shx) +\" \"+ (o.y+shy));\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tvar cmd = o.t || \"L \";\r\n\t\t\t\t\t\t\tstrAr.push(cmd + (o.x+shx) +\" \"+ (o.y+shy)); // Z + undefined works here\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this);\r\n\t\t\t\t\tif(closePath){\r\n\t\t\t\t\t\tstrAr.push(\"Z\");\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.container.createPath(strAr.join(\", \")).setStroke({width:lineWidth, color:c, cap:\"round\"}).setFill(c);\r\n\t\t\t\t\t\r\n\t\t\t\t}else{\r\n\t\t\t\t\t// Leaving this code for VML. It seems slightly faster but times vary.\r\n\t\t\t\t\tvar pth = this.container.createPath({}).setStroke({width:lineWidth, color:c, cap:\"round\"})\r\n\t\t\t\t\t\r\n\t\t\t\t\tdojo.forEach(pts, function(o, i){\r\n\t\t\t\t\t\tif(i==0 || o.t==\"M\"){\r\n\t\t\t\t\t\t\tpth.moveTo(o.x+shx, o.y+shy);\r\n\t\t\t\t\t\t}else if(o.t==\"Z\"){\r\n\t\t\t\t\t\t\tclosePath && pth.closePath();\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tpth.lineTo(o.x+shx, o.y+shy);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this);\r\n\t\t\t\t\t\r\n\t\t\t\t\tclosePath && pth.closePath();\r\n\t\t\t\t}\r\n\t\t\t\tvar sp = this.stencil.points;\r\n\t\t\t\tthis.container.createLine({x1:sp[0].x, y1:sp[0].y, x2:pts[0].x, y2:pts[0].y})\r\n\t\t\t\t\t.setStroke({width:lineWidth, color:c, cap:\"round\"});\r\n\t\t\t\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tonTransform: function(){\r\n\t\t\tthis.render();\r\n\t\t},\r\n\t\tonRender: function(){\r\n\t\t\tthis.container.moveToBack();\r\n\t\t},\r\n\t\tdestroy: function(){\r\n\t\t\tif(this.container){\r\n\t\t\t\tthis.container.removeShape();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n);\r\n\r\n});\r\n"]}