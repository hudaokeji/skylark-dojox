{"version":3,"sources":["drawing/ui/Button.js"],"names":["define","dojo","oo","Rect","Ellipse","Text","registry","Button","declare","options","subShape","mixin","this","width","data","rx","height","ry","y","cy","id","util","uid","type","attr","container","callback","hitched","hitch","scope","window","drawingType","shape","setGrad","s","p","v","forEach","nm","fill","style","button","icon","text","constr","drawing","getConstructor","o","makeOptions","norm","borderWidth","color","closePath","selected","_lineHeight","c","toolType","addUI","setup","tooltip","onOut","onClick","d","clone","mouse","x","makeFit","points","n","pt","test","enabled","select","_change","shadow","hide","deselect","show","disable","disabled","enable","sty","moveToBack","moveToFront","onOver","over","onDown","onUp","setObject","register","name"],"mappings":"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","file":"../../../drawing/ui/Button.js","sourcesContent":["define([\"dojo\", \"../util/oo\", \"../stencil/Rect\", \"../stencil/Ellipse\",\r\n\"../stencil/Text\", \"../manager/_registry\"],\r\n  function(dojo, oo, Rect, Ellipse, Text, registry){\r\n\r\n//dojox.drawing.ui.Button = \r\nvar Button = oo.declare(\r\n\tfunction(options){\r\n\t\toptions.subShape = true;\r\n\t\tdojo.mixin(this, options);\r\n\t\t//console.log(\"  button:\", this);\r\n\t\tthis.width = options.data.width || options.data.rx*2;\r\n\t\tthis.height = options.data.height || options.data.ry*2;\r\n\t\tthis.y = options.data.y || options.data.cy - options.data.ry;\r\n\r\n\t\tthis.id = this.id || this.util.uid(this.type);\r\n\t\tthis.util.attr(this.container, \"id\", this.id);\r\n\t\tif(this.callback){\r\n\t\t\tthis.hitched = dojo.hitch(this.scope || window, this.callback, this);\r\n\t\t}\r\n\t\t\r\n\t\t// Rectangle itself must be \"ui\" for radio buttons to work.\r\n\t\t// This is a work-around for messy code associated with drawingType;\r\n\t\t// see http://www.andestutor.org/bugzilla/show_bug.cgi?id=1745\r\n\t\toptions.drawingType=\"ui\";\r\n\t\t// Choose between rectangle and ellipse based on options\r\n\t\tif(options.data.width && options.data.height){\r\n\t\t\tthis.shape = new Rect(options);\r\n\t\t}else{\r\n\t\t\tthis.shape = new Ellipse(options);\r\n\t\t}\r\n\t\t\r\n\t\tvar setGrad = function(s, p, v){\r\n\t\t\tdojo.forEach([\"norm\", \"over\", \"down\", \"selected\"], function(nm){\r\n\t\t\t\ts[nm].fill[p] = v;\r\n\t\t\t});\r\n\t\t};\r\n\t\t// for button backs, not for icons\r\n\t\tsetGrad(this.style.button, \"y2\", this.height + this.y);\r\n\t\tsetGrad(this.style.button, \"y1\", this.y);\r\n\t\t\r\n\t\tif(options.icon && !options.icon.text){\r\n\t\t\tvar constr = this.drawing.getConstructor(options.icon.type);\r\n\t\t\tvar o = this.makeOptions(options.icon);\r\n\t\t\to.data = dojo.mixin(o.data, this.style.button.icon.norm);\r\n\t\t\t\r\n\t\t\tif(o.data && o.data.borderWidth===0){\r\n\t\t\t\to.data.fill = this.style.button.icon.norm.fill = o.data.color;\r\n\t\t\t}else if(options.icon.type==\"line\" || (options.icon.type==\"path\" && !options.icon.closePath)){\r\n\t\t\t\tthis.style.button.icon.selected.color = this.style.button.icon.selected.fill;\r\n\t\t\t}else{\r\n\t\t\t\t//o.data.fill = this.style.button.icon.norm.fill = o.data.color;\r\n\t\t\t}\r\n\t\t\tthis.icon = new constr(o);\r\n\t\t\t//console.log(\"  button:\", this.toolType, this.style.button.icon)\r\n\t\t}else if(options.text || (options.icon && options.icon.text)){\r\n\t\t\t//console.warn(\"button text:\", options.text || options.icon.text)\r\n\t\t\to = this.makeOptions(options.text || options.icon.text);\r\n\t\t\to.data.color = this.style.button.icon.norm.color; //= o.data.fill;\r\n\t\t\tthis.style.button.icon.selected.color = this.style.button.icon.selected.fill;\r\n\t\t\tthis.icon = new Text(o);\r\n\t\t\tthis.icon.attr({\r\n\t\t\t\theight:\tthis.icon._lineHeight,\r\n\t\t\t\ty:((this.height-this.icon._lineHeight)/2)+this.y\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\tvar c = this.drawing.getConstructor(this.toolType);\r\n\t\tif(c){\r\n\t\t\tthis.drawing.addUI(\"tooltip\", {data:{text:c.setup.tooltip}, button:this});\r\n\t\t}\r\n\t\t\r\n\t\tthis.onOut();\r\n\t\t\r\n\t},{\r\n\t\t// summary:\r\n\t\t//\t\tCreates a clickable button in \"UI\" mode of the drawing.\r\n\t\t// description:\r\n\t\t//\t\tCreates a 4-state button: normal, hover, active, selected.\r\n\t\t//\t\tOptionally may include button text or an icon.\r\n\r\n\t\tcallback:null,\r\n\t\tscope:null,\r\n\t\thitched:null,\r\n\t\ttoolType:\"\",\r\n\t\t\r\n\t\tonClick: function(/*Object*/button){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tStub to connect. Event is 'this'\r\n\t\t\t//\t\tAlternatively can pass in a scope and a callback\r\n\t\t\t//\t\ton creation.\r\n\t\t},\r\n\t\t\r\n\t\tmakeOptions: function(/*Object*/d, /*Float*/s){\r\n\t\t\t\r\n\t\t\ts = s || 1;\r\n\t\t\td = dojo.clone(d);\r\n\t\t\tvar o = {\r\n\t\t\t\tutil: this.util,\r\n\t\t\t\tmouse: this.mouse,\r\n\t\t\t\tcontainer: this.container,\r\n\t\t\t\tsubShape:true\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\tif(typeof(d)==\"string\"){\r\n\t\t\t\t\r\n\t\t\t\to.data = {\r\n\t\t\t\t\tx:this.data.x - 5,\r\n\t\t\t\t\ty: this.data.y + 2,\r\n\t\t\t\t\twidth:this.data.width,\r\n\t\t\t\t\theight:this.data.height,\r\n\t\t\t\t\ttext:d,\r\n\t\t\t\t\tmakeFit:true\r\n\t\t\t\t};\r\n\t\t\t\r\n\t\t\t}else if(d.points){\r\n\t\t\t\t//console.warn(\"points\")\r\n\t\t\t\tdojo.forEach(d.points, function(pt){\r\n\t\t\t\t\tpt.x = pt.x * this.data.width * .01 * s + this.data.x;\r\n\t\t\t\t\tpt.y = pt.y * this.data.height * .01 * s + this.data.y;\r\n\t\t\t\t}, this);\r\n\t\t\t\to.data = {};\r\n\t\t\t\tfor(var n in d){\r\n\t\t\t\t\tif(n!=\"points\"){\r\n\t\t\t\t\t\to.data[n] = d[n];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\to.points = d.points;\r\n\t\t\t\t\r\n\t\t\t}else{\r\n\t\t\t\t//console.warn(\"data\")\r\n\t\t\t\tfor(n in d){\r\n\t\t\t\t\tif(/x|width/.test(n)){\r\n\t\t\t\t\t\td[n] = d[n] * this.data.width * .01 * s;\r\n\t\t\t\t\t}else if(/y|height/.test(n)){\r\n\t\t\t\t\t\td[n] = d[n] * this.data.height * .01 * s;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(/x/.test(n) && !/r/.test(n)){\r\n\t\t\t\t\t\td[n] += this.data.x;\r\n\t\t\t\t\t}else if(/y/.test(n) && !/r/.test(n)){\r\n\t\t\t\t\t\td[n] += this.data.y;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tdelete d.type;\r\n\t\t\t\to.data = d;\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\to.drawingType = \"ui\";\r\n\t\t\treturn o;\r\n\t\t\r\n\t\t\t// do style\r\n\t\t\tif(d.borderWidth!==undefined){\r\n\t\t\t\t//console.log(\" -------- bw data:\", o.data)\r\n\t\t\t\to.data.borderWidth = d.borderWidth;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn o;\r\n\t\t},\r\n\t\t\r\n\t\tenabled:true,\r\n\t\tselected:false,\r\n\t\ttype:\"drawing.library.UI.Button\",\r\n\t\t\r\n\t\t// note:\r\n\t\t//\tneed to move the Stencil's shape to front, not\r\n\t\t// its container. Therefore we can't use the Stencil's\r\n\t\t// moveTo.. methods.\r\n\t\tselect: function(){\r\n\t\t\tthis.selected = true;\r\n\t\t\tif(this.icon){this.icon.attr(this.style.button.icon.selected);}\r\n\t\t\tthis._change(this.style.button.selected);\r\n\t\t\tthis.shape.shadow && this.shape.shadow.hide();\r\n\t\t},\r\n\t\tdeselect: function(){\r\n\t\t\tthis.selected = false;\r\n\t\t\tif(this.icon){this.icon.attr(this.style.button.icon.norm);}\r\n\t\t\tthis.shape.shadow && this.shape.shadow.show();\r\n\t\t\tthis._change(this.style.button.norm);\r\n\t\t\t\r\n\t\t},\r\n\t\tdisable: function(){\r\n\t\t\tif(!this.enabled){ return; }\r\n\t\t\tthis.enabled = false;\r\n\t\t\tthis._change(this.style.button.disabled);\r\n\t\t\tthis.icon.attr({color:this.style.button.norm.color});\r\n\t\t},\r\n\t\tenable: function(){\r\n\t\t\tif(this.enabled){ return; }\r\n\t\t\tthis.enabled = true;\r\n\t\t\tthis._change(this.style.button.norm);\r\n\t\t\tthis.icon.attr({color:this.style.button.icon.norm.color});\r\n\t\t},\r\n\t\t\r\n\t\t_change: function(/*Object*/sty){\r\n\t\t\tthis.shape.attr(sty);\r\n\t\t\tthis.shape.shadow && this.shape.shadow.container.moveToBack();\r\n\t\t\tif(this.icon){this.icon.shape.moveToFront();};\r\n\t\t},\r\n\t\tonOver: function(){\r\n\t\t\t//console.log(\"BUTTON OVER\")\r\n\t\t\tif(this.selected || !this.enabled){ return; }\r\n\t\t\tthis._change(this.style.button.over);\r\n\t\t},\r\n\t\tonOut: function(){\r\n\t\t\tif(this.selected){ return; }\r\n\t\t\tthis._change(this.style.button.norm);\r\n\t\t},\r\n\t\tonDown: function(){\r\n\t\t\tif(this.selected || !this.enabled){ return; }\r\n\t\t\tthis._change(this.style.button.selected);\r\n\t\t},\r\n\t\tonUp: function(){\r\n\t\t\t//console.log(\"BUTTON UP\")\r\n\t\t\tif(!this.enabled){ return; }\r\n\t\t\tthis._change(this.style.button.over);\r\n\t\t\tif(this.hitched){\r\n\t\t\t\tthis.hitched();\r\n\t\t\t}\r\n\t\t\tthis.onClick(this);\r\n\t\t},\r\n\t\tattr: function(options){\r\n\t\t\tif(this.icon){this.icon.attr(options);}\r\n\t\t}\r\n\t}\r\n\t\r\n);\r\n\r\ndojo.setObject(\"dojox.drawing.ui.Button\", Button);\r\n\r\nregistry.register({\r\n\tname:\"dojox.drawing.ui.Button\"\r\n}, \"stencil\");\r\n\r\nreturn Button;\r\n});\r\n"]}