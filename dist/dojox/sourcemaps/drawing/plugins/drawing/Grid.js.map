{"version":3,"sources":["drawing/plugins/drawing/Grid.js"],"names":["define","dojo","oo","Plugin","Grid","declare","options","gap","this","major","majorColor","minorColor","setGrid","connect","canvas","type","minor","zoom","setZoom","x1","y1","i","len","mjr","Math","floor","mnr","grid","removeShape","s","underlay","createGroup","mj","mn","createGridLine","x2","y2","c","createLine","setStroke","style","width","cap","color","moveToBack","util","attr","setObject"],"mappings":";;;;;;;AAAAA,QAAQ,OAAQ,gBAAiB,cACjC,SAASC,EAAMC,EAAIC,GAEnB,IAAIC,EAAOF,EAAGG,QACbF,EACA,SAASG,GACLA,EAAQC,MACVC,KAAKC,MAAQH,EAAQC,KAEtBC,KAAKE,WAAaJ,EAAQI,YAAcF,KAAKE,WAC7CF,KAAKG,WAAaL,EAAQK,YAAcH,KAAKG,WAE7CH,KAAKI,UACLX,EAAKY,QAAQL,KAAKM,OAAQ,UAAWN,KAAM,aAU3CO,KAAK,qCAILR,IAAI,IACJE,MAAM,IACNO,MAAM,EAINN,WAAY,UAIZC,WAAY,UAIZM,KAAK,EAELC,QAAS,SAASD,GAGjBT,KAAKS,KAAOA,EACZT,KAAKI,WAENA,QAAS,SAASN,GAQjB,IAKIa,EAAMC,EAAMC,EAAMC,EALlBC,EAAMC,KAAKC,MAAMjB,KAAKC,MAAQD,KAAKS,MACnCS,EAAMlB,KAAKQ,MAAQQ,KAAKC,MAAMjB,KAAKQ,MAAQR,KAAKS,MAAQM,EAE5Df,KAAKmB,MAAQnB,KAAKmB,KAAKC,cAGvB,IAAIC,EAAIrB,KAAKM,OAAOgB,SAASC,cAIzBC,EAAKxB,KAAKE,WACVuB,EAAKzB,KAAKG,WAEVuB,EAAiB,SAASf,EAAGC,EAAGe,EAAGC,EAAIC,GAC1CR,EAAES,YAAYnB,GAAIA,EAAIC,GAAIA,EAAIe,GAAIA,EAAIC,GAAIA,IAAKG,WAAWC,MAAO,QAASC,MALnE,EAK6EC,IAAK,QAASC,MAAMN,KAIzG,IAAIhB,EAAE,EAAEC,EAVA,IAUQI,EAAKL,EAAEC,EAAKD,IAM3Ba,EALAf,EAAK,EACLC,EAAKM,EAAIL,EAbF,IAaUD,EAGXA,EAAGG,EAAMU,EAAKD,GAIrB,IAAIX,EAAE,EAAEC,EApBA,IAoBQI,EAAKL,EAAEC,EAAKD,IAI3Ba,EAFAf,EAAKO,EAAIL,EADTD,EAAK,EACYD,EArBV,IAsBDA,EAAGI,EAAMU,EAAKD,GAOrB,OAHAH,EAAEe,aACFpC,KAAKmB,KAAOE,EACZrB,KAAKqC,KAAKC,KAAKjB,EAAG,KAAM,QACjBA,KAMV,OADA5B,EAAK8C,UAAU,qCAAsC3C,GAC9CA","file":"../../../../drawing/plugins/drawing/Grid.js","sourcesContent":["define([\"dojo\", \"../../util/oo\", \"../_Plugin\"],\r\nfunction(dojo, oo, Plugin){\r\n\r\nvar Grid = oo.declare(\r\n\tPlugin,\r\n\tfunction(options){\r\n\t\tif(options.gap){\r\n\t\t\tthis.major = options.gap;\r\n\t\t}\r\n\t\tthis.majorColor = options.majorColor || this.majorColor;\r\n\t\tthis.minorColor = options.minorColor || this.minorColor;\r\n\r\n\t\tthis.setGrid();\r\n\t\tdojo.connect(this.canvas, \"setZoom\", this, \"setZoom\");\r\n\t},\r\n\t{\r\n\t\t// summary:\r\n\t\t//\t\tPlugin that displays a grid on the Drawing canvas.\r\n\t\t// example:\r\n\t\t//\t\t|\t<div dojoType=\"dojox.drawing.Drawing\" id=\"drawingNode\"\r\n\t\t//\t\t|\t\tplugins=\"[{'name':'dojox.drawing.plugins.drawing.Grid', 'options':{gap:50}}]\">\r\n\t\t//\t\t|\t</div>\r\n\r\n\t\ttype:\"dojox.drawing.plugins.drawing.Grid\",\r\n\r\n\t\t// gap: Number\r\n\t\t//\t\tHow far apart to set the grid lines\r\n\t\tgap:100,\r\n\t\tmajor:100,\r\n\t\tminor:0,\r\n\r\n\t\t// majorColor: String\r\n\t\t//\t\tMajor lines color\r\n\t\tmajorColor: \"#00ffff\",\r\n\r\n\t\t// minorColor: String\r\n\t\t//\t\tMinor lines color\r\n\t\tminorColor: \"#d7ffff\",\r\n\r\n\t\t// zoom: [readonly] Number\r\n\t\t//\t\tThe current zoom of the grid\r\n\t\tzoom:1,\r\n\t\t\r\n\t\tsetZoom: function(zoom){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tSet's the zoom of the canvas\r\n\t\t\tthis.zoom = zoom;\r\n\t\t\tthis.setGrid();\r\n\t\t},\r\n\t\tsetGrid: function(options){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tRenders grid\r\n\r\n\t\t\t// TODO: major minor lines\r\n\t\t\t//\tminors don't show on zoom out\r\n\t\t\t//\tdraw minors first\r\n\r\n\t\t\tvar mjr = Math.floor(this.major * this.zoom);\r\n\t\t\tvar mnr = this.minor ? Math.floor(this.minor * this.zoom) : mjr;\r\n\t\t\t\r\n\t\t\tthis.grid && this.grid.removeShape();\r\n\t\t\t\r\n\t\t\tvar x1,x2,y1,y2,i,clr,len;\r\n\t\t\tvar s = this.canvas.underlay.createGroup();\r\n\t\t\tvar w = 2000;//this.canvas.width;\r\n\t\t\tvar h = 1000;//this.canvas.height;\r\n\t\t\tvar b = 1;\r\n\t\t\tvar mj = this.majorColor;\r\n\t\t\tvar mn = this.minorColor;\r\n\t\t\t\r\n\t\t\tvar createGridLine = function(x1,y1,x2,y2, c){\r\n\t\t\t\ts.createLine({x1: x1, y1: y1, x2: x2, y2: y2}).setStroke({style: \"Solid\", width: b, cap: \"round\", color:c});\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\t// horz\r\n\t\t\tfor(i=1,len = h/mnr; i<len; i++){\r\n\t\t\t\tx1 = 0; x2 = w;\r\n\t\t\t\ty1 = mnr*i; y2 = y1;\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tclr = y1%mjr ? mn : mj;\r\n\t\t\t\tcreateGridLine(x1,y1,x2,y2, clr);\r\n\t\t\t}\r\n\t\t\t// vert\r\n\t\t\tfor(i=1,len = w/mnr; i<len; i++){\r\n\t\t\t\ty1 = 0; y2 = h;\r\n\t\t\t\tx1 = mnr*i; x2 = x1;\r\n\t\t\t\tclr = x1%mjr ? mn : mj;\r\n\t\t\t\tcreateGridLine(x1,y1,x2,y2, clr);\r\n\t\t\t}\r\n\t\t\r\n\t\t\ts.moveToBack();\r\n\t\t\tthis.grid = s;\r\n\t\t\tthis.util.attr(s, \"id\", \"grid\");\r\n\t\t\treturn s;\r\n\t\t}\r\n\t}\r\n);\r\n\r\ndojo.setObject(\"dojox.drawing.plugins.drawing.Grid\", Grid);\r\nreturn Grid;\r\n});\r\n"]}