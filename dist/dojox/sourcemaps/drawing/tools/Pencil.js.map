{"version":3,"sources":["drawing/tools/Pencil.js"],"names":["define","lang","oo","registry","StencilPath","Pencil","declare","this","_started","draws","minDist","onDown","obj","p","x","y","points","lastPoint","revertRenderHit","renderHit","closePath","onDrag","util","distance","push","render","checkClosePoint","onUp","length","box","getBounds","w","minimumSize","h","remove","hit","shape","closeGuide","setPoints","renderedOnce","onRender","setObject","setup","name","tooltip","iconClass","register"],"mappings":";;;;;;;AAAAA,QAAQ,kBAAmB,aAAc,uBAAwB,mBACjE,SAASC,EAAMC,EAAIC,EAAUC,GAG7B,IAAIC,EAASH,EAAGI,QACfF,EACA,WAGCG,KAAKC,UAAW,IAMhBC,OAAM,EAMNC,QAAS,GAETC,OAAQ,SAASC,GAChBL,KAAKC,UAAW,EAChB,IAAIK,GACHC,EAAEF,EAAIE,EACNC,EAAEH,EAAIG,GAEPR,KAAKS,QAAUH,GACfN,KAAKU,UAAYJ,EACjBN,KAAKW,gBAAkBX,KAAKY,UAC5BZ,KAAKY,WAAY,EACjBZ,KAAKa,WAAY,GAGlBC,OAAQ,SAAST,GAChB,GACIL,KAAKC,YACHD,KAAKG,QAAUH,KAAKe,KAAKC,SAASX,EAAIE,EAAGF,EAAIG,EAAGR,KAAKU,UAAUH,EAAGP,KAAKU,UAAUF,IAFvF,CAKA,IAAIF,GACHC,EAAEF,EAAIE,EACNC,EAAEH,EAAIG,GAEPR,KAAKS,OAAOQ,KAAKX,GACjBN,KAAKkB,SACLlB,KAAKmB,gBAAgBnB,KAAKS,OAAO,GAAIJ,GACrCL,KAAKU,UAAYJ,IAGlBc,KAAM,SAASf,GACd,GAAIL,KAAKC,SAAT,CACA,IAAID,KAAKS,QAAUT,KAAKS,OAAOY,OAAO,EAGrC,OAFArB,KAAKC,UAAW,OAChBD,KAAKS,WAGN,IAAIa,EAAMtB,KAAKuB,YACf,GAAGD,EAAIE,EAAExB,KAAKyB,aAAeH,EAAII,EAAE1B,KAAKyB,YAIvC,OAHAzB,KAAK2B,OAAO3B,KAAK4B,IAAK5B,KAAK6B,MAAO7B,KAAK8B,YACvC9B,KAAKC,UAAW,OAChBD,KAAK+B,cAGH/B,KAAKmB,gBAAgBnB,KAAKS,OAAO,GAAIJ,GAAK,KAC5CL,KAAKa,WAAY,GAElBb,KAAKY,UAAYZ,KAAKW,gBACtBX,KAAKgC,cAAe,EACpBhC,KAAKkB,SACLlB,KAAKiC,SAASjC,UAejB,OATAN,EAAKwC,UAAU,6BAA8BpC,GAC7CA,EAAOqC,OACNC,KAAK,6BACLC,QAAQ,cACRC,UAAU,YAGX1C,EAAS2C,SAASzC,EAAOqC,MAAO,QAEzBrC","file":"../../../drawing/tools/Pencil.js","sourcesContent":["define([\"dojo/_base/lang\", \"../util/oo\", \"../manager/_registry\", \"../stencil/Path\"],\r\nfunction(lang, oo, registry, StencilPath){\r\n\r\n//dojox.drawing.tools.Pencil \r\nvar Pencil = oo.declare(\r\n\tStencilPath,\r\n\tfunction(){\r\n\t\t// summary:\r\n\t\t//\t\tconstructor\r\n\t\tthis._started = false;\r\n\t},\r\n\t{\r\n\t\t// summary:\r\n\t\t//\t\tClass for a drawable, continuous Path\r\n\r\n\t\tdraws:true,\r\n\r\n\t\t// minDist: Number\r\n\t\t//\t\tThe distance the mouse must travel before rendering\r\n\t\t//\t\ta path segment. Lower number is a higher definition\r\n\t\t//\t\tpath but more points.\r\n\t\tminDist: 15, // how to make this more dynamic? Settable?\r\n\t\t\r\n\t\tonDown: function(obj){\r\n\t\t\tthis._started = true;\r\n\t\t\tvar p = {\r\n\t\t\t\tx:obj.x,\r\n\t\t\t\ty:obj.y\r\n\t\t\t};\r\n\t\t\tthis.points = [p];\r\n\t\t\tthis.lastPoint = p;\r\n\t\t\tthis.revertRenderHit = this.renderHit;\r\n\t\t\tthis.renderHit = false;\r\n\t\t\tthis.closePath = false;\r\n\t\t},\r\n\t\t\r\n\t\tonDrag: function(obj){\r\n\t\t\tif(\r\n\t\t\t   !this._started\r\n\t\t\t   || this.minDist > this.util.distance(obj.x, obj.y, this.lastPoint.x, this.lastPoint.y)\r\n\t\t\t){ return; }\r\n\t\t\t\r\n\t\t\tvar p = {\r\n\t\t\t\tx:obj.x,\r\n\t\t\t\ty:obj.y\r\n\t\t\t};\r\n\t\t\tthis.points.push(p);\r\n\t\t\tthis.render();\r\n\t\t\tthis.checkClosePoint(this.points[0], obj);\r\n\t\t\tthis.lastPoint = p;\r\n\t\t},\r\n\t\t\r\n\t\tonUp: function(obj){\r\n\t\t\tif(!this._started){ return; }\r\n\t\t\tif(!this.points || this.points.length<2){\r\n\t\t\t\tthis._started = false;\r\n\t\t\t\tthis.points = [];\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar box = this.getBounds();\r\n\t\t\tif(box.w<this.minimumSize && box.h<this.minimumSize){\r\n\t\t\t\tthis.remove(this.hit, this.shape, this.closeGuide);\r\n\t\t\t\tthis._started = false;\r\n\t\t\t\tthis.setPoints([]);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif(this.checkClosePoint(this.points[0], obj, true)){\r\n\t\t\t\tthis.closePath = true;\r\n\t\t\t}\r\n\t\t\tthis.renderHit = this.revertRenderHit;\r\n\t\t\tthis.renderedOnce = true;\r\n\t\t\tthis.render();\r\n\t\t\tthis.onRender(this);\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n);\r\n\r\nlang.setObject(\"dojox.drawing.tools.Pencil\", Pencil);\r\nPencil.setup = {\r\n\tname:\"dojox.drawing.tools.Pencil\",\r\n\ttooltip:\"Pencil Tool\",\r\n\ticonClass:\"iconLine\"\r\n};\r\n\r\nregistry.register(Pencil.setup, \"tool\");\r\n\r\nreturn Pencil;\r\n});\r\n"]}