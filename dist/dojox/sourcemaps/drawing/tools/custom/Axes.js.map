{"version":3,"sources":["drawing/tools/custom/Axes.js"],"names":["define","lang","oo","registry","StencilPath","Arrow","Label","Vector","Axes","declare","options","this","closePath","xArrow","stencil","idx1","idx2","yArrow","data","style","zAxisEnabled","cosphi","setData","ops","mixin","container","createGroup","showAngle","label","radius","angle","x2","x4","y2","y4","zAxis","minimumSize","connectMult","points","length","setPoints","_postSetPoints","render","setLabel","shadow","addShadow","draws","type","baseRender","zScale","zPoint","obj","util","pt","pointOnCircle","start","x","y","zAngle","skip","noAnchor","zSet","c","z","p","createLabels","props","align","valign","annotation","mouse","labelX","labelPosition","setLabelX","labelY","setLabelY","labelZ","setLabelZ","px","py","pt2","ax","lineSub","width","ay","value","_labelsCreated","lbls","match","replace","getLabel","getText","anchorPositionCheck","anchor","pm","getParent","getTransform","am","shape","o","dx","org","dy","onTransformBegin","_isBeingModified","onTransformEnd","_toggleSelected","console","log","Math","ceil","constrainAngle","zpt","snapAngle","angleSnap","ox","oy","warn","push","onModify","getBounds","absolute","pc","pz","bounds","x1","y1","x3","y3","w","h","pts","pointsToData","onTransform","d","getRadius","line","dataToPoints","onDrag","onUp","_downOnCanvas","s","onRender","len","distance","remove","hit","zArrow","setObject","setup","name","tooltip","iconClass","register"],"mappings":"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","file":"../../../../drawing/tools/custom/Axes.js","sourcesContent":["define([\"dojo/_base/lang\", \"../../util/oo\", \"../../manager/_registry\", \"../../stencil/Path\",\r\n\t\"../../annotations/Arrow\", \"../../annotations/Label\", \"../../tools/custom/Vector\"],\r\nfunction(lang, oo, registry, StencilPath, Arrow, Label, Vector){\r\n\r\nvar Axes = oo.declare(\r\n\tStencilPath,\r\n\tfunction(options){\r\n\t\tthis.closePath = false;\r\n\r\n\t\tthis.xArrow = new Arrow({stencil:this, idx1:0, idx2:1});\r\n\t\tthis.yArrow = new Arrow({stencil:this, idx1:2, idx2:1});\r\n\t\tif(options.data){\r\n\t\t\t//Allows import of z-axis in non-enabled canvas and xy-axis in\r\n\t\t\t//enabled canvas\r\n\t\t\tthis.style.zAxisEnabled = options.data.cosphi == 1 ? true : false;\r\n\t\t\tthis.setData(options.data);\r\n\t\t}\r\n\t\tif(this.style.zAxisEnabled){\r\n\t\t\t// If the z-axis is enabled, all axes will be created with a z-axis on the canvas.\r\n\t\t\t// there is no switching back and forth for the axis, only for vectors.\r\n\t\t\tthis.data.cosphi = 1;\r\n\t\t\tvar ops = {};\r\n\t\t\tlang.mixin(ops,options);\r\n\t\t\tlang.mixin(ops,{\r\n\t\t\t\tcontainer:this.container.createGroup(),\r\n\t\t\t\tstyle: this.style,\r\n\t\t\t\tshowAngle: false,\r\n\t\t\t\tlabel: null\r\n\t\t\t});\r\n\t\t\tif(options.data && (!ops.data.radius || !ops.data.angle)){\r\n\t\t\t\tops.data.x2 = ops.data.x4;\r\n\t\t\t\tops.data.y2 = ops.data.y4;\r\n\t\t\t}\r\n\t\t\tops.style.zAxis = true;\r\n\t\t\tthis.zAxis = new Vector(ops);\r\n\t\t\tthis.zAxis.minimumSize = 5;\r\n\t\t\t//console.log(\"-----constructing axes: \",this.zAxis);\r\n\t\t\tthis.connectMult([\r\n\t\t\t\t[this, \"onChangeStyle\", this.zAxis, \"onChangeStyle\"],\r\n\t\t\t\t[this, \"select\", this.zAxis, \"select\"],\r\n\t\t\t\t[this, \"deselect\", this.zAxis, \"deselect\"],\r\n\t\t\t\t[this, \"onDelete\", this.zAxis, \"destroy\"],\r\n\t\t\t\t[this, \"onDrag\", this, \"zSet\"],\r\n\t\t\t\t[this, \"onTransform\", this, \"zSet\"],\r\n\t\t\t\t[this.zAxis, \"onBeforeRender\", this, \"zSet\"],\r\n\t\t\t\t[this, \"_onPostRender\", this.zAxis, \"render\"]\r\n\t\t\t]);\r\n\r\n\t\t}\r\n\r\n\t\tif(this.points && this.points.length){\r\n\t\t\tthis.setPoints = this._postSetPoints;\r\n\t\t\t// render isn't called yet because baseRender is false\r\n\t\t\t// instead it is called here\r\n\t\t\tthis.render();\r\n\t\t\toptions.label && this.setLabel(options.label);\r\n\t\t\toptions.shadow && this.addShadow(options.shadow);\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t// summary:\r\n\t\t//\t\tDraws a right-angle Axes (shaped like an L, not a +)\r\n\t\t// description:\r\n\t\t//\t\tThis Stencil is created with a Path so that the L shape\r\n\t\t//\t\tis one continuous piece. Arrow heads are placed at the end\r\n\t\t//\t\tof each axis. The Axes can be rotated. There are custom\r\n\t\t//\t\tlabel methods.\r\n\r\n\t\tdraws:true,\r\n\t\ttype:\"dojox.drawing.tools.custom.Axes\",\r\n\t\tminimumSize:30,\r\n\t\tshowAngle:true,\r\n\t\tclosePath:false,\r\n\t\tbaseRender:false,\r\n\t\tzScale:.5,\r\n\r\n\t\tzPoint: function(obj){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tFinds the point for the z axis.\r\n\t\t\tobj.radius = this.util.length(obj);\r\n\t\t\tvar pt = this.util.pointOnCircle(obj.start.x, obj.start.y, obj.radius*this.zScale, this.style.zAngle);\r\n\t\t\treturn {x:pt.x, y:pt.y, skip:true, noAnchor:true};\r\n\t\t},\r\n\r\n\t\tzSet: function(){\r\n\t\t\tif(!this.zAxis){ return; };\r\n\t\t\tvar c = this.points[1];\r\n\t\t\tvar z = this.points[3];\r\n\t\t\tvar p = [\r\n\t\t\t\t{x:c.x, y:c.y},\r\n\t\t\t\t{x:z.x, y:z.y}\r\n\t\t\t];\r\n\t\t\tvar len = this.util.length({start:{x:c.x, y:c.y}, x:z.x, y:z.y});\r\n\t\t\tlen > this.zAxis.minimumSize ? this.zAxis.setPoints(p) : false;\r\n\t\t\tthis.zAxis.cosphi = 1;\r\n\t\t},\r\n\r\n\t\tcreateLabels: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tCreates the label for each axis.\r\n\r\n\t\t\t// NOTE: Not passing style into text because it's changing it\r\n\t\t\tvar props = {align:\"middle\", valign:\"middle\", util:this.util, annotation:true, container:this.container, mouse:this.mouse, stencil:this};\r\n\t\t\tthis.labelX = new Label(lang.mixin(props,{\r\n\t\t\t\tlabelPosition:this.setLabelX\r\n\t\t\t}));\r\n\t\t\tthis.labelY = new Label(lang.mixin(props,{\r\n\t\t\t\tlabelPosition:this.setLabelY\r\n\t\t\t}));\r\n\t\t\tif(this.style.zAxisEnabled){\r\n\t\t\t\tthis.labelZ = new Label(lang.mixin(props,{\r\n\t\t\t\t\tlabelPosition:this.setLabelZ\r\n\t\t\t\t}));\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tsetLabelX: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tCustom placement for x-axis label\r\n\r\n\t\t\tvar ax = this.points[0];\r\n\t\t\tvar c =  this.points[1];\r\n\r\n\t\t\tvar dist = 40;\r\n\t\t\tvar offdist = 20;\r\n\t\t\tvar pt, px, py, pt2;\r\n\r\n\t\t\tpt = this.util.lineSub(c.x, c.y, ax.x, ax.y, dist);\r\n\t\t\tpx = pt.x + (pt.y -ax.y);\r\n\t\t\tpy = pt.y + (ax.x - pt.x);\r\n\t\t\tpt2 = this.util.lineSub(pt.x, pt.y, px, py, (dist-offdist));\r\n\r\n\t\t\treturn {\r\n\t\t\t\tx:  pt2.x,\r\n\t\t\t\ty:  pt2.y,\r\n\t\t\t\twidth:20\r\n\t\t\t};\r\n\t\t},\r\n\t\tsetLabelY: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tCustom placement for y-axis label\r\n\r\n\t\t\tvar c =  this.points[1];\r\n\t\t\tvar ay = this.points[2];\r\n\r\n\t\t\tvar dist = 40;\r\n\t\t\tvar offdist = 20;\r\n\t\t\tvar pt, px, py, pt2;\r\n\t\t\tpt = this.util.lineSub(c.x, c.y, ay.x, ay.y, dist);\r\n\t\t\tpx = pt.x + (ay.y - pt.y);\r\n\t\t\tpy = pt.y + (pt.x - ay.x);\r\n\t\t\tpt2 = this.util.lineSub(pt.x, pt.y, px, py, (dist-offdist));\r\n\t\t\treturn {\r\n\t\t\t\tx:  pt2.x,\r\n\t\t\t\ty:  pt2.y,\r\n\t\t\t\twidth:20\r\n\t\t\t};\r\n\t\t},\r\n\t\tsetLabelZ: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tCustom placement for z-axis label\r\n\r\n\t\t\tvar c = this.points[1];\r\n\t\t\tvar z = this.points[3];\r\n\r\n\t\t\tvar dist = 40;\r\n\t\t\tvar offdist = 20;\r\n\t\t\tvar pt, px, py, pt2;\r\n\t\t\tpt = this.util.lineSub(c.x, c.y, z.x, z.y, dist);\r\n\t\t\tpx = pt.x + (pt.y - z.y);\r\n\t\t\tpy = pt.y + (z.x - pt.x);\r\n\t\t\tpt2 = this.util.lineSub(pt.x, pt.y, px, py, (dist-offdist));\r\n\r\n\t\t\treturn {\r\n\t\t\t\tx:pt2.x,\r\n\t\t\t\ty:pt2.y,\r\n\t\t\t\twidth:20\r\n\t\t\t}\r\n\t\t},\r\n\t\tsetLabel: function(/* ? String*/value){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tSet the text of the labels. The text would be\r\n\t\t\t//\t\tbroken up into the two labels.\r\n\t\t\t// value: [optional] String\r\n\t\t\t//\t\tIf no argument is passed, defaults to two labels\r\n\t\t\t//\t\t'x' and 'y'. If an argument is passed, that\r\n\t\t\t//\t\ttext will be split on the word 'and' to determine\r\n\t\t\t//\t\tthe two labels.\r\n\r\n\t\t\tif(this._labelsCreated){ return; }\r\n\t\t\t!this.labelX && this.createLabels();\r\n\t\t\tvar x = \"x\";\r\n\t\t\tvar y = \"y\";\r\n\t\t\tvar z = \"z\";\r\n\t\t\tif(value){\r\n\t\t\t\t// match first \"and\" or \"&\" and trim whitespace.\r\n\t\t\t\t// Non-greedy matches are not supported in older\r\n\t\t\t\t// browsers such as Netscape Navigator 4 or\r\n\t\t\t\t// Microsoft Internet Explorer 5.0.\r\n\t\t\t\tif(this.labelZ){\r\n\t\t\t\t\tvar lbls = value.match(/(.*?)(and|&)(.*?)(and|&)(.*)/i);\r\n\t\t\t\t\tif(lbls.length>4){\r\n\t\t\t\t\t\tx = lbls[1].replace(/^\\s+/,\"\").replace(/\\s+$/,\"\");\r\n\t\t\t\t\t\ty = lbls[3].replace(/^\\s+/,\"\").replace(/\\s+$/,\"\");\r\n\t\t\t\t\t\tz = lbls[5].replace(/^\\s+/,\"\").replace(/\\s+$/,\"\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}else{\r\n\t\t\t\t\tvar lbls = value.match(/(.*?)(and|&)(.*)/i);\r\n\t\t\t\t\tif(lbls.length>2){\r\n\t\t\t\t\t\tx = lbls[1].replace(/^\\s+/,\"\").replace(/\\s+$/,\"\");\r\n\t\t\t\t\t\ty = lbls[3].replace(/^\\s+/,\"\").replace(/\\s+$/,\"\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.labelX.setLabel(x);\r\n\t\t\tthis.labelY.setLabel(y);\r\n\t\t\tif(this.labelZ){\r\n\t\t\t\tthis.labelZ.setLabel(z);\r\n\t\t\t}\r\n\t\t\tthis._labelsCreated = true;\r\n\t\t},\r\n\t\tgetLabel: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tGetter for the labels. returns an object.\r\n\r\n\t\t\tif(!this.labelX){ return null; }\r\n\t\t\treturn {\r\n\t\t\t\tx:this.labelX.getText(),\r\n\t\t\t\ty:this.labelY.getText(),\r\n\t\t\t\tz:this.labelZ?this.labelZ.getText():null\r\n\t\t\t}; // Object\r\n\t\t},\r\n\r\n\t\tanchorPositionCheck: function(/*Number*/x, /*Number*/y, /*manager.Anchor*/anchor){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tGets called from anchor to check if its current\r\n\t\t\t//\t\tposition is ok. If not, its x or y transform will\r\n\t\t\t//\t\tbe changed until this passes.\r\n\r\n\t\t\tvar pm = this.container.getParent().getTransform();\r\n\t\t\tvar am = anchor.shape.getTransform();\r\n\r\n\t\t\t// the xaxis point has changed and is not yet set as a point\r\n\t\t\t//\t- but the center should be good (except for the transform).\r\n\t\t\t// Now check the yaxis point.\r\n\r\n\t\t\tvar p = this.points;\r\n\t\t\tvar o = {x:am.dx+anchor.org.x+pm.dx, y:am.dy+anchor.org.y+pm.dy};\r\n\t\t\tvar c = {x:p[1].x+pm.dx, y:p[1].y+pm.dy};\r\n\t\t\tvar ox = c.x - (c.y - o.y);\r\n\t\t\tvar oy = c.y - (o.x - c.x);\r\n\r\n\t\t\treturn {x:ox, y:oy};\r\n\r\n\t\t},\r\n\r\n\t\tonTransformBegin: function(/*manager.Anchor*/anchor){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tOverwrites _Base.onTransformBegin\r\n\r\n\t\t\t// called from anchor point up mouse down\r\n\t\t\tthis._isBeingModified = true;\r\n\t\t},\r\n\r\n\t\tonTransformEnd: function(/*manager.Anchor*/anchor){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tOverwrites _Base.onTransformEnd\r\n\r\n\t\t\t// Gets called on anchor mouseup\r\n\t\t\t// also gets called by checkBounds - we don't want that.\r\n\t\t\tif(!anchor){ return; }\r\n\r\n\t\t\t// tell anchor to go to prev point if wrong\r\n\t\t\t// called from anchor point up mouse up\r\n\r\n\t\t\tthis._isBeingModified = false;\r\n\t\t\t//this.deselect();\r\n\t\t\tthis._toggleSelected();\r\n\t\t\tconsole.log(\"before:\", Math.ceil(this.points[1].x), \" x \", Math.ceil(this.points[1].y))\r\n\r\n\t\t\tvar o = this.points[0];\r\n\t\t\tvar c = this.points[1];\r\n\t\t\tvar obj = {start:{x:c.x,y:c.y},x:o.x, y:o.y};\r\n\t\t\tvar pt = this.util.constrainAngle(obj, 0, 89);\r\n\t\t\tvar zpt = this.style.zAxisEnabled ? this.zPoint(obj) : null;\r\n\r\n\t\t\tif(pt.x==o.x && pt.y == o.y){\r\n\t\t\t\t// we're within the constraint, so now we snap\r\n\t\t\t\tpt = this.util.snapAngle(obj, this.angleSnap/180);\r\n\r\n\t\t\t\tobj.x = pt.x;\r\n\t\t\t\tobj.y = pt.y;\r\n\t\t\t\tvar ox = obj.start.x - (obj.start.y - obj.y);\r\n\t\t\t\tvar oy = obj.start.y - (obj.x - obj.start.x);\r\n\r\n\t\t\t\tif(ox<0 || oy<0){\r\n\t\t\t\t\tconsole.warn(\"AXES ERROR LESS THAN ZERO - ABORT\");\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tthis.points = [{x:obj.x, y:obj.y}, {x:obj.start.x, y:obj.start.y, noAnchor:true}];\r\n\t\t\t\tthis.points.push({x:ox, y:oy, noAnchor:true});\r\n\t\t\t\tif(zpt){ this.points.push(zpt);}\r\n\t\t\t\tthis.setPoints(this.points);\r\n\r\n\t\t\t\t//this.select();\r\n\t\t\t\tthis.onModify(this);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// we're outside of the constraint. Set to the low or high.\r\n\t\t\tthis.points[0].x = pt.x;\r\n\t\t\tthis.points[0].y = pt.y;\r\n\t\t\to = this.points[0];\r\n\r\n\t\t\tvar ox = c.x - (c.y - o.y);\r\n\t\t\tvar oy = c.y - (o.x - c.x);\r\n\r\n\t\t\tthis.points[2] = {x:ox, y:oy, noAnchor:true};\r\n\t\t\tif(zpt){ this.points.push(zpt); }\r\n\t\t\tthis.setPoints(this.points);\r\n\r\n\t\t\t// reset handles render\r\n\t\t\t//anchor.reset(this);\r\n\r\n\t\t\tthis.labelX.setLabel();\r\n\t\t\tthis.labelY.setLabel();\r\n\t\t\tif(this.labelZ){\r\n\t\t\t\tthis.labelZ.setLabel();\r\n\t\t\t}\r\n\r\n\t\t\t//this.select();\r\n\t\t\tthis.onModify(this);\r\n\r\n\t\t},\r\n\r\n\t\tgetBounds: function(/*Boolean*/absolute){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tCustom getBounds overwrites _Base.getBounds\r\n\r\n\t\t\tvar px = this.points[0],\r\n\t\t\t    pc = this.points[1],\r\n\t\t\t    py = this.points[2];\r\n\t\t\tif(this.style.zAxisEnabled){ var pz = this.points[3]; }\r\n\r\n\t\t\tif(absolute){\r\n\t\t\t\tvar bounds = {\r\n\t\t\t\t\tx:pc.x,\r\n\t\t\t\t\ty:pc.y,\r\n\t\t\t\t\tx1:pc.x,\r\n\t\t\t\t\ty1:pc.y,\r\n\t\t\t\t\tx2:px.x,\r\n\t\t\t\t\ty2:px.y,\r\n\t\t\t\t\tx3:py.x,\r\n\t\t\t\t\ty3:py.y\r\n\t\t\t\t};\r\n\t\t\t\tif(this.style.zAxisEnabled){\r\n\t\t\t\t\tbounds.x4 = pz.x;\r\n\t\t\t\t\tbounds.y4 = pz.y;\r\n\t\t\t\t}\r\n\t\t\t\treturn bounds;\r\n\t\t\t}\r\n\r\n\t\t\tvar x1 = this.style.zAxisEnabled ? (py.x < pz.x ? py.x : pz.x) : py.x;\r\n\t\t\t    y1 = py.y < px.y ? py.y : px.y,\r\n\t\t\t    x2 = px.x,\r\n\t\t\t    y2 = this.style.zAxisEnabled ? pz.y : pc.y;\r\n\r\n\t\t\treturn {\r\n\t\t\t\tx1:x1,\r\n\t\t\t\ty1:y1,\r\n\t\t\t\tx2:x2,\r\n\t\t\t\ty2:y2,\r\n\t\t\t\tx:x1,\r\n\t\t\t\ty:y1,\r\n\t\t\t\tw:x2-x1,\r\n\t\t\t\th:y2-y1\r\n\t\t\t};\r\n\t\t},\r\n\r\n\t\t_postSetPoints: function(/*Array*/pts){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tBecause Axes only has one anchor,\r\n\t\t\t//\t\twe substitute a special setPoints method\r\n\r\n\t\t\tthis.points[0] = pts[0];\r\n\t\t\tif(this.pointsToData){\r\n\t\t\t\tthis.data = this.pointsToData();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tonTransform: function(/*Number*/anchor){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tOverwrites _Base.onTransform\r\n\r\n\t\t\t// the xaxis point has changed - the center will not.\r\n\t\t\t// need to find the yaxis point.\r\n\t\t\tvar o = this.points[0];\r\n\t\t\tvar c = this.points[1];\r\n\t\t\tvar ox = c.x - (c.y - o.y);\r\n\t\t\tvar oy = c.y - (o.x - c.x);\r\n\r\n\t\t\t// 'noAnchor' on a point indicates an anchor should\r\n\t\t\t// not be rendered. This is the Y point being set.\r\n\t\t\tthis.points[2] = {x:ox, y:oy, noAnchor:true};\r\n\t\t\tif(this.style.zAxisEnabled){\r\n\t\t\t\tthis.points[3] = this.zPoint({start:{x:c.x, y:c.y}, x:o.x, y:o.y});\r\n\t\t\t}\r\n\t\t\tthis.setPoints(this.points);\r\n\t\t\tif(!this._isBeingModified){\r\n\t\t\t\tthis.onTransformBegin();\r\n\t\t\t}\r\n\t\t\tthis.render();\r\n\t\t},\r\n\r\n\t\tpointsToData: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tConverts points to data.\r\n\t\t\tvar p = this.points;\r\n\t\t\tvar d = {\r\n\t\t\t\tx1:p[1].x,\r\n\t\t\t\ty1:p[1].y,\r\n\t\t\t\tx2:p[0].x,\r\n\t\t\t\ty2:p[0].y,\r\n\t\t\t\tx3:p[2].x,\r\n\t\t\t\ty3:p[2].y\r\n\t\t\t}\r\n\t\t\tif(this.style.zAxisEnabled){\r\n\t\t\t\td.x4 = p[3].x;\r\n\t\t\t\td.y4 = p[3].y;\r\n\t\t\t\td.cosphi = 1;\r\n\t\t\t}\r\n\t\t\treturn d;\r\n\r\n\t\t},\r\n\r\n\t\tgetRadius: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tPossibility of z-axis makes bounds unreliable.\r\n\t\t\t//\t\tUse these points instead.\r\n\t\t\tvar p = this.points;\r\n\t\t\tvar line = {start:{x:p[1].x, y:p[1].y}, x:p[0].x, y:p[0].y};\r\n\t\t\treturn this.util.length(line);\r\n\t\t},\r\n\r\n\t\tdataToPoints: function(/* ? Object*/o){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tConverts data to points.\r\n\t\t\to = o || this.data;\r\n\t\t\tif(o.radius || o.angle){\r\n\t\t\t\t// instead of using x1,x2,y1,y1,\r\n\t\t\t\t// it's been set as x,y,angle,radius\r\n\t\t\t\tvar pt = this.util.pointOnCircle(o.x,o.y,o.radius,o.angle), zpt;\r\n\t\t\t\tvar ox = o.x - (o.y - pt.y);\r\n\t\t\t\tvar oy = o.y - (pt.x - o.x);\r\n\t\t\t\tif((o.cosphi && o.cosphi==1) || this.style.zAxisEnabled){\r\n\t\t\t\t\tthis.style.zAxisEnabled = true;\r\n\t\t\t\t\tzpt = this.util.pointOnCircle(o.x, o.y, o.radius*this.zScale, this.style.zAngle);\r\n\t\t\t\t}\r\n\t\t\t\tthis.data = o = {\r\n\t\t\t\t\tx1:o.x,\r\n\t\t\t\t\ty1:o.y,\r\n\t\t\t\t\tx2:pt.x,\r\n\t\t\t\t\ty2:pt.y,\r\n\t\t\t\t\tx3:ox,\r\n\t\t\t\t\ty3:oy\r\n\t\t\t\t}\r\n\t\t\t\tif(this.style.zAxisEnabled){\r\n\t\t\t\t\tthis.data.x4 = o.x4 = zpt.x;\r\n\t\t\t\t\tthis.data.y4 = o.y4 = zpt.y;\r\n\t\t\t\t\tthis.data.cosphi = 1;\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tthis.points = [\r\n\t\t\t\t{x:o.x2, y:o.y2},\r\n\t\t\t\t{x:o.x1, y:o.y1, noAnchor:true},\r\n\t\t\t\t{x:o.x3, y:o.y3, noAnchor:true}\r\n\t\t\t];\r\n\t\t\tif(this.style.zAxisEnabled){ this.points.push({x:o.x4, y:o.y4, skip:true, noAnchor:true}); }\r\n\t\t\treturn this.points;\r\n\t\t},\r\n\r\n\t\tonDrag: function(/*EventObject*/obj){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tSee stencil._Base.onDrag\r\n\r\n\t\t\tvar pt = this.util.constrainAngle(obj, 0, 89);\r\n\t\t\tobj.x = pt.x;\r\n\t\t\tobj.y = pt.y;\r\n\t\t\tvar ox = obj.start.x - (obj.start.y - obj.y);\r\n\t\t\tvar oy = obj.start.y - (obj.x - obj.start.x);\r\n\r\n\t\t\tif(ox<0 || oy<0){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.points = [{x:obj.x, y:obj.y}, {x:obj.start.x, y:obj.start.y, noAnchor:true}];\r\n\r\n\t\t\tthis.points.push({x:ox, y:oy, noAnchor:true});\r\n\t\t\tif(this.style.zAxisEnabled){\r\n\t\t\t\tvar zpt = this.zPoint(obj);\r\n\t\t\t\tthis.points.push(zpt);\r\n\t\t\t}\r\n\t\t\tthis.render();\r\n\t\t},\r\n\r\n\t\tonUp: function(/*EventObject*/obj){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tSee stencil._Base.onUp\r\n\r\n\t\t\tif(!this._downOnCanvas){ return; }\r\n\t\t\tthis._downOnCanvas = false;\r\n\t\t\tvar p = this.points;\r\n\t\t\tif(!p.length){\r\n\t\t\t\tvar s = obj.start, d = 100;\r\n\t\t\t\tthis.points = [\r\n\t\t\t\t\t{x:s.x+d, y:s.y+d},\r\n\t\t\t\t\t{x:s.x, y:s.y+d, noAnchor:true},\r\n\t\t\t\t\t{x:s.x, y:s.y, noAnchor:true}\r\n\t\t\t\t];\r\n\t\t\t\tif(this.style.zAxisEnabled){\r\n\t\t\t\t\tvar zpt = this.zPoint({start:{x:s.x, y:s.y+d}, x:s.x+d, y:s.y+d});\r\n\t\t\t\t\tthis.points.push(zpt);\r\n\t\t\t\t}\r\n\t\t\t\tthis.setPoints = this._postSetPoints;\r\n\t\t\t\tthis.pointsToData();\r\n\t\t\t\tthis.render();\r\n\t\t\t\tthis.onRender(this);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar len = this.util.distance(p[1].x ,p[1].y ,p[0].x ,p[0].y );\r\n\t\t\tif(!p || !p.length){\r\n\t\t\t\treturn;\r\n\t\t\t}else if(len < this.minimumSize){\r\n\t\t\t\tthis.remove(this.shape, this.hit);\r\n\t\t\t\tthis.xArrow.remove(this.xArrow.shape, this.xArrow.hit);\r\n\t\t\t\tthis.yArrow.remove(this.yArrow.shape, this.yArrow.hit);\r\n\t\t\t\tif(this.zArrow){\r\n\t\t\t\t  this.zArrow.remove(this.zArrow.shape, this.zArrow.hit);\r\n\t\t\t\t}\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar o = p[0];\r\n\t\t\tvar c = p[1];\r\n\t\t\tobj = {start:{x:c.x,y:c.y},x:o.x,y:o.y};\r\n\t\t\tvar pt = this.util.snapAngle(obj, this.angleSnap/180);\r\n\t\t\tobj.x = pt.x;\r\n\t\t\tobj.y = pt.y;\r\n\t\t\tvar ox = obj.start.x - (obj.start.y - obj.y);\r\n\t\t\tvar oy = obj.start.y - (obj.x - obj.start.x);\r\n\r\n\t\t\tif(ox<0 || oy<0){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.points = [{x:obj.x, y:obj.y}, {x:obj.start.x, y:obj.start.y, noAnchor:true}];\r\n\r\n\t\t\tthis.points.push({x:ox, y:oy, noAnchor:true});\r\n\t\t\tif(this.style.zAxisEnabled){ this.points.push(this.zPoint(obj)); }\r\n\t\t\tthis.onRender(this);\r\n\t\t\tthis.setPoints = this._postSetPoints;\r\n\t\t}\r\n\t}\r\n);\r\n\r\nlang.setObject(\"dojox.drawing.tools.custom.Axes\", Axes);\r\nAxes.setup = {\r\n\t// summary:\r\n\t//\t\tSee stencil._Base ToolsSetup\r\n\r\n\tname:\"dojox.drawing.tools.custom.Axes\",\r\n\ttooltip:\"Axes Tool\",\r\n\ticonClass:\"iconAxes\"\r\n};\r\nregistry.register(Axes.setup, \"tool\");\r\n\r\nreturn Axes;\r\n});\r\n"]}