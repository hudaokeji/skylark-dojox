{"version":3,"sources":["drawing/tools/Arrow.js"],"names":["define","lang","oo","registry","Line","AnnotationArrow","positioning","Arrow","declare","options","this","arrowStart","begArrow","stencil","idx1","idx2","arrowEnd","endArrow","points","length","render","label","setLabel","draws","type","baseRender","labelPosition","d","data","pt","x","x1","y","y1","x2","y2","onUp","obj","created","shape","p","util","distance","minimumSize","remove","hit","snapAngle","angleSnap","setPoints","renderedOnce","onRender","setObject","setup","name","tooltip","iconClass","register"],"mappings":";;;;;;;AAAAA,QAAQ,kBAAmB,aAAc,uBAAwB,SACjE,uBAAwB,uBACxB,SAASC,EAAMC,EAAIC,EAAUC,EAAMC,EAAiBC,GAEpD,IAAIC,EAAQL,EAAGM,QACdJ,EACA,SAASK,GAGLC,KAAKC,aACPD,KAAKE,SAAW,IAAIP,GAAiBQ,QAAQH,KAAMI,KAAK,EAAGC,KAAK,KAE9DL,KAAKM,WACPN,KAAKO,SAAW,IAAIZ,GAAiBQ,QAAQH,KAAMI,KAAK,EAAGC,KAAK,KAE9DL,KAAKQ,OAAOC,SAIdT,KAAKU,SACLX,EAAQY,OAASX,KAAKY,SAASb,EAAQY,UAQxCE,OAAM,EACNC,KAAK,4BACLC,YAAW,EAIXd,YAAW,EAIXK,UAAS,EAETU,cAAe,WAId,IAAIC,EAAIjB,KAAKkB,KACTC,EAAKvB,EAAYe,OAAOS,EAAEH,EAAEI,GAAGC,EAAEL,EAAEM,KAAKH,EAAEH,EAAEO,GAAGF,EAAEL,EAAEQ,KACvD,OACCL,EAAED,EAAGC,EACLE,EAAEH,EAAGG,IAIPI,KAAM,SAAwBC,GAC7B,IAAG3B,KAAK4B,SAAY5B,KAAK6B,MAAzB,CAGA,IAAIC,EAAI9B,KAAKQ,OAEb,GADUR,KAAK+B,KAAKC,SAASF,EAAE,GAAGV,EAAEU,EAAE,GAAGR,EAAEQ,EAAE,GAAGV,EAAEU,EAAE,GAAGR,GAChDtB,KAAKiC,YACXjC,KAAKkC,OAAOlC,KAAK6B,MAAO7B,KAAKmC,SAD9B,CAKA,IAAIhB,EAAKnB,KAAK+B,KAAKK,UAAUT,EAAK3B,KAAKqC,UAAU,KACjDrC,KAAKsC,YACHlB,EAAEU,EAAE,GAAGV,EAAGE,EAAEQ,EAAE,GAAGR,IACjBF,EAAED,EAAGC,EAAGE,EAAEH,EAAGG,KAGftB,KAAKuC,cAAe,EACpBvC,KAAKwC,SAASxC,WAcjB,OATAT,EAAKkD,UAAU,4BAA6B5C,GAC5CA,EAAM6C,OACLC,KAAK,4BACLC,QAAQ,aACRC,UAAU,aAGXpD,EAASqD,SAASjD,EAAM6C,MAAO,QAExB7C","file":"../../../drawing/tools/Arrow.js","sourcesContent":["define([\"dojo/_base/lang\", \"../util/oo\", \"../manager/_registry\", \"./Line\", \r\n\"../annotations/Arrow\", \"../util/positioning\"],\r\nfunction(lang, oo, registry, Line, AnnotationArrow, positioning){\r\n\r\nvar Arrow = oo.declare(\r\n\tLine,\r\n\tfunction(options){\r\n\t\t// summary:\r\n\t\t//\t\tconstructor\r\n\t\tif(this.arrowStart){\r\n\t\t\tthis.begArrow = new AnnotationArrow({stencil:this, idx1:0, idx2:1});\r\n\t\t}\r\n\t\tif(this.arrowEnd){\r\n\t\t\tthis.endArrow = new AnnotationArrow({stencil:this, idx1:1, idx2:0});\r\n\t\t}\r\n\t\tif(this.points.length){\r\n\t\t\t// This is protecting against cases when there are no points\r\n\t\t\t// not sure how that would ever happen\r\n\t\t\t// Render & label here instead of in base because of Arrow annotation\r\n\t\t\tthis.render();\r\n\t\t\toptions.label && this.setLabel(options.label);\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t// summary:\r\n\t\t//\t\tExtends stencil.Line and adds an arrow head\r\n\t\t//\t\tto the end and or start.\r\n\r\n\t\tdraws:true,\r\n\t\ttype:\"dojox.drawing.tools.Arrow\",\r\n\t\tbaseRender:false,\r\n\t\t\r\n\t\t// arrowStart: Boolean\r\n\t\t//\t\tWhether or not to place an arrow on start.\r\n\t\tarrowStart:false,\r\n\r\n\t\t// arrowEnd: Boolean\r\n\t\t//\t\tWhether or not to place an arrow on end.\r\n\t\tarrowEnd:true,\r\n\t\t\r\n\t\tlabelPosition: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tThe custom position used for the label\r\n\r\n\t\t\tvar d = this.data;\r\n\t\t\tvar pt = positioning.label({x:d.x1,y:d.y1},{x:d.x2,y:d.y2});\r\n\t\t\treturn {\r\n\t\t\t\tx:pt.x,\r\n\t\t\t\ty:pt.y\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\tonUp: function(/*EventObject*/obj){\r\n\t\t\tif(this.created || !this.shape){ return; }\r\n\t\t\t\r\n\t\t\t// if too small, need to reset\r\n\t\t\tvar p = this.points;\r\n\t\t\tvar len = this.util.distance(p[0].x,p[0].y,p[1].x,p[1].y);\r\n\t\t\tif(len<this.minimumSize){\r\n\t\t\t\tthis.remove(this.shape, this.hit);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar pt = this.util.snapAngle(obj, this.angleSnap/180);\r\n\t\t\tthis.setPoints([\r\n\t\t\t\t{x:p[0].x, y:p[0].y},\r\n\t\t\t\t{x:pt.x, y:pt.y}\r\n\t\t\t]);\r\n\t\t\t\r\n\t\t\tthis.renderedOnce = true;\r\n\t\t\tthis.onRender(this);\r\n\t\t}\r\n\t}\r\n);\r\n\r\nlang.setObject(\"dojox.drawing.tools.Arrow\", Arrow);\r\nArrow.setup = {\r\n\tname:\"dojox.drawing.tools.Arrow\",\r\n\ttooltip:\"Arrow Tool\",\r\n\ticonClass:\"iconArrow\"\r\n};\r\n\r\nregistry.register(Arrow.setup, \"tool\");\r\n\r\nreturn Arrow;\r\n});\r\n"]}