{"version":3,"sources":["gantt/GanttResourceItem.js"],"names":["define","declare","arrayUtil","lang","locale","request","on","dom","domClass","domConstruct","domStyle","domAttr","domGeometry","keys","constructor","ganttchart","this","ganttChart","ownerItem","ownerNameItem","ownerTaskNodeMapping","ownerTaskNodeMapping_time","resourceInfo","ownerTimeConsume","clearAll","clearData","clearItems","content","firstChild","destroy","buildResource","forEach","arrProjects","project","arrTasks","task","buildResourceInfo","buildOwnerTimeConsume","owner","tasks","timeZoom","i","length","startTime","taskItem","getTime","dur","duration","hsPerDay","min","Math","max","Date","refresh","contentData","style","width","pixelsPerDay","totalDays","refreshOwnerEntry","reConstruct","tableControl","create","cellPadding","cellSpacing","className","newRowTblControl","insertRow","rows","contentHeight","offsetHeight","contentWidth","offsetWidth","appendChild","createPanelOwners","set","panelTimeHeight","newCellTblControl","vAlign","panelNames","createPanelNamesOwners","divCell","height","scrollBarWidth","maxWidthPanelNames","panelTime","cells","_this","onscroll","scrollTop","scrollLeft","createOwnerEntry","postAdjustment","resourceHeader","innerHTML","resourceChartHeight","refreshOwnerItem","item","refreshDetailedTaskEntry","containerOwner","previousOwner","posY","parseInt","top","heightTaskItem","oItem","createOwnerItem","push","oNameItem","createOwnerNameItem","currentOwnerNameNode","checkWidthTaskNameItem","treeImg","createTreeImg","createDetailedTaskEntry","ownerName","id","title","start","posX","getPosOnDate","left","pixelsPerWorkHour","tposX","childNodes","ownerControl","ownerTaskItem","refreshTaskItem","parentNode","taskItems","containerTasks","createTaskItem","display","taskNameItem","createTaskNameItem","name","get","arrConnectingLinesNames","createConnectingLinesPN","lineName","v","h","itemControl","currentNode","lineVerticalLeft","cNode","pNode","LineHorizontalLeft","noShade","color","currentItem","e","_events","hitch","evt","reachTarget","keyCode","ENTER","isOpen","remove","add","tItem","taskCount","tItems","t","styleOwnerItem","displayType","topOffset","offsetTop","offsetLeft","countChar","round","tName","substring","panelOwner","panelNameOwner"],"mappings":"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","file":"../../gantt/GanttResourceItem.js","sourcesContent":["define([\r\n    \"dojo/_base/declare\",\r\n\t\"dojo/_base/array\",\r\n\t\"dojo/_base/lang\",\r\n    \"dojo/date/locale\",\r\n\t\"dojo/request\",\r\n\t\"dojo/on\",\r\n\t\"dojo/dom\",\r\n\t\"dojo/dom-class\",\r\n\t\"dojo/dom-construct\",\r\n\t\"dojo/dom-style\",\r\n\t\"dojo/dom-attr\",\r\n\t\"dojo/dom-geometry\",\r\n\t\"dojo/keys\",\r\n\t\"dojo/domReady!\"\r\n], function(declare, arrayUtil, lang, locale, request, on,\r\n\t\tdom, domClass, domConstruct, domStyle, domAttr, domGeometry, keys){\r\n\treturn declare(\"dojox.gantt.GanttResourceItem\", [], {\r\n\t\tconstructor: function(ganttchart){\r\n\t\t\tthis.ganttChart = ganttchart;\r\n\t\t\tthis.ownerItem = [];\r\n\t\t\tthis.ownerNameItem = [];\r\n\t\t\tthis.ownerTaskNodeMapping = {};\r\n\t\t\tthis.ownerTaskNodeMapping_time = {};\r\n\t\t\tthis.resourceInfo = {};\r\n\t\t\tthis.ownerTimeConsume = {};\r\n\t\t},\r\n\t\tclearAll: function(){\r\n\t\t\tthis.clearData();\r\n\t\t\tthis.clearItems();\r\n\t\t},\r\n\t\tclearData: function(){\r\n\t\t\tthis.ownerItem = [];\r\n\t\t\tthis.ownerNameItem = [];\r\n\t\t\tthis.ownerTaskNodeMapping = {};\r\n\t\t\tthis.ownerTaskNodeMapping_time = {};\r\n\t\t\tthis.resourceInfo = {};\r\n\t\t\tthis.ownerTimeConsume = {};\r\n\t\t},\r\n\t\tclearItems: function(){\r\n\t\t\tif(this.content.firstChild){\r\n\t\t\t    domConstruct.destroy(this.content.firstChild);\r\n\t\t\t}\r\n\t\t},\r\n\t\tbuildResource: function(){\r\n\t\t\tvar resourceInfo = {};\r\n\t\t\tarrayUtil.forEach(this.ganttChart.arrProjects, function(project){\r\n\t\t\t\tarrayUtil.forEach(project.arrTasks, function(task){\r\n\t\t\t\t\ttask.buildResourceInfo(resourceInfo);\r\n\t\t\t\t}, this);\r\n\t\t\t}, this);\r\n\t\t\treturn resourceInfo;\r\n\t\t},\r\n\t\tbuildOwnerTimeConsume: function(){\r\n\t\t\tvar ownerTimeConsume = {};\r\n\t\t\tfor(var owner in this.resourceInfo){\r\n\t\t\t\tvar tasks = this.resourceInfo[owner];\r\n\t\t\t\t//combine time zone  (startTime - this.startDate) / (60 * 60 * 1000) * this.pixelsPerHour;\r\n\t\t\t\tvar timeZoom = {};\r\n\t\t\t\tfor(var i = 0; i < tasks.length; i++){\r\n\t\t\t\t\tvar task = tasks[i];\r\n\t\t\t\t\tvar startTime = task.taskItem.startTime.getTime(), dur = task.taskItem.duration * 24 * 60 * 60 * 1000 / this.ganttChart.hsPerDay;\r\n\t\t\t\t\ttimeZoom.min = timeZoom.min ? Math.min(timeZoom.min, startTime) : startTime;\r\n\t\t\t\t\ttimeZoom.max = timeZoom.max ? Math.max(timeZoom.max, (startTime + dur)) : (startTime + dur);\r\n\t\t\t\t}\r\n\t\t\t\ttimeZoom.dur = (timeZoom.max - timeZoom.min) * this.ganttChart.hsPerDay / (24 * 60 * 60 * 1000);\r\n\t\t\t\ttimeZoom.min = new Date(timeZoom.min);\r\n\t\t\t\ttimeZoom.max = new Date(timeZoom.max);\r\n\t\t\t\townerTimeConsume[owner] = timeZoom;\r\n\t\t\t}\r\n\t\t\treturn ownerTimeConsume;\r\n\t\t},\r\n\t\trefresh: function(){\r\n\t\t\tthis.ownerTimeConsume = this.buildOwnerTimeConsume();\r\n\t\t\t//resize outer div\r\n\t\t\tthis.contentData.firstChild.style.width = Math.max(1200, this.ganttChart.pixelsPerDay * this.ganttChart.totalDays) + \"px\";\r\n\t\t\tfor(var owner in this.resourceInfo){\r\n\t\t\t\tthis.refreshOwnerEntry(owner);\r\n\t\t\t}\r\n\t\t},\r\n\t\treConstruct: function(){\r\n\t\t\tthis.clearAll();\r\n\t\t\tthis.resourceInfo = this.buildResource();\r\n\t\t\tthis.ownerTimeConsume = this.buildOwnerTimeConsume();\r\n\t\t\tthis.tableControl = domConstruct.create(\"table\", {\r\n\t\t\t\tcellPadding: \"0\",\r\n\t\t\t\tcellSpacing: \"0\",\r\n\t\t\t\tclassName: \"ganttResourceTableControl\"\r\n\t\t\t});\r\n\t\t\tvar newRowTblControl = this.tableControl.insertRow(this.tableControl.rows.length);\r\n\t\t\t//Add to content Table\r\n\t\t\tthis.contentHeight = this.content.offsetHeight;\r\n\t\t\tthis.contentWidth = this.content.offsetWidth;\r\n\t\t\tthis.content.appendChild(this.tableControl);\r\n\t\t\t//Creation panel contentData\r\n\t\t\tthis.contentData = domConstruct.create(\"div\", {className: \"ganttResourceContentDataContainer\"});\r\n\t\t\tthis.contentData.appendChild(this.createPanelOwners());\r\n\t\t\tdomStyle.set(this.contentData, \"height\", (this.contentHeight - this.ganttChart.panelTimeHeight) + \"px\");\r\n\t\t\t//Creation panel of names\r\n\t\t\tvar newCellTblControl = domConstruct.create(\"td\", {\r\n\t\t\t\tvAlign: \"top\"\r\n\t\t\t});\r\n\t\t\tthis.panelNames = domConstruct.create(\"div\", {className: \"ganttResourcePanelNames\"});\r\n\t\t\tthis.panelNames.appendChild(this.createPanelNamesOwners());\r\n\t\t\tnewCellTblControl.appendChild(this.panelNames);\r\n\t\t\tnewRowTblControl.appendChild(newCellTblControl);\r\n\t\t\t//add to control contentData and contentDataTime\r\n\t\t\tnewCellTblControl = domConstruct.create(\"td\", {\r\n\t\t\t\tvAlign: \"top\"\r\n\t\t\t});\r\n\t\t\tvar divCell = domConstruct.create(\"div\", {className: \"ganttResourceDivCell\"});\r\n\t\t\tdivCell.appendChild(this.contentData);\r\n\t\t\tnewCellTblControl.appendChild(divCell);\r\n\t\t\tnewRowTblControl.appendChild(newCellTblControl);\r\n\t\t\t//Show panel of names\r\n\t\t\tdomStyle.set(this.panelNames, {\r\n\t\t\t\theight: (this.contentHeight - this.ganttChart.panelTimeHeight - this.ganttChart.scrollBarWidth) + \"px\",\r\n\t\t\t\twidth: this.ganttChart.maxWidthPanelNames + \"px\"\r\n\t\t\t});\r\n\t\t\tthis.contentData.style.width = (this.contentWidth - this.ganttChart.maxWidthPanelNames) + \"px\";\r\n\t\t\tthis.contentData.firstChild.style.width = this.ganttChart.pixelsPerDay * (this.ganttChart.panelTime.firstChild.firstChild.rows[3].cells.length) + \"px\";\r\n\t\t\tvar _this = this;\r\n\t\t\tthis.contentData.onscroll = function(){\r\n\t\t\t\tif(_this.panelNames){\r\n\t\t\t\t\t_this.panelNames.scrollTop = this.scrollTop;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tthis.contentData.scrollLeft = this.ganttChart.contentData.scrollLeft;\r\n\t\t\tfor(var owner in this.resourceInfo){\r\n\t\t\t\tthis.createOwnerEntry(owner);\r\n\t\t\t}\r\n\t\t\tthis.postAdjustment();\r\n\t\t},\r\n\t\tcreate: function(){\r\n\t\t\tvar resourceHeader = domConstruct.create(\"div\", {\r\n\t\t\t\tinnerHTML: \"Resource Chart:\",\r\n\t\t\t\tclassName: \"ganttResourceHeader\"\r\n\t\t\t}, this.ganttChart.content, \"after\");\r\n\t\t\tdomStyle.set(resourceHeader, \"width\", this.ganttChart.contentWidth + \"px\");\r\n\t\t\tvar content = domConstruct.create(\"div\", {className: \"ganttResourceContent\"}, resourceHeader, \"after\");\r\n\t\t\tdomStyle.set(content, {\r\n\t\t\t\twidth: this.ganttChart.contentWidth + \"px\",\r\n\t\t\t\theight: (this.ganttChart.resourceChartHeight || (this.ganttChart.contentHeight * 0.8)) + \"px\"\r\n\t\t\t});\r\n\t\t\tthis.content = content || this.content;\r\n\t\t\t//create Table\r\n\t\t\tthis.reConstruct();\r\n\t\t},\r\n\t\tpostAdjustment: function(){\r\n\t\t\t//contentData height\r\n\t\t\tthis.contentData.firstChild.style.height = (this.ownerItem.length * 23) + \"px\";\r\n\t\t\tthis.panelNames.firstChild.style.height = (this.ownerItem.length * 23) + \"px\";\r\n\t\t},\r\n\t\r\n\t\trefreshOwnerEntry: function(owner){\r\n\t\t\tthis.refreshOwnerItem(owner);\r\n\t\t\tarrayUtil.forEach(this.resourceInfo[owner], function(task, i){\r\n\t\t\t\tvar item = this.ownerTaskNodeMapping[owner].tasks[i][0];\r\n\t\t\t\tthis.refreshDetailedTaskEntry(owner, item, task);\r\n\t\t\t}, this);\r\n\t\t},\r\n\t\tcreateOwnerEntry: function(owner){\r\n\t\t\tvar containerOwner = this.contentData.firstChild;\r\n\t\t\tvar previousOwner = this.ownerItem[this.ownerItem.length - 1];\r\n\t\t\tthis.ownerTaskNodeMapping[owner] = {};\r\n\t\t\tthis.ownerTaskNodeMapping[owner][owner] = [];\r\n\t\t\t//creation arrTasks\r\n\t\t\tvar posY = (previousOwner ? parseInt(previousOwner.style.top) : (6 - 23)) + this.ganttChart.heightTaskItem + 11;\r\n\t\t\t//creation task item\r\n\t\t\tvar oItem = this.createOwnerItem(owner, posY);\r\n\t\t\tcontainerOwner.appendChild(oItem);\r\n\t\t\tthis.ownerItem.push(oItem);\r\n\t\t\tthis.ownerTaskNodeMapping[owner][owner].push(oItem);\r\n\t\t\tif(this.panelNames){\r\n\t\t\t\tvar oNameItem = this.createOwnerNameItem(owner, posY);\r\n\t\t\t\tthis.panelNames.firstChild.appendChild(oNameItem);\r\n\t\t\t\tthis.ownerNameItem.push(oNameItem);\r\n\t\t\t\tthis.ownerTaskNodeMapping[owner][owner].push(oNameItem);\r\n\t\t\t}\r\n\t\t\tvar currentOwnerNameNode = this.ownerNameItem[this.ownerNameItem.length - 1];\r\n\t\t\t//adjust nodes\r\n\t\t\tif(this.panelNames){\r\n\t\t\t\tthis.checkWidthTaskNameItem(currentOwnerNameNode);\r\n\t\t\t\tvar treeImg = this.createTreeImg(currentOwnerNameNode);\r\n\t\t\t\tthis.panelNames.firstChild.appendChild(treeImg);\r\n\t\t\t\tthis.ownerTaskNodeMapping[owner][owner].push(treeImg);\r\n\t\t\t}\r\n\t\t\tthis.ownerTaskNodeMapping[owner][\"taskCount\"] = this.resourceInfo[owner].length;\r\n\t\t\tthis.ownerTaskNodeMapping[owner][\"isOpen\"] = false;\r\n\t\t\tthis.ownerTaskNodeMapping[owner][\"tasks\"] = [];\r\n\t\t\tarrayUtil.forEach(this.resourceInfo[owner], function(task){\r\n\t\t\t\tthis.ownerTaskNodeMapping[owner][\"tasks\"].push(this.createDetailedTaskEntry(owner, currentOwnerNameNode, task));\r\n\t\t\t}, this);\r\n\t\t\treturn this;\r\n\t\t},\r\n\t\tcreateOwnerNameItem: function(owner, posY){\r\n\t\t\tvar ownerName = domConstruct.create(\"div\", {\r\n\t\t\t\tid: owner,\r\n\t\t\t\ttitle: owner,\r\n\t\t\t\tinnerHTML: owner,\r\n\t\t\t\tclassName: \"ganttOwnerNameItem\"\r\n\t\t\t});\r\n\t\t\tdomStyle.set(ownerName, \"top\", posY + \"px\");\r\n\t\t\treturn ownerName;\r\n\t\t},\r\n\t\trefreshOwnerItem: function(owner){\r\n\t\t\tvar item = this.ownerTaskNodeMapping[owner][owner][0],\r\n\t\t\t\tstart = this.ownerTimeConsume[owner].min, dur = this.ownerTimeConsume[owner].dur,\r\n\t\t\t\tposX = this.ganttChart.getPosOnDate(start); // should be task start date\r\n\t\t\titem.style.left = posX + \"px\";\r\n\t\t\titem.style.width = dur * this.ganttChart.pixelsPerWorkHour + \"px\";\r\n\t\t\tarrayUtil.forEach(this.resourceInfo[owner], function(task, i){\r\n\t\t\t\tvar tposX = this.ganttChart.getPosOnDate(task.taskItem.startTime); // should be task start date\r\n\t\t\t\tdomStyle.set(item.childNodes[i], {\r\n\t\t\t\t\tleft: (tposX - posX) + \"px\",\r\n\t\t\t\t\twidth: task.taskItem.duration * this.ganttChart.pixelsPerWorkHour + \"px\"\r\n\t\t\t\t});\r\n\t\t\t}, this);\r\n\t\t},\r\n\t\tcreateOwnerItem: function(owner, posY){\r\n\t\t\tvar start = this.ownerTimeConsume[owner].min, dur = this.ownerTimeConsume[owner].dur;\r\n\t\t\tvar posX = this.ganttChart.getPosOnDate(start); // should be task start date\r\n\t\t\tvar ownerControl = domConstruct.create(\"div\", {\r\n\t\t\t\tid: owner,\r\n\t\t\t\towner: true,\r\n\t\t\t\tclassName: \"ganttOwnerBar\"\r\n\t\t\t});\r\n\t\t\tdomStyle.set(ownerControl, {\r\n\t\t\t\tleft: posX + \"px\",\r\n\t\t\t\ttop: posY + \"px\",\r\n\t\t\t\twidth: dur * this.ganttChart.pixelsPerWorkHour + \"px\",\r\n\t\t\t\theight: this.ganttChart.heightTaskItem + \"px\"\r\n\t\t\t});\r\n\t\t\tarrayUtil.forEach(this.resourceInfo[owner], function(task){\r\n\t\t\t\tvar ownerTaskItem = domConstruct.create(\"div\", {\r\n\t\t\t\t\tid: owner,\r\n\t\t\t\t\tclassName: \"ganttOwnerTaskBar\"\r\n\t\t\t\t}, ownerControl);\r\n\t\t\t\tvar tposX = this.ganttChart.getPosOnDate(task.taskItem.startTime); // should be task start date\r\n\t\t\t\tdomStyle.set(ownerTaskItem, {\r\n\t\t\t\t\tleft: (tposX - posX) + \"px\",\r\n\t\t\t\t\twidth: task.taskItem.duration * this.ganttChart.pixelsPerWorkHour + \"px\", // should be task duration\r\n\t\t\t\t\theight: this.ganttChart.heightTaskItem + \"px\"\r\n\t\t\t\t});\r\n\t\t\t}, this);\r\n\t\t\treturn ownerControl;\r\n\t\t},\r\n\t\trefreshDetailedTaskEntry: function(owner, item, task){\r\n\t\t\tthis.refreshTaskItem(item, task);\r\n\t\t},\r\n\t\tcreateDetailedTaskEntry: function(owner, parentNode, task){\r\n\t\t\tvar taskItems = [];\r\n\t\t\tvar containerTasks = this.contentData.firstChild;\r\n\t\t\tvar posY = parseInt(parentNode.style.top);\r\n\t\t\r\n\t\t\t//creation task item\r\n\t\t\tvar taskItem = this.createTaskItem(task, posY);\r\n\t\t\ttaskItem.style.display = \"none\";\r\n\t\t\tcontainerTasks.appendChild(taskItem);\r\n\t\t\tthis.ownerItem.push(taskItem);\r\n\t\t\ttaskItems.push(taskItem);\r\n\t\t\tif(this.panelNames){\r\n\t\t\t\tvar taskNameItem = this.createTaskNameItem(task.taskItem.name, posY);\r\n\t\t\t\tthis.panelNames.firstChild.appendChild(taskNameItem);\r\n\t\t\t\ttaskNameItem.style.display = \"none\";\r\n\t\t\t\tthis.ownerNameItem.push(taskNameItem);\r\n\t\t\t\ttaskItems.push(taskNameItem);\r\n\t\t\t}\r\n\t\t\tif(this.panelNames){\r\n\t\t\t\tthis.ownerNameItem[this.ownerNameItem.length - 1].style.left = domStyle.get(parentNode, \"left\") + 15 + \"px\";\r\n\t\t\t\tvar arrConnectingLinesNames = this.createConnectingLinesPN(parentNode, this.ownerNameItem[this.ownerNameItem.length - 1]);\r\n\t\t\t\tarrayUtil.forEach(arrConnectingLinesNames, function(lineName){\r\n\t\t\t\t\tlineName.style.display = \"none\";\r\n\t\t\t\t}, this);\r\n\t\t\t\ttaskItems.push({\r\n\t\t\t\t\t\"v\": arrConnectingLinesNames[0],\r\n\t\t\t\t\t\"h\": arrConnectingLinesNames[1]\r\n\t\t\t\t});\r\n\t\t\t\tthis.checkWidthTaskNameItem(this.ownerNameItem[this.ownerNameItem.length - 1]);\r\n\t\t\t}\r\n\t\t\treturn taskItems;\r\n\t\t},\r\n\t\tcreateTaskNameItem: function(owner, posY){\r\n\t\t\tvar taskNameItem = domConstruct.create(\"div\", {\r\n\t\t\t\tid: owner,\r\n\t\t\t\tclassName: \"ganttTaskNameItem\",\r\n\t\t\t\ttitle: owner,\r\n\t\t\t\tinnerHTML: owner\r\n\t\t\t});\r\n\t\t\tdomStyle.set(taskNameItem, \"top\", posY + \"px\");\r\n\t\t\treturn taskNameItem;\r\n\t\t},\r\n\t\trefreshTaskItem: function(item, task){\r\n\t\t\tvar posX = this.ganttChart.getPosOnDate(task.taskItem.startTime); // should be task start date\r\n\t\t\tdomStyle.set(item, {\r\n\t\t\t\tleft: posX + \"px\",\r\n\t\t\t\twidth: task.taskItem.duration * this.ganttChart.pixelsPerWorkHour + \"px\"\r\n\t\t\t});\r\n\t\t},\r\n\t\tcreateTaskItem: function(task, posY){\r\n\t\t\tvar posX = this.ganttChart.getPosOnDate(task.taskItem.startTime); // should be task start date\r\n\t\t\tvar itemControl = domConstruct.create(\"div\", {\r\n\t\t\t\tid: task.taskItem.name,\r\n\t\t\t\tclassName: \"ganttTaskBar\"\r\n\t\t\t});\r\n\t\t\tdomStyle.set(itemControl, {\r\n\t\t\t\tleft: posX + \"px\",\r\n\t\t\t\ttop: posY + \"px\",\r\n\t\t\t\twidth: task.taskItem.duration * this.ganttChart.pixelsPerWorkHour + \"px\",\r\n\t\t\t\theight: this.ganttChart.heightTaskItem + \"px\"\r\n\t\t\t});\r\n\t\t\treturn itemControl;\r\n\t\t},\r\n\t\tcreateConnectingLinesPN: function(parentNode, currentNode){\r\n\t\t\tvar arrConnectingLinesNames = [];\r\n\t\t\tvar lineVerticalLeft = domConstruct.create(\"div\", {\r\n\t\t\t\tinnerHTML: \"&nbsp;\",\r\n\t\t\t\tclassName: \"ganttResourceLineVerticalLeft\"\r\n\t\t\t}, this.panelNames.firstChild);\r\n\t\t\tlineVerticalLeft.cNode = currentNode;\r\n\t\t\tlineVerticalLeft.pNode = parentNode;\r\n\t\t\tvar LineHorizontalLeft = domConstruct.create(\"div\", {\r\n\t\t\t\tnoShade: true,\r\n\t\t\t\tcolor: \"#000\",\r\n\t\t\t\tclassName: \"ganttResourceLineHorizontalLeft\"\r\n\t\t\t}, this.panelNames.firstChild);\r\n\t\t\tLineHorizontalLeft.cNode = currentNode;\r\n\t\t\tLineHorizontalLeft.pNode = parentNode;\r\n\t\t\tthis.panelNames.firstChild.appendChild(LineHorizontalLeft);\r\n\t\t\tarrConnectingLinesNames.push(lineVerticalLeft);\r\n\t\t\tarrConnectingLinesNames.push(LineHorizontalLeft);\r\n\t\t\treturn arrConnectingLinesNames;\r\n\t\t},\r\n\t\tcreateTreeImg: function(ownerNameItem){\r\n\t\t\tvar treeImg = domConstruct.create(\"div\", {\r\n\t\t\t\tid: ownerNameItem.id,\r\n\t\t\t\tclassName: \"ganttImageTreeExpand\"\r\n\t\t\t});\r\n\t\t\tdomAttr.set(treeImg, \"tabIndex\", 0);\r\n\t\t\tvar currentItem = this.ownerTaskNodeMapping[ownerNameItem.id];\r\n\t\t\tarrayUtil.forEach([\"click\", \"keydown\"], function(e){\r\n\t\t\t\tthis.ganttChart._events.push(\r\n\t\t\t\t\ton(treeImg, e, lang.hitch(this, function(evt){\r\n\t\t\t\t\t\tvar reachTarget = false, owner, ownerItem;\r\n\t\t\t\t\t\tif(e == \"keydown\" && evt.keyCode != keys.ENTER){ return; }\r\n\t\t\t\t\t\t//TODO: perhaps the following conditional can be collapsed?  Duplicate code.\r\n\t\t\t\t\t\tif(currentItem.isOpen){\r\n\t\t\t\t\t\t\tdomClass.remove(treeImg, \"ganttImageTreeCollapse\");\r\n\t\t\t\t\t\t\tdomClass.add(treeImg, \"ganttImageTreeExpand\");\r\n\t\t\t\t\t\t\tcurrentItem.isOpen = false;\r\n\t\t\t\t\t\t\t//collapse\r\n\t\t\t\t\t\t\tfor(owner in this.ownerTaskNodeMapping){\r\n\t\t\t\t\t\t\t\townerItem = this.ownerTaskNodeMapping[owner];\r\n\t\t\t\t\t\t\t\tif(reachTarget){\r\n\t\t\t\t\t\t\t\t\tarrayUtil.forEach(ownerItem[owner], function(tItem){\r\n\t\t\t\t\t\t\t\t\t\tdomStyle.set(tItem, \"top\", domStyle.get(tItem, \"top\") - currentItem.taskCount * 23 + \"px\");\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\tarrayUtil.forEach(ownerItem.tasks, function(tItems){\r\n\t\t\t\t\t\t\t\t\t\tarrayUtil.forEach(tItems, function(tItem){\r\n\t\t\t\t\t\t\t\t\t\t\tvar item = !tItem.v && !tItem.h ? [tItem] : [tItem.v, tItem.h];\r\n\t\t\t\t\t\t\t\t\t\t\tarrayUtil.forEach(item, function(t){\r\n\t\t\t\t\t\t\t\t\t\t\t\tdomStyle.set(t, \"top\", domStyle.get(t, \"top\") - currentItem.taskCount * 23 + \"px\");\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\tif(owner == ownerNameItem.id){\r\n\t\t\t\t\t\t\t\t\t\treachTarget = true;\r\n\t\t\t\t\t\t\t\t\t\tarrayUtil.forEach(ownerItem.tasks, function(tItems){\r\n\t\t\t\t\t\t\t\t\t\t\tarrayUtil.forEach(tItems, function(tItem){\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.styleOwnerItem(tItem, ownerItem[owner][0], \"none\", 0);\r\n\t\t\t\t\t\t\t\t\t\t\t}, this);\r\n\t\t\t\t\t\t\t\t\t\t}, this);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tdomClass.remove(treeImg, \"ganttImageTreeExpand\");\r\n\t\t\t\t\t\t\tdomClass.add(treeImg, \"ganttImageTreeCollapse\");\r\n\t\t\t\t\t\t\tcurrentItem.isOpen = true;\r\n\t\t\t\t\t\t\t//expand\r\n\t\t\t\t\t\t\tfor(owner in this.ownerTaskNodeMapping){\r\n\t\t\t\t\t\t\t\townerItem = this.ownerTaskNodeMapping[owner];\r\n\t\t\t\t\t\t\t\tif(reachTarget){\r\n\t\t\t\t\t\t\t\t\tarrayUtil.forEach(ownerItem[owner], function(tItem){\r\n\t\t\t\t\t\t\t\t\t\tdomStyle.set(tItem, \"top\", domStyle.get(tItem, \"top\") + currentItem.taskCount * 23 + \"px\");\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\tarrayUtil.forEach(ownerItem.tasks, function(tItems){\r\n\t\t\t\t\t\t\t\t\t\tarrayUtil.forEach(tItems, function(tItem){\r\n\t\t\t\t\t\t\t\t\t\t\tvar item = !tItem.v && !tItem.h ? [tItem] : [tItem.v, tItem.h];\r\n\t\t\t\t\t\t\t\t\t\t\tarrayUtil.forEach(item, function(t){\r\n\t\t\t\t\t\t\t\t\t\t\t\tdomStyle.set(t, \"top\", domStyle.get(t, \"top\") + currentItem.taskCount * 23 + \"px\");\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\tif(owner == ownerNameItem.id){\r\n\t\t\t\t\t\t\t\t\t\treachTarget = true;\r\n\t\t\t\t\t\t\t\t\t\tarrayUtil.forEach(ownerItem.tasks, function(tItems, i){\r\n\t\t\t\t\t\t\t\t\t\t\tarrayUtil.forEach(tItems, function(tItem){\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.styleOwnerItem(tItem, ownerItem[owner][0], \"inline\", (i + 1) * 23);\r\n\t\t\t\t\t\t\t\t\t\t\t}, this);\r\n\t\t\t\t\t\t\t\t\t\t}, this);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}))\r\n\t\t\t\t);\r\n\t\t\t}, this);\r\n\t\t\tdomClass.add(treeImg, \"ganttResourceTreeImage\");\r\n\t\t\tdomStyle.set(treeImg, {\r\n\t\t\t\tleft: (domStyle.get(ownerNameItem, \"left\") - 12) + \"px\",\r\n\t\t\t\ttop: (domStyle.get(ownerNameItem, \"top\") + 3) + \"px\"\r\n\t\t\t});\r\n\t\t\treturn treeImg;\r\n\t\t},\r\n\t\tstyleOwnerItem: function(tItem, owner, displayType, topOffset){\r\n\t\t\tif(tItem.v || tItem.h){\r\n\t\t\t\tdomStyle.set(tItem.v, {\r\n\t\t\t\t\theight: Math.max(1, (tItem.v.cNode.offsetTop - tItem.v.pNode.offsetTop)) + \"px\",\r\n\t\t\t\t\ttop: (tItem.v.pNode.offsetTop + 5) + \"px\",\r\n\t\t\t\t\tleft: (tItem.v.pNode.offsetLeft - 9) + \"px\",\r\n\t\t\t\t\tdisplay: displayType\r\n\t\t\t\t});\r\n\t\t\t\tdomStyle.set(tItem.h, {\r\n\t\t\t\t\twidth: Math.max(1, (tItem.h.cNode.offsetLeft - tItem.h.pNode.offsetLeft + 4)) + \"px\",\r\n\t\t\t\t\ttop: (tItem.h.cNode.offsetTop + 5) + \"px\",\r\n\t\t\t\t\tleft: (tItem.h.pNode.offsetLeft - 9) + \"px\",\r\n\t\t\t\t\tdisplay: displayType\r\n\t\t\t\t});\r\n\t\t\t}else{\r\n\t\t\t\tdomStyle.set(tItem, {\r\n\t\t\t\t\tdisplay: displayType,\r\n\t\t\t\t\ttop: parseInt(owner.style.top) + topOffset + \"px\"\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\tcheckWidthTaskNameItem: function(taskNameItem){\r\n\t\t\tif(taskNameItem && taskNameItem.offsetWidth + taskNameItem.offsetLeft > this.ganttChart.maxWidthPanelNames){\r\n\t\t\t\tvar width = taskNameItem.offsetWidth + taskNameItem.offsetLeft - this.ganttChart.maxWidthPanelNames,\r\n\t\t\t\t\tcountChar = Math.round(width / (taskNameItem.offsetWidth / taskNameItem.firstChild.length)),\r\n\t\t\t\t\ttName = taskNameItem.id.substring(0, taskNameItem.firstChild.length - countChar - 3);\r\n\t\t\t\ttaskNameItem.innerHTML = tName + \"...\";\r\n\t\t\t}\r\n\t\t},\r\n\t\tcreatePanelOwners: function(){\r\n\t\t\tvar panelOwner = domConstruct.create(\"div\", {\r\n\t\t\t\tclassName: \"ganttOwnerPanel\"\r\n\t\t\t});\r\n\t\t\tdomStyle.set(panelOwner, {\r\n\t\t\t\theight: (this.contentHeight - this.ganttChart.panelTimeHeight - this.ganttChart.scrollBarWidth) + \"px\"\r\n\t\t\t});\r\n\t\t\treturn panelOwner;\r\n\t\t},\r\n\t\tcreatePanelNamesOwners: function(){\r\n\t\t\tvar panelNameOwner = domConstruct.create(\"div\", {\r\n\t\t\t\tinnerHTML: \"&nbsp;\",\r\n\t\t\t\tclassName: \"ganttResourcePanelNamesOwners\"\r\n\t\t\t});\r\n\t\t\tdomStyle.set(panelNameOwner, {\r\n\t\t\t\theight: (this.contentHeight - this.ganttChart.panelTimeHeight - this.ganttChart.scrollBarWidth) + \"px\",\r\n\t\t\t\twidth: this.ganttChart.maxWidthPanelNames + \"px\"\r\n\t\t\t});\r\n\t\t\treturn panelNameOwner;\r\n\t\t}\r\n\t});\r\n});"]}