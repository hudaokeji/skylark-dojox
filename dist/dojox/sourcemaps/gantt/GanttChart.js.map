{"version":3,"sources":["gantt/GanttChart.js"],"names":["define","GanttProjectItem","GanttResourceItem","GanttProjectControl","GanttTaskControl","GanttTaskItem","TabMenu","Tooltip","declare","arrayUtil","lang","locale","request","util","on","dom","domClass","domConstruct","domStyle","domAttr","domGeometry","keys","has","win","JSON","constructor","configuration","node","this","resourceChartHeight","undefined","withResource","correctError","autoCorrectError","isShowConMenu","isContentEditable","readOnly","withTaskId","animation","saveProgramPath","dataFilePath","contentHeight","height","contentWidth","width","content","byId","scrollBarWidth","panelTimeHeight","maxWidthPanelNames","maxWidthTaskNames","minWorkLength","heightTaskItem","heightTaskItemExtra","pixelsPerDay","hsPerDay","pixelsPerWorkHour","pixelsPerHour","countDays","totalDays","startDate","initialPos","contentDataHeight","panelTimeExpandDelta","divTimeInfo","panelNames","panelTime","contentData","tabMenu","project","arrProjects","xmlLoader","isMoving","isResizing","animationNodes","scale","tempDayInPixels","resource","months","getNames","_events","getProject","id","filter","proj","checkPosPreviousTask","predTask","task","getWidthOnDuration","duration","getPosOnDate","startTime","correctPosPreviousTask","ctask","ctaskObj","newDate","Date","setHours","getHours","setDate","getDate","setStartTime","parentTask","checkPosParentTask","newDate2","parseInt","correctPosParentTask","previousTask","checkPosParentTaskInTree","exception","i","cldTasks","length","pcTask","setPreviousTask","parentTasks","ppTask","previousTaskId","getTaskById","cldPreTasks","push","setPreviousTaskInTree","addProject","projectItem","deleteProject","arrTasks","deleteChildTask","rowHeight","nextProject","shiftNextProject","previousProject","splice","parentNode","removeChild","descrProject","projectNameItem","d","t","pi","name","create","checkPosition","insertProject","checkHeighPanelTasks","_project","curProject","preProject","hideDescrProject","openTree","lastParentTask","getLastCloseParent","openNode","taskItem","isExpanded","remove","cTaskNameItem","add","shiftCurrentTasks","hideTasksHeight","showChildTasks","style","display","getProjectItemById","clearAll","clearData","clearItems","clearEvents","forEach","e","firstChild","appendChild","createPanelTasks","createPanelNamesTasks","buildUIContent","sort","sortProjStartDate","getStartDate","createPanelTime","k","setStartTimeChild","sortTasksByStartTime","createTasks","reConstruct","postLoadData","postBindEvents","loadJSONData","filename","_this","get","sync","then","response","loadJSONString","text","console","log","items","parse","pItem","startdate","split","tItems","tasks","tItem","starttime","percentage","taskOwner","ctItems","children","buildChildTasksData","addTask","childTaskItems","ctItem","addChildTask","getJSONData","jsonObj","identifier","getFullYear","getMonth","pTask","getChildTasksData","childTasks","cTaskObj","childTask","saveJSONData","fileName","trim","post","query","data","stringify","checkStatus","options","status","message","sortTaskStartTime","a","b","panelTask","className","set","refreshParams","createPanelNamesTasksHeader","panelHeader","tblHeader","cellPadding","border","cellSpacing","bgColor","firstRow","insertRow","rows","secondRow","thirdRow","zoomIn","align","vAlign","zoomInFn","hitch","switchTeleMicroView","zoomInClickEvent","zoomInKeyEvent","keyCode","ENTER","zoomOut","zoomOutFn","zoomOutClickEvent","zoomOutKeyEvent","micro","microClickEvent","refresh","microKeyEvent","blur","tele","teleClickEvent","teleKeyEvent","save","saveClickEvent","saveKeyEvent","load","loadClickEvent","loadKeyEvent","actions","titles","action","title","tooltipShow","dijit","showTooltip","onmouseover","onfocus","tooltipHide","hideTooltip","onmouseout","onblur","panelNameTask","innerHTML","tblTime","oldYear","newYear","newYearRow","ycount","date","addYearInPanelTime","oldMonth","newMonth","newMonthRow","mcount","lastYear","addMonthInPanelTime","oldWeek","newWeek","newWeekRow","_getWeekOfYear","addWeekInPanelTime","newDayRow","addDayInPanelTime","newHourRow","addHourInPanelTime","adjustPanelTime","maxEndPos","map","left","offsetWidth","maxTaskEndPos","prows","removeCell","Math","round","cells","row","count","year","newCell","colSpan","innerHTMLData","month","week","String","getDay","event","dayTime","target","srcElement","getTime","hourTable","newRow","hourTD","incHeightPanelTasks","containerTasks","incHeightPanelNames","containerNames","sortChildTasks","parenttask","current","multi","refreshController","panelNameHeadersCover","dip","pow","setTimeout","plChild","max","childNodes","td","cs","idata","sdata","init","tableControl","newRowTblControl","getCountDays","newCellTblControl","panelNameHeaders","divCell","onscroll","scrollLeft","scrollTop","hide","cpos","getMarginBox","l","top","h","w","pos","position","elem","hlTop","layerY","oldHLTop","highLightDiv","y","body","x","pppTask","nextParentTask","previousParentTask","createChildItemControls","arrChildTasks","cTask","previousChildTask","nextChildTask","getLastChildTask","deleteCell"],"mappings":"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","file":"../../gantt/GanttChart.js","sourcesContent":["// FIXME: documentation\r\ndefine([\r\n    \"./GanttProjectItem\",\r\n    \"./GanttResourceItem\",\r\n    \"./GanttProjectControl\",\r\n    \"./GanttTaskControl\",\r\n    \"./GanttTaskItem\",\r\n    \"./TabMenu\",\r\n    \"dijit/Tooltip\",\r\n    \"dojo/_base/declare\",\r\n\t\"dojo/_base/array\",\r\n\t\"dojo/_base/lang\",\r\n    \"dojo/date/locale\",\r\n\t\"dojo/request\",\r\n\t\"dojo/request/util\",\r\n\t\"dojo/on\",\r\n\t\"dojo/dom\",\r\n\t\"dojo/dom-class\",\r\n\t\"dojo/dom-construct\",\r\n\t\"dojo/dom-style\",\r\n\t\"dojo/dom-attr\",\r\n\t\"dojo/dom-geometry\",\r\n\t\"dojo/keys\",\r\n\t\"dojo/has\",\r\n\t\"dojo/_base/window\",\r\n\t\"dojo/json\",\r\n\t\"dojo/domReady!\"\r\n], function(GanttProjectItem, GanttResourceItem, GanttProjectControl, \r\n\t\tGanttTaskControl, GanttTaskItem, TabMenu,\r\n\t\tTooltip, \r\n\t\tdeclare, arrayUtil, lang, locale, request, util, on,\r\n\t\tdom, domClass, domConstruct, domStyle, domAttr, domGeometry, keys, has, win, JSON){\r\n\treturn declare(\"dojox.gantt.GanttChart\", [], {\r\n\t\tconstructor: function(configuration, node){\r\n\t\t\tthis.resourceChartHeight = configuration.resourceChartHeight !== undefined ? configuration.resourceChartHeight : false;\r\n\t\t\tthis.withResource = configuration.withResource !== undefined ? configuration.withResource : true;\r\n\t\t\tthis.correctError = configuration.autoCorrectError !== undefined ? configuration.autoCorrectError : false;\r\n\t\t\tthis.isShowConMenu = this.isContentEditable = !configuration.readOnly;\r\n\t\t\tthis.withTaskId = configuration.withTaskId !== undefined ? configuration.withTaskId : !configuration.readOnly;\r\n\t\t\tthis.animation = configuration.animation !== undefined ? configuration.animation : true;\r\n\t\t\tthis.saveProgramPath = configuration.saveProgramPath  || \"saveGanttData.php\";\r\n\t\t\tthis.dataFilePath = configuration.dataFilePath  || \"gantt_default.json\";\r\n\t\t\tthis.contentHeight = configuration.height || 400;\r\n\t\t\tthis.contentWidth = configuration.width || 600;\r\n\t\t\tthis.content = dom.byId(node);\r\n\t\t\tthis.scrollBarWidth = 18;\r\n\t\t\tthis.panelTimeHeight = 102;\r\n\t\t\tthis.maxWidthPanelNames = 150;\r\n\t\t\tthis.maxWidthTaskNames = 150;\r\n\t\t\tthis.minWorkLength = 8;\r\n\t\t\tthis.heightTaskItem = 12;\r\n\t\t\tthis.heightTaskItemExtra = 11;\r\n\t\t\tthis.pixelsPerDay = 24;//px\r\n\t\t\tthis.hsPerDay = 8;\r\n\t\t\tthis.pixelsPerWorkHour = this.pixelsPerDay / this.hsPerDay;//px\r\n\t\t\tthis.pixelsPerHour = this.pixelsPerDay / 24;//px\r\n\t\t\tthis.countDays = 0;\r\n\t\t\tthis.totalDays = 0;\r\n\t\t\tthis.startDate = null;\r\n\t\t\tthis.initialPos = 0;\r\n\t\t\t\r\n\t\t\tthis.contentDataHeight = 0;\r\n\t\t\tthis.panelTimeExpandDelta = 20;\r\n\t\t\t\r\n\t\t\tthis.divTimeInfo = null;\r\n\t\t\tthis.panelNames = null;\r\n\t\t\tthis.panelTime = null;\r\n\t\t\tthis.contentData = null;\r\n\t\t\tthis.tabMenu = null;\r\n\t\t\t\r\n\t\t\tthis.project = [];\r\n\t\t\tthis.arrProjects = [];\r\n\t\t\t\r\n\t\t\tthis.xmlLoader = null;\r\n\t\t\tthis.isMoving = false;\r\n\t\t\tthis.isResizing = false;\r\n\t\t\tthis.animationNodes = [];\r\n\t\t\tthis.scale = 1;\r\n\t\t\tthis.tempDayInPixels = 0;\r\n\t\t\tthis.resource = null;\r\n\t\t\tthis.months = locale.getNames(\"months\", \"wide\");\r\n\t\t\tthis._events = [];\r\n\t\t},\r\n\t\tgetProject: function(id){\r\n\t\t\treturn arrayUtil.filter(this.arrProjects, function(proj){\r\n\t\t\t\treturn proj.project.id == id;\r\n\t\t\t}, this)[0];\r\n\t\t},\r\n\t\tcheckPosPreviousTask: function(predTask, task){\r\n\t\t\tvar widthPred = this.getWidthOnDuration(predTask.duration);\r\n\t\t\tvar posPred = this.getPosOnDate(predTask.startTime);\r\n\t\t\tvar posChild = this.getPosOnDate(task.startTime);\r\n\t\t\treturn (widthPred + posPred) <= posChild;\r\n\r\n\t\t},\r\n\t\tcorrectPosPreviousTask: function(predTask, ctask, ctaskObj){\r\n\t\t\tvar newDate = new Date(predTask.startTime);\r\n\t\t\tnewDate.setHours(newDate.getHours() + (predTask.duration / this.hsPerDay * 24));\r\n\t\t\tif(newDate.getHours() > 0){\r\n\t\t\t\tnewDate.setHours(0);\r\n\t\t\t\tnewDate.setDate(newDate.getDate() + 1);\r\n\t\t\t}\r\n\t\t\tctaskObj ? (ctaskObj.setStartTime(newDate, true)) : (ctask.startTime = newDate);\r\n\t\t\tif(ctask.parentTask){\r\n\t\t\t\tif(!this.checkPosParentTask(ctask.parentTask, ctask)){\r\n\t\t\t\t\tvar newDate2 = new Date(ctask.parentTask.startTime);\r\n\t\t\t\t\tnewDate2.setHours(newDate2.getHours() + (ctask.parentTask.duration / this.hsPerDay * 24));\r\n\t\t\t\t\tctask.duration = parseInt((parseInt((newDate2 - ctask.startTime) / (1000 * 60 * 60))) * this.hsPerDay / 24);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tcorrectPosParentTask: function(parentTask, ctask){\r\n\t\t\tif(!ctask.previousTask){\r\n\t\t\t\tif(parentTask.startTime > ctask.startTime){\r\n\t\t\t\t\tctask.startTime = new Date(parentTask.startTime);\r\n\t\t\t\t}\r\n\t\t\t\tif(!this.checkPosParentTask(parentTask, ctask)){\r\n\t\t\t\t\tctask.duration = parentTask.duration;\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\tthis.correctPosPreviousTask(ctask.previousTask, ctask);\r\n\t\t\t}\r\n\t\t},\r\n\t\tcheckPosParentTaskInTree: function(parentTask){\r\n\t\t\tvar exception = false;\r\n\t\t\tfor(var i = 0; i < parentTask.cldTasks.length; i++){\r\n\t\t\t\tvar pcTask = parentTask.cldTasks[i];\r\n\t\t\t\tif(!this.checkPosParentTask(parentTask, pcTask)){\r\n\t\t\t\t\tif(!this.correctError){\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tthis.correctPosParentTask(parentTask, pcTask);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(parentTask.startTime > pcTask.startTime){\r\n\t\t\t\t\tif(!this.correctError){\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tthis.correctPosParentTask(parentTask, pcTask);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(pcTask.cldTasks.length > 0){\r\n\t\t\t\t\texception = this.checkPosParentTaskInTree(pcTask);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn exception;\r\n\t\t},\r\n\t\tsetPreviousTask: function(project){\r\n\t\t\tvar exception = false;\r\n\t\t\tfor(var i = 0; i < project.parentTasks.length; i++){\r\n\t\t\t\tvar ppTask = project.parentTasks[i];\r\n\t\t\t\tif(ppTask.previousTaskId){\r\n\t\t\t\t\tppTask.previousTask = project.getTaskById(ppTask.previousTaskId);\r\n\t\t\t\t\tif(!ppTask.previousTask){\r\n\t\t\t\t\t\tif(!this.correctError){\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tppTask.previousTask.cldPreTasks.push(ppTask);\r\n\t\t\t\t}\r\n\t\t\t\tif(ppTask.previousTask){\r\n\t\t\t\t\tif(!this.checkPosPreviousTask(ppTask.previousTask, ppTask)){\r\n\t\t\t\t\t\tif(!this.correctError){\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tthis.correctPosPreviousTask(ppTask.previousTask, ppTask);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\texception = this.setPreviousTaskInTree(ppTask);\r\n\t\t\t}\r\n\t\t\treturn exception;\r\n\t\t},\r\n\t\tsetPreviousTaskInTree: function(parentTask){\r\n\t\t\tvar exception = false;\r\n\t\t\tfor(var i = 0; i < parentTask.cldTasks.length; i++){\r\n\t\t\t\tvar pcTask = parentTask.cldTasks[i];\r\n\t\t\t\tif(pcTask.previousTaskId){\r\n\t\t\t\t\tpcTask.previousTask = parentTask.project.getTaskById(pcTask.previousTaskId);\r\n\t\t\t\t\tif(!pcTask.previousTask){\r\n\t\t\t\t\t\tif(!this.correctError){\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(!this.checkPosPreviousTask(pcTask.previousTask, pcTask)){\r\n\t\t\t\t\t\tif(!this.correctError){\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tthis.correctPosPreviousTask(pcTask.previousTask, pcTask);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tpcTask.previousTask.cldPreTasks.push(pcTask);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif(pcTask.cldTasks.length > 0){\r\n\t\t\t\t\texception = this.setPreviousTaskInTree(pcTask);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn exception;\r\n\t\t},\r\n\t\tcheckPosParentTask: function(parentTask, task){\r\n\t\t\tvar widthParent = this.getWidthOnDuration(parentTask.duration);\r\n\t\t\tvar posParent = this.getPosOnDate(parentTask.startTime);\r\n\t\t\tvar posChild = this.getPosOnDate(task.startTime);\r\n\t\t\tvar widthChild = this.getWidthOnDuration(task.duration);\r\n\t\t\treturn (widthParent + posParent) >= (posChild + widthChild);\r\n\t\t},\r\n\t\taddProject: function(projectItem){\r\n\t\t\tthis.project.push(projectItem);\r\n\t\t},\r\n\t\tdeleteProject: function(id){\r\n\t\t\tvar project = this.getProject(id);\r\n\t\t\tif(project){\r\n\t\t\t\tif(project.arrTasks.length > 0){\r\n\t\t\t\t\twhile(project.arrTasks.length > 0){\r\n\t\t\t\t\t\tproject.deleteChildTask(project.arrTasks[0]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tvar rowHeight = this.heightTaskItemExtra + this.heightTaskItem;\r\n\t\t\t\tproject.nextProject && project.shiftNextProject(project, -rowHeight); //rowHeight: 23\r\n\t\t\t\tthis.project = arrayUtil.filter(this.project, function(proj){\r\n\t\t\t\t\treturn proj.id != project.project.id;\r\n\t\t\t\t}, this);\r\n\t\t\t\tif((project.previousProject) && (project.nextProject)){\r\n\t\t\t\t\tvar previousProject = project.previousProject;\r\n\t\t\t\t\tpreviousProject.nextProject = project.nextProject;\r\n\t\t\t\t}\r\n\t\t\t\tif((project.previousProject) && !(project.nextProject)){\r\n\t\t\t\t\tvar previousProject = project.previousProject;\r\n\t\t\t\t\tpreviousProject.nextProject = null;\r\n\t\t\t\t}\r\n\t\t\t\tif(!(project.previousProject) && (project.nextProject)){\r\n\t\t\t\t\tvar nextProject = project.nextProject;\r\n\t\t\t\t\tnextProject.previousProject = null;\r\n\t\t\t\t}\r\n\t\t\t\tfor(var i = 0; i < this.arrProjects.length; i++){\r\n\t\t\t\t\tif(this.arrProjects[i].project.id == id){\r\n\t\t\t\t\t\tthis.arrProjects.splice(i, 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tproject.projectItem[0].parentNode.removeChild(project.projectItem[0]);\r\n\t\t\t\tproject.descrProject.parentNode.removeChild(project.descrProject);\r\n\t\t\t\tproject.projectNameItem.parentNode.removeChild(project.projectNameItem);\r\n\t\t\t\tthis.contentDataHeight -= this.heightTaskItemExtra + this.heightTaskItem;\r\n\t\t\t\tif(this.project.length == 0){\r\n\t\t\t\t\tvar d = new Date(this.startDate);\r\n\t\t\t\t\tvar t = new Date(d.setDate(d.getDate() + 1));\r\n\t\t\t\t\tvar pi = new GanttProjectItem({\r\n\t\t\t\t\t\tid: 1,\r\n\t\t\t\t\t\tname: \"New Project\",\r\n\t\t\t\t\t\tstartDate: t\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.project.push(pi);\r\n\t\t\t\t\tvar project = new GanttProjectControl(this, pi);\r\n\t\t\t\t\tproject.create();\r\n\t\t\t\t\tthis.arrProjects.push(project);\r\n\t\t\t\t\tthis.contentDataHeight += this.heightTaskItemExtra + this.heightTaskItem;\r\n\t\t\t\t}\r\n\t\t\t\tthis.checkPosition();\r\n\t\t\t}\r\n\t\t},\r\n\t\tinsertProject: function(id, name, startDate){\r\n\t\t\tif(this.startDate >= startDate){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tif(this.getProject(id)){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tthis.checkHeighPanelTasks();\r\n\t\t\tvar project = new GanttProjectItem({\r\n\t\t\t\tid: id,\r\n\t\t\t\tname: name,\r\n\t\t\t\tstartDate: startDate\r\n\t\t\t});\r\n\t\t\tthis.project.push(project);\r\n\t\t\tvar _project = new GanttProjectControl(this, project);\r\n\t\t\tfor(var i = 0; i < this.arrProjects.length; i++){\r\n\t\t\t\tvar curProject = this.arrProjects[i],\r\n\t\t\t\t\tpreProject = this.arrProjects[i-1],\r\n\t\t\t\t\tnextProject = this.arrProjects[i+1];\r\n\t\t\t\tif(startDate < curProject.project.startDate){\r\n\t\t\t\t\tthis.arrProjects.splice(i, 0, _project);\r\n\t\t\t\t\tif(i > 0){\r\n\t\t\t\t\t\t_project.previousProject = preProject;\r\n\t\t\t\t\t\tpreProject.nextProject = _project;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(i + 1 <= this.arrProjects.length){\r\n\t\t\t\t\t\t_project.nextProject = nextProject;\r\n\t\t\t\t\t\tnextProject.previousProject = _project;\r\n\t\t\t\t\t\tvar rowHeight = this.heightTaskItem + this.heightTaskItemExtra;\r\n\t\t\t\t\t\t_project.shiftNextProject(_project, rowHeight);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_project.create();\r\n\t\t\t\t\t_project.hideDescrProject();\r\n\t\t\t\t\tthis.checkPosition();\r\n\t\t\t\t\treturn _project;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(this.arrProjects.length > 0){\r\n\t\t\t\tthis.arrProjects[this.arrProjects.length - 1].nextProject = _project;\r\n\t\t\t\t_project.previousProject = this.arrProjects[this.arrProjects.length - 1];\r\n\t\t\t}\r\n\t\t\tthis.arrProjects.push(_project);\r\n\t\t\t_project.create();\r\n\t\t\t_project.hideDescrProject();\r\n\t\t\tthis.checkPosition();\r\n\t\t\treturn _project;\r\n\t\t},\r\n\t\topenTree: function(parentTask){\r\n\t\t\tvar lastParentTask = this.getLastCloseParent(parentTask);\r\n\t\t\tthis.openNode(lastParentTask);\r\n\t\t\tparentTask.taskItem.id != lastParentTask.taskItem.id && this.openTree(parentTask);\r\n\t\t},\r\n\t\topenNode: function(parentTask){\r\n\t\t\tif(!parentTask.isExpanded){\r\n\t\t\t\tdomClass.remove(parentTask.cTaskNameItem[2], \"ganttImageTreeExpand\");\r\n\t\t\t\tdomClass.add(parentTask.cTaskNameItem[2], \"ganttImageTreeCollapse\");\r\n\t\t\t\tparentTask.isExpanded = true;\r\n\t\t\t\tparentTask.shiftCurrentTasks(parentTask, parentTask.hideTasksHeight);\r\n\t\t\t\tparentTask.showChildTasks(parentTask, parentTask.isExpanded);\r\n\t\t\t\tparentTask.hideTasksHeight = 0;\r\n\t\t\t}\r\n\t\t},\r\n\t\tgetLastCloseParent: function(task){\r\n\t\t\tif(task.parentTask){\r\n\t\t\t\tif((!task.parentTask.isExpanded) ||\r\n\t\t\t\t(task.parentTask.cTaskNameItem[2].style.display == \"none\")){\r\n\t\t\t\t\treturn this.getLastCloseParent(task.parentTask);\r\n\t\t\t\t}else{\r\n\t\t\t\t\treturn task;\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\treturn task;\r\n\t\t\t}\r\n\t\t},\r\n\t\tgetProjectItemById: function(id){\r\n\t\t\treturn arrayUtil.filter(this.project, function(proj){\r\n\t\t\t\treturn proj.id == id;\r\n\t\t\t}, this)[0];\r\n\t\t},\r\n\t\tclearAll: function(){\r\n\t\t\tthis.contentDataHeight = 0;\r\n\t\t\tthis.startDate = null;\r\n\t\t\tthis.clearData();\r\n\t\t\tthis.clearItems();\r\n\t\t\tthis.clearEvents();\r\n\t\t},\r\n\t\tclearEvents: function(){\r\n\t\t\tarrayUtil.forEach(this._events, function(e){\r\n\t\t\t\te.remove();\r\n\t\t\t});\r\n\t\t\tthis._events = [];\r\n\t\t},\r\n\t\tclearData: function(){\r\n\t\t\tthis.project = [];\r\n\t\t\tthis.arrProjects = [];\r\n\t\t},\r\n\t\tclearItems: function(){\r\n\t\t\tthis.contentData.removeChild(this.contentData.firstChild);\r\n\t\t\tthis.contentData.appendChild(this.createPanelTasks());\r\n\t\t\tthis.panelNames.removeChild(this.panelNames.firstChild);\r\n\t\t\tthis.panelNames.appendChild(this.createPanelNamesTasks());\r\n\t\t\tthis.panelTime.removeChild(this.panelTime.firstChild);\r\n\t\t},\r\n\t\tbuildUIContent: function(){\r\n\t\t\tthis.project.sort(this.sortProjStartDate);\r\n\t\t\tthis.startDate = this.getStartDate();\r\n\t\t\tthis.panelTime.appendChild(this.createPanelTime());\r\n\t\t\tfor(var i = 0; i < this.project.length; i++){\r\n\t\t\t\tvar proj = this.project[i];\r\n\t\t\t\tfor(var k = 0; k < proj.parentTasks.length; k++){\r\n\t\t\t\t\tvar ppTask = proj.parentTasks[k];\r\n\t\t\t\t\tif(ppTask.startTime){\r\n\t\t\t\t\t\tthis.setStartTimeChild(ppTask);\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(this.setPreviousTask(proj)){\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tfor(var k = 0; k < proj.parentTasks.length; k++){\r\n\t\t\t\t\tvar ppTask = proj.parentTasks[k];\r\n\t\t\t\t\tif(ppTask.startTime < proj.startDate){\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(this.checkPosParentTaskInTree(ppTask)) return;\r\n\t\t\t\t}\r\n\t\t\t\tthis.sortTasksByStartTime(proj);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfor(var i = 0; i < this.project.length; i++){\r\n\t\t\t\tvar proj = this.project[i];\r\n\t\t\t\tvar project = new GanttProjectControl(this, proj);\r\n\t\t\t\tif(this.arrProjects.length > 0){\r\n\t\t\t\t\tvar previousProject = this.arrProjects[this.arrProjects.length - 1];\r\n\t\t\t\t\tproject.previousProject = previousProject;\r\n\t\t\t\t\tpreviousProject.nextProject = project;\r\n\t\t\t\t}\r\n\t\t\t\tproject.create();\r\n\t\t\t\tthis.checkHeighPanelTasks();\r\n\t\t\t\tthis.arrProjects.push(project);\r\n\t\t\t\tthis.createTasks(project);\r\n\t\t\t}\r\n\t\t\tthis.resource && this.resource.reConstruct();\r\n\t\t\tthis.postLoadData();\r\n\t\t\tthis.postBindEvents();\r\n\t\t},\r\n\t\tloadJSONData: function(filename){\r\n\t\t\tvar _this = this;\r\n\t\t\t_this.dataFilePath = filename || _this.dataFilePath;\r\n\t\t\trequest.get(_this.dataFilePath, {\r\n\t\t\t\tsync: true\r\n\t\t\t}).then(function(response){\r\n\t\t\t\t_this.loadJSONString(response.text);\r\n\t\t\t\t_this.buildUIContent();\r\n\t\t\t\tconsole.log(\"Successfully! Loaded data from: \" + _this.dataFilePath);\r\n\t\t\t}, function(){\r\n\t\t\t\tconsole.log(\"Failed! Load error: \" + _this.dataFilePath);\r\n\t\t\t});\r\n\t\t},\r\n\t\tloadJSONString: function(content){\r\n\t\t\t//load data\r\n\t\t\tif(!content){ return; }\r\n\t\t\tthis.clearAll();\r\n\t\t\tvar jsonObj = JSON.parse(content);\r\n\t\t\t\r\n\t\t\tvar items = jsonObj.items;\r\n\t\t\tarrayUtil.forEach(items, function(pItem){\r\n\t\t\t\tvar startDate = pItem.startdate.split(\"-\");\r\n\t\t\t\tvar project = new GanttProjectItem({\r\n\t\t\t\t\tid: pItem.id,\r\n\t\t\t\t\tname: pItem.name,\r\n\t\t\t\t\tstartDate: new Date(startDate[0], (parseInt(startDate[1]) - 1), startDate[2])\r\n\t\t\t\t});\r\n\t\t\t\tvar tItems = pItem.tasks;\r\n\t\t\t\tarrayUtil.forEach(tItems, function(tItem){\r\n\t\t\t\t\tvar id = tItem.id,\r\n\t\t\t\t\t\tname = tItem.name,\r\n\t\t\t\t\t\tstarttime = tItem.starttime.split(\"-\"),\r\n\t\t\t\t\t\tduration = tItem.duration,\r\n\t\t\t\t\t\tpercentage = tItem.percentage,\r\n\t\t\t\t\t\tpreviousTaskId = tItem.previousTaskId,\r\n\t\t\t\t\t\ttaskOwner = tItem.taskOwner;\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar task = new GanttTaskItem({\r\n\t\t\t\t\t\tid: id,\r\n\t\t\t\t\t\tname: name,\r\n\t\t\t\t\t\tstartTime: new Date(starttime[0], (parseInt(starttime[1]) - 1), starttime[2]),\r\n\t\t\t\t\t\tduration: duration,\r\n\t\t\t\t\t\tpercentage: percentage,\r\n\t\t\t\t\t\tpreviousTaskId: previousTaskId,\r\n\t\t\t\t\t\ttaskOwner: taskOwner\r\n\t\t\t\t\t});\r\n\t\t\t\t\tvar ctItems = tItem.children;\r\n\t\t\t\t\tif(ctItems.length != 0){\r\n\t\t\t\t\t\tthis.buildChildTasksData(task, ctItems);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tproject.addTask(task);\r\n\t\t\t\t}, this);\r\n\t\t\t\tthis.addProject(project);\r\n\t\t\t }, this);\r\n\t\t},\r\n\t\tbuildChildTasksData: function(parentTask, childTaskItems){\r\n\t\t\tchildTaskItems && arrayUtil.forEach(childTaskItems, function(ctItem){\r\n\t\t\t\tvar id = ctItem.id,\r\n\t\t\t\t\tname = ctItem.name,\r\n\t\t\t\t\tstarttime = ctItem.starttime.split(\"-\"),\r\n\t\t\t\t\tduration = ctItem.duration,\r\n\t\t\t\t\tpercentage = ctItem.percentage,\r\n\t\t\t\t\tpreviousTaskId = ctItem.previousTaskId,\r\n\t\t\t\t\ttaskOwner = ctItem.taskOwner;\r\n\t\t\t\t\r\n\t\t\t\tvar task = new GanttTaskItem({\r\n\t\t\t\t\tid: id,\r\n\t\t\t\t\tname: name,\r\n\t\t\t\t\tstartTime: new Date(starttime[0], (parseInt(starttime[1]) - 1), starttime[2]),\r\n\t\t\t\t\tduration: duration,\r\n\t\t\t\t\tpercentage: percentage,\r\n\t\t\t\t\tpreviousTaskId: previousTaskId,\r\n\t\t\t\t\ttaskOwner: taskOwner\r\n\t\t\t\t});\r\n\t\t\t\ttask.parentTask = parentTask;\r\n\t\t\t\tparentTask.addChildTask(task);\r\n\t\t\t\t\r\n\t\t\t\tvar ctItems = ctItem.children;\r\n\t\t\t\tif(ctItems.length != 0){\r\n\t\t\t\t\tthis.buildChildTasksData(task, ctItems);\r\n\t\t\t\t}\r\n\t\t\t}, this);\r\n\t\t},\r\n\t\tgetJSONData: function(){\r\n\t\t\tvar jsonObj = {identifier: 'id', items: []};\r\n\t\t\tarrayUtil.forEach(this.project, function(proj){\r\n\t\t\t\tvar project = {\r\n\t\t\t\t\tid: proj.id,\r\n\t\t\t\t\tname: proj.name,\r\n\t\t\t\t\tstartdate: proj.startDate.getFullYear() + '-' + (proj.startDate.getMonth() + 1) + '-' + proj.startDate.getDate(),\r\n\t\t\t\t\ttasks: []\r\n\t\t\t\t};\r\n\t\t\t\tjsonObj.items.push(project);\r\n\t\t\t\tarrayUtil.forEach(proj.parentTasks, function(pTask){\r\n\t\t\t\t\tvar task = {\r\n\t\t\t\t\t\tid: pTask.id,\r\n\t\t\t\t\t\tname: pTask.name,\r\n\t\t\t\t\t\tstarttime: pTask.startTime.getFullYear() + '-' + (pTask.startTime.getMonth() + 1) + '-' + pTask.startTime.getDate(),\r\n\t\t\t\t\t\tduration: pTask.duration,\r\n\t\t\t\t\t\tpercentage: pTask.percentage,\r\n\t\t\t\t\t\tpreviousTaskId: (pTask.previousTaskId || ''),\r\n\t\t\t\t\t\ttaskOwner: (pTask.taskOwner || ''),\r\n\t\t\t\t\t\tchildren: this.getChildTasksData(pTask.cldTasks)\r\n\t\t\t\t\t};\r\n\t\t\t\t\tproject.tasks.push(task);\r\n\t\t\t\t}, this);\r\n\t\t\t}, this);\r\n\t\t\treturn jsonObj;\r\n\t\t},\r\n\t\tgetChildTasksData: function(childTasks){\r\n\t\t\tvar cTaskObj = [];\r\n\t\t\tchildTasks && childTasks.length > 0 && arrayUtil.forEach(childTasks, function(childTask){\r\n\t\t\t\tvar ctask = {\r\n\t\t\t\t\tid: childTask.id,\r\n\t\t\t\t\tname: childTask.name,\r\n\t\t\t\t\tstarttime: childTask.startTime.getFullYear() + '-' + (childTask.startTime.getMonth() + 1) + '-' + childTask.startTime.getDate(),\r\n\t\t\t\t\tduration: childTask.duration,\r\n\t\t\t\t\tpercentage: childTask.percentage,\r\n\t\t\t\t\tpreviousTaskId: (childTask.previousTaskId || ''),\r\n\t\t\t\t\ttaskOwner: (childTask.taskOwner || ''),\r\n\t\t\t\t\tchildren: this.getChildTasksData(childTask.cldTasks)\r\n\t\t\t\t};\r\n\t\t\t\tcTaskObj.push(ctask);\r\n\t\t\t}, this);\r\n\t\t\treturn cTaskObj;\r\n\t\t},\r\n\t\tsaveJSONData: function(fileName){\r\n\t\t\tvar _this = this;\r\n\t\t\t_this.dataFilePath = (fileName && lang.trim(fileName).length > 0) ? fileName : this.dataFilePath;\r\n\t\t\ttry {\r\n\t\t\t\trequest.post(_this.saveProgramPath, {\r\n\t\t\t\t\tquery: {filename: _this.dataFilePath, data: JSON.stringify(_this.getJSONData())}\r\n\t\t\t\t}).response.then(function(response){\r\n\t\t\t\t\tif((util.checkStatus(response.options.status))||\r\n\t\t\t\t\t\t(response.options.status == 405)\r\n\t\t\t\t\t){\r\n\t\t\t\t\t\tconsole.log(\"Successfully! Saved data to \" + _this.dataFilePath);\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tconsole.log(\"Failed! Saved error\");\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} catch(e){\r\n\t\t\t\tconsole.log(\"exception: \" + e.message);\r\n\t\t\t}\r\n\t\t},\r\n\t\tsortTaskStartTime: function(a, b){\r\n\t\t\treturn a.startTime < b.startTime ? -1 : (a.startTime > b.startTime ? 1 : 0);\r\n\t\t},\r\n\t\tsortProjStartDate: function(a, b){\r\n\t\t\treturn a.startDate < b.startDate ? -1 : (a.startDate > b.startDate ? 1 : 0);\r\n\t\t},\r\n\t\tsetStartTimeChild: function(parentTask){\r\n\t\t\tarrayUtil.forEach(parentTask.cldTasks, function(pcTask){\r\n\t\t\t\tif(!pcTask.startTime){\r\n\t\t\t\t\tpcTask.startTime = parentTask.startTime;\r\n\t\t\t\t}\r\n\t\t\t\tif(pcTask.cldTasks.length != 0){\r\n\t\t\t\t\tthis.setStartTimeChild(pcTask);\r\n\t\t\t\t}\r\n\t\t\t}, this);\r\n\t\t},\r\n\t\tcreatePanelTasks: function(){\r\n\t\t\tvar panelTask = domConstruct.create(\"div\", {\r\n\t\t\t\tclassName: \"ganttTaskPanel\"\r\n\t\t\t});\r\n\t\t\tdomStyle.set(panelTask, {\r\n\t\t\t\theight: (this.contentHeight - this.panelTimeHeight - this.scrollBarWidth) + \"px\"\r\n\t\t\t});\r\n\t\t\treturn panelTask;\r\n\t\t},\r\n\t\trefreshParams: function(pixelsPerDay){\r\n\t\t\tthis.pixelsPerDay = pixelsPerDay;\r\n\t\t\tthis.pixelsPerWorkHour = this.pixelsPerDay / this.hsPerDay;\r\n\t\t\tthis.pixelsPerHour = this.pixelsPerDay / 24;\r\n\t\t},\r\n\t\tcreatePanelNamesTasksHeader: function(){\r\n\t\t\tvar panelHeader = domConstruct.create(\"div\", {className: \"ganttPanelHeader\"});\r\n\t\t\tvar tblHeader = domConstruct.create(\"table\", {\r\n\t\t\t\tcellPadding: \"0px\",\r\n\t\t\t\tborder: \"0px\",\r\n\t\t\t\tcellSpacing: \"0px\",\r\n\t\t\t\tbgColor: \"#FFFFFF\",\r\n\t\t\t\tclassName: \"ganttToolbar\"\r\n\t\t\t}, panelHeader);\r\n\t\t\tvar firstRow = tblHeader.insertRow(tblHeader.rows.length);\r\n\t\t\tvar secondRow = tblHeader.insertRow(tblHeader.rows.length);\r\n\t\t\tvar thirdRow = tblHeader.insertRow(tblHeader.rows.length);\r\n\t\t\tvar forthRow = tblHeader.insertRow(tblHeader.rows.length);\r\n\t\t\tvar zoomIn = domConstruct.create(\"td\", {\r\n\t\t\t\talign: \"center\",\r\n\t\t\t\tvAlign: \"middle\",\r\n\t\t\t\tclassName: \"ganttToolbarZoomIn\"\r\n\t\t\t}, firstRow);\r\n\t\t\tvar zoomInFn = lang.hitch(this, function(){\r\n\t\t\t\tif(this.scale * 2 > 5){return;}\r\n\t\t\t\tthis.scale = this.scale * 2;\r\n\t\t\t\tthis.switchTeleMicroView(this.pixelsPerDay * this.scale);\r\n\t\t\t});\r\n\t\t\tif(this.zoomInClickEvent){\r\n\t\t\t\tthis.zoomInClickEvent.remove();\r\n\t\t\t}\r\n\t\t\tthis.zoomInClickEvent = on(zoomIn, \"click\", lang.hitch(this, zoomInFn));\r\n\t\t\t//a11y support\r\n\t\t\tif(this.zoomInKeyEvent){\r\n\t\t\t\tthis.zoomInKeyEvent.remove();\r\n\t\t\t}\r\n\t\t\tthis.zoomInKeyEvent = on(zoomIn, \"keydown\", lang.hitch(this, function(e){\r\n\t\t\t\tif(e.keyCode != keys.ENTER){return;}\r\n\t\t\t\tzoomInFn();\r\n\t\t\t}));\r\n\r\n\t\t\tdomAttr.set(zoomIn, \"tabIndex\", 0);\r\n\t\t\tvar zoomOut = domConstruct.create(\"td\", {\r\n\t\t\t\talign: \"center\",\r\n\t\t\t\tvAlign: \"middle\",\r\n\t\t\t\tclassName: \"ganttToolbarZoomOut\"\r\n\t\t\t}, firstRow);\r\n\t\t\tvar zoomOutFn = lang.hitch(this, function(){\r\n\t\t\t\tif(this.scale * 0.5 < 0.2){return;}\r\n\t\t\t\tthis.scale = this.scale * 0.5;\r\n\t\t\t\tthis.switchTeleMicroView(this.pixelsPerDay * this.scale);\r\n\t\t\t});\r\n\t\t\tif(this.zoomOutClickEvent){\r\n\t\t\t\tthis.zoomOutClickEvent.remove();\r\n\t\t\t}\r\n\t\t\tthis.zoomOutClickEvent = on(zoomOut, \"click\", lang.hitch(this, zoomOutFn));\r\n\r\n\t\t\t//a11y support\r\n\t\t\tif(this.zoomOutKeyEvent){\r\n\t\t\t\tthis.zoomOutKeyEvent.remove();\r\n\t\t\t}\r\n\t\t\tthis.zoomOutKeyEvent = on(zoomOut, \"keydown\", lang.hitch(this, function(e){\r\n\t\t\t\tif(e.keyCode != keys.ENTER){return;}\r\n\t\t\t\tzoomOutFn();\r\n\t\t\t}));\r\n\r\n\t\t\tdomAttr.set(zoomOut, \"tabIndex\", 0);\r\n\t\t\tvar micro = domConstruct.create(\"td\", {\r\n\t\t\t\talign: \"center\",\r\n\t\t\t\tvAlign: \"middle\",\r\n\t\t\t\tclassName: \"ganttToolbarMicro\"\r\n\t\t\t}, secondRow);\r\n\t\t\tif(this.microClickEvent){\r\n\t\t\t\tthis.microClickEvent.remove();\r\n\t\t\t}\r\n\t\t\tthis.microClickEvent = on(micro, \"click\", lang.hitch(this, this.refresh, this.animation?15:1, 0, 2));\r\n\r\n\t\t\t//a11y support\r\n\t\t\tif(this.microKeyEvent){\r\n\t\t\t\tthis.microKeyEvent.remove();\r\n\t\t\t}\r\n\t\t\tthis.microKeyEvent = on(micro, \"keydown\", lang.hitch(this, function(e){\r\n\t\t\t\tif(e.keyCode != keys.ENTER){return;}\r\n\t\t\t\tmicro.blur();\r\n\t\t\t\tthis.refresh(this.animation?15:1, 0, 2);\r\n\t\t\t}));\r\n\r\n\t\t\tdomAttr.set(micro, \"tabIndex\", 0);\r\n\t\t\tvar tele = domConstruct.create(\"td\", {\r\n\t\t\t\talign: \"center\",\r\n\t\t\t\tvAlign: \"middle\",\r\n\t\t\t\tclassName: \"ganttToolbarTele\"\r\n\t\t\t}, secondRow);\r\n\t\t\tif(this.teleClickEvent){\r\n\t\t\t\tthis.teleClickEvent.remove();\r\n\t\t\t}\r\n\t\t\tthis.teleClickEvent = on(tele, \"click\", lang.hitch(this, this.refresh, this.animation?15:1, 0, 0.5));\r\n\t\t\t//a11y support\r\n\t\t\tif(this.teleKeyEvent){\r\n\t\t\t\tthis.teleKeyEvent.remove();\r\n\t\t\t}\r\n\t\t\tthis.teleKeyEvent = on(tele, \"keydown\", lang.hitch(this, function(e){\r\n\t\t\t\tif(e.keyCode != keys.ENTER){return;}\r\n\t\t\t\ttele.blur();\r\n\t\t\t\tthis.refresh(this.animation?15:1, 0, 0.5);\r\n\t\t\t}));\r\n\t\t\tdomAttr.set(tele, \"tabIndex\", 0);\r\n\t\t\tvar save = domConstruct.create(\"td\", {\r\n\t\t\t\talign: \"center\",\r\n\t\t\t\tvAlign: \"middle\",\r\n\t\t\t\tclassName: \"ganttToolbarSave\"\r\n\t\t\t}, thirdRow);\r\n\t\t\tif(this.saveClickEvent){\r\n\t\t\t\tthis.saveClickEvent.remove();\r\n\t\t\t}\r\n\t\t\tthis.saveClickEvent = on(save, \"click\", lang.hitch(this, this.saveJSONData, \"\"));\r\n\t\t\t//a11y support\r\n\t\t\tif(this.saveKeyEvent){\r\n\t\t\t\tthis.saveKeyEvent.remove();\r\n\t\t\t}\r\n\t\t\tthis.saveKeyEvent = on(save, \"keydown\", lang.hitch(this, function(e){\r\n\t\t\t\tif(e.keyCode != keys.ENTER){return;}\r\n\t\t\t\tthis.saveJSONData(\"\");\r\n\t\t\t}));\r\n\t\t\tdomAttr.set(save, \"tabIndex\", 0);\r\n\t\t\tvar load = domConstruct.create(\"td\", {\r\n\t\t\t\talign: \"center\",\r\n\t\t\t\tvAlign: \"middle\",\r\n\t\t\t\tclassName: \"ganttToolbarLoad\"\r\n\t\t\t}, thirdRow);\r\n\t\t\tif(this.loadClickEvent){\r\n\t\t\t\tthis.loadClickEvent.remove();\r\n\t\t\t}\r\n\t\t\tthis.loadClickEvent = on(load, \"click\", lang.hitch(this, this.loadJSONData, \"\"));\r\n\t\t\t//a11y support\r\n\t\t\tif(this.loadKeyEvent){\r\n\t\t\t\tthis.loadKeyEvent.remove();\r\n\t\t\t}\r\n\t\t\tthis.loadKeyEvent = on(load, \"keydown\", lang.hitch(this, function(e){\r\n\t\t\t\tif(e.keyCode != keys.ENTER){return;}\r\n\t\t\t\tthis.loadJSONData(\"\");\r\n\t\t\t}));\r\n\r\n\t\t\tdomAttr.set(load, \"tabIndex\", 0);\r\n\t\t\t//action popup description\r\n\t\t\tvar actions = [zoomIn, zoomOut, micro, tele, save, load],\r\n\t\t\t\ttitles = [\"Enlarge timeline\", \"Shrink timeline\", \"Zoom in time zone(microscope view)\", \"Zoom out time zone(telescope view)\",\r\n\t\t\t\t\t\t\t\"Save gantt data to json file\", \"Load gantt data from json file\"];\r\n\t\t\tarrayUtil.forEach(actions, function(action, i){\r\n\t\t\t\tvar title = titles[i];\r\n\t\t\t\tvar tooltipShow = function(){\r\n\t\t\t\t\tdomClass.add(action, \"ganttToolbarActionHover\");\r\n\t\t\t\t\t// FIXME: including dijit/Tooltip moves showTooltip and hideTooltip into the dijit namespace\r\n\t\t\t\t\tdijit.showTooltip(title, action, [\"above\", \"below\"]);\r\n\t\t\t\t};\r\n\t\t\t\taction.onmouseover = tooltipShow;\r\n\t\t\t\t//a11y support\r\n\t\t\t\taction.onfocus = tooltipShow;\r\n\t\t\t\tvar tooltipHide = function(){\r\n\t\t\t\t\tdomClass.remove(action, \"ganttToolbarActionHover\");\r\n\t\t\t\t\taction && dijit.hideTooltip(action);\r\n\t\t\t\t};\r\n\t\t\t\taction.onmouseout = tooltipHide;\r\n\t\t\t\taction.onblur = tooltipHide;\r\n\t\t\t}, this);\r\n\t\t\treturn panelHeader;\r\n\t\t},\r\n\t\tcreatePanelNamesTasks: function(){\r\n\t\t\tvar panelNameTask = domConstruct.create(\"div\", {\r\n\t\t\t\tinnerHTML: \"&nbsp;\",\r\n\t\t\t\tclassName: \"ganttPanelNames\"\r\n\t\t\t});\r\n\t\t\tdomStyle.set(panelNameTask, {\r\n\t\t\t\theight: (this.contentHeight - this.panelTimeHeight - this.scrollBarWidth) + \"px\",\r\n\t\t\t\twidth: this.maxWidthPanelNames + \"px\"\r\n\t\t\t});\r\n\t\t\treturn panelNameTask;\r\n\t\t},\r\n\t\tcreatePanelTime: function(){\r\n\t\t\tvar panelTime = domConstruct.create(\"div\", {className: \"ganttPanelTime\"});\r\n\t\t\tvar tblTime = domConstruct.create(\"table\", {\r\n\t\t\t\tcellPadding: \"0px\",\r\n\t\t\t\tborder: \"0px\",\r\n\t\t\t\tcellSpacing: \"0px\",\r\n\t\t\t\tbgColor: \"#FFFFFF\",\r\n\t\t\t\tclassName: \"ganttTblTime\"\r\n\t\t\t}, panelTime);\r\n\t\t\tthis.totalDays = this.countDays;\r\n\t\t\t//year\r\n\t\t\tvar newYearRow = tblTime.insertRow(tblTime.rows.length), oldYear, newYear, ycount = 0;\r\n\t\t\tnewYear = oldYear = new Date(this.startDate).getFullYear();\r\n\t\t\tfor(var i = 0; i < this.countDays; i++, ycount++){\r\n\t\t\t\tvar date = new Date(this.startDate);\r\n\t\t\t\tdate.setDate(date.getDate() + i);\r\n\t\t\t\tnewYear = date.getFullYear();\r\n\t\t\t\tif(newYear != oldYear){\r\n\t\t\t\t\tthis.addYearInPanelTime(newYearRow, ycount, oldYear);\r\n\t\t\t\t\tycount = 0;\r\n\t\t\t\t\toldYear = newYear;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.addYearInPanelTime(newYearRow, ycount, newYear);\r\n\t\t\tdomStyle.set(newYearRow, \"display\", \"none\");\r\n\t\t\t//month\r\n\t\t\tvar newMonthRow = tblTime.insertRow(tblTime.rows.length), oldMonth, newMonth, mcount = 0, lastYear = 1970;\r\n\t\t\tnewMonth = oldMonth = new Date(this.startDate).getMonth();\r\n\t\t\tfor(var i = 0; i < this.countDays; i++, mcount++){\r\n\t\t\t\tvar date = new Date(this.startDate);\r\n\t\t\t\tdate.setDate(date.getDate() + i);\r\n\t\t\t\tnewMonth = date.getMonth();\r\n\t\t\t\tlastYear = date.getFullYear();\r\n\t\t\t\tif(newMonth != oldMonth){\r\n\t\t\t\t\tthis.addMonthInPanelTime(newMonthRow, mcount, oldMonth, oldMonth !== 11 ? lastYear : lastYear - 1);\r\n\t\t\t\t\tmcount = 0;\r\n\t\t\t\t\toldMonth = newMonth;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.addMonthInPanelTime(newMonthRow, mcount, newMonth, lastYear);\r\n\t\t\t//week\r\n\t\t\tvar newWeekRow = tblTime.insertRow(tblTime.rows.length), oldWeek, newWeek, mcount = 0;\r\n\t\t\tnewWeek = oldWeek = locale._getWeekOfYear(new Date(this.startDate));\r\n\t\t\tfor(var i = 0; i < this.countDays; i++, mcount++){\r\n\t\t\t\tvar date = new Date(this.startDate);\r\n\t\t\t\tdate.setDate(date.getDate() + i);\r\n\t\t\t\tnewWeek = locale._getWeekOfYear(date);\r\n\t\t\t\tif(newWeek != oldWeek){\r\n\t\t\t\t\tthis.addWeekInPanelTime(newWeekRow, mcount, oldWeek);\r\n\t\t\t\t\tmcount = 0;\r\n\t\t\t\t\toldWeek = newWeek;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.addWeekInPanelTime(newWeekRow, mcount, newWeek);\r\n\t\t\t//day\r\n\t\t\tvar newDayRow = tblTime.insertRow(tblTime.rows.length);\r\n\t\t\tfor(var i = 0; i < this.countDays; i++){\r\n\t\t\t\tthis.addDayInPanelTime(newDayRow);\r\n\t\t\t}\r\n\t\t\t//hour\r\n\t\t\tvar newHourRow = tblTime.insertRow(tblTime.rows.length);\r\n\t\t\tfor(var i = 0; i < this.countDays; i++){\r\n\t\t\t\tthis.addHourInPanelTime(newHourRow);\r\n\t\t\t}\r\n\t\t\tdomStyle.set(newHourRow, \"display\", \"none\");\r\n\t\t\treturn panelTime;\r\n\t\t},\r\n\t\tadjustPanelTime: function(){\r\n\t\t\tvar maxEndPos = arrayUtil.map(this.arrProjects, function(project){\r\n\t\t\t\treturn (parseInt(project.projectItem[0].style.left) + parseInt(project.projectItem[0].firstChild.style.width)\r\n\t\t\t\t\t+ project.descrProject.offsetWidth + this.panelTimeExpandDelta);\r\n\t\t\t}, this).sort(function(a,b){return b-a})[0];\r\n\t\t\tif(this.maxTaskEndPos != maxEndPos){\r\n\t\t\t\t//reset panel time\r\n\t\t\t\tvar prows = this.panelTime.firstChild.firstChild.rows;\r\n\t\t\t\tfor(var i = 0; i <= 4; i++){//prows.length\r\n\t\t\t\t\tthis.removeCell(prows[i]);\r\n\t\t\t\t}\r\n\t\t\t\tvar countDays = Math.round((maxEndPos+this.panelTimeExpandDelta) / this.pixelsPerDay);\r\n\t\t\t\tthis.totalDays = countDays;\r\n\t\t\t\t//year\r\n\t\t\t\tvar oldYear, newYear, ycount = 0;\r\n\t\t\t\tnewYear = oldYear = new Date(this.startDate).getFullYear();\r\n\t\t\t\tfor(var i = 0; i < countDays; i++, ycount++){\r\n\t\t\t\t\tvar date = new Date(this.startDate);\r\n\t\t\t\t\tdate.setDate(date.getDate() + i);\r\n\t\t\t\t\tnewYear = date.getFullYear();\r\n\t\t\t\t\tif(newYear != oldYear){\r\n\t\t\t\t\t\tthis.addYearInPanelTime(prows[0], ycount, oldYear);\r\n\t\t\t\t\t\tycount = 0;\r\n\t\t\t\t\t\toldYear = newYear;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.addYearInPanelTime(prows[0], ycount, newYear);\r\n\t\t\t\t//month\r\n\t\t\t\tvar oldMonth, newMonth, mcount = 0, lastYear = 1970;\r\n\t\t\t\tnewMonth = oldMonth = new Date(this.startDate).getMonth();\r\n\t\t\t\tfor(var i = 0; i < countDays; i++, mcount++){\r\n\t\t\t\t\tvar date = new Date(this.startDate);\r\n\t\t\t\t\tdate.setDate(date.getDate() + i);\r\n\t\t\t\t\tnewMonth = date.getMonth();\r\n\t\t\t\t\tlastYear = date.getFullYear();\r\n\t\t\t\t\tif(newMonth != oldMonth){\r\n\t\t\t\t\t\tthis.addMonthInPanelTime(prows[1], mcount, oldMonth, oldMonth !== 11 ? lastYear : lastYear - 1);\r\n\t\t\t\t\t\tmcount = 0;\r\n\t\t\t\t\t\toldMonth = newMonth;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.addMonthInPanelTime(prows[1], mcount, newMonth, lastYear);\r\n\t\t\t\t//week\r\n\t\t\t\tvar oldWeek, newWeek, mcount = 0;\r\n\t\t\t\tnewWeek = oldWeek = locale._getWeekOfYear(new Date(this.startDate));\r\n\t\t\t\tfor(var i = 0; i < countDays; i++, mcount++){\r\n\t\t\t\t\tvar date = new Date(this.startDate);\r\n\t\t\t\t\tdate.setDate(date.getDate() + i);\r\n\t\t\t\t\tnewWeek = locale._getWeekOfYear(date);\r\n\t\t\t\t\tif(newWeek != oldWeek){\r\n\t\t\t\t\t\tthis.addWeekInPanelTime(prows[2], mcount, oldWeek);\r\n\t\t\t\t\t\tmcount = 0;\r\n\t\t\t\t\t\toldWeek = newWeek;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.addWeekInPanelTime(prows[2], mcount, newWeek);\r\n\t\t\t\t//day\r\n\t\t\t\tfor(var i = 0; i < countDays; i++){\r\n\t\t\t\t\tthis.addDayInPanelTime(prows[3]);\r\n\t\t\t\t}\r\n\t\t\t\t//hour\r\n\t\t\t\tfor(var i = 0; i < countDays; i++){\r\n\t\t\t\t\tthis.addHourInPanelTime(prows[4]);\r\n\t\t\t\t}\r\n\t\t\t\tthis.panelTime.firstChild.firstChild.style.width = this.pixelsPerDay * (prows[3].cells.length) + \"px\";\r\n\t\t\t\tthis.contentData.firstChild.style.width = this.pixelsPerDay * (prows[3].cells.length) + \"px\";\r\n\t\t\t\tthis.maxTaskEndPos = maxEndPos;\r\n\t\t\t}\r\n\t\t},\r\n\t\taddYearInPanelTime: function(row, count, year){\r\n\t\t\tvar data = \"Year   \" + year;\r\n\t\t\tvar newCell = domConstruct.create(\"td\", {\r\n\t\t\t\tcolSpan: count,\r\n\t\t\t\talign: \"center\",\r\n\t\t\t\tvAlign: \"middle\",\r\n\t\t\t\tclassName: \"ganttYearNumber\",\r\n\t\t\t\tinnerHTML: this.pixelsPerDay * count > 20 ? data : \"\",\r\n\t\t\t\tinnerHTMLData: data\r\n\t\t\t}, row);\r\n\t\t\tdomStyle.set(newCell, \"width\", (this.pixelsPerDay * count) + \"px\");\r\n\t\t},\r\n\t\taddMonthInPanelTime: function(row, count, month, year){\r\n\t\t\tvar data = this.months[month] + (year ? \" of \" + year : \"\");\r\n\t\t\tvar newCell = domConstruct.create(\"td\", {\r\n\t\t\t\tcolSpan: count,\r\n\t\t\t\talign: \"center\",\r\n\t\t\t\tvAlign: \"middle\",\r\n\t\t\t\tclassName: \"ganttMonthNumber\",\r\n\t\t\t\tinnerHTML: this.pixelsPerDay * count > 30 ? data : \"\",\r\n\t\t\t\tinnerHTMLData: data\r\n\t\t\t}, row);\r\n\t\t\tdomStyle.set(newCell, \"width\", (this.pixelsPerDay * count) + \"px\");\r\n\t\t},\r\n\t\taddWeekInPanelTime: function(row, count, week){\r\n\t\t\tvar data = \"Week   \" + week;\r\n\t\t\tvar newCell = domConstruct.create(\"td\", {\r\n\t\t\t\tcolSpan: count,\r\n\t\t\t\talign: \"center\",\r\n\t\t\t\tvAlign: \"middle\",\r\n\t\t\t\tclassName: \"ganttWeekNumber\",\r\n\t\t\t\tinnerHTML: this.pixelsPerDay * count > 20 ? data : \"\",\r\n\t\t\t\tinnerHTMLData: data\r\n\t\t\t}, row);\r\n\t\t\tdomStyle.set(newCell, \"width\", (this.pixelsPerDay * count) + \"px\");\r\n\t\t},\r\n\t\taddDayInPanelTime: function(row){\r\n\t\t\tvar date = new Date(this.startDate);\r\n\t\t\tdate.setDate(date.getDate() + parseInt(row.cells.length));\r\n\t\t\tvar newCell = domConstruct.create(\"td\", {\r\n\t\t\t\talign: \"center\",\r\n\t\t\t\tvAlign: \"middle\",\r\n\t\t\t\tclassName: \"ganttDayNumber\",\r\n\t\t\t\tinnerHTML: this.pixelsPerDay > 20 ? date.getDate() : \"\",\r\n\t\t\t\tinnerHTMLData: String(date.getDate()),\r\n\t\t\t\tdata: row.cells.length\r\n\t\t\t}, row);\r\n\t\t\tdomStyle.set(newCell, \"width\", this.pixelsPerDay + \"px\");\r\n\t\t\t(date.getDay() >= 5) && domClass.add(newCell, \"ganttDayNumberWeekend\");\r\n\t\t\tthis._events.push(\r\n\t\t\t\ton(newCell, \"mouseover\", lang.hitch(this, function(event){\r\n\t\t\t\t\tvar dayTime = event.target || event.srcElement;\r\n\t\t\t\t\tvar date = new Date(this.startDate.getTime());\r\n\t\t\t\t\tdate.setDate(date.getDate() + parseInt(domAttr.get(dayTime, \"data\")));\r\n\t\t\t\t\tdijit.showTooltip(date.getFullYear() + \".\" + (date.getMonth() + 1) + \".\" + date.getDate(), newCell, [\"above\", \"below\"]);\r\n\t\t\t\t}))\r\n\t\t\t);\r\n\t\t\tthis._events.push(\r\n\t\t\t\ton(newCell, \"mouseout\", lang.hitch(this, function(event){\r\n\t\t\t\t\tvar dayTime = event.target || event.srcElement;\r\n\t\t\t\t\tdayTime && dijit.hideTooltip(dayTime);\r\n\t\t\t\t}))\r\n\t\t\t);\r\n\t\t},\r\n\t\taddHourInPanelTime: function(row){\r\n\t\t\tvar newCell = domConstruct.create(\"td\", {\r\n\t\t\t\talign: \"center\",\r\n\t\t\t\tvAlign: \"middle\",\r\n\t\t\t\tclassName: \"ganttHourNumber\",\r\n\t\t\t\tdata: row.cells.length\r\n\t\t\t}, row);\r\n\t\t\tdomStyle.set(newCell, \"width\", this.pixelsPerDay + \"px\");\r\n\t\t\t\r\n\t\t\tvar hourTable = domConstruct.create(\"table\", {\r\n\t\t\t\tcellPadding: \"0\",\r\n\t\t\t\tcellSpacing: \"0\"\r\n\t\t\t}, newCell);\r\n\t\t\tvar newRow = hourTable.insertRow(hourTable.rows.length);\r\n\t\t\tfor(var i = 0; i < this.hsPerDay; i++){\r\n\t\t\t\tvar hourTD = domConstruct.create(\"td\", {\r\n\t\t\t\t\tclassName: \"ganttHourClass\"\r\n\t\t\t\t}, newRow);\r\n\t\t\t\tdomStyle.set(hourTD, \"width\", (this.pixelsPerDay / this.hsPerDay) + \"px\");\r\n\t\t\t\tdomAttr.set(hourTD, \"innerHTMLData\", String(9 + i));\r\n\t\t\t\tif(this.pixelsPerDay / this.hsPerDay > 5){\r\n\t\t\t\t\tdomAttr.set(hourTD, \"innerHTML\", String(9 + i));\r\n\t\t\t\t}\r\n\t\t\t\tdomClass.add(hourTD, i <= 3?\"ganttHourNumberAM\":\"ganttHourNumberPM\");\r\n\t\t\t}\r\n\t\t},\r\n\t\tincHeightPanelTasks: function(height){\r\n\t\t\tvar containerTasks = this.contentData.firstChild;\r\n\t\t\tcontainerTasks.style.height = parseInt(containerTasks.style.height) + height + \"px\";\r\n\t\t},\r\n\t\tincHeightPanelNames: function(height){\r\n\t\t\tvar containerNames = this.panelNames.firstChild;\r\n\t\t\tcontainerNames.style.height = parseInt(containerNames.style.height) + height + \"px\";\r\n\t\t},\r\n\t\tcheckPosition: function(){\r\n\t\t\tarrayUtil.forEach(this.arrProjects, function(project){\r\n\t\t\t\tarrayUtil.forEach(project.arrTasks, function(task){\r\n\t\t\t\t\ttask.checkPosition();\r\n\t\t\t\t}, this);\r\n\t\t\t}, this);\r\n\t\t},\r\n\t\tcheckHeighPanelTasks: function(){\r\n\t\t\tthis.contentDataHeight += this.heightTaskItemExtra + this.heightTaskItem;\r\n\t\t\tif((parseInt(this.contentData.firstChild.style.height) <= this.contentDataHeight)){\r\n\t\t\t\tthis.incHeightPanelTasks(this.heightTaskItem + this.heightTaskItemExtra);\r\n\t\t\t\tthis.incHeightPanelNames(this.heightTaskItem + this.heightTaskItemExtra);\r\n\t\t\t}\r\n\t\t},\r\n\t\tsortTasksByStartTime: function(project){\r\n\t\t\tproject.parentTasks.sort(this.sortTaskStartTime);\r\n\t\t\tfor(var i = 0; i < project.parentTasks.length; i++){\r\n\t\t\t\tproject.parentTasks[i] = this.sortChildTasks(project.parentTasks[i]);\r\n\t\t\t}\r\n\t\t},\r\n\t\tsortChildTasks: function(parenttask){\r\n\t\t\tparenttask.cldTasks.sort(this.sortTaskStartTime);\r\n\t\t\tfor(var i = 0; i < parenttask.cldTasks.length; i++){\r\n\t\t\t\tif(parenttask.cldTasks[i].cldTasks.length > 0) this.sortChildTasks(parenttask.cldTasks[i]);\r\n\t\t\t}\r\n\t\t\treturn parenttask;\r\n\t\t},\r\n\t\trefresh: function(count, current, multi){\r\n\t\t\t//return if no task items\r\n\t\t\tif(this.arrProjects.length <= 0){return;}\r\n\t\t\tif(this.arrProjects[0].arrTasks.length <= 0){return;}\r\n\t\t\t//Show panel of names\r\n\t\t\tif(!count || current > count){\r\n\t\t\t\tthis.refreshController();\r\n\t\t\t\tif(this.resource){\r\n\t\t\t\t\tthis.resource.refresh();\r\n\t\t\t\t}\r\n\t\t\t\tthis.tempDayInPixels = 0;\r\n\t\t\t\tthis.panelNameHeadersCover && domStyle.set(this.panelNameHeadersCover, \"display\", \"none\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif(this.tempDayInPixels == 0){\r\n\t\t\t\tthis.tempDayInPixels = this.pixelsPerDay;\r\n\t\t\t}\r\n\t\t\tthis.panelNameHeadersCover && domStyle.set(this.panelNameHeadersCover, \"display\", \"\");\r\n\t\t\tvar dip = this.tempDayInPixels + this.tempDayInPixels * (multi - 1) * Math.pow((current / count), 2);\r\n\t\t\tthis.refreshParams(dip);\r\n\t\t\tarrayUtil.forEach(this.arrProjects, function(project){\r\n\t\t\t\tarrayUtil.forEach(project.arrTasks, function(task){\r\n\t\t\t\t\ttask.refresh();\r\n\t\t\t\t}, this);\r\n\t\t\t\tproject.refresh();\r\n\t\t\t}, this);\r\n\t\t\tsetTimeout(lang.hitch(this, function(){\r\n\t\t\t\tthis.refresh(count, ++current, multi);\r\n\t\t\t}), 15);\r\n\t\t},\r\n\t\tswitchTeleMicroView: function(dip){\r\n\t\t\tvar plChild = this.panelTime.firstChild.firstChild;\r\n\t\t\tfor(var i = 0; i < 5; i++){//0:Y 1:M 2:W 3:D 4:H\r\n\t\t\t\tif(dip > 40){\r\n\t\t\t\t\tdomStyle.set(plChild.rows[i], \"display\", (i==0||i==1)?\"none\":\"\");\r\n\t\t\t\t}else if(dip < 20){\r\n\t\t\t\t\tdomStyle.set(plChild.rows[i], \"display\", (i==2||i==4)?\"none\":\"\");\r\n\t\t\t\t}else{\r\n\t\t\t\t\tdomStyle.set(plChild.rows[i], \"display\", (i==0||i==4)?\"none\":\"\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\trefreshController: function(){\r\n\t\t\tthis.contentData.firstChild.style.width = Math.max(1200, this.pixelsPerDay * this.totalDays) + \"px\";\r\n\t\t\tthis.panelTime.firstChild.style.width = this.pixelsPerDay * this.totalDays + \"px\";\r\n\t\t\tthis.panelTime.firstChild.firstChild.style.width = this.pixelsPerDay * this.totalDays + \"px\";\r\n\t\t\tthis.switchTeleMicroView(this.pixelsPerDay);\r\n\t\t\tarrayUtil.forEach(this.panelTime.firstChild.firstChild.rows, function(row){\r\n\t\t\t\tarrayUtil.forEach(row.childNodes, function(td){\r\n\t\t\t\t\tvar cs = parseInt(domAttr.get(td, \"colSpan\") || 1);\r\n\t\t\t\t\tvar idata = lang.trim(domAttr.get(td, \"innerHTMLData\")||\"\");\r\n\t\t\t\t\tif(idata.length > 0){\r\n\t\t\t\t\t\tdomAttr.set(td, \"innerHTML\", this.pixelsPerDay * cs < 20 ? \"\" : idata);\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tarrayUtil.forEach(td.firstChild.rows[0].childNodes, function(td){\r\n\t\t\t\t\t\t\tvar sdata = lang.trim(domAttr.get(td, \"innerHTMLData\")||\"\");\r\n\t\t\t\t\t\t\tdomAttr.set(td, \"innerHTML\", this.pixelsPerDay / this.hsPerDay > 10 ? sdata : \"\");\r\n\t\t\t\t\t\t}, this);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(cs == 1){\r\n\t\t\t\t\t\tdomStyle.set(td, \"width\", (this.pixelsPerDay*cs) + \"px\");\r\n\t\t\t\t\t\tif(idata.length <= 0){\r\n\t\t\t\t\t\t\tarrayUtil.forEach(td.firstChild.rows[0].childNodes, function(td){\r\n\t\t\t\t\t\t\t\tdomStyle.set(td, \"width\", (this.pixelsPerDay*cs / this.hsPerDay) + \"px\");\r\n\t\t\t\t\t\t\t}, this);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}, this);\r\n\t\t\t}, this);\r\n\t\t},\r\n\t\tinit: function(){\r\n\t\t\tthis.startDate = this.getStartDate();\r\n\t\t\tdomStyle.set(this.content, {\r\n\t\t\t\twidth: this.contentWidth + \"px\",\r\n\t\t\t\theight: this.contentHeight + \"px\"\r\n\t\t\t});\r\n\t\t\t//create Table\r\n\t\t\tthis.tableControl = domConstruct.create(\"table\", {\r\n\t\t\t\tcellPadding: \"0\",\r\n\t\t\t\tcellSpacing: \"0\",\r\n\t\t\t\tclassName: \"ganttTabelControl\"\r\n\t\t\t});\r\n\t\t\tvar newRowTblControl = this.tableControl.insertRow(this.tableControl.rows.length);\r\n\t\t\t//Add to content Table\r\n\t\t\tthis.content.appendChild(this.tableControl);\r\n\t\t\tthis.countDays = this.getCountDays();\r\n\t\t\t//Creation panel of time\r\n\t\t\tthis.panelTime = domConstruct.create(\"div\", {className: \"ganttPanelTimeContainer\"});\r\n\t\t\tdomStyle.set(this.panelTime, \"height\", this.panelTimeHeight + \"px\");\r\n\t\t\tthis.panelTime.appendChild(this.createPanelTime());\r\n\t\t\t//Creation panel contentData\r\n\t\t\tthis.contentData = domConstruct.create(\"div\", {className: \"ganttContentDataContainer\"});\r\n\t\t\tdomStyle.set(this.contentData, \"height\", (this.contentHeight - this.panelTimeHeight) + \"px\");\r\n\t\t\tthis.contentData.appendChild(this.createPanelTasks());\r\n\t\t\t//Creation panel of names\r\n\t\t\tvar newCellTblControl = domConstruct.create(\"td\", {\r\n\t\t\t\tvAlign: \"top\"\r\n\t\t\t});\r\n\t\t\t//Creation panel of task header\r\n\t\t\tthis.panelNameHeaders = domConstruct.create(\"div\", {className: \"ganttPanelNameHeaders\"}, newCellTblControl);\r\n\t\t\tdomStyle.set(this.panelNameHeaders, {\r\n\t\t\t\theight: this.panelTimeHeight + \"px\",\r\n\t\t\t\twidth: this.maxWidthPanelNames + \"px\"\r\n\t\t\t});\r\n\t\t\tthis.panelNameHeaders.appendChild(this.createPanelNamesTasksHeader());\r\n\t\t\tthis.panelNames = domConstruct.create(\"div\", {className: \"ganttPanelNamesContainer\"}, newCellTblControl);\r\n\t\t\tthis.panelNames.appendChild(this.createPanelNamesTasks());\r\n\t\t\tnewRowTblControl.appendChild(newCellTblControl);\r\n\t\t\t//add to control contentData and dataTime\r\n\t\t\tnewCellTblControl = domConstruct.create(\"td\", {\r\n\t\t\t\tvAlign: \"top\"\r\n\t\t\t});\r\n\t\t\tvar divCell = domConstruct.create(\"div\", {className: \"ganttDivCell\"});\r\n\t\t\tdivCell.appendChild(this.panelTime);\r\n\t\t\tdivCell.appendChild(this.contentData);\r\n\t\t\tnewCellTblControl.appendChild(divCell);\r\n\t\t\tnewRowTblControl.appendChild(newCellTblControl);\r\n\t\t\t//Show panel of names\r\n\t\t\tdomStyle.set(this.panelNames, \"height\", (this.contentHeight - this.panelTimeHeight - this.scrollBarWidth) + \"px\");\r\n\t\t\tdomStyle.set(this.panelNames, \"width\", this.maxWidthPanelNames + \"px\");\r\n\t\t\tdomStyle.set(this.contentData, \"width\", (this.contentWidth - this.maxWidthPanelNames) + \"px\");\r\n\t\t\tdomStyle.set(this.contentData.firstChild, \"width\", this.pixelsPerDay * this.countDays + \"px\");\r\n\t\t\tdomStyle.set(this.panelTime, \"width\", (this.contentWidth - this.maxWidthPanelNames - this.scrollBarWidth) + \"px\");\r\n\t\t\tdomStyle.set(this.panelTime.firstChild, \"width\", this.pixelsPerDay * this.countDays + \"px\");\r\n\t\t\tif(this.isShowConMenu){\r\n\t\t\t\tthis.tabMenu = new TabMenu(this);\r\n\t\t\t}\r\n\t\t\tvar _this = this;\r\n\t\t\tthis.contentData.onscroll = function(){\r\n\t\t\t\t_this.panelTime.scrollLeft = this.scrollLeft;\r\n\t\t\t\tif(_this.panelNames){\r\n\t\t\t\t\t_this.panelNames.scrollTop = this.scrollTop;\r\n\t\t\t\t\tif(_this.isShowConMenu){\r\n\t\t\t\t\t\t_this.tabMenu.hide();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(_this.resource){\r\n\t\t\t\t\t_this.resource.contentData.scrollLeft = this.scrollLeft;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tthis.project.sort(this.sortProjStartDate);\r\n\t\t\tfor(var i = 0; i < this.project.length; i++){\r\n\t\t\t\tvar proj = this.project[i];\r\n\t\t\t\tfor(var k = 0; k < proj.parentTasks.length; k++){\r\n\t\t\t\t\tvar ppTask = proj.parentTasks[k];\r\n\t\t\t\t\tif(!ppTask.startTime){\r\n\t\t\t\t\t\tppTask.startTime = proj.startDate;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.setStartTimeChild(ppTask);\r\n\t\t\t\t\tif(this.setPreviousTask(proj)){\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tfor(var k = 0; k < proj.parentTasks.length; k++){\r\n\t\t\t\t\tvar ppTask = proj.parentTasks[k];\r\n\t\t\t\t\tif(ppTask.startTime < proj.startDate){\r\n\t\t\t\t\t\tif(!this.correctError){\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tppTask.startTime = proj.startDate;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(this.checkPosParentTaskInTree(ppTask)){\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.sortTasksByStartTime(proj);\r\n\t\t\t}\r\n\t\t\tfor(var i = 0; i < this.project.length; i++){\r\n\t\t\t\t//creation project\r\n\t\t\t\tvar proj = this.project[i];\r\n\t\t\t\tvar project = new GanttProjectControl(this, proj);\r\n\t\t\t\tif(this.arrProjects.length > 0){\r\n\t\t\t\t\tvar previousProject = this.arrProjects[this.arrProjects.length - 1];\r\n\t\t\t\t\tproject.previousProject = previousProject;\r\n\t\t\t\t\tpreviousProject.nextProject = project;\r\n\t\t\t\t}\r\n\t\t\t\tproject.create();\r\n\t\t\t\tthis.checkHeighPanelTasks();\r\n\t\t\t\tthis.arrProjects.push(project);\r\n\t\t\t\tthis.createTasks(project);\r\n\t\t\t}\r\n\t\t\tif(this.withResource){\r\n\t\t\t\tthis.resource = new GanttResourceItem(this);\r\n\t\t\t\tthis.resource.create();\r\n\t\t\t}\r\n\t\t\tthis.postLoadData();\r\n\t\t\tthis.postBindEvents();\r\n\t\t\treturn this;\r\n\t\t},\r\n\t\tpostLoadData: function(){\r\n\t\t\tarrayUtil.forEach(this.arrProjects, function(project){\r\n\t\t\t\tarrayUtil.forEach(project.arrTasks, function(task){\r\n\t\t\t\t\ttask.postLoadData();\r\n\t\t\t\t}, this);\r\n\t\t\t\tproject.postLoadData();\r\n\t\t\t}, this);\r\n\t\t\t//toolbar cover div\r\n\t\t\tvar cpos = domGeometry.getMarginBox(this.panelNameHeaders);\r\n\t\t\tif(!this.panelNameHeadersCover){\r\n\t\t\t\tthis.panelNameHeadersCover = domConstruct.create(\"div\", {className: \"ganttHeaderCover\"}, this.panelNameHeaders.parentNode);\r\n\t\t\t\tdomStyle.set(this.panelNameHeadersCover, {\r\n\t\t\t\t\tleft: cpos.l+\"px\",\r\n\t\t\t\t\ttop: cpos.t+\"px\",\r\n\t\t\t\t\theight: cpos.h+\"px\",\r\n\t\t\t\t\twidth: cpos.w+\"px\",\r\n\t\t\t\t\tdisplay: \"none\"\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\tpostBindEvents: function(){\r\n\t\t\t//highlight row\r\n\t\t\tvar pos = domGeometry.position(this.tableControl, true);\r\n\t\t\thas(\"dom-addeventlistener\") && this._events.push(\r\n\t\t\t\ton(this.tableControl, \"mousemove\", lang.hitch(this, function(event){\r\n\t\t\t\t\tvar elem = event.srcElement || event.target;\r\n\t\t\t\t\tif(elem == this.panelNames.firstChild || elem == this.contentData.firstChild){\r\n\t\t\t\t\t\t//23: this.heightTaskItem + this.heightTaskItemExtra\r\n\t\t\t\t\t\tvar rowHeight = this.heightTaskItem + this.heightTaskItemExtra;\r\n\t\t\t\t\t\tvar hlTop = parseInt(event.layerY / rowHeight) * rowHeight + this.panelTimeHeight - this.contentData.scrollTop;\r\n\t\t\t\t\t\tif(hlTop != this.oldHLTop && hlTop < (pos.h - 50)){\r\n\t\t\t\t\t\t\tif(this.highLightDiv){\r\n\t\t\t\t\t\t\t\tdomStyle.set(this.highLightDiv, \"top\", (pos.y + hlTop) + \"px\");\r\n\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\tthis.highLightDiv = domConstruct.create(\"div\", {\r\n\t\t\t\t\t\t\t\t\tclassName: \"ganttRowHighlight\"\r\n\t\t\t\t\t\t\t\t}, win.body());\r\n\t\t\t\t\t\t\t\tdomStyle.set(this.highLightDiv, {\r\n\t\t\t\t\t\t\t\t\ttop: (pos.y + hlTop) + \"px\",\r\n\t\t\t\t\t\t\t\t\tleft: pos.x + \"px\",\r\n\t\t\t\t\t\t\t\t\twidth: (pos.w - 20) + \"px\",\r\n\t\t\t\t\t\t\t\t\theight: rowHeight + \"px\"\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.oldHLTop = hlTop;\r\n\t\t\t\t\t}\r\n\t\t\t\t}))\r\n\t\t\t);\r\n\t\t},\r\n\t\tgetStartDate: function(){\r\n\t\t\tarrayUtil.forEach(this.project, function(proj){\r\n\t\t\t\tif(this.startDate){\r\n\t\t\t\t\tif(proj.startDate < this.startDate){\r\n\t\t\t\t\t\tthis.startDate = new Date(proj.startDate);\r\n\t\t\t\t\t}\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis.startDate = new Date(proj.startDate);\r\n\t\t\t\t}\r\n\t\t\t}, this);\r\n\t\t\tthis.initialPos = 24 * this.pixelsPerHour;\r\n\t\t\treturn this.startDate ? new Date(this.startDate.setHours(this.startDate.getHours() - 24)) : new Date();\r\n\t\t},\r\n\t\tgetCountDays: function(){\r\n\t\t\treturn parseInt((this.contentWidth - this.maxWidthPanelNames) / (this.pixelsPerHour * 24));\r\n\t\t},\r\n\t\tcreateTasks: function(project){\r\n\t\t\tarrayUtil.forEach(project.project.parentTasks, function(pppTask, i){\r\n\t\t\t\tif(i > 0){\r\n\t\t\t\t\tproject.project.parentTasks[i - 1].nextParentTask = pppTask;\r\n\t\t\t\t\tpppTask.previousParentTask = project.project.parentTasks[i - 1];\r\n\t\t\t\t}\r\n\t\t\t\tvar task = new GanttTaskControl(pppTask, project, this);\r\n\t\t\t\tproject.arrTasks.push(task);\r\n\t\t\t\ttask.create();\r\n\t\t\t\tthis.checkHeighPanelTasks();\r\n\t\t\t\tif(pppTask.cldTasks.length > 0){\r\n\t\t\t\t\tthis.createChildItemControls(pppTask.cldTasks, project);\r\n\t\t\t\t}\r\n\t\t\t}, this);\r\n\t\t},\r\n\t\tcreateChildItemControls: function(arrChildTasks, project){\r\n\t\t\tarrChildTasks && arrayUtil.forEach(arrChildTasks, function(cTask, i){\r\n\t\t\t\tif(i > 0){\r\n\t\t\t\t\tcTask.previousChildTask = arrChildTasks[i - 1];\r\n\t\t\t\t\tarrChildTasks[i - 1].nextChildTask = cTask;\r\n\t\t\t\t}\r\n\t\t\t\tvar task = new GanttTaskControl(cTask, project, this);\r\n\t\t\t\ttask.create();\r\n\t\t\t\tthis.checkHeighPanelTasks();\r\n\t\t\t\tif(cTask.cldTasks.length > 0){\r\n\t\t\t\t\tthis.createChildItemControls(cTask.cldTasks, project);\r\n\t\t\t\t}\r\n\t\t\t}, this);\r\n\t\t},\r\n\t\tgetPosOnDate: function(startTime){\r\n\t\t\treturn (startTime - this.startDate) / (60 * 60 * 1000) * this.pixelsPerHour;\r\n\t\t},\r\n\t\tgetWidthOnDuration: function(duration){\r\n\t\t\treturn Math.round(this.pixelsPerWorkHour * duration);\r\n\t\t},\r\n\t\tgetLastChildTask: function(task){\r\n\t\t\treturn task.childTask.length > 0 ? this.getLastChildTask(task.childTask[task.childTask.length - 1]) : task;\r\n\t\t},\r\n\t\tremoveCell: function(row){\r\n\t\t\twhile(row.cells[0]){\r\n\t\t\t\trow.deleteCell(row.cells[0]);\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n});"]}