{"version":3,"sources":["app/widgets/_ScrollableMixin.js"],"names":["define","declare","lang","array","win","domClass","registry","dom","domConstruct","Scrollable","scrollableParams","appBars","allowNestedScrolls","constructor","this","noResize","destroy","cleanup","inherited","arguments","startup","_started","findAppBars","node","params","fixedHeader","byId","parentNode","domNode","isLocalHeader","fixedHeaderHeight","offsetHeight","fixedFooter","isLocalFooter","style","bottom","fixedFooterHeight","init","reparent","buildRendering","add","overflow","top","containerNode","create","className","position","scrollDir","width","i","idx","len","c","childNodes","length","checkFixedBar","appendChild","removeChild","resize","forEach","getChildren","child","body","local","nodeType","fixed","getAttribute","byNode","_fixedAppFooter"],"mappings":";;;;;;;AACAA,QACC,qBACA,kBACA,mBACA,oBACA,iBACA,iBACA,WACA,qBACA,2BACA,SAASC,EAASC,EAAMC,EAAOC,EAAKC,EAAUC,EAAUC,EAAKC,EAAcC,GAM3E,OAAOR,EAAQ,qCAAsCQ,GAUpDC,iBAAkB,KAIlBC,SAAS,EAITC,oBAAoB,EAEpBC,YAAa,WACZC,KAAKJ,kBAAoBK,UAAU,IAGpCC,QAAS,WACRF,KAAKG,UACLH,KAAKI,UAAUC,YAGhBC,QAAS,WACR,IAAGN,KAAKO,SAAR,CACAP,KAAKQ,cACL,IAAIC,EAAMC,EAASV,KAAKJ,iBACrBI,KAAKW,eACPF,EAAOhB,EAAImB,KAAKZ,KAAKW,cACbE,YAAcb,KAAKc,UAC1Bd,KAAKe,eAAgB,GAEtBL,EAAOM,kBAAoBP,EAAKQ,cAE9BjB,KAAKkB,cACPT,EAAOhB,EAAImB,KAAKZ,KAAKkB,gBAEjBT,EAAKI,YAAcb,KAAKc,UAC1Bd,KAAKmB,eAAgB,EACrBV,EAAKW,MAAMC,OAAS,OAErBX,EAAOY,kBAAoBb,EAAKQ,cAIlCjB,KAAKuB,KAAKb,GACVV,KAAKI,UAAUC,WACfL,KAAKwB,aAINC,eAAgB,WACfzB,KAAKI,UAAUC,WACfd,EAASmC,IAAI1B,KAAKc,QAAS,qBAC3Bd,KAAKc,QAAQM,MAAMO,SAAW,SAC9B3B,KAAKc,QAAQM,MAAMQ,IAAM,MACzB5B,KAAK6B,cAAgBnC,EAAaoC,OAAO,OAAQC,UAAU,8BAA+B/B,KAAKc,SAC/Fd,KAAK6B,cAAcT,MAAMY,SAAW,WACpChC,KAAK6B,cAAcT,MAAMQ,IAAM,MACT,MAAnB5B,KAAKiC,YACPjC,KAAK6B,cAAcT,MAAMc,MAAQ,SAKnCV,SAAU,WAGT,IAAIW,EAAGC,EAAKC,EAAKC,EACjB,IAAIH,EAAI,EAAGC,EAAM,EAAGC,EAAMrC,KAAKc,QAAQyB,WAAWC,OAAQL,EAAIE,EAAKF,KAClEG,EAAItC,KAAKc,QAAQyB,WAAWH,MAGnBpC,KAAK6B,eAAiB7B,KAAKyC,cAAcH,GAAG,GACpDF,IAGDpC,KAAK6B,cAAca,YAAY1C,KAAKc,QAAQ6B,YAAYL,KAK1DM,OAAQ,WAGP5C,KAAKI,UAAUC,WACfhB,EAAMwD,QAAQ7C,KAAK8C,cAAe,SAASC,GACvCA,EAAMH,QAASG,EAAMH,YAK1BpC,YAAa,WAGZ,GAAIR,KAAKH,QAAT,CACA,IAAIsC,EAAGE,EAAKC,EACZ,IAAIH,EAAI,EAAGE,EAAM/C,EAAI0D,OAAOT,WAAWC,OAAQL,EAAIE,EAAKF,IACvDG,EAAIhD,EAAI0D,OAAOT,WAAWJ,GAC1BnC,KAAKyC,cAAcH,GAAG,GAEvB,GAAGtC,KAAKc,QAAQD,WACf,IAAIsB,EAAI,EAAGE,EAAMrC,KAAKc,QAAQD,WAAW0B,WAAWC,OAAQL,EAAIE,EAAKF,IACpEG,EAAItC,KAAKc,QAAQD,WAAW0B,WAAWJ,GACvCnC,KAAKyC,cAAcH,GAAG,GAGxBtC,KAAKsB,kBAAoBtB,KAAKkB,YAAclB,KAAKkB,YAAYD,aAAe,IAI7EwB,cAAe,SAAoBhC,EAAiBwC,GAGnD,GAAqB,IAAlBxC,EAAKyC,SAAe,CACtB,IAAIC,EAAQ1C,EAAK2C,aAAa,wBACzB5D,EAAS6D,OAAO5C,IAASjB,EAAS6D,OAAO5C,GAAM,uBAUpD,GAAa,WAAV0C,EAOF,OANA5D,EAASmC,IAAIjB,EAAM,qBAChBwC,EACFjD,KAAKkB,YAAcT,EAEnBT,KAAKsD,gBAAkB7C,EAEjB0C,EAGT,OAAO","file":"../../../app/widgets/_ScrollableMixin.js","sourcesContent":["// This module is modified from dojox/mobile/_ScrollableMixin and dojox/mobile/ScrollableView\r\ndefine([\r\n\t\"dojo/_base/declare\",\r\n\t\"dojo/_base/lang\",\r\n\t\"dojo/_base/array\",\r\n\t\"dojo/_base/window\",\r\n\t\"dojo/dom-class\",\r\n\t\"dijit/registry\",\r\n\t\"dojo/dom\",\r\n\t\"dojo/dom-construct\",\r\n\t\"dojox/mobile/scrollable\"],\r\n\tfunction(declare, lang, array, win, domClass, registry, dom, domConstruct, Scrollable){\r\n\t// module:\r\n\t//\t\tdojox/mobile/_ScrollableMixin\r\n\t// summary:\r\n\t//\t\tMixin for widgets to have a touch scrolling capability.\r\n\r\n\treturn declare(\"dojox.app.widgets._ScrollableMixin\", Scrollable, {\r\n\t\t// summary:\r\n\t\t//\t\tMixin for widgets to have a touch scrolling capability.\r\n\t\t// description:\r\n\t\t//\t\tActual implementation is in dojox/mobile/scrollable.js.\r\n\t\t//\t\tscrollable.js is not a dojo class, but just a collection\r\n\t\t//\t\tof functions. This module makes scrollable.js a dojo class.\r\n\r\n\t\t// scrollableParams: Object\r\n\t\t//\t\tParameters for dojox/mobile/scrollable.init().\r\n\t\tscrollableParams: null,\r\n\r\n\t\t// appBars: Boolean\r\n\t\t//\t\tEnables the search for application-specific bars (header or footer).\r\n\t\tappBars: true, \r\n\r\n\t\t// allowNestedScrolls: Boolean\r\n\t\t//\t\te.g. Allow ScrollableView in a SwapView.\r\n\t\tallowNestedScrolls: true,\r\n\r\n\t\tconstructor: function(){\r\n\t\t\tthis.scrollableParams = {noResize: true}; // set noResize to true to match the way it was done in app/widgets/scrollable.js\r\n\t\t},\r\n\r\n\t\tdestroy: function(){\r\n\t\t\tthis.cleanup();\r\n\t\t\tthis.inherited(arguments);\r\n\t\t},\r\n\r\n\t\tstartup: function(){\r\n\t\t\tif(this._started){ return; }\r\n\t\t\tthis.findAppBars();\r\n\t\t\tvar node, params = this.scrollableParams;\r\n\t\t\tif(this.fixedHeader){\r\n\t\t\t\tnode = dom.byId(this.fixedHeader);\r\n\t\t\t\tif(node.parentNode == this.domNode){ // local footer\r\n\t\t\t\t\tthis.isLocalHeader = true;\r\n\t\t\t\t}\r\n\t\t\t\tparams.fixedHeaderHeight = node.offsetHeight;\r\n\t\t\t}\r\n\t\t\tif(this.fixedFooter){\r\n\t\t\t\tnode = dom.byId(this.fixedFooter);\r\n\t\t\t\tif(node){\r\n\t\t\t\t\tif(node.parentNode == this.domNode){ // local footer\r\n\t\t\t\t\t\tthis.isLocalFooter = true;\r\n\t\t\t\t\t\tnode.style.bottom = \"0px\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tparams.fixedFooterHeight = node.offsetHeight;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.init(params);\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\tthis.reparent();\r\n\t\t},\r\n\r\n\t\t// build scrollable container domNode. This method from dojox/mobile/ScrollableView\r\n\t\tbuildRendering: function(){\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\tdomClass.add(this.domNode, \"mblScrollableView\");\r\n\t\t\tthis.domNode.style.overflow = \"hidden\";\r\n\t\t\tthis.domNode.style.top = \"0px\";\r\n\t\t\tthis.containerNode = domConstruct.create(\"div\",\t{className:\"mblScrollableViewContainer\"}, this.domNode);\r\n\t\t\tthis.containerNode.style.position = \"absolute\";\r\n\t\t\tthis.containerNode.style.top = \"0px\"; // view bar is relative\r\n\t\t\tif(this.scrollDir === \"v\"){\r\n\t\t\t\tthis.containerNode.style.width = \"100%\";\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// This method from dojox/mobile/ScrollableView\r\n\t\treparent: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tMoves all the children to containerNode.\r\n\t\t\tvar i, idx, len, c;\r\n\t\t\tfor(i = 0, idx = 0, len = this.domNode.childNodes.length; i < len; i++){\r\n\t\t\t\tc = this.domNode.childNodes[idx];\r\n\t\t\t\t// search for view-specific header or footer\r\n\t\t//\t\tif(c === this.containerNode){\r\n\t\t\t\tif(c === this.containerNode || this.checkFixedBar(c, true)){\r\n\t\t\t\t\tidx++;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tthis.containerNode.appendChild(this.domNode.removeChild(c));\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// This method from dojox/mobile/ScrollableView\r\n\t\tresize: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tCalls resize() of each child widget.\r\n\t\t\tthis.inherited(arguments); // scrollable#resize() will be called\r\n\t\t\tarray.forEach(this.getChildren(), function(child){\r\n\t\t\t\tif(child.resize){ child.resize(); }\r\n\t\t\t});\r\n\t\t},\r\n\r\n\r\n\t\tfindAppBars: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tSearch for application-specific header or footer.\r\n\t\t\tif(!this.appBars){ return; }\r\n\t\t\tvar i, len, c;\r\n\t\t\tfor(i = 0, len = win.body().childNodes.length; i < len; i++){\r\n\t\t\t\tc = win.body().childNodes[i];\r\n\t\t\t\tthis.checkFixedBar(c, false);\r\n\t\t\t}\r\n\t\t\tif(this.domNode.parentNode){\r\n\t\t\t\tfor(i = 0, len = this.domNode.parentNode.childNodes.length; i < len; i++){\r\n\t\t\t\t\tc = this.domNode.parentNode.childNodes[i];\r\n\t\t\t\t\tthis.checkFixedBar(c, false);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.fixedFooterHeight = this.fixedFooter ? this.fixedFooter.offsetHeight : 0;\r\n\t\t},\r\n\r\n\t\r\n\t\tcheckFixedBar: function(/*DomNode*/node, /*Boolean*/local){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tChecks if the given node is a fixed bar or not.\r\n\t\t\tif(node.nodeType === 1){\r\n\t\t\t\tvar fixed = node.getAttribute(\"data-app-constraint\")\r\n\t\t\t\t\t|| (registry.byNode(node) && registry.byNode(node)[\"data-app-constraint\"]);\r\n\t\t\t/*\tif(fixed === \"top\"){\r\n\t\t\t\t\tdomClass.add(node, \"mblFixedHeaderBar\");\r\n\t\t\t\t\tif(local){\r\n\t\t\t\t\t\tnode.style.top = \"0px\";\r\n\t\t\t\t\t\tthis.fixedHeader = node;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn fixed;\r\n\t\t\t\t}else\r\n\t\t\t*/\t \r\n\t\t\t\tif(fixed === \"bottom\"){\r\n\t\t\t\t\tdomClass.add(node, \"mblFixedBottomBar\");\r\n\t\t\t\t\tif(local){\r\n\t\t\t\t\t\tthis.fixedFooter = node;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tthis._fixedAppFooter = node;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn fixed;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\t\t\r\n\t});\r\n});\r\n"]}