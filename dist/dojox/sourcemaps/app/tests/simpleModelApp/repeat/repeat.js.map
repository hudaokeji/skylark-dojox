{"version":3,"sources":["app/tests/simpleModelApp/repeat/repeat.js"],"names":["define","dom","connect","registry","at","Repeat","getStateful","_connectResults","repeatmodel","setDetailsContext","index","set","getIndexFromId","nodeId","perfix","len","length","Error","substring","parseInt","init","this","loadedModels","jsonRestModel","connectResult","repeatDom","byId","e","target","id","push","model","First","data","Math","random","Last","Location","Office","Email","Tel","Fax","splice","insertResult","nextIndex","get","deleteResult","destroy","pop","disconnect"],"mappings":";;;;;;;AAAAA,QAAQ,WAAY,qBAAsB,iBAAkB,eAAgB,mBAAoB,yBAChG,SAASC,EAAKC,EAASC,EAAUC,EAAIC,EAAQC,GAE5C,IAAIC,KAEAC,EAAc,KAYdC,EAAoB,SAASC,GAChCF,EAAYG,IAAI,cAAeD,IAgB5BE,EAAiB,SAASC,EAAQC,GACrC,IAAIC,EAAMD,EAAOE,OACjB,GAAGH,EAAOG,QAAUD,EACnB,MAAME,MAAM,yBAEb,IAAIP,EAAQG,EAAOK,UAAUH,EAAKF,EAAOG,QACzC,OAAOG,SAAST,IAGjB,OAECU,KAAM,WACLZ,EAAca,KAAKC,aAAaC,cAChC,IACIC,EADAC,EAAYxB,EAAIyB,KAAK,gBAEzBF,EAAgBtB,EAAQA,QAAQuB,EAAW,6BAAgC,SAASE,GACnF,IAAIjB,EAAQE,EAAee,EAAEC,OAAOC,GAAI,UACxCpB,EAAkBC,KAEnBH,EAAgBuB,KAAKN,GAErBA,EAAgBtB,EAAQA,QAAQuB,EAAW,6BAAgC,SAASE,IAlCnE,SAASjB,GAC3B,GAAGA,EAAM,GAAKA,EAAMF,EAAYuB,MAAMf,OACrC,MAAMC,MAAM,4BAEb,KAAoC,IAAhCT,EAAYuB,MAAMrB,GAAOsB,OAC3BxB,EAAYuB,MAAMrB,EAAM,IAA2C,IAApCF,EAAYuB,MAAMrB,EAAM,GAAGsB,OAD5D,CAIA,IAAIC,GAAQJ,GAAGK,KAAKC,SAAUH,MAAS,GAAII,KAAQ,GAAIC,SAAY,KAAMC,OAAU,GAAIC,MAAS,GAAIC,IAAO,GAAIC,IAAO,IACtHjC,EAAYuB,MAAMW,OAAOhC,EAAM,EAAG,EAAG,IAAIJ,EAAY2B,IACrDxB,EAAkBC,EAAM,IA0BtBiC,CADY/B,EAAee,EAAEC,OAAOC,GAAI,aAGzCtB,EAAgBuB,KAAKN,GAErBA,EAAgBtB,EAAQA,QAAQuB,EAAW,6BAAgC,SAASE,IArDnE,SAASjB,GAC3B,IAAIkC,EAAYpC,EAAYqC,IAAI,eAC7BD,GAAalC,IACfkC,GAAsB,GAEvBpC,EAAYuB,MAAMW,OAAOhC,EAAO,GAChCF,EAAYG,IAAI,cAAeiC,GAiD7BE,CADYlC,EAAee,EAAEC,OAAOC,GAAI,aAGzCtB,EAAgBuB,KAAKN,IAEtBuB,QAAS,WAER,IADA,IAAIvB,EAAgBjB,EAAgByC,MAC9BxB,GACLtB,EAAQ+C,WAAWzB,GACnBA,EAAgBjB,EAAgByC","file":"../../../../../app/tests/simpleModelApp/repeat/repeat.js","sourcesContent":["define([\"dojo/dom\", \"dojo/_base/connect\", \"dijit/registry\", \"dojox/mvc/at\", \"dojox/mvc/Repeat\", \"dojox/mvc/getStateful\"],\r\nfunction(dom, connect, registry, at, Repeat, getStateful){\r\n\r\n\tvar _connectResults = []; // events connect result\r\n\r\n\tvar repeatmodel = null;\t//repeat view data model\r\n\r\n\t// delete an item\r\n\tvar deleteResult = function(index){\r\n\t\tvar nextIndex = repeatmodel.get(\"cursorIndex\");\r\n\t\tif(nextIndex >= index){\r\n\t\t\tnextIndex = nextIndex-1;\r\n\t\t}\r\n\t\trepeatmodel.model.splice(index, 1);\r\n\t\trepeatmodel.set(\"cursorIndex\", nextIndex);\t\t\r\n\t};\r\n\t// show an item detail\r\n\tvar setDetailsContext = function(index){\r\n\t\trepeatmodel.set(\"cursorIndex\", index);\r\n\t};\r\n\t// insert an item\r\n\tvar insertResult = function(index){\r\n\t\tif(index<0 || index>repeatmodel.model.length){\r\n\t\t\tthrow Error(\"index out of data model.\");\r\n\t\t}\r\n\t\tif((repeatmodel.model[index].First==\"\") ||\r\n\t\t\t(repeatmodel.model[index+1] && (repeatmodel.model[index+1].First == \"\"))){\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar data = {id:Math.random(), \"First\": \"\", \"Last\": \"\", \"Location\": \"CA\", \"Office\": \"\", \"Email\": \"\", \"Tel\": \"\", \"Fax\": \"\"};\r\n\t\trepeatmodel.model.splice(index+1, 0, new getStateful(data));\r\n\t\tsetDetailsContext(index+1);\r\n\t};\r\n\t// get index from dom node id\r\n\tvar getIndexFromId = function(nodeId, perfix){\r\n\t\tvar len = perfix.length;\r\n\t\tif(nodeId.length <= len){\r\n\t\t\tthrow Error(\"repeat node id error.\");\r\n\t\t}\r\n\t\tvar index = nodeId.substring(len, nodeId.length);\r\n\t\treturn parseInt(index);\r\n\t};\r\n\r\n\treturn {\r\n\t\t// repeat view init\r\n\t\tinit: function(){\r\n\t\t\trepeatmodel = this.loadedModels.jsonRestModel;\r\n\t\t\tvar repeatDom = dom.byId('repeatWidget');\r\n\t\t\tvar connectResult;\r\n\t\t\tconnectResult = connect.connect(repeatDom, \"button[id^=\\\"detail\\\"]:click\", function(e){\r\n\t\t\t\tvar index = getIndexFromId(e.target.id, \"detail\");\r\n\t\t\t\tsetDetailsContext(index);\r\n\t\t\t});\r\n\t\t\t_connectResults.push(connectResult);\r\n\r\n\t\t\tconnectResult = connect.connect(repeatDom, \"button[id^=\\\"insert\\\"]:click\", function(e){\r\n\t\t\t\tvar index = getIndexFromId(e.target.id, \"insert\");\r\n\t\t\t\tinsertResult(index);\r\n\t\t\t});\r\n\t\t\t_connectResults.push(connectResult);\r\n\r\n\t\t\tconnectResult = connect.connect(repeatDom, \"button[id^=\\\"delete\\\"]:click\", function(e){\r\n\t\t\t\tvar index = getIndexFromId(e.target.id, \"delete\");\r\n\t\t\t\tdeleteResult(index);\r\n\t\t\t});\r\n\t\t\t_connectResults.push(connectResult);\r\n\t\t},\r\n\t\tdestroy: function(){\r\n\t\t\tvar connectResult = _connectResults.pop();\r\n\t\t\twhile(connectResult){\r\n\t\t\t\tconnect.disconnect(connectResult);\r\n\t\t\t\tconnectResult = _connectResults.pop();\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n});\r\n"]}