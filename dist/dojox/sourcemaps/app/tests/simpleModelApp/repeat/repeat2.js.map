{"version":3,"sources":["app/tests/simpleModelApp/repeat/repeat2.js"],"names":["define","dom","connect","registry","at","Repeat","getStateful","_connectResults","repeatmodel2","setDetailsContext","index","set","getIndexFromId","nodeId","perfix","len","length","Error","substring","parseInt","init","this","loadedModels","repeatmodels2","connectResult","repeatDom","byId","e","target","id","push","model","First","data","Math","random","Last","Location","Office","Email","Tel","Fax","splice","insertResult","nextIndex","get","deleteResult","destroy","pop","disconnect"],"mappings":";;;;;;;AAAAA,QAAQ,WAAY,qBAAsB,iBAAkB,eAAgB,mBAAoB,yBAChG,SAASC,EAAKC,EAASC,EAAUC,EAAIC,EAAQC,GAE5C,IAAIC,KAEAC,EAAe,KAYfC,EAAoB,SAASC,GAChCF,EAAaG,IAAI,cAAeD,IAgB7BE,EAAiB,SAASC,EAAQC,GACrC,IAAIC,EAAMD,EAAOE,OACjB,GAAGH,EAAOG,QAAUD,EACnB,MAAME,MAAM,yBAEb,IAAIP,EAAQG,EAAOK,UAAUH,EAAKF,EAAOG,QACzC,OAAOG,SAAST,IAGjB,OAECU,KAAM,WACLZ,EAAea,KAAKC,aAAaC,cACjC,IACIC,EADAC,EAAYxB,EAAIyB,KAAK,iBAEzBF,EAAgBtB,EAAQA,QAAQuB,EAAW,8BAAiC,SAASE,GACpF,IAAIjB,EAAQE,EAAee,EAAEC,OAAOC,GAAI,WACxCpB,EAAkBC,KAEnBH,EAAgBuB,KAAKN,GAErBA,EAAgBtB,EAAQA,QAAQuB,EAAW,8BAAiC,SAASE,IAlCpE,SAASjB,GAC3B,GAAGA,EAAM,GAAKA,EAAMF,EAAauB,MAAMf,OACtC,MAAMC,MAAM,4BAEb,KAAqC,IAAjCT,EAAauB,MAAMrB,GAAOsB,OAC5BxB,EAAauB,MAAMrB,EAAM,IAA4C,IAArCF,EAAauB,MAAMrB,EAAM,GAAGsB,OAD9D,CAIA,IAAIC,GAAQJ,GAAGK,KAAKC,SAAUH,MAAS,GAAII,KAAQ,GAAIC,SAAY,KAAMC,OAAU,GAAIC,MAAS,GAAIC,IAAO,GAAIC,IAAO,IACtHjC,EAAauB,MAAMW,OAAOhC,EAAM,EAAG,EAAG,IAAIJ,EAAY2B,IACtDxB,EAAkBC,EAAM,IA0BtBiC,CADY/B,EAAee,EAAEC,OAAOC,GAAI,cAGzCtB,EAAgBuB,KAAKN,GAErBA,EAAgBtB,EAAQA,QAAQuB,EAAW,8BAAiC,SAASE,IArDpE,SAASjB,GAC3B,IAAIkC,EAAYpC,EAAaqC,IAAI,eAC9BD,GAAalC,IACfkC,GAAsB,GAEvBpC,EAAauB,MAAMW,OAAOhC,EAAO,GACjCF,EAAaG,IAAI,cAAeiC,GAiD9BE,CADYlC,EAAee,EAAEC,OAAOC,GAAI,cAGzCtB,EAAgBuB,KAAKN,IAGtBuB,QAAS,WAER,IADA,IAAIvB,EAAgBjB,EAAgByC,MAC9BxB,GACLtB,EAAQ+C,WAAWzB,GACnBA,EAAgBjB,EAAgByC","file":"../../../../../app/tests/simpleModelApp/repeat/repeat2.js","sourcesContent":["define([\"dojo/dom\", \"dojo/_base/connect\", \"dijit/registry\", \"dojox/mvc/at\", \"dojox/mvc/Repeat\", \"dojox/mvc/getStateful\"],\r\nfunction(dom, connect, registry, at, Repeat, getStateful){\r\n\r\n\tvar _connectResults = []; // events connect result\r\n\r\n\tvar repeatmodel2 = null;\t//repeat view data model\r\n\r\n\t// delete an item\r\n\tvar deleteResult = function(index){\r\n\t\tvar nextIndex = repeatmodel2.get(\"cursorIndex\");\r\n\t\tif(nextIndex >= index){\r\n\t\t\tnextIndex = nextIndex-1;\r\n\t\t}\r\n\t\trepeatmodel2.model.splice(index, 1);\r\n\t\trepeatmodel2.set(\"cursorIndex\", nextIndex);\t\t\r\n\t};\r\n\t// show an item detail\r\n\tvar setDetailsContext = function(index){\r\n\t\trepeatmodel2.set(\"cursorIndex\", index);\r\n\t};\r\n\t// insert an item\r\n\tvar insertResult = function(index){\r\n\t\tif(index<0 || index>repeatmodel2.model.length){\r\n\t\t\tthrow Error(\"index out of data model.\");\r\n\t\t}\r\n\t\tif((repeatmodel2.model[index].First==\"\") ||\r\n\t\t\t(repeatmodel2.model[index+1] && (repeatmodel2.model[index+1].First == \"\"))){\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar data = {id:Math.random(), \"First\": \"\", \"Last\": \"\", \"Location\": \"CA\", \"Office\": \"\", \"Email\": \"\", \"Tel\": \"\", \"Fax\": \"\"};\r\n\t\trepeatmodel2.model.splice(index+1, 0, new getStateful(data));\r\n\t\tsetDetailsContext(index+1);\r\n\t};\r\n\t// get index from dom node id\r\n\tvar getIndexFromId = function(nodeId, perfix){\r\n\t\tvar len = perfix.length;\r\n\t\tif(nodeId.length <= len){\r\n\t\t\tthrow Error(\"repeat node id error.\");\r\n\t\t}\r\n\t\tvar index = nodeId.substring(len, nodeId.length);\r\n\t\treturn parseInt(index);\r\n\t};\r\n\r\n\treturn {\r\n\t\t// repeat2 view init\r\n\t\tinit: function(){\r\n\t\t\trepeatmodel2 = this.loadedModels.repeatmodels2;\r\n\t\t\tvar repeatDom = dom.byId('repeatWidget2');\r\n\t\t\tvar connectResult;\r\n\t\t\tconnectResult = connect.connect(repeatDom, \"button[id^=\\\"detail2\\\"]:click\", function(e){\r\n\t\t\t\tvar index = getIndexFromId(e.target.id, \"detail2\");\r\n\t\t\t\tsetDetailsContext(index);\r\n\t\t\t});\r\n\t\t\t_connectResults.push(connectResult);\r\n\r\n\t\t\tconnectResult = connect.connect(repeatDom, \"button[id^=\\\"insert2\\\"]:click\", function(e){\r\n\t\t\t\tvar index = getIndexFromId(e.target.id, \"insert2\");\r\n\t\t\t\tinsertResult(index);\r\n\t\t\t});\r\n\t\t\t_connectResults.push(connectResult);\r\n\r\n\t\t\tconnectResult = connect.connect(repeatDom, \"button[id^=\\\"delete2\\\"]:click\", function(e){\r\n\t\t\t\tvar index = getIndexFromId(e.target.id, \"delete2\");\r\n\t\t\t\tdeleteResult(index);\r\n\t\t\t});\r\n\t\t\t_connectResults.push(connectResult);\r\n\t\t},\r\n\t\t// repeat2 view destroy\r\n\t\tdestroy: function(){\r\n\t\t\tvar connectResult = _connectResults.pop();\r\n\t\t\twhile(connectResult){\r\n\t\t\t\tconnect.disconnect(connectResult);\r\n\t\t\t\tconnectResult = _connectResults.pop();\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n});\r\n"]}