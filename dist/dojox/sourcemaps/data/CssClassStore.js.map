{"version":3,"sources":["data/CssClassStore.js"],"names":["define","declare","CssRuleStore","_labelAttribute","_idAttribute","_cName","getFeatures","dojo.data.api.Read","dojo.data.api.Identity","getAttributes","item","this","_assertIsItem","getValue","attribute","defaultValue","values","getValues","length","_assertIsAttribute","value","className","replace","_handleRule","rule","styleSheet","href","obj","s","split","j","tmp","first","indexOf","last","substring","key","_allItems","_storeRef","_handleReturn","requestInfo","_inProgress","items","i","_pending","pop","request","_items","push","fetch","_handleFetchReturn","_handleFetchByIdentityReturn","identity","isItem","onItem","scope","dojo","global","call","getIdentity","getIdentityAttributes","fetchItemByIdentity","store","_fetch"],"mappings":";;;;;;;AAAAA,QAAQ,qBAAqB,2BAC3B,SAASC,EAASC,GAEpB,OAAOD,EAAQ,2BAA4BC,GAY1CC,gBAAiB,QAEjBC,aAAc,QACdC,OAAQ,2BAERC,YAAa,WAGZ,OACCC,sBAAuB,EACvBC,0BAA2B,IAI7BC,cAAe,SAASC,GAIvB,OADAC,KAAKC,cAAcF,IACX,QAAS,cAGlBG,SAAU,SAASH,EAAMI,EAAWC,GAGnC,IAAIC,EAASL,KAAKM,UAAUP,EAAMI,GAClC,OAAGE,GAAUA,EAAOE,OAAS,EACrBF,EAAO,GAERD,GAGRE,UAAW,SAASP,EAAMI,GAGzBH,KAAKC,cAAcF,GACnBC,KAAKQ,mBAAmBL,GACxB,IAAIM,KAMJ,MALiB,UAAdN,EACFM,GAASV,EAAKW,WACQ,cAAdP,IACRM,GAASV,EAAKW,UAAUC,QAAQ,MAAM,MAEhCF,GAGRG,YAAa,SAASC,EAAMC,EAAYC,GAMvC,IAFA,IAAIC,KACAC,EAAIJ,EAAmB,aAAEK,MAAM,KAC3BC,EAAE,EAAGA,EAAEF,EAAEV,OAAQY,IAAI,CAC5B,IAAIC,EAAMH,EAAEE,GACRE,EAAQD,EAAIE,QAAQ,KACxB,GAAGF,GAAOA,EAAIb,OAAS,IAAgB,IAAXc,EAAa,CACxC,IAAIE,EAAOH,EAAIE,QAAQ,MAAQF,EAAIE,QAAQ,KAE3CN,EADAI,EAAMA,EAAII,UAAUH,GAAmB,IAAVE,GAAeA,EAAOF,EAAOE,EAAKH,EAAIb,UACxD,GAGb,IAAI,IAAIkB,KAAOT,EACd,IAAIhB,KAAK0B,UAAUD,GAAK,CACvB,IAAI1B,KACJA,EAAKW,UAAYe,EACjB1B,EAAKC,KAAK2B,WAAa3B,KACvBA,KAAK0B,UAAUD,GAAO1B,IAKzB6B,cAAe,WAKd,IAMIC,EANAC,KAEAC,KACJ,IAAI,IAAIC,KAAKhC,KAAK0B,UACjBK,EAAMC,GAAKhC,KAAK0B,UAAUM,GAI3B,KAAMhC,KAAKiC,SAAS1B,SACnBsB,EAAc7B,KAAKiC,SAASC,OAChBC,QAAQC,OAASL,EAC7BD,EAAYO,KAAKR,GAGlB,KAAMC,EAAYvB,SACjBsB,EAAcC,EAAYI,OACXI,MACdtC,KAAKuC,mBAAmBV,EAAYM,SAEpCnC,KAAKwC,6BAA6BX,EAAYM,UAKjDK,6BAA8B,SAASL,GAGtC,IAGIpC,EAHQoC,EAAQC,OAGHD,EAAQM,UAIzB,GAHIzC,KAAK0C,OAAO3C,KACfA,EAAO,MAELoC,EAAQQ,OAAO,CACjB,IAAIC,EAAQT,EAAQS,OAASC,KAAKC,OAClCX,EAAQQ,OAAOI,KAAKH,EAAO7C,KAK7BiD,YAAa,SAAoBjD,GAIhC,OADAC,KAAKC,cAAcF,GACZC,KAAKE,SAASH,EAAMC,KAAKP,eAGjCwD,sBAAuB,SAAoBlD,GAI1C,OADAC,KAAKC,cAAcF,IACXC,KAAKP,eAGdyD,oBAAqB,SAAuBf,GAa3C,OAVAA,EAAUA,OACEgB,QACXhB,EAAQgB,MAAQnD,MAEdA,KAAKiC,UAAYjC,KAAKiC,SAAS1B,OAAS,EAC1CP,KAAKiC,SAASI,MAAMF,QAASA,KAE7BnC,KAAKiC,WAAaE,QAASA,IAC3BnC,KAAKoD,OAAOjB,IAENA","file":"../../data/CssClassStore.js","sourcesContent":["define([\"dojo/_base/declare\",\"dojox/data/CssRuleStore\"], \r\n  function(declare, CssRuleStore) {\r\n\r\nreturn declare(\"dojox.data.CssClassStore\", CssRuleStore, {\r\n\t// summary:\r\n\t//\t\tBasic store to display CSS information.\r\n\t// description:\r\n\t//\t\tThe CssClassStore allows users to get information about active Css classes in the page running the CssClassStore.\r\n\t//\t\tIt can also filter out classes from specific stylesheets.  The attributes it exposes on classes are as follows:\r\n\t//\r\n\t//\t\t- class:\t\tThe classname, including the '.'.\r\n\t//\t\t- classSans:\tThe classname without the '.'.\r\n\r\n\t// _labelAttribute:\r\n\t//\t\ttext representation of the Item [label and identifier may need to stay due to method names]\r\n\t_labelAttribute: 'class',\r\n\t\r\n\t_idAttribute: 'class',\r\n\t_cName: \"dojox.data.CssClassStore\",\r\n\r\n\tgetFeatures: function(){\r\n\t\t// summary:\r\n\t\t//\t\tSee dojo/data/api/Read.getFeatures()\r\n\t\treturn {\r\n\t\t\t\"dojo.data.api.Read\" : true,\r\n\t\t\t\"dojo.data.api.Identity\" : true\r\n\t\t};\r\n\t},\r\n\r\n\tgetAttributes: function(item){\r\n\t\t// summary:\r\n\t\t//\t\tSee dojo/data/api/Read.getAttributes()\r\n\t\tthis._assertIsItem(item);\r\n\t\treturn ['class', 'classSans'];\r\n\t},\r\n\r\n\tgetValue: function(item, attribute, defaultValue){\r\n\t\t// summary:\r\n\t\t//\t\tSee dojo/data/api/Read.getValue()\r\n\t\tvar values = this.getValues(item, attribute);\r\n\t\tif(values && values.length > 0){\r\n\t\t\treturn values[0];\r\n\t\t}\r\n\t\treturn defaultValue;\r\n\t},\r\n\r\n\tgetValues: function(item, attribute){\r\n\t\t// summary:\r\n\t\t//\t\tSee dojo/data/api/Read.getValues()\r\n\t\tthis._assertIsItem(item);\r\n\t\tthis._assertIsAttribute(attribute);\r\n\t\tvar value = [];\r\n\t\tif(attribute === \"class\"){\r\n\t\t\tvalue = [item.className];\r\n\t\t}else if(attribute === \"classSans\"){\r\n\t\t\tvalue = [item.className.replace(/\\./g,'')];\r\n\t\t}\r\n\t\treturn value;\r\n\t},\r\n\r\n\t_handleRule: function(rule, styleSheet, href){\r\n\t\t// summary:\r\n\t\t//\t\tHandles the creation of an item based on the passed rule.  In this store, this implies\r\n\t\t//\t\tparsing out all available class names.\r\n\t\tvar obj = {};\r\n\t\tvar s = rule['selectorText'].split(\" \");\r\n\t\tfor(var j=0; j<s.length; j++){\r\n\t\t\tvar tmp = s[j];\r\n\t\t\tvar first = tmp.indexOf('.');\r\n\t\t\tif(tmp && tmp.length > 0 && first !== -1){\r\n\t\t\t\tvar last = tmp.indexOf(',') || tmp.indexOf('[');\r\n\t\t\t\ttmp = tmp.substring(first, ((last !== -1 && last > first)?last:tmp.length));\r\n\t\t\t\tobj[tmp] = true;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(var key in obj){\r\n\t\t\tif(!this._allItems[key]){\r\n\t\t\t\tvar item = {};\r\n\t\t\t\titem.className = key;\r\n\t\t\t\titem[this._storeRef] = this;\r\n\t\t\t\tthis._allItems[key] = item;\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t_handleReturn: function(){\r\n\t\t// summary:\r\n\t\t//\t\tHandles the return from a fetching action.  Delegates requests to act on the resulting\r\n\t\t//\t\titem set to eitehr the _handleFetchReturn or _handleFetchByIdentityReturn depending on\r\n\t\t//\t\twhere the request originated.\r\n\t\tvar _inProgress = [];\r\n\t\t\r\n\t\tvar items = {};\r\n\t\tfor(var i in this._allItems){\r\n\t\t\titems[i] = this._allItems[i];\r\n\t\t}\r\n\t\tvar requestInfo;\r\n\t\t// One-level deep clone (can't use dojo.clone, since we don't want to clone all those store refs!)\r\n\t\twhile(this._pending.length){\r\n\t\t\trequestInfo = this._pending.pop();\r\n\t\t\trequestInfo.request._items = items;\r\n\t\t\t_inProgress.push(requestInfo);\r\n\t\t}\r\n\r\n\t\twhile(_inProgress.length){\r\n\t\t\trequestInfo = _inProgress.pop();\r\n\t\t\tif(requestInfo.fetch){\r\n\t\t\t\tthis._handleFetchReturn(requestInfo.request);\r\n\t\t\t}else{\r\n\t\t\t\tthis._handleFetchByIdentityReturn(requestInfo.request);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t_handleFetchByIdentityReturn: function(request){\r\n\t\t// summary:\r\n\t\t//\t\tHandles a fetchByIdentity request by finding the correct item.\r\n\t\tvar items = request._items;\r\n\t\t// Per https://bugs.webkit.org/show_bug.cgi?id=17935 , Safari 3.x always returns the selectorText\r\n\t\t// of a rule in full lowercase.\r\n\t\tvar item = items[request.identity];\r\n\t\tif(!this.isItem(item)){\r\n\t\t\titem = null;\r\n\t\t}\r\n\t\tif(request.onItem){\r\n\t\t\tvar scope = request.scope || dojo.global;\r\n\t\t\trequest.onItem.call(scope, item);\r\n\t\t}\r\n\t},\r\n\r\n\t/* Identity API */\r\n\tgetIdentity: function(/* item */ item){\r\n\t\t// summary:\r\n\t\t//\t\tSee dojo/data/api/Identity.getIdentity()\r\n\t\tthis._assertIsItem(item);\r\n\t\treturn this.getValue(item, this._idAttribute);\r\n\t},\r\n\r\n\tgetIdentityAttributes: function(/* item */ item){\r\n\t\t// summary:\r\n\t\t//\t\tSee dojo/data/api/Identity.getIdentityAttributes()\r\n\t\tthis._assertIsItem(item);\r\n\t\treturn [this._idAttribute];\r\n\t},\r\n\r\n\tfetchItemByIdentity: function(/* request */ request){\r\n\t\t// summary:\r\n\t\t//\t\tSee dojo/data/api/Identity.fetchItemByIdentity()\r\n\t\trequest = request || {};\r\n\t\tif(!request.store){\r\n\t\t\trequest.store = this;\r\n\t\t}\r\n\t\tif(this._pending && this._pending.length > 0){\r\n\t\t\tthis._pending.push({request: request});\r\n\t\t}else{\r\n\t\t\tthis._pending = [{request: request}];\r\n\t\t\tthis._fetch(request);\r\n\t\t}\r\n\t\treturn request;\r\n\t}\r\n});\r\n\r\n});\r\n"]}