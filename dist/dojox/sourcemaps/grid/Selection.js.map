{"version":3,"sources":["grid/Selection.js"],"names":["define","declare","array","lang","domAttr","constructor","inGrid","this","grid","selected","setMode","selectionMode","mode","updating","selectedIndex","rangeStartIndex","length","deselectAll","onCanSelect","inIndex","onCanDeselect","onSelected","onDeselected","onChanging","onChanged","isSelected","getFirstSelected","i","l","getNextSelected","inPrev","getSelected","result","push","getSelectedCount","c","_beginUpdate","_endUpdate","select","addToSelection","toggleSelect","isArray","forEach","Number","rowNode","getRowNode","set","deselect","setSelected","inSelect","_range","inFrom","inTo","func","s","e","selectRange","hitch","deselectRange","insert","splice","remove","inExcept","clickSelect","inCtrlKey","inShiftKey","clickSelectEvent","rowIndex","dojo","isCopyKey","shiftKey","clear"],"mappings":"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","file":"../../grid/Selection.js","sourcesContent":["define([\r\n\t\"dojo/_base/declare\",\r\n\t\"dojo/_base/array\",\r\n\t\"dojo/_base/lang\",\r\n\t\"dojo/dom-attr\"\r\n], function(declare, array, lang, domAttr){\r\n\r\nreturn declare(\"dojox.grid.Selection\", null, {\r\n\t// summary:\r\n\t//\t\tManages row selection for grid. Owned by grid and used internally\r\n\t//\t\tfor selection. Override to implement custom selection.\r\n\r\n\tconstructor: function(inGrid){\r\n\t\tthis.grid = inGrid;\r\n\t\tthis.selected = [];\r\n\r\n\t\tthis.setMode(inGrid.selectionMode);\r\n\t},\r\n\r\n\tmode: 'extended',\r\n\r\n\tselected: null,\r\n\tupdating: 0,\r\n\tselectedIndex: -1,\r\n\trangeStartIndex: -1,\r\n\r\n\tsetMode: function(mode){\r\n\t\tif(this.selected.length){\r\n\t\t\tthis.deselectAll();\r\n\t\t}\r\n\t\tif(mode != 'extended' && mode != 'multiple' && mode != 'single' && mode != 'none'){\r\n\t\t\tthis.mode = 'extended';\r\n\t\t}else{\r\n\t\t\tthis.mode = mode;\r\n\t\t}\r\n\t},\r\n\r\n\tonCanSelect: function(inIndex){\r\n\t\treturn this.grid.onCanSelect(inIndex);\r\n\t},\r\n\r\n\tonCanDeselect: function(inIndex){\r\n\t\treturn this.grid.onCanDeselect(inIndex);\r\n\t},\r\n\r\n\tonSelected: function(inIndex){\r\n\t},\r\n\r\n\tonDeselected: function(inIndex){\r\n\t},\r\n\r\n\t//onSetSelected: function(inIndex, inSelect) { };\r\n\tonChanging: function(){\r\n\t},\r\n\r\n\tonChanged: function(){\r\n\t},\r\n\r\n\tisSelected: function(inIndex){\r\n\t\tif(this.mode == 'none'){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn this.selected[inIndex];\r\n\t},\r\n\r\n\tgetFirstSelected: function(){\r\n\t\tif(!this.selected.length||this.mode == 'none'){ return -1; }\r\n\t\tfor(var i=0, l=this.selected.length; i<l; i++){\r\n\t\t\tif(this.selected[i]){\r\n\t\t\t\treturn i;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn -1;\r\n\t},\r\n\r\n\tgetNextSelected: function(inPrev){\r\n\t\tif(this.mode == 'none'){ return -1; }\r\n\t\tfor(var i=inPrev+1, l=this.selected.length; i<l; i++){\r\n\t\t\tif(this.selected[i]){\r\n\t\t\t\treturn i;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn -1;\r\n\t},\r\n\r\n\tgetSelected: function(){\r\n\t\tvar result = [];\r\n\t\tfor(var i=0, l=this.selected.length; i<l; i++){\r\n\t\t\tif(this.selected[i]){\r\n\t\t\t\tresult.push(i);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t},\r\n\r\n\tgetSelectedCount: function(){\r\n\t\tvar c = 0;\r\n\t\tfor(var i=0; i<this.selected.length; i++){\r\n\t\t\tif(this.selected[i]){\r\n\t\t\t\tc++;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn c;\r\n\t},\r\n\r\n\t_beginUpdate: function(){\r\n\t\tif(this.updating === 0){\r\n\t\t\tthis.onChanging();\r\n\t\t}\r\n\t\tthis.updating++;\r\n\t},\r\n\r\n\t_endUpdate: function(){\r\n\t\tthis.updating--;\r\n\t\tif(this.updating === 0){\r\n\t\t\tthis.onChanged();\r\n\t\t}\r\n\t},\r\n\r\n\tselect: function(inIndex){\r\n\t\tif(this.mode == 'none'){ return; }\r\n\t\tif(this.mode != 'multiple'){\r\n\t\t\tthis.deselectAll(inIndex);\r\n\t\t\tthis.addToSelection(inIndex);\r\n\t\t}else{\r\n\t\t\tthis.toggleSelect(inIndex);\r\n\t\t}\r\n\t},\r\n\r\n\taddToSelection: function(inIndex){\r\n\t\tif(this.mode == 'none'){ return; }\r\n\t\tif(lang.isArray(inIndex)){\r\n\t\t\tarray.forEach(inIndex, this.addToSelection, this);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tinIndex = Number(inIndex);\r\n\t\tif(this.selected[inIndex]){\r\n\t\t\tthis.selectedIndex = inIndex;\r\n\t\t}else{\r\n\t\t\tif(this.onCanSelect(inIndex) !== false){\r\n\t\t\t\tthis.selectedIndex = inIndex;\r\n\t\t\t\tvar rowNode = this.grid.getRowNode(inIndex);\r\n\t\t\t\tif(rowNode){\r\n\t\t\t\t\tdomAttr.set(rowNode, \"aria-selected\", \"true\");\r\n\t\t\t\t}\r\n\t\t\t\tthis._beginUpdate();\r\n\t\t\t\tthis.selected[inIndex] = true;\r\n\t\t\t\t//this.grid.onSelected(inIndex);\r\n\t\t\t\tthis.onSelected(inIndex);\r\n\t\t\t\t//this.onSetSelected(inIndex, true);\r\n\t\t\t\tthis._endUpdate();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tdeselect: function(inIndex){\r\n\t\tif(this.mode == 'none'){ return; }\r\n\t\tif(lang.isArray(inIndex)){\r\n\t\t\tarray.forEach(inIndex, this.deselect, this);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tinIndex = Number(inIndex);\r\n\t\tif(this.selectedIndex == inIndex){\r\n\t\t\tthis.selectedIndex = -1;\r\n\t\t}\r\n\t\tif(this.selected[inIndex]){\r\n\t\t\tif(this.onCanDeselect(inIndex) === false){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar rowNode = this.grid.getRowNode(inIndex);\r\n\t\t\tif(rowNode){\r\n\t\t\t\tdomAttr.set(rowNode, \"aria-selected\", \"false\");\r\n\t\t\t}\r\n\t\t\tthis._beginUpdate();\r\n\t\t\tdelete this.selected[inIndex];\r\n\t\t\t//this.grid.onDeselected(inIndex);\r\n\t\t\tthis.onDeselected(inIndex);\r\n\t\t\t//this.onSetSelected(inIndex, false);\r\n\t\t\tthis._endUpdate();\r\n\t\t}\r\n\t},\r\n\r\n\tsetSelected: function(inIndex, inSelect){\r\n\t\tthis[(inSelect ? 'addToSelection' : 'deselect')](inIndex);\r\n\t},\r\n\r\n\ttoggleSelect: function(inIndex){\r\n\t\tif(lang.isArray(inIndex)){\r\n\t\t\tarray.forEach(inIndex, this.toggleSelect, this);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.setSelected(inIndex, !this.selected[inIndex]);\r\n\t},\r\n\r\n\t_range: function(inFrom, inTo, func){\r\n\t\tvar s = (inFrom >= 0 ? inFrom : inTo), e = inTo;\r\n\t\tif(s > e){\r\n\t\t\te = s;\r\n\t\t\ts = inTo;\r\n\t\t}\r\n\t\tfor(var i=s; i<=e; i++){\r\n\t\t\tfunc(i);\r\n\t\t}\r\n\t},\r\n\r\n\tselectRange: function(inFrom, inTo){\r\n\t\tthis._range(inFrom, inTo, lang.hitch(this, \"addToSelection\"));\r\n\t},\r\n\r\n\tdeselectRange: function(inFrom, inTo){\r\n\t\tthis._range(inFrom, inTo, lang.hitch(this, \"deselect\"));\r\n\t},\r\n\r\n\tinsert: function(inIndex){\r\n\t\tthis.selected.splice(inIndex, 0, false);\r\n\t\tif(this.selectedIndex >= inIndex){\r\n\t\t\tthis.selectedIndex++;\r\n\t\t}\r\n\t},\r\n\r\n\tremove: function(inIndex){\r\n\t\tthis.selected.splice(inIndex, 1);\r\n\t\tif(this.selectedIndex >= inIndex){\r\n\t\t\tthis.selectedIndex--;\r\n\t\t}\r\n\t},\r\n\r\n\tdeselectAll: function(inExcept){\r\n\t\tfor(var i in this.selected){\r\n\t\t\tif((i!=inExcept)&&(this.selected[i]===true)){\r\n\t\t\t\tthis.deselect(i);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tclickSelect: function(inIndex, inCtrlKey, inShiftKey){\r\n\t\tif(this.mode == 'none'){ return; }\r\n\t\tthis._beginUpdate();\r\n\t\tif(this.mode != 'extended'){\r\n\t\t\tthis.select(inIndex);\r\n\t\t}else{\r\n\t\t\tif(!inShiftKey || this.rangeStartIndex < 0){\r\n\t\t\t\tthis.rangeStartIndex = inIndex;\r\n\t\t\t}\r\n\t\t\tif(!inCtrlKey){\r\n\t\t\t\tthis.deselectAll(inIndex);\r\n\t\t\t}\r\n\t\t\tif(inShiftKey){\r\n\t\t\t\tthis.selectRange(this.rangeStartIndex, inIndex);\r\n\t\t\t}else if(inCtrlKey){\r\n\t\t\t\tthis.toggleSelect(inIndex);\r\n\t\t\t}else{\r\n\t\t\t\tthis.addToSelection(inIndex);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis._endUpdate();\r\n\t},\r\n\r\n\tclickSelectEvent: function(e){\r\n\t\tthis.clickSelect(e.rowIndex, dojo.isCopyKey(e), e.shiftKey);\r\n\t},\r\n\r\n\tclear: function(){\r\n\t\tthis._beginUpdate();\r\n\t\tthis.deselectAll();\r\n\t\tthis._endUpdate();\r\n\t}\r\n});\r\n});"]}