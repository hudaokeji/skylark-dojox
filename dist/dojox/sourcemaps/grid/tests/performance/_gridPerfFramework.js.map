{"version":3,"sources":["grid/tests/performance/_gridPerfFramework.js"],"names":["dojo","require","provide","data_list","col1","col2","col3","col4","col5","col6","col7","default_obj","rows","layout","rowSelector","doProfiling","stores","setObject","numRows","force","data","identifier","label","items","i","l","length","push","mixin","id","ItemFileWriteStore","type","toLowerCase","cells","name","field","width","noscroll","defaultObj","p","window","location","search","replace","split","o","forEach","b","clone","getRunFunction","getSetUpFunction","getTearDownFunction","isTop","top","obj","searchParamsAsObj","parseInt","isMoz","t","runTest","setUp","tearDown","tests","_buttonsAdded","n","query","create","innerHTML","value","size","onchange","v","this","isNaN","onclick","testType","trialDuration","trialIterations","trialDelay"],"mappings":"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","file":"../../../../grid/tests/performance/_gridPerfFramework.js","sourcesContent":["dojo.require(\"dojo.data.ItemFileWriteStore\");\r\ndojo.provide(\"dojox.grid.tests.performance._gridPerfFramework\");\r\n\r\n(function(){\r\n\t// some sample data\r\n\tvar data_list = [\r\n\t\t{ col1: \"normal\", col2: false, col3: \"new\", col4: 'But are not followed by two hexadecimal', col5: 29.91, col6: 10, col7: false },\r\n\t\t{ col1: \"important\", col2: false, col3: \"new\", col4: 'Because a % sign always indicates', col5: 9.33, col6: -5, col7: false },\r\n\t\t{ col1: \"important\", col2: true, col3: \"read\", col4: 'Signs can be selectively', col5: 19.34, col6: 0, col7: true },\r\n\t\t{ col1: \"note\", col2: false, col3: \"read\", col4: 'However the reserved characters', col5: 15.63, col6: 0, col7: true },\r\n\t\t{ col1: \"normal\", col2: true, col3: \"replied\", col4: 'It is therefore necessary', col5: 24.22, col6: 5.50, col7: true },\r\n\t\t{ col1: \"important\", col2: false, col3: \"replied\", col4: 'To problems of corruption by', col5: 9.12, col6: -3, col7: true },\r\n\t\t{ col1: \"note\", col2: false, col3: \"replied\", col4: 'Which would simply be awkward in', col5: 12.15, col6: -4, col7: false }\r\n\t];\r\n\t\r\n\t// default querystring values\r\n\tvar default_obj = {rows: \"100\", layout: \"single\", rowSelector: \"false\", doProfiling: \"false\"};\r\n\r\n\t// values for the performance tests\r\n\tvar iterations = 100;\r\n\tvar duration = 100;\r\n\tvar delay = 100;\r\n\t\r\n\t// Store functions\r\n\tvar stores = {};\r\n\tdojo.setObject(\"getStore\", function(numRows, force){\r\n\t\tif(force){\r\n\t\t\tdelete stores[numRows];\r\n\t\t}\r\n\t\tif(!stores[numRows]){\r\n\t\t\tvar data = {\r\n\t\t\t\tidentifier: 'id',\r\n\t\t\t\tlabel: 'id',\r\n\t\t\t\titems: []\r\n\t\t\t};\r\n\t\t\tfor(var i=0, l=data_list.length; i<numRows; i++){\r\n\t\t\t\tdata.items.push(dojo.mixin({ id: i }, data_list[i%l]));\r\n\t\t\t}\r\n\t\t\tstores[numRows] = new dojo.data.ItemFileWriteStore({data: data});\r\n\t\t}\r\n\t\treturn stores[numRows];\r\n\t});\r\n\t\r\n\t// Layout generation functions\r\n\tdojo.setObject(\"getLayout\", function(type){\r\n\t\tswitch (type.toLowerCase()){\r\n\t\t\tcase \"dual\":\r\n\t\t\t\treturn [{\r\n\t\t\t\t\tcells: [\r\n\t\t\t\t\t\t{name: 'Column 0', field: 'id',   width: '100px' },\r\n\t\t\t\t\t\t{name: 'Column 1', field: 'col1', width: '100px' },\r\n\t\t\t\t\t\t{name: 'Column 2', field: 'col2', width: '100px' },\r\n\t\t\t\t\t\t{name: 'Column 3', field: 'col3', width: '100px' }\r\n\t\t\t\t\t],\r\n\t\t\t\t\tnoscroll: true\r\n\t\t\t\t},{\r\n\t\t\t\t\tcells: [\r\n\t\t\t\t\t\t{name: 'Column 4', field: 'col4', width: '300px' },\r\n\t\t\t\t\t\t{name: 'Column 5', field: 'col5', width: '150px' },\r\n\t\t\t\t\t\t{name: 'Column 6', field: 'col6', width: '150px' },\r\n\t\t\t\t\t\t{name: 'Column 7', field: 'col7', width: '150px' },\r\n\t\t\t\t\t\t{name: 'Column 8', field: 'col8', width: '150px' }\r\n\t\t\t\t\t]\r\n\t\t\t\t}];\r\n\t\t\tcase \"single\":\r\n\t\t\tdefault:\r\n\t\t\t\treturn [\r\n\t\t\t\t\t[\r\n\t\t\t\t\t\t{ name: 'Column 0', field: 'id',   width: '10%' },\r\n\t\t\t\t\t\t{ name: 'Column 1', field: 'col1', width: '10%' },\r\n\t\t\t\t\t\t{ name: 'Column 2', field: 'col2', width: '10%' },\r\n\t\t\t\t\t\t{ name: 'Column 3', field: 'col3', width: '10%' },\r\n\t\t\t\t\t\t{ name: 'Column 4', field: 'col4', width: '20%' },\r\n\t\t\t\t\t\t{ name: 'Column 5', field: 'col5', width: '10%' },\r\n\t\t\t\t\t\t{ name: 'Column 6', field: 'col6', width: '10%' },\r\n\t\t\t\t\t\t{ name: 'Column 7', field: 'col7', width: '10%' },\r\n\t\t\t\t\t\t{ name: 'Column 8', field: 'col3', width: '10%' }\r\n\t\t\t\t\t]\r\n\t\t\t\t];\r\n\t\t}\r\n\t});\r\n\r\n\t// Returns the parameters in the query string as an object\r\n\t// It mixes in over the defaultObj you pass it - if you pass\r\n\t// true, it will mix in over the global default obj.\r\n\tdojo.setObject(\"searchParamsAsObj\", function(defaultObj){\r\n\t\tvar s = (window.location.search||\"\").replace(/^\\?/, \"\");\r\n\t\tvar p = s.split(\"&\");\r\n\t\tvar o = {}\r\n\t\tdojo.forEach(p, function(i){\r\n\t\t\tvar b = i.split(\"=\");\r\n\t\t\to[b[0]] = b[1];\r\n\t\t});\r\n\t\tif(defaultObj === true){\r\n\t\t\tdefaultObj = default_obj;\r\n\t\t}\r\n\t\treturn dojo.mixin(dojo.clone(defaultObj||{}), o);\r\n\t});\r\n\t\r\n\t// Gets the tests for a row/layout/selector type test (the common one)\r\n\t// This parses the object and returns a single instance and either perf\r\n\t// tests (if run within the runner) or buttons for changing value (if\r\n\t// run directly)\r\n\t//\r\n\t// getRunFunction is the core function to call.  It gets the row, layout\r\n\t// and selector values, as well as a boolean if it's a perf function or\r\n\t// not.\r\n\tdojo.setObject(\"getRLSTests\", function(getRunFunction, getSetUpFunction, getTearDownFunction){\r\n\t\tvar isTop = (window.top == window);\r\n\t\tvar obj = searchParamsAsObj(default_obj);\r\n\t\tvar rows = parseInt(obj.rows, 10);\r\n\t\tvar layout = obj.layout;\r\n\t\tvar rowSelector = (obj.rowSelector.toLowerCase() == \"true\");\r\n\t\tvar doProfiling = isTop && dojo.isMoz && obj.doProfiling.toLowerCase() == \"true\";\r\n\t\tvar name = layout + \" Layout\" + (rowSelector ? \" w/ Row Selector\" : \"\");\r\n\t\tvar t = {\r\n\t\t\tname: name,\r\n\t\t\trunTest: getRunFunction(rows, layout, rowSelector, doProfiling, false)\r\n\t\t};\r\n\t\tif(getSetUpFunction){\r\n\t\t\tt.setUp = getSetUpFunction(rows, layout, rowSelector, doProfiling, false);\r\n\t\t}\r\n\t\tif(getTearDownFunction){\r\n\t\t\tt.tearDown = getTearDownFunction(rows, layout, rowSelector, doProfiling, false);\r\n\t\t}\r\n\t\tvar tests = [ t ];\r\n\t\tif(isTop && !window._buttonsAdded){\r\n\t\t\t// Give buttons amd text boxes for changing views/rows/etc\r\n\t\t\tvar n = dojo.query(\".heading\")[0];\r\n\t\t\tn = dojo.create(\"span\", {innerHTML: \"Rows: \"}, n, \"after\");\r\n\t\t\tn = dojo.create(\"input\", {\r\n\t\t\t\ttype: \"text\",\r\n\t\t\t\tvalue: rows,\r\n\t\t\t\tsize: 5,\r\n\t\t\t\tonchange: function(){\r\n\t\t\t\t\tv = parseInt(this.value, 10);\r\n\t\t\t\t\tif(v && !isNaN(v)){\r\n\t\t\t\t\t\twindow.location.search=\"?rows=\" + v +\r\n\t\t\t\t\t\t\t\t\"&layout=\" + layout +\r\n\t\t\t\t\t\t\t\t\"&rowSelector=\" + (rowSelector ? \"true\" : \"false\") +\r\n\t\t\t\t\t\t\t\t\"&doProfiling=\" + (doProfiling ? \"true\" : \"false\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}, n, \"after\");\r\n\t\t\tn = dojo.create(\"button\", {\r\n\t\t\t\tinnerHTML: layout == \"single\" ? \"Dual Layout\" : \"Single Layout\",\r\n\t\t\t\tonclick: function(){window.location.search=\"?rows=\" + rows +\r\n\t\t\t\t\t\t\t\t\"&layout=\" + (layout == \"single\" ? \"dual\" : \"single\") +\r\n\t\t\t\t\t\t\t\t\"&rowSelector=\" + (rowSelector ? \"true\" : \"false\") +\r\n\t\t\t\t\t\t\t\t\"&doProfiling=\" + (doProfiling ? \"true\" : \"false\")}\r\n\t\t\t}, n, \"after\");\r\n\t\t\tn = dojo.create(\"button\", {\r\n\t\t\t\tinnerHTML: rowSelector ? \"Remove Row Selector\" : \"Add Row Selector\",\r\n\t\t\t\tonclick: function(){window.location.search=\"?rows=\" + rows +\r\n\t\t\t\t\t\t\t\t\"&layout=\" + layout +\r\n\t\t\t\t\t\t\t\t\"&rowSelector=\" + (!rowSelector ? \"true\" : \"false\") +\r\n\t\t\t\t\t\t\t\t\"&doProfiling=\" + (doProfiling ? \"true\" : \"false\")}\r\n\t\t\t}, n, \"after\");\r\n\t\t\tif(dojo.isMoz){\r\n\t\t\t\tn = dojo.create(\"button\", {\r\n\t\t\t\t\tinnerHTML: doProfiling ? \"No Profiling\" : \"Do Profiling\",\r\n\t\t\t\t\tonclick: function(){window.location.search=\"?rows=\" + rows +\r\n\t\t\t\t\t\t\t\t\t\"&layout=\" + layout +\r\n\t\t\t\t\t\t\t\t\t\"&rowSelector=\" + (rowSelector ? \"true\" : \"false\") +\r\n\t\t\t\t\t\t\t\t\t\"&doProfiling=\" + (!doProfiling ? \"true\" : \"false\")}\r\n\t\t\t\t}, n, \"after\");\r\n\t\t\t}\r\n\t\t\twindow._buttonsAdded = true;\r\n\t\t}else if (!isTop){\r\n\t\t\t// Only run the perf tests if we are within the runner (which\r\n\t\t\t// gives us pretty graphs and statistics...)\r\n\t\t\tt = {\r\n\t\t\t\tname: \"Perf \" + name,\r\n\t\t\t\ttestType: \"perf\",\r\n\t\t\t\ttrialDuration: duration,\r\n\t\t\t\ttrialIterations: iterations,\r\n\t\t\t\ttrialDelay: delay,\r\n\t\t\t\trunTest: getRunFunction(rows, layout, rowSelector, doProfiling, true)\r\n\t\t\t}\r\n\t\t\tif(getSetUpFunction){\r\n\t\t\t\tt.setUp = getSetUpFunction(rows, layout, rowSelector, doProfiling, true);\r\n\t\t\t}\r\n\t\t\tif(getTearDownFunction){\r\n\t\t\t\tt.tearDown = getTearDownFunction(rows, layout, rowSelector, doProfiling, true);\r\n\t\t\t}\r\n\t\t\ttests.push(t);\r\n\t\t}\r\n\t\treturn tests;\r\n\t})\r\n\r\n})();\r\n"]}