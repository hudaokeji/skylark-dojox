{"version":3,"sources":["calc/GraphPro.js"],"names":["define","declare","lang","win","domStyle","domConstruct","domGeometry","ready","Standard","calc","FloatingPane","template","templateString","grapher","funcMaker","aFloatingPane","executorLoaded","this","inherited","arguments","hitch","writeStore","set","functionMakerButton","domNode","visibility","makeFunctionWindow","body","pane","create","appendChild","dojox","layout","resizable","dockable","maxable","closable","duration","title","style","d","FuncGen","readStore","functions","deleteFunction","executor","onSaved","name","combo","get","status","textarea","args","item","put","saveFunction","startup","bringToTop","makeGrapherWindow","that","Grapher","myPane","drawOne","i","array","chartIndex","resize","graphWidth","graphHeight","axes","max","graphMaxX","expressionIndex","func","yEquals","functionMode","evaluatedExpression","Function","value","functionRef","pickedColor","colorIndex","draw","graphNumber","funcNumberIndex","fOfX","color","stroke","setStatus","onDraw","rowCount","dirty","checkboxIndex","statusIndex","innerHTML","bufferY","position","outerDiv","y","Math","abs","height","parseInt","scrollHeight","width","scrollWidth","w","h"],"mappings":"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","file":"../../calc/GraphPro.js","sourcesContent":["define([\r\n\t\"dojo/_base/declare\",\r\n\t\"dojo/_base/lang\",\r\n\t\"dojo/_base/window\",\r\n\t\"dojo/dom-style\",\r\n\t\"dojo/dom-construct\",\r\n\t\"dojo/dom-geometry\",\r\n\t\"dojo/ready\",\r\n\t\"dojox/calc/Standard\",\r\n\t\"dojox/calc/Grapher\",\r\n\t\"dojox/layout/FloatingPane\",\r\n\t\"dojo/text!./templates/GraphPro.html\",\r\n\t\"dojox/calc/_Executor\", // template\r\n\t\"dijit/Menu\", // template\r\n\t\"dijit/MenuItem\", // template\r\n\t\"dijit/form/ComboButton\", // template\r\n\t\"dijit/form/Button\", // template\r\n\t\"dijit/form/TextBox\" // template\r\n], function(declare, lang, win, domStyle, domConstruct, domGeometry, ready, Standard, calc, FloatingPane, template){\r\n\r\n\r\n\treturn declare(\r\n\t\t\"dojox.calc.GraphPro\",\r\n\t\tStandard,\r\n\t{\r\n\t\t// summary:\r\n\t\t//\t\tThe dialog widget for a graphing, scientific calculator\r\n\r\n\t\ttemplateString: template,\r\n\r\n\t\tgrapher:null,\r\n\t\tfuncMaker:null,\r\n\t\taFloatingPane: null,\r\n\r\n\t\texecutorLoaded: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\twhen executor loads check to see if the writestore is there\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\tready(lang.hitch(this, function(){\r\n\t\t\t\tif(this.writeStore == null && \"functionMakerButton\" in this){\r\n\t\t\t\t\tdomStyle.set(this.functionMakerButton.domNode, { visibility: \"hidden\" });\r\n\t\t\t\t}\r\n\t\t\t}));\r\n\t\t},\r\n\t\tmakeFunctionWindow: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tuse this function to create a function window (with the button on the layout)\r\n\t\t\tvar body = win.body();\r\n\r\n\t\t\tvar pane = domConstruct.create('div');\r\n\t\t\tbody.appendChild(pane);\r\n\r\n\t\t\tthis.aFloatingPane = new dojox.layout.FloatingPane({resizable:false, dockable:true, maxable:false, closable:true, duration:300, title:\"Function Window\", style:\"position:absolute;left:10em;top:10em;width:50em;\"}, pane);\r\n\t\t\tvar that = this;\r\n\t\t\tvar d = domConstruct.create(\"div\");\r\n\t\t\tthis.funcMaker = new calc.FuncGen({\r\n\t\t\t\twriteStore:that.writeStore,\r\n\t\t\t\treadStore:that.readStore,\r\n\t\t\t\tfunctions:that.functions,\r\n\t\t\t\tdeleteFunction: that.executor.deleteFunction,\r\n\t\t\t\tonSaved:function(){\r\n\t\t\t\t\tvar\tname,\r\n\t\t\t\t\t\tbody;\r\n\t\t\t\t\tif((name = this.combo.get(\"value\")) == \"\"){\r\n\t\t\t\t\t\tthis.status.set(\"value\", \"The function needs a name\");\r\n\t\t\t\t\t}else if((body = this.textarea.get(\"value\")) == \"\"){\r\n\t\t\t\t\t\t// i don't think users need empty functions for math\r\n\t\t\t\t\t\tthis.status.set(\"value\", \"The function needs a body\");\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tvar args = this.args.get(\"value\");\r\n\t\t\t\t\t\tif(!(name in this.functions)){\r\n\t\t\t\t\t\t\tthis.combo.item = this.writeStore.put({name: name, args: args, body: body});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.saveFunction(name, args, body);\r\n\t\t\t\t\t\tthis.status.set(\"value\", \"Function \"+name+\" was saved\");\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tsaveFunction: lang.hitch(that, that.saveFunction)\r\n\t\t\t}, d);\r\n\t\t\tthis.aFloatingPane.set('content', this.funcMaker);\r\n\t\t\tthis.aFloatingPane.startup();\r\n\t\t\tthis.aFloatingPane.bringToTop();\r\n\t\t},\r\n\t\tmakeGrapherWindow: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tuse this to make a Grapher window appear with a button\r\n\t\t\tvar body = win.body();\r\n\r\n\t\t\tvar pane = domConstruct.create('div');\r\n\t\t\tbody.appendChild(pane);\r\n\r\n\t\t\tthis.aFloatingPane = new dojox.layout.FloatingPane({resizable:false, dockable:true, maxable:false, closable:true, duration:300, title:\"Graph Window\", style:\"position:absolute;left:10em;top:5em;width:50em;\"}, pane);\r\n\t\t\tvar that = this;\r\n\r\n\t\t\tvar d = domConstruct.create(\"div\");\r\n\t\t\tthis.grapher = new calc.Grapher({\r\n\t\t\t\tmyPane: this.aFloatingPane,\r\n\t\t\t\tdrawOne: function(i){\r\n\t\t\t\t\tthis.array[i][this.chartIndex].resize(this.graphWidth.get(\"value\"), this.graphHeight.get(\"value\"));\r\n\t\t\t\t\tthis.array[i][this.chartIndex].axes[\"x\"].max = this.graphMaxX.get('value');\r\n\t\t\t\t\tif(this.array[i][this.expressionIndex].get(\"value\")==\"\"){\r\n\t\t\t\t\t\tthis.setStatus(i, \"Error\");\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar func;\r\n\t\t\t\t\tvar yEquals = (this.array[i][this.functionMode]==\"y=\");\r\n\t\t\t\t\tif(this.array[i][this.expressionIndex].get(\"value\")!=this.array[i][this.evaluatedExpression]){\r\n\t\t\t\t\t\tvar args = 'x';\r\n\t\t\t\t\t\tif(!yEquals){\r\n\t\t\t\t\t\t\targs = 'y';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfunc = that.executor.Function('', args, \"return \"+this.array[i][this.expressionIndex].get('value'));\r\n\t\t\t\t\t\tthis.array[i][this.evaluatedExpression] = this.array[i][this.expressionIndex].value;\r\n\t\t\t\t\t\tthis.array[i][this.functionRef] = func;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tfunc = this.array[i][this.functionRef];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar pickedColor = this.array[i][this.colorIndex].get(\"value\");\r\n\t\t\t\t\tif(!pickedColor){\r\n\t\t\t\t\t\tpickedColor = 'black';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcalc.draw(this.array[i][this.chartIndex], func, {graphNumber:this.array[i][this.funcNumberIndex], fOfX:yEquals, color:{stroke:{color:pickedColor}}});\r\n\t\t\t\t\tthis.setStatus(i, \"Drawn\");\r\n\t\t\t\t},\r\n\t\t\t\tonDraw:function(){\r\n\t\t\t\t\tfor(var i = 0; i < this.rowCount; i++){\r\n\t\t\t\t\t\tif((!this.dirty && this.array[i][this.checkboxIndex].get(\"checked\")) || (this.dirty && this.array[i][this.statusIndex].innerHTML==\"Drawn\")){\r\n\t\t\t\t\t\t\tthis.drawOne(i);\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tthis.array[i][this.chartIndex].resize(this.graphWidth.get(\"value\"), this.graphHeight.get(\"value\"));\r\n\t\t\t\t\t\t\tthis.array[i][this.chartIndex].axes[\"x\"].max = this.graphMaxX.get('value');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar bufferY = domGeometry.position(this.outerDiv).y-domGeometry.position(this.myPane.domNode).y;\r\n\t\t\t\t\tbufferY*=2;\r\n\t\t\t\t\tbufferY=Math.abs(bufferY);\r\n\t\t\t\t\tvar height = \"\" + Math.max(parseInt(this.graphHeight.get('value'))+50, this.outerDiv.scrollHeight+bufferY);\r\n\t\t\t\t\tvar width = \"\" + (parseInt(this.graphWidth.get('value')) + this.outerDiv.scrollWidth);\r\n\t\t\t\t\tthis.myPane.resize({w:width, h:height});\r\n\t\t\t\t}\r\n\t\t\t}, d);\r\n\t\t\tthis.aFloatingPane.set('content', this.grapher);\r\n\t\t\tthis.aFloatingPane.startup();\r\n\t\t\tthis.aFloatingPane.bringToTop();\r\n\t\t}\r\n\t});\r\n});\r\n"]}