{"version":3,"sources":["calc/Standard.js"],"names":["define","declare","lang","has","win","event","domStyle","ready","keys","registry","typematic","WidgetBase","WidgetsInTemplateMixin","TemplatedMixin","_TextBoxMixin","math","TooltipDialog","template","calc","templateString","readStore","writeStore","functions","executorLoaded","hitch","this","loadStore","saveFunction","name","args","body","executor","normalizedFunction","store","isReadOnly","query","forEach","item","parseTextbox","text","textboxWidget","textbox","value","commandList","length","setTextboxValue","ans","eval","isNaN","push","print","commandIndex","hasDisplay","displayBox","scrollTop","scrollHeight","selectInputText","focus","cycleCommands","count","node","keyNum","charOrCode","UP_ARROW","cycleCommandUp","DOWN_ARROW","cycleCommandDown","onBlur","tr","doc","selection","createRange","duplicate","selectedText","ntr","createTextRange","move","setEndPoint","selectionEnd","selectionStart","String","replace","e","onKeyPress","ENTER","stop","get","putInAnsIfTextboxIsHighlighted","insertMinus","insertText","isRight","t","innerHTML","widget","val","set","document","range","clearText","insertOperator","newText","getEnclosingWidget","setTimeout","pos","cr","substring","match","handle","clearTimeout","select","postCreate","toFracButton","toFrac","domNode","visibility","functionMakerButton","FuncGen","grapherMakerButton","Grapher","_connects","addKeyListener","shiftKey","metaKey","ctrlKey","startup"],"mappings":"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","file":"../../calc/Standard.js","sourcesContent":["define([\r\n\t\"dojo/_base/declare\",\r\n\t\"dojo/_base/lang\",\r\n\t\"dojo/_base/sniff\",\r\n\t\"dojo/_base/window\",\r\n\t\"dojo/_base/event\",\r\n\t\"dojo/dom-style\",\r\n\t\"dojo/ready\",\r\n\t\"dojo/keys\",\r\n\t\"dijit/registry\",\r\n\t\"dijit/typematic\",\r\n\t\"dijit/_WidgetBase\",\r\n\t\"dijit/_WidgetsInTemplateMixin\",\r\n\t\"dijit/_TemplatedMixin\",\r\n\t\"dijit/form/_TextBoxMixin\",\r\n\t\"dojox/math/_base\",\r\n\t\"dijit/TooltipDialog\",\r\n\t\"dojo/text!./templates/Standard.html\",\r\n\t\"dojox/calc/_Executor\", // template\r\n\t\"dijit/Menu\", // template\r\n\t\"dijit/MenuItem\", // template\r\n\t\"dijit/form/ComboButton\", // template\r\n\t\"dijit/form/Button\", // template\r\n\t\"dijit/form/TextBox\" // template\r\n], function(declare, lang, has, win, event, domStyle, ready, keys, registry, typematic, WidgetBase, WidgetsInTemplateMixin, TemplatedMixin, _TextBoxMixin, math, TooltipDialog, template, calc){\r\n\r\n\treturn declare(\r\n\t\t\"dojox.calc.Standard\",\r\n\t\t[WidgetBase, TemplatedMixin, WidgetsInTemplateMixin],\r\n\t{\r\n\t\t// summary:\r\n\t\t//\t\tThe dialog layout for a standard 4 function/algebraic calculator\r\n\r\n\t\ttemplateString: template,\r\n\r\n\t\treadStore:null,\r\n\t\twriteStore:null,\r\n\t\tfunctions: [],\r\n\r\n\t\texecutorLoaded: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tload in the stores after executor is loaded (the stores need executor to be loaded because it parses them)\r\n\t\t\tready(lang.hitch(this, function(){\r\n\t\t\t\tthis.loadStore(this.readStore, true);\r\n\t\t\t\tthis.loadStore(this.writeStore);\r\n\t\t\t}));\r\n\t\t},\r\n\r\n\t\tsaveFunction: function(name, args, body){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tmake the function with executor\r\n\t\t\tthis.functions[name] = this.executor.normalizedFunction(name, args, body);\r\n\t\t\tthis.functions[name].args = args;\r\n\t\t\tthis.functions[name].body = body;\r\n\t\t},\r\n\r\n\t\tloadStore: function(store, isReadOnly){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tload an entire store, and make it publicly editable/viewable based on isReadOnly\r\n\t\t\tif(!store){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tstore.query({}).forEach(lang.hitch(this, function(item){\r\n\t\t\t\tlang.hitch(this, isReadOnly ? this.executor.normalizedFunction : this.saveFunction)(item.name, item.args, item.body);\r\n\t\t\t}));\r\n\t\t},\r\n\r\n\t\tparseTextbox: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tparse the contents of the textboxWidget and display the answer somewhere (depending on the layout)\r\n\t\t\tvar text = this.textboxWidget.textbox.value;\r\n\t\t\tif(text == \"\" && this.commandList.length > 0){\r\n\t\t\t\tthis.setTextboxValue(this.textboxWidget, this.commandList[this.commandList.length-1]);\r\n\t\t\t\ttext = this.textboxWidget.textbox.value;\r\n\t\t\t}\r\n\t\t\tif(text!=\"\"){\r\n\t\t\t\tvar ans = this.executor.eval(text);\r\n\r\n\t\t\t\tif((typeof ans == \"number\" && isNaN(ans))){\r\n\t\t\t\t\tif(this.commandList.length == 0 || this.commandList[this.commandList.length - 1] != text){\r\n\t\t\t\t\t\tthis.commandList.push(text);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.print(text, false);\r\n\t\t\t\t\tthis.print(\"Not a Number\", true);\r\n\t\t\t\t}else if(((typeof ans == \"object\" && \"length\" in ans) || typeof ans != \"object\") && typeof ans != \"function\" && ans != null){\r\n\t\t\t\t\tthis.executor.eval(\"Ans=\"+ans);\r\n\t\t\t\t\t// add it to the command list as well\r\n\t\t\t\t\tif(this.commandList.length == 0 || this.commandList[this.commandList.length - 1] != text){\r\n\t\t\t\t\t\tthis.commandList.push(text);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.print(text, false);\r\n\t\t\t\t\tthis.print(ans, true);\r\n\t\t\t\t}\r\n\t\t\t\tthis.commandIndex = this.commandList.length-1;\r\n\t\t\t\t//this.displayBox.textbox.scrollTop=this.displayBox.textbox.scrollHeight;\r\n\t\t\t\tif(this.hasDisplay){\r\n\t\t\t\t\tthis.displayBox.scrollTop=this.displayBox.scrollHeight;\r\n\t\t\t\t}\r\n\t\t\t\t//this.clearText();\r\n\t\t\t\t//this.textboxWidget.focus();\r\n\t\t\t\t_TextBoxMixin.selectInputText(this.textboxWidget.textbox);\r\n\r\n\t\t\t}else{\r\n\t\t\t\tthis.textboxWidget.focus();\r\n\t\t\t}\r\n\t\t},\r\n\t\tcycleCommands: function(count, node, event){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tCycle through the commands that the user has entered.\r\n\t\t\t//\t\tIt does not wrap around.\r\n\t\t\tif(count == -1 || this.commandList.length==0){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar keyNum = event.charOrCode;\r\n\t\t\t//up arrow\r\n\t\t\tif(keyNum == keys.UP_ARROW){\r\n\t\t\t\tthis.cycleCommandUp();\r\n\t\t\t}else if(keyNum == keys.DOWN_ARROW){\r\n\t\t\t\tthis.cycleCommandDown();\r\n\t\t\t}\r\n\t\t},\r\n\t\tcycleCommandUp: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tcycle up through the list of commands the user has entered already\r\n\t\t\tif(this.commandIndex-1<0){\r\n\t\t\t\tthis.commandIndex=0;\r\n\t\t\t}else{\r\n\t\t\t\tthis.commandIndex--;\r\n\t\t\t}\r\n\t\t\tthis.setTextboxValue(this.textboxWidget, this.commandList[this.commandIndex]);\r\n\t\t},\r\n\t\tcycleCommandDown: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tcycle down through the list of commands the user has entered already\r\n\t\t\tif(this.commandIndex+1>=this.commandList.length){\r\n\t\t\t\tthis.commandIndex=this.commandList.length;\r\n\t\t\t\tthis.setTextboxValue(this.textboxWidget, \"\");\r\n\t\t\t}else{\r\n\t\t\t\tthis.commandIndex++;\r\n\t\t\t\tthis.setTextboxValue(this.textboxWidget, this.commandList[this.commandIndex]);\r\n\t\t\t}\r\n\r\n\t\t},\r\n\t\tonBlur: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tIE is lacking in function when it comes to the text boxes, so here, make it work like other browsers do by forcing a node.selectionStart and End onto it\r\n\t\t\tif(has('ie')){\r\n\t\t\t\tvar tr = win.doc.selection.createRange().duplicate();\r\n\t\t\t\tvar selectedText = tr.text || '';\r\n\t\t\t\tvar ntr = this.textboxWidget.textbox.createTextRange();\r\n\t\t\t\ttr.move(\"character\",0);\r\n\t\t\t\tntr.move(\"character\",0);\r\n\t\t\t\ttry{\r\n\t\t\t\t\tntr.setEndPoint(\"EndToEnd\", tr);\r\n\t\t\t\t\tthis.textboxWidget.textbox.selectionEnd = (this.textboxWidget.textbox.selectionStart = String(ntr.text).replace(/\\r/g,\"\").length) + selectedText.length;\r\n\r\n\t\t\t\t}catch(e){}\r\n\t\t\t}\r\n\t\t},\r\n\t\tonKeyPress: function(e){\r\n\t\t\t// summary:\r\n\t\t\t//\t\thandle key input for Enter and operators\r\n\t\t\tif(e.charOrCode == keys.ENTER){\r\n\t\t\t\tthis.parseTextbox();\r\n\t\t\t\t// stop form submissions\r\n\t\t\t\tevent.stop(e);\r\n\t\t\t}else if(e.charOrCode == '!' || e.charOrCode == '^' || e.charOrCode == '*' || e.charOrCode == '/' || e.charOrCode == '-' || e.charOrCode == '+'){\r\n\t\t\t\tif(has('ie')){\r\n\t\t\t\t\tvar tr = win.doc.selection.createRange().duplicate();\r\n\t\t\t\t\tvar selectedText = tr.text || '';\r\n\t\t\t\t\tvar ntr = this.textboxWidget.textbox.createTextRange();\r\n\t\t\t\t\ttr.move(\"character\",0);\r\n\t\t\t\t\tntr.move(\"character\",0);\r\n\t\t\t\t\ttry{\r\n\t\t\t\t\t\tntr.setEndPoint(\"EndToEnd\", tr);\r\n\t\t\t\t\t\tthis.textboxWidget.textbox.selectionEnd = (this.textboxWidget.textbox.selectionStart = String(ntr.text).replace(/\\r/g,\"\").length) + selectedText.length;\r\n\r\n\t\t\t\t\t}catch(e){}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(this.textboxWidget.get(\"value\")==\"\"){\r\n\t\t\t\t\tthis.setTextboxValue(this.textboxWidget, \"Ans\");\r\n\t\t\t\t}else if(this.putInAnsIfTextboxIsHighlighted(this.textboxWidget.textbox, event.charOrCode)){\r\n\t\t\t\t\tthis.setTextboxValue(this.textboxWidget, \"Ans\");//this.insertText(\"Ans\");\r\n\t\t\t\t\t// move the cursor to the end of \"Ans\"\r\n\t\t\t\t\t_TextBoxMixin.selectInputText(this.textboxWidget.textbox, this.textboxWidget.textbox.value.length, this.textboxWidget.textbox.value.length);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tinsertMinus: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tinsert a minus sign when they press (-) in the combo button\r\n\t\t\tthis.insertText('-');\r\n\t\t},\r\n\t\tprint: function(text, isRight){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tprint the answer (typically) to the display or the input box\r\n\t\t\tvar t = \"<span style='display:block;\";\r\n\t\t\tif(isRight){\r\n\t\t\t\tt += \"text-align:right;'>\";\r\n\t\t\t}else{\r\n\t\t\t\tt += \"text-align:left;'>\";\r\n\t\t\t}\r\n\t\t\tt += text+\"<br></span>\";\r\n\t\t\tif(this.hasDisplay){\r\n\t\t\t\tthis.displayBox.innerHTML += t;\r\n\t\t\t}else{// if there is not a display box, put the answer in the input box\r\n\t\t\t\tthis.setTextboxValue(this.textboxWidget, text);\r\n\t\t\t}\r\n\t\t\t//this.setTextboxValue(this.displayBox, this.displayBox.get('value')+'\\n'+text);\r\n\t\t},\r\n\t\tsetTextboxValue: function(widget, val){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tset a widget's value\r\n\t\t\twidget.set('value', val);\r\n\t\t},\r\n\t\tputInAnsIfTextboxIsHighlighted: function(node){\r\n\t\t\t// summary:\r\n\t\t\t//\t\ttry seeing if the textbox is highlighted completely so you know if Ans should be put in for an operator like +\r\n\r\n\t\t\t//console.log(\"Entered \"+node.selectionStart + \" \"+ node.selectionEnd);\r\n\t\t\tif(typeof node.selectionStart == \"number\"){ // not-IE\r\n\t\t\t\tif(node.selectionStart==0 && node.selectionEnd == node.value.length){\r\n\t\t\t\t\t//node.value = \"Ans\";\r\n\t\t\t\t\t//dijit.selectInputText(node, node.value.length, node.value.length);\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}else if(document.selection){ // IE\r\n\t\t\t\t//console.log(\"Entered 2\");\r\n\t\t\t\tvar range = document.selection.createRange();\r\n\t\t\t\t//console.log(\"Range: \"+range.text +\" Node: \"+node.value);\r\n\t\t\t\tif(node.value == range.text){\r\n\t\t\t\t\t//this.insertText(\"Ans\");\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\tclearText: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tthis clears the input box if it has content, but if it does not it clears the display\r\n\t\t\tif(this.hasDisplay && this.textboxWidget.get('value')==\"\"){\r\n\t\t\t\tthis.displayBox.innerHTML = \"\";//this.setTextboxValue(this.displayBox, \"\");\r\n\t\t\t}else{\r\n\t\t\t\tthis.setTextboxValue(this.textboxWidget, \"\");\r\n\t\t\t}\r\n\t\t\tthis.textboxWidget.focus();\r\n\t\t},\r\n\t\t/*insertMinusSign: function(){\r\n\t\t\t//\r\n\t\t\tvar v = this.subtract.get('label');\r\n\t\t\tif(v != '(-)' && this.putInAnsIfTextboxIsHighlighted(this.textboxWidget.textbox)){\r\n\t\t\t\tthis.insertText(\"Ans-\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.insertText('-');\r\n\t\t},*/\r\n\t\tinsertOperator: function(newText){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tinsert an operator with a button\r\n\t\t\tif(typeof newText == \"object\"){\r\n\t\t\t\tnewText = newText = registry.getEnclosingWidget(newText[\"target\"]).value;\r\n\t\t\t}\r\n\t\t\tif(this.textboxWidget.get(\"value\") == \"\" || this.putInAnsIfTextboxIsHighlighted(this.textboxWidget.textbox)){\r\n\t\t\t\tnewText = \"Ans\"+newText;\r\n\t\t\t}\r\n\t\t\tthis.insertText(newText);\r\n\t\t},\r\n\t\tinsertText: function(newText){//(node, newText){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tinsert text to the textboxWidget node\r\n\t\t\tsetTimeout(lang.hitch(this, function(){\r\n\r\n\t\t\tvar node = this.textboxWidget.textbox;\r\n\t\t\tif(node.value==\"\"){\r\n\t\t\t\tnode.selectionStart = 0;\r\n\t\t\t\tnode.selectionEnd = 0;\r\n\t\t\t}\r\n\t\t\tif(typeof newText == \"object\"){\r\n\t\t\t\tnewText = newText = registry.getEnclosingWidget(newText[\"target\"]).value;\r\n\t\t\t}\r\n\r\n\t\t\tvar value = node.value.replace(/\\r/g,'');\r\n\t\t\tif(typeof node.selectionStart == \"number\"){ // not-IE\r\n\t\t\t        var pos = node.selectionStart;\r\n\t\t\t        var cr = 0;\r\n\t\t        \tif(has('opera')){\r\n\t\t                \tcr = (node.value.substring(0,pos).match(/\\r/g) || []).length;\r\n\t\t\t        }\r\n\t\t\t        node.value = value.substring(0, node.selectionStart-cr) + newText + value.substring(node.selectionEnd-cr);\r\n\t\t\t\tnode.focus();\r\n\t\t\t\tpos += newText.length;\r\n\t\t\t        //node.setSelectionRange(pos, pos);\r\n\t\t\t\t_TextBoxMixin.selectInputText(this.textboxWidget.textbox, pos, pos);\r\n\t\t\t}else if(document.selection){ // IE\r\n\t\t\t\tif(this.handle){\r\n\t\t\t\t\tclearTimeout(this.handle);\r\n\t\t\t\t\tthis.handle = null;\r\n\t\t\t\t}\r\n\t\t\t\tnode.focus();\r\n\t\t\t\tthis.handle = setTimeout(function(){\r\n\t\t\t        \tvar range = document.selection.createRange();\r\n\t\t\t\t        range.text = newText;\r\n\t\t\t\t        // show cursor\r\n\t\t        \t\trange.select();\r\n\t\t\t\t\tthis.handle = null;\r\n\t\t\t\t}, 0);\r\n\r\n\t\t\t}\r\n\t\t\t}), 0);\r\n\t\t},\r\n\t\thasDisplay: false,\r\n\t\tpostCreate: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\trun startup, see if there is an upper display box, etc\r\n\t\t\tthis.handle = null;\r\n\t\t\tthis.commandList = [];\r\n\t\t\tthis.commandIndex = 0;\r\n\r\n\t\t\tif(this.displayBox){\r\n\t\t\t\tthis.hasDisplay = true;\r\n\t\t\t}\r\n\t\t\tif(this.toFracButton && !calc.toFrac){\r\n\t\t\t\tdomStyle.set(this.toFracButton.domNode, { visibility: \"hidden\" });\r\n\t\t\t}\r\n\t\t\tif(this.functionMakerButton && !calc.FuncGen){\r\n\t\t\t\tdomStyle.set(this.functionMakerButton.domNode, { visibility: \"hidden\" });\r\n\t\t\t}\r\n\t\t\tif(this.grapherMakerButton && !calc.Grapher){\r\n\t\t\t\tdomStyle.set(this.grapherMakerButton.domNode, { visibility: \"hidden\" });\r\n\t\t\t}\r\n\t\t\tthis._connects.push(typematic.addKeyListener(this.textboxWidget.textbox,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcharOrCode:keys.UP_ARROW,\r\n\t\t\t\t\t\tshiftKey:false,\r\n\t\t\t\t\t\tmetaKey:false,\r\n\t\t\t\t\t\tctrlKey:false // ALT is optional since its unspecified\r\n\t\t\t\t\t},\r\n\t\t\t\t\tthis, this.cycleCommands, 200, 200));\r\n\t\t\tthis._connects.push(typematic.addKeyListener(this.textboxWidget.textbox,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcharOrCode:keys.DOWN_ARROW,\r\n\t\t\t\t\t\tshiftKey:false,\r\n\t\t\t\t\t\tmetaKey:false,\r\n\t\t\t\t\t\tctrlKey:false // ALT is optional since its unspecified\r\n\t\t\t\t\t},\r\n\t\t\t\t\tthis, this.cycleCommands, 200, 200));\r\n\r\n\r\n\t\t\t//onClick=\"this.insertText(document.getElementById('textbox'), '\\u221A')\"\r\n\t\t\t//this.sqrt.set(\"onClick\", lang.hitch(this, \"insertText\", this.textboxWidget, '\\u221A'));\r\n\t\t\t//this.pi.set(\"onClick\", lang.hitch(this, \"insertText\", this.textboxWidget, '\\u03C0'));\r\n\t\t\tthis.startup()\r\n\t\t}\r\n\t});\r\n\r\n});\r\n"]}