{"version":3,"sources":["analytics/Urchin.js"],"names":["define","lang","declare","window","config","construct","acct","constructor","args","this","tracker","mixin","urchin","re","gaHost","doc","location","protocol","h","getElementsByTagName","n","create","src","onload","onreadystatechange","hitch","e","type","test","readyState","_gotGA","removeChild","_gat","_getTracker","GAonLoad","apply","arguments","trackPageView","url","_trackPageview"],"mappings":";;;;;;;AAAAA,QAAQ,kBAAmB,qBAAsB,oBACzC,oBAAqB,sBAC1B,SAASC,EAAMC,EAASC,EAAQC,EAAQC,GAY1C,OAAOH,EAAQ,yBAA0B,MAuCxCI,KAAM,GAENC,YAAa,SAASC,GAKrBC,KAAKC,QAAU,KACfT,EAAKU,MAAMF,KAAMD,GACjBC,KAAKH,KAAOG,KAAKH,MAAQF,EAAOQ,OAEhC,IAAIC,EAAK,kBACRC,EAAU,UAAYX,EAAOY,IAAIC,SAASC,SAAY,eAAiB,cACvEC,EAAIf,EAAOY,IAAII,qBAAqB,QAAQ,GAC5CC,EAAIf,EAAUgB,OAAO,UACpBC,IAAKR,EAAS,8BACZI,GAEJE,EAAEG,OAASH,EAAEI,mBAAqBvB,EAAKwB,MAAMhB,KAAM,SAASiB,IACxDA,GAAe,QAAVA,EAAEC,MAAkBd,EAAGe,KAAKR,EAAES,eACrCT,EAAEG,OAASH,EAAEI,mBAAqB,KAClCf,KAAKqB,SACLZ,EAAEa,YAAYX,OAMjBU,OAAQ,WAGPrB,KAAKC,QAAUsB,KAAKC,YAAYxB,KAAKH,MACrCG,KAAKyB,SAASC,MAAM1B,KAAM2B,YAG3BF,SAAU,WAqBTzB,KAAK4B,iBAGNA,cAAe,SAAqBC,GAenC7B,KAAKC,QAAQ6B,eAAeJ,MAAM1B,KAAKC,QAAS0B","file":"../../analytics/Urchin.js","sourcesContent":["define([\"dojo/_base/lang\", \"dojo/_base/declare\", \"dojo/_base/window\",\r\n        \"dojo/_base/config\", \"dojo/dom-construct\"\r\n], function(lang, declare, window, config, construct){\r\n\r\n\t/*=====\r\n\tlang.mixin(config,{\r\n\t\t// urchin: String\r\n\t\t//\t\tUsed by `dojox.analytics.Urchin` as the default UA-123456-7 account\r\n\t\t//\t\tnumber used when being created. Alternately, you can pass an acct:\"\"\r\n\t\t//\t\tparameter to the constructor a la: new dojox.analytics.Urchin({ acct:\"UA-123456-7\" });\r\n\t\turchin: \"\"\r\n\t});\r\n\t=====*/\r\n\r\n\treturn declare(\"dojox.analytics.Urchin\", null, {\r\n\t\t// summary:\r\n\t\t//\t\tA Google-analytics helper, for post-onLoad inclusion of the tracker, and\r\n\t\t//\t\tdynamic tracking during long-lived page cycles.\r\n\t\t// description:\r\n\t\t//\t\tA small class object will allows for lazy-loading the Google Analytics API\r\n\t\t//\t\tat any point during a page lifecycle. Most commonly, Google-Analytics is loaded\r\n\t\t//\t\tvia a synchronous script tag in the body, which causes `dojo.addOnLoad` to\r\n\t\t//\t\tstall until the external API has been completely loaded. The Urchin helper\r\n\t\t//\t\twill load the API on the fly, and provide a convenient API to use, wrapping\r\n\t\t//\t\tAnalytics for Ajaxy or single page applications.\r\n\t\t//\r\n\t\t//\t\tThe class can be instantiated two ways: Programatically, by passing an\r\n\t\t//\t\t`acct:` parameter, or via Markup / dojoType and defining a djConfig\r\n\t\t//\t\tparameter `urchin:`\r\n\t\t//\r\n\t\t//\t\tIMPORTANT:\r\n\t\t//\t\tThis module will not work simultaneously with the core dojox.analytics\r\n\t\t//\t\tpackage. If you need the ability to run Google Analytics AND your own local\r\n\t\t//\t\tanalytics system, you MUST include dojox.analytics._base BEFORE dojox.analytics.Urchin\r\n\t\t// example:\r\n\t\t//\t|\t// create the tracker programatically:\r\n\t\t//\t|\tvar tracker = new dojox.analytics.Urchin({ acct:\"UA-123456-7\" });\r\n\t\t//\r\n\t\t// example:\r\n\t\t//\t|\t// define the urchin djConfig option:\r\n\t\t//\t|\tvar djConfig = { urchin: \"UA-123456-7\" };\r\n\t\t//\t|\r\n\t\t//\t|\t// and in markup:\r\n\t\t//\t|\t<div dojoType=\"dojox.analytics.Urchin\"></div>\r\n\t\t//\t|\t// or code:\r\n\t\t//\t|\tnew dojox.analytics.Urchin();\r\n\t\t//\r\n\t\t// example:\r\n\t\t//\t|\t// create and define all analytics with one tag.\r\n\t\t//\t|\t<div dojoType=\"dojox.analytics.Urchin\" acct=\"UA-12345-67\"></div>\r\n\r\n\t\t// acct: String\r\n\t\t//\t\tyour GA urchin tracker account number. Overrides `djConfig.urchin`\r\n\t\tacct: \"\",\r\n\r\n\t\tconstructor: function(args){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tInitialize this Urchin instance. Immediately starts the load\r\n\t\t\t//\t\tsequence, so defer construction until (ideally) after onLoad and\r\n\t\t\t//\t\tpotentially widget parsing.\r\n\t\t\tthis.tracker = null;\r\n\t\t\tlang.mixin(this, args);\r\n\t\t\tthis.acct = this.acct || config.urchin;\r\n\r\n\t\t\tvar re = /loaded|complete/,\r\n\t\t\t\tgaHost = (\"https:\" == window.doc.location.protocol) ? \"https://ssl.\" : \"http://www.\",\r\n\t\t\t\th = window.doc.getElementsByTagName(\"head\")[0],\r\n\t\t\t\tn = construct.create('script', {\r\n\t\t\t\t\tsrc: gaHost + \"google-analytics.com/ga.js\"\r\n\t\t\t\t}, h);\r\n\r\n\t\t\tn.onload = n.onreadystatechange = lang.hitch(this, function(e){\r\n\t\t\t\tif(e && e.type == \"load\" || re.test(n.readyState)){\r\n\t\t\t\t\tn.onload = n.onreadystatechange = null;\r\n\t\t\t\t\tthis._gotGA();\r\n\t\t\t\t\th.removeChild(n);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t},\r\n\r\n\t\t_gotGA: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tinitialize the tracker\r\n\t\t\tthis.tracker = _gat._getTracker(this.acct);\r\n\t\t\tthis.GAonLoad.apply(this, arguments);\r\n\t\t},\r\n\r\n\t\tGAonLoad: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tStub function to fire when urchin is complete\r\n\t\t\t// description:\r\n\t\t\t//\t\tThis function is executed when the tracker variable is\r\n\t\t\t//\t\tcomplete and initialized. The initial trackPageView (with\r\n\t\t\t//\t\tno arguments) is called here as well, so remeber to call\r\n\t\t\t//\t\tmanually if overloading this method.\r\n\t\t\t//\r\n\t\t\t// example:\r\n\t\t\t//\t\tCreate an Urchin tracker that will track a specific page on init\r\n\t\t\t//\t\tafter page load (or parsing, if parseOnLoad is true)\r\n\t\t\t//\t|\tdojo.addOnLoad(function(){\r\n\t\t\t//\t|\t\tnew dojox.ananlytics.Urchin({\r\n\t\t\t//\t|\t\t\tacct:\"UA-12345-67\",\r\n\t\t\t//\t|\t\t\tGAonLoad: function(){\r\n\t\t\t//\t|\t\t\t\tthis.trackPageView(\"/custom-page\");\r\n\t\t\t//\t|\t\t\t}\r\n\t\t\t//\t|\t\t});\r\n\t\t\t//\t|\t});\r\n\t\t\t\r\n\t\t\tthis.trackPageView();\r\n\t\t},\r\n\r\n\t\ttrackPageView: function(/* string */url){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tA public API attached to this widget instance, allowing you\r\n\t\t\t//\t\tAjax-like notification of updates.\r\n\t\t\t// url: String\r\n\t\t\t//\t\tA location to tell the tracker to track, eg: \"/my-ajaxy-endpoint\"\r\n\t\t\t// example:\r\n\t\t\t//\t\tTrack clicks from a container of anchors and populate a `ContentPane`\r\n\t\t\t//\t|\t// 'tracker' is our `Urchin` instance, pane is the `ContentPane` ref.\r\n\t\t\t//\t|\tdojo.connect(container, \"onclick\", function(e){\r\n\t\t\t//\t|\t\tvar ref = dojo.attr(e.target, \"href\");\r\n\t\t\t//\t|\t\ttracker.trackPageView(ref);\r\n\t\t\t//\t|\t\tpane.attr(\"href\", ref);\r\n\t\t\t//\t|\t});\r\n\t\t\t\r\n\t\t\tthis.tracker._trackPageview.apply(this.tracker, arguments);\r\n\t\t}\r\n\r\n\t});\r\n});\r\n"]}