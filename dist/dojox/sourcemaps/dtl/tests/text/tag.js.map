{"version":3,"sources":["dtl/tests/text/tag.js"],"names":["dojo","provide","require","dojox","dtl","text","_getTemplateString","getTemplateString","file","replace","doh","register","t","dd","template","Template","is","render","context","Context","parent","moduleUrl","url","items","found","e","message","unplugged","push","slice","list","four","three","apple","banana","lemon","jokes","hot_pockets","unicycles","bacon","comedians","hedberg","gaffigan","cook","year","days","Date","user","id","comment","user_id","favorite","comedian","hello","person","people","f","tests","load","match","firstName","lastName","gender","RegExp","this_value","max_value","someSqlMethod"],"mappings":"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","file":"../../../../dtl/tests/text/tag.js","sourcesContent":["dojo.provide(\"dojox.dtl.tests.text.tag\");\r\n\r\ndojo.require(\"dojox.dtl\");\r\ndojo.require(\"dojox.dtl.Context\");\r\n\r\nif(!(\"_getTemplateString\" in dojox.dtl.text)){\r\n\tdojox.dtl.text._getTemplateString = dojox.dtl.text.getTemplateString;\r\n\tdojox.dtl.text.getTemplateString = function(file){\r\n\t\treturn dojox.dtl.text._getTemplateString(file).replace(/(\\r?\\n)$/, ''); // remove optional trailing newline from template HTML file to make testing consistent\r\n\t};\r\n}\r\n\r\ndoh.register(\"dojox.dtl.text.tag\",\r\n\t[\r\n\t\tfunction test_tag_block_and_extends(t){\r\n\t\t\tvar dd = dojox.dtl;\r\n\r\n\t\t\t// Simple (messy) string-based extension\r\n\t\t\tvar template = new dd.Template('{% extends \"../../dojox/dtl/tests/templates/pocket.html\" %}{% block pocket %}Simple{% endblock %}');\r\n\t\t\tt.is(\"Simple Pocket\", template.render());\r\n\r\n\t\t\t// Variable replacement\r\n\t\t\tvar context = new dd.Context({\r\n\t\t\t\tparent: \"../../dojox/dtl/tests/templates/pocket.html\"\r\n\t\t\t})\r\n\t\t\ttemplate = new dd.Template('{% extends parent %}{% block pocket %}Variabled{% endblock %}');\r\n\t\t\tt.is(\"Variabled Pocket\", template.render(context));\r\n\r\n\t\t\t// Nicer dojo.moduleUrl and variable based extension\r\n\t\t\tcontext.parent = dojo.moduleUrl(\"dojox.dtl.tests.templates\", \"pocket.html\");\r\n\t\t\ttemplate = new dd.Template('{% extends parent %}{% block pocket %}Slightly More Advanced{% endblock %}');\r\n\t\t\tt.is(\"Slightly More Advanced Pocket\", template.render(context));\r\n\r\n\t\t\t// dojo.moduleUrl with support for more variables.\r\n\t\t\t// This is important for HTML templates where the \"shared\" flag will be important.\r\n\t\t\tcontext.parent = {\r\n\t\t\t\turl: dojo.moduleUrl(\"dojox.dtl.tests.templates\", \"pocket.html\")\r\n\t\t\t}\r\n\t\t\ttemplate = new dd.Template('{% extends parent %}{% block pocket %}Super{% endblock %}');\r\n\t\t\tt.is(\"Super Pocket\", template.render(context));\r\n\t\t},\r\n\t\tfunction test_tag_block(t){\r\n\t\t\tvar dd = dojox.dtl;\r\n\r\n\t\t\tvar context = new dd.Context({\r\n\t\t\t\tparent: dojo.moduleUrl(\"dojox.dtl.tests.templates\", \"pocket2.html\"),\r\n\t\t\t\titems: [\"apple\", \"banana\", \"lemon\" ]\r\n\t\t\t});\r\n\r\n\t\t\tvar template = new dd.Template(\"{% extends parent %}{% block pocket %}My {{ item }}{% endblock %}\");\r\n\t\t\tt.is(\"(My apple) (My banana) (My lemon) Pocket\", template.render(context));\r\n\t\t},\r\n\t\tfunction test_tag_block_super(t){\r\n\t\t\tvar dd = dojox.dtl;\r\n\r\n\t\t\tvar context = new dd.Context({\r\n\t\t\t\tparent: dojo.moduleUrl(\"dojox.dtl.tests.templates\", \"pocket2.html\"),\r\n\t\t\t\titems: [\"apple\", \"banana\", \"lemon\" ]\r\n\t\t\t});\r\n\r\n\t\t\tvar template = new dd.Template(\"{% extends parent %}{% block pocket %}My {{ item }} {{ block.super }}{% endblock %}\");\r\n\t\t\tt.is(\"(My apple Hot) (My banana Hot) (My lemon Hot) Pocket\", template.render(context));\r\n\t\t},\r\n\t\tfunction test_tag_comment(t){\r\n\t\t\tvar dd = dojox.dtl;\r\n\r\n\t\t\tvar template = new dd.Template('Hot{% comment %}<strong>Make me disappear</strong>{% endcomment %} Pocket');\r\n\t\t\tt.is(\"Hot Pocket\", template.render());\r\n\r\n\t\t\tvar found = false;\r\n\t\t\ttry{\r\n\t\t\t\ttemplate = new dd.Template('Hot{% comment %}<strong>Make me disappear</strong> Pocket');\r\n\t\t\t}catch(e){\r\n\t\t\t\tt.is(\"Unclosed tag found when looking for endcomment\", e.message);\r\n\t\t\t\tfound = true;\r\n\t\t\t}\r\n\t\t\tt.t(found);\r\n\t\t},\r\n\t\tfunction test_tag_cycle(t){\r\n\t\t\tvar dd = dojox.dtl;\r\n\r\n\t\t\tvar context = new dd.Context({\r\n\t\t\t\titems: [\"apple\", \"banana\", \"lemon\"],\r\n\t\t\t\tunplugged: \"Torrey\"\r\n\t\t\t});\r\n\t\t\tvar template = new dd.Template(\"{% for item in items %}{% cycle 'Hot' 'Diarrhea' unplugged 'Extra' %} Pocket. {% endfor %}\");\r\n\t\t\tt.is(\"Hot Pocket. Diarrhea Pocket. Torrey Pocket. \", template.render(context));\r\n\t\t\t// Make sure that it doesn't break on re-render\r\n\t\t\tt.is(\"Hot Pocket. Diarrhea Pocket. Torrey Pocket. \", template.render(context));\r\n\r\n\t\t\t// Test repeating the loop\r\n\t\t\tcontext.items.push(\"guava\", \"mango\", \"pineapple\");\r\n\t\t\tt.is(\"Hot Pocket. Diarrhea Pocket. Torrey Pocket. Extra Pocket. Hot Pocket. Diarrhea Pocket. \", template.render(context));\r\n\r\n\t\t\t// Repeat the above tests for the old style\r\n\t\t\t// ========================================\r\n\t\t\tcontext.items = context.items.slice(0, 3);\r\n\t\t\ttemplate = new dd.Template(\"{% for item in items %}{% cycle Hot,Diarrhea,Torrey,Extra %} Pocket. {% endfor %}\");\r\n\t\t\tt.is(\"Hot Pocket. Diarrhea Pocket. Torrey Pocket. \", template.render(context));\r\n\t\t\t// Make sure that it doesn't break on re-render\r\n\t\t\tt.is(\"Hot Pocket. Diarrhea Pocket. Torrey Pocket. \", template.render(context));\r\n\r\n\t\t\t// Test repeating the loop\r\n\t\t\tcontext.items.push(\"guava\", \"mango\", \"pineapple\");\r\n\t\t\tt.is(\"Hot Pocket. Diarrhea Pocket. Torrey Pocket. Extra Pocket. Hot Pocket. Diarrhea Pocket. \", template.render(context));\r\n\r\n\t\t\t// Now test outside of the for loop\r\n\t\t\t// ================================\r\n\t\t\tcontext = new dojox.dtl.Context({ unplugged: \"Torrey\" });\r\n\t\t\ttemplate = new dd.Template(\"{% cycle 'Hot' 'Diarrhea' unplugged 'Extra' as steakum %} Pocket. {% cycle steakum %} Pocket. {% cycle steakum %} Pocket.\");\r\n\t\t\tt.is(\"Hot Pocket. Diarrhea Pocket. Torrey Pocket.\", template.render(context));\r\n\r\n\t\t\ttemplate = new dd.Template(\"{% cycle 'Hot' 'Diarrhea' unplugged 'Extra' as steakum %} Pocket. {% cycle steakum %} Pocket. {% cycle steakum %} Pocket. {% cycle steakum %} Pocket. {% cycle steakum %} Pocket. {% cycle steakum %} Pocket.\");\r\n\t\t\tt.is(\"Hot Pocket. Diarrhea Pocket. Torrey Pocket. Extra Pocket. Hot Pocket. Diarrhea Pocket.\", template.render(context));\r\n//t.t(false)\r\n\t\t\t// Test for nested objects\r\n\t\t\tcontext.items = {\r\n\t\t\t\tlist: [\"apple\", \"banana\", \"lemon\"]\r\n\t\t\t};\r\n\t\t\ttemplate = new dd.Template(\"{% for item in items.list %}{% cycle 'Hot' 'Diarrhea' unplugged 'Extra' %} Pocket. {% endfor %}\");\r\n\t\t\tt.is(\"Hot Pocket. Diarrhea Pocket. Torrey Pocket. \", template.render(context));\r\n\t\t\t// Make sure that it doesn't break on re-render\r\n\t\t\tt.is(\"Hot Pocket. Diarrhea Pocket. Torrey Pocket. \", template.render(context));\r\n\t\t},\r\n\t\tfunction test_tag_debug(t){\r\n\t\t\tvar dd = dojox.dtl;\r\n\r\n\t\t\tvar context = new dd.Context({\r\n\t\t\t\titems: [\"apple\", \"banana\", \"lemon\"],\r\n\t\t\t\tunplugged: \"Torrey\"\r\n\t\t\t});\r\n\t\t\tvar template = new dd.Template(\"{% debug %}\");\r\n\t\t\tt.is('[items: object]\\n[unplugged: string]\\n', template.render(context));\r\n\t\t},\r\n\t\tfunction test_tag_filter(t){\r\n\t\t\tvar dd = dojox.dtl;\r\n\r\n\t\t\tvar template = new dd.Template('{% filter lower|center:\"15\" %}Hot Pocket{% endfilter %}');\r\n\t\t\tt.is(\"  hot pocket   \", template.render());\r\n\t\t},\r\n\t\tfunction test_tag_firstof(t){\r\n\t\t\tvar dd = dojox.dtl;\r\n\r\n\t\t\tvar context = new dd.Context({\r\n\t\t\t\tfound: \"unicorn\"\r\n\t\t\t});\r\n\r\n\t\t\tvar template = new dd.Template(\"{% firstof one two three four found %}\");\r\n\t\t\tt.is(\"unicorn\", template.render(context));\r\n\r\n\t\t\tcontext.four = null;\r\n\t\t\tt.is(\"null\", template.render(context));\r\n\r\n\t\t\tcontext.three = false;\r\n\t\t\tt.is(\"false\", template.render(context));\r\n\t\t},\r\n\t\tfunction test_tag_for(t){\r\n\t\t\tvar dd = dojox.dtl;\r\n\r\n\t\t\tvar context = new dd.Context({\r\n\t\t\t\titems: [\"apple\", \"banana\", \"lemon\"]\r\n\t\t\t});\r\n\t\t\tvar template = new dd.Template(\"{% for item in items %}<li>{{ item }}</li>{% endfor %}\");\r\n\t\t\tt.is(\"<li>apple</li><li>banana</li><li>lemon</li>\", template.render(context));\r\n\r\n\t\t\ttemplate = new dd.Template(\"{% for item in items reversed %}<li>{{ item }}</li>{% endfor %}\");\r\n\t\t\tt.is(\"<li>lemon</li><li>banana</li><li>apple</li>\", template.render(context));\r\n\r\n\t\t\tcontext.items = {\r\n\t\t\t\tapple: \"Red Delicious\",\r\n\t\t\t\tbanana: \"Cavendish\",\r\n\t\t\t\tlemon: \"Citrus\"\r\n\t\t\t};\r\n\t\t\ttemplate = new dd.Template(\"{% for key, value in items.items %}<li>{{ value }} {{ key|title }}</li>{% endfor %}\");\r\n\t\t\tt.is(\"<li>Red Delicious Apple</li><li>Cavendish Banana</li><li>Citrus Lemon</li>\", template.render(context));\r\n\r\n\t\t\t// The same thing above, but using \"zipped\" sets\r\n\t\t\tcontext.items = [\r\n\t\t\t\t[\"apple\", \"Red Delicious\", 1.99],\r\n\t\t\t\t[\"banana\", \"Cavendish\", 0.49],\r\n\t\t\t\t[\"lemon\", \"Citrus\", 0.29]\r\n\t\t\t];\r\n\t\t\ttemplate = new dd.Template(\"{% for fruit, type, price in items %}<li>{{ type }} {{ fruit|title }} costs ${{ price}}</li>{% endfor %}\");\r\n\t\t\tt.is(\"<li>Red Delicious Apple costs $1.99</li><li>Cavendish Banana costs $0.49</li><li>Citrus Lemon costs $0.29</li>\", template.render(context));\r\n\r\n\t\t\ttemplate = new dd.Template(\"{% for fruit, type, price in items reversed %}<li>{{ type }} {{ fruit|title }} costs ${{ price}}</li>{% endfor %}\");\r\n\t\t\tt.is(\"<li>Citrus Lemon costs $0.29</li><li>Cavendish Banana costs $0.49</li><li>Red Delicious Apple costs $1.99</li>\", template.render(context));\r\n\r\n\t\t\t// Now to create some errors\r\n\t\t\tvar found = false;\r\n\t\t\ttry {\r\n\t\t\t\ttemplate = new dd.Template(\"{% for item initems %}<li>{{ item }}</li>{% endfor %}\");\r\n\t\t\t}catch(e){\r\n\t\t\t\tfound = true;\r\n\t\t\t\tt.is(\"'for' statements should have at least four words: for item initems\", e.message);\r\n\t\t\t}\r\n\t\t\tt.t(found);\r\n\r\n\t\t\tfound = false;\r\n\t\t\ttry {\r\n\t\t\t\ttemplate = new dd.Template(\"{% for item ni items %}<li>{{ item }}</li>{% endfor %}\");\r\n\t\t\t}catch(e){\r\n\t\t\t\tfound = true;\r\n\t\t\t\tt.is(\"'for' tag received an invalid argument: for item ni items\", e.message);\r\n\t\t\t}\r\n\t\t\tt.t(found);\r\n\r\n\t\t\tfound = false;\r\n\t\t\ttry {\r\n\t\t\t\ttemplate = new dd.Template(\"{% for my item in items %}<li>{{ item }}</li>{% endfor %}\");\r\n\t\t\t}catch(e){\r\n\t\t\t\tfound = true;\r\n\t\t\t\tt.is(\"'for' tag received an invalid argument: for my item in items\", e.message);\r\n\t\t\t}\r\n\t\t\tt.t(found);\r\n\t\t},\r\n\t\tfunction test_tag_if(t){\r\n\t\t\tvar dd = dojox.dtl;\r\n\r\n\t\t\tvar context = new dd.Context({\r\n\t\t\t\tjokes: {\r\n\t\t\t\t\thot_pockets: true,\r\n\t\t\t\t\tunicycles: true,\r\n\t\t\t\t\tbacon: true\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tvar template = new dd.Template(\"Comedian is {% if jokes.hot_pockets and jokes.unicycles and jokes.bacon %}funny{% else %}not funny{% endif %}\");\r\n\t\t\tt.is(\"Comedian is funny\", template.render(context));\r\n\r\n\t\t\tcontext.jokes.unicycles = false;\r\n\t\t\tt.is(\"Comedian is not funny\", template.render(context));\r\n\r\n\t\t\tcontext.comedians = {\r\n\t\t\t\thedberg: true,\r\n\t\t\t\tgaffigan: true,\r\n\t\t\t\tcook: true\r\n\t\t\t};\r\n\t\t\ttemplate = new dd.Template(\"Show will be {% if comedians.hedberg or comedians.gaffigan %}worth seeing{% else %}not worth seeing{% endif %}\");\r\n\t\t\tt.is(\"Show will be worth seeing\", template.render(context));\r\n\r\n\t\t\t// NOTE: \"and\" is implied by nesting. eg {% if sunny %}{% if windy %}It's Sunny and Windy{% endif %}{% endif %}\r\n\t\t\t// Not mixing ands and ors allows for MUCH faster rendering\r\n\t\t\ttemplate = new dd.Template(\"Show will {% if comedians.hedberg or comedians.gaffigan %}{% if comedians.cook %}not {% endif %}be worth seeing{% else %}not be worth seeing{% endif %}\");\r\n\t\t\tt.is(\"Show will not be worth seeing\", template.render(context));\r\n\r\n\t\t\tcontext.comedians.cook = false;\r\n\t\t\tt.is(\"Show will be worth seeing\", template.render(context));\r\n\r\n\t\t\ttemplate = new dd.Template(\"Show will be {% if comedians.hedberg and comedians.gaffigan and not comedians.cook %}AWESOME{% else %}almost awesome{% endif %}\");\r\n\t\t\tt.is(\"Show will be AWESOME\", template.render(context));\r\n\r\n\t\t\tcontext.comedians.cook = true;\r\n\t\t\tt.is(\"Show will be almost awesome\", template.render(context));\r\n\r\n\t\t\t// Now we test for errors.\r\n\t\t\tvar found = false;\r\n\t\t\ttry {\r\n\t\t\t\ttemplate = new dd.Template(\"Show will be {% if comedians.hedberg or comedians.gaffigan and not comedians.cook %}worth seeing{% else %}not worth seeing{% endif %}\");\r\n\t\t\t}catch(e){\r\n\t\t\t\tfound = true;\r\n\t\t\t\tt.is(\"'if' tags can't mix 'and' and 'or'\", e.message);\r\n\t\t\t}\r\n\t\t\tt.t(found);\r\n\t\t},\r\n\t\tfunction test_tag_ifchanged(t){\r\n\t\t\tvar dd = dojox.dtl;\r\n\r\n\t\t\tvar context = new dd.Context({\r\n\t\t\t\tyear: 2008,\r\n\t\t\t\tdays: [\r\n\t\t\t\t\tnew Date(2008, 0, 12),\r\n\t\t\t\t\tnew Date(2008, 0, 28),\r\n\t\t\t\t\tnew Date(2008, 1, 1),\r\n\t\t\t\t\tnew Date(2008, 1, 1),\r\n\t\t\t\t\tnew Date(2008, 1, 1)\r\n\t\t\t\t]\r\n\t\t\t});\r\n\r\n\t\t\tvar template = new dd.Template(\"<h1>Archive for {{ year }}</h1>\"+\r\n\"{% for date in days %}\"+\r\n'{% ifchanged %}<h3>{{ date|date:\"F\" }}</h3>{% endifchanged %}'+\r\n'<a href=\"{{ date|date:\\'M/d\\'|lower }}/\">{{ date|date:\\'j\\' }}</a>'+\r\n\"{% endfor %}\");\r\n\t\t\tt.is('<h1>Archive for 2008</h1>'+\r\n'<h3>January</h3>'+\r\n'<a href=\"jan/12/\">12</a>'+\r\n'<a href=\"jan/28/\">28</a>'+\r\n'<h3>February</h3>'+\r\n'<a href=\"feb/01/\">1</a>'+\r\n'<a href=\"feb/01/\">1</a>'+\r\n'<a href=\"feb/01/\">1</a>', template.render(context));\r\n\r\n\t\t\ttemplate = new dd.Template('{% for date in days %}'+\r\n'{% ifchanged date.date %} {{ date.date }} {% endifchanged %}'+\r\n'{% ifchanged date.hour date.date %}'+\r\n'{{ date.hour }}'+\r\n'{% endifchanged %}'+\r\n'{% endfor %}');\r\n\t\t\tt.is(' 2008-01-12 0 2008-01-28 0 2008-02-01 0', template.render(context));\r\n\t\t},\r\n\t\tfunction test_tag_ifequal(t){\r\n\t\t\tvar dd = dojox.dtl;\r\n\r\n\t\t\tvar context = new dd.Context({\r\n\t\t\t\tuser: {\r\n\t\t\t\t\tid: 314\r\n\t\t\t\t},\r\n\t\t\t\tcomment: {\r\n\t\t\t\t\tuser_id: 314\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tvar template = new dd.Template(\"{% ifequal user.id comment.user_id %}You posted this{% endifequal %}\");\r\n\t\t\tt.is(\"You posted this\", template.render(context));\r\n\r\n\t\t\tcontext.user.id = 313;\r\n\t\t\tt.is(\"\", template.render(context));\r\n\r\n\t\t\t// Errors\r\n\t\t\tvar found = false;\r\n\t\t\ttry {\r\n\t\t\t\ttemplate = new dd.Template(\"{% ifequal user.id %}You posted this{% endifequal %}\");\r\n\t\t\t}catch(e){\r\n\t\t\t\tfound = true;\r\n\t\t\t\tt.is(\"ifequal takes two arguments\", e.message);\r\n\t\t\t}\r\n\t\t\tt.t(found);\r\n\r\n\t\t\tfound = false;\r\n\t\t\ttry {\r\n\t\t\t\ttemplate = new dd.Template(\"{% ifequal user.id comment.user_id %}You posted this{% endif %}\");\r\n\t\t\t}catch(e){\r\n\t\t\t\tfound = true;\r\n\t\t\t\tt.is(\"No tag found for endif\", e.message);\r\n\t\t\t}\r\n\t\t\tt.t(found);\r\n\r\n\t\t\ttemplate = new dd.Template('{% ifequal empty \"\" %}empty{% endifequal %}');\r\n\t\t\tdoh.is('empty', template.render());\r\n\t\t},\r\n\t\tfunction test_tag_ifnotequal(t){\r\n\t\t\tvar dd = dojox.dtl;\r\n\r\n\t\t\tvar context = new dd.Context({\r\n\t\t\t\tfavorite: \"hedberg\",\r\n\t\t\t\tcomedian: \"cook\"\r\n\t\t\t});\r\n\r\n\t\t\tvar template = new dd.Template(\"{% ifnotequal favorite comedian %}Not your favorite{% else %}Your favorite{% endifnotequal %}\");\r\n\t\t\tt.is(\"Not your favorite\", template.render(context));\r\n\r\n\t\t\tcontext.comedian = \"hedberg\";\r\n\t\t\tt.is(\"Your favorite\", template.render(context));\r\n\t\t},\r\n\t\tfunction test_tag_include(t){\r\n\t\t\tvar dd = dojox.dtl;\r\n\r\n\t\t\tvar context = new dd.Context({\r\n\t\t\t\thello: dojo.moduleUrl(\"dojox.dtl.tests.templates\", \"hello.html\"),\r\n\t\t\t\tperson: \"Bob\",\r\n\t\t\t\tpeople: [\"Charles\", \"Ralph\", \"Julia\"]\r\n\t\t\t});\r\n\r\n\t\t\tvar template = new dd.Template(\"{% include hello %}\");\r\n\t\t\tt.is(\"Hello, <span>Bob</span>\", template.render(context));\r\n\r\n\t\t\ttemplate = new dd.Template('{% include \"../../dojox/dtl/tests/templates/hello.html\" %}');\r\n\t\t\tt.is(\"Hello, <span>Bob</span>\", template.render(context));\r\n\r\n\t\t\ttemplate = new dd.Template('{% for person in people %}{% include hello %} {% endfor %}');\r\n\t\t\tt.is(\"Hello, <span>Charles</span> Hello, <span>Ralph</span> Hello, <span>Julia</span> \", template.render(context));\r\n\t\t},\r\n\t\tfunction test_tag_load(t){\r\n\t\t\tt.f(dojox.dtl.tests.text.load);\r\n\t\t\tnew dojox.dtl.Template(\"{% load dojox.dtl.tests.text.load %}\");\r\n\t\t\tt.t(dojox.dtl.tests.text.load);\r\n\t\t},\r\n\t\tfunction test_tag_now(t){\r\n\t\t\tvar dd = dojox.dtl;\r\n\r\n\t\t\tvar template = new dd.Template('It is {% now \"jS F Y H:i\" %}');\r\n\t\t\tt.t(template.render().match(/^It is \\d{1,2}[a-z]{2} [A-Z][a-z]+ [0-9]{4,} \\d{2}:\\d{2}$/));\r\n\r\n\t\t\ttemplate = new dd.Template('It is the {% now \"jS \\\\o\\\\f F\" %}');\r\n\t\t\tt.t(template.render().match(/^It is the \\d{1,2}[a-z]{2} of [A-Z][a-z]+$/));\r\n\r\n\t\t\ttemplate = new dd.Template(\"It is the {% now 'jS \\\\o\\\\f F' %}\");\r\n\t\t\tt.t(template.render().match(/^It is the \\d{1,2}[a-z]{2} of [A-Z][a-z]+$/));\r\n\r\n\t\t\tvar found = false;\r\n\t\t\ttry{\r\n\t\t\t\ttemplate = new dd.Template(\"It is the {% now 'jS \\\\o\\\\f F %}\");\r\n\t\t\t}catch(e){\r\n\t\t\t\tfound = true;\r\n\t\t\t\tt.is(\"'now' statement takes one argument\", e.message);\r\n\t\t\t}\r\n\t\t\tt.t(found);\r\n\r\n\t\t\tfound = false;\r\n\t\t\ttry{\r\n\t\t\t\ttemplate = new dd.Template('It is the {% now \"jS \\\\o\\\\f F %}');\r\n\t\t\t}catch(e){\r\n\t\t\t\tfound = true;\r\n\t\t\t\tt.is(\"'now' statement takes one argument\", e.message);\r\n\t\t\t}\r\n\t\t\tt.t(found);\r\n\t\t},\r\n\t\tfunction test_tag_regroup(t){\r\n\t\t\tvar dd = dojox.dtl;\r\n\r\n\t\t\tvar context = new dd.Context({\r\n\t\t\t\tpeople: [\r\n\t\t\t\t\t{ firstName: \"Bill\", lastName: \"Clinton\", gender: \"Male\" },\r\n\t\t\t\t\t{ firstName: \"Margaret\", lastName: \"Thatcher\", gender: \"Female\" },\r\n\t\t\t\t\t{ firstName: \"Path\", lastName: \"Smith\", gender: \"Unknown\" },\r\n\t\t\t\t\t{ firstName: \"Condoleezza\", lastName: \"Rice\", gender: \"Female\" },\r\n\t\t\t\t\t{ firstName: \"George\", lastName: \"Bush\", gender: \"Male\" }\r\n\t\t\t\t]\r\n\t\t\t});\r\n\r\n\t\t\tvar template = new dd.Template(\"{% regroup people|dictsort:'gender' by gender as grouped %}<ul>{% for group in grouped %}<li>{{ group.grouper }}<ul>{% for item in group.list %}<li>{{ item.firstName }} {{ item.lastName }}</li>{% endfor %}</ul></li>{% endfor %}</ul>\");\r\n\t\t\tt.t(template.render(context).match(new RegExp(\"^<ul><li>Female<ul><li>(Condoleezza Rice|Margaret Thatcher)</li><li>(Condoleezza Rice|Margaret Thatcher)</li></ul></li><li>Male<ul><li>(Bill Clinton|George Bush)</li><li>(Bill Clinton|George Bush)</li></ul></li><li>Unknown<ul><li>Path Smith</li></ul></li></ul>$\")));\r\n\t\t},\r\n\t\tfunction test_tag_spaceless(t){\r\n\t\t\tvar dd = dojox.dtl;\r\n\r\n\t\t\tvar template = new dd.Template(\"{% spaceless %}<ul> \\n <li>Hot</li> \\n\\n<li>Pocket </li>\\n </ul>{% endspaceless %}\");\r\n\t\t\tt.is(\"<ul><li>Hot</li><li>Pocket </li></ul>\", template.render());\r\n\t\t},\r\n\t\tfunction test_tag_ssi(t){\r\n\t\t\tvar dd = dojox.dtl;\r\n\r\n\t\t\tvar context = new dd.Context({\r\n\t\t\t\thello: dojo.moduleUrl(\"dojox.dtl.tests.templates\", \"hello.html\"),\r\n\t\t\t\tperson: \"Bob\",\r\n\t\t\t\tpeople: [\"Charles\", \"Ralph\", \"Julia\"]\r\n\t\t\t});\r\n\r\n\t\t\tvar template = new dd.Template(\"{% ssi hello parsed %}\");\r\n\t\t\tt.is(\"Hello, <span>Bob</span>\", template.render(context));\r\n\r\n\t\t\ttemplate = new dd.Template(\"{% ssi hello %}\");\r\n\t\t\tt.is(\"Hello, <span>{{ person }}</span>\", template.render(context));\r\n\r\n\t\t\ttemplate = new dd.Template('{% ssi \"../../dojox/dtl/tests/templates/hello.html\" parsed %}');\r\n\t\t\tt.is(\"Hello, <span>Bob</span>\", template.render(context));\r\n\r\n\t\t\ttemplate = new dd.Template('{% for person in people %}{% ssi hello parsed %} {% endfor %}');\r\n\t\t\tt.is(\"Hello, <span>Charles</span> Hello, <span>Ralph</span> Hello, <span>Julia</span> \", template.render(context));\r\n\t\t},\r\n\t\tfunction test_tag_templatetag(t){\r\n\t\t\tvar dd = dojox.dtl;\r\n\r\n\t\t\tvar template = new dd.Template(\"{% templatetag openblock %}\");\r\n\t\t\tt.is(\"{%\", template.render());\r\n\t\t\ttemplate = new dd.Template(\"{% templatetag closeblock %}\");\r\n\t\t\tt.is(\"%}\", template.render());\r\n\t\t\ttemplate = new dd.Template(\"{% templatetag openvariable %}\");\r\n\t\t\tt.is(\"{{\", template.render());\r\n\t\t\ttemplate = new dd.Template(\"{% templatetag closevariable %}\");\r\n\t\t\tt.is(\"}}\", template.render());\r\n\t\t\ttemplate = new dd.Template(\"{% templatetag openbrace %}\");\r\n\t\t\tt.is(\"{\", template.render());\r\n\t\t\ttemplate = new dd.Template(\"{% templatetag closebrace %}\");\r\n\t\t\tt.is(\"}\", template.render());\r\n\t\t\ttemplate = new dd.Template(\"{% templatetag opencomment %}\");\r\n\t\t\tt.is(\"{#\", template.render());\r\n\t\t\ttemplate = new dd.Template(\"{% templatetag closecomment %}\");\r\n\t\t\tt.is(\"#}\", template.render());\r\n\t\t},\r\n\t\tfunction test_tag_widthratio(t){\r\n\t\t\tvar dd = dojox.dtl;\r\n\r\n\t\t\tvar context = new dd.Context({\r\n\t\t\t\tthis_value: 175,\r\n\t\t\t\tmax_value: 200\r\n\t\t\t});\r\n\r\n\t\t\tvar template = new dd.Template('<img src=\"bar.gif\" height=\"10\" width=\"{% widthratio this_value max_value 100 %}\" />');\r\n\t\t\tt.is('<img src=\"bar.gif\" height=\"10\" width=\"88\" />', template.render(context));\r\n\t\t},\r\n\t\tfunction test_tag_with(t){\r\n\t\t\tvar dd = dojox.dtl;\r\n\r\n\t\t\tvar context = new dd.Context({\r\n\t\t\t\tperson: {\r\n\t\t\t\t\tsomeSqlMethod: function(){\r\n\t\t\t\t\t\treturn 4815162342;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tvar template = new dd.Template('{% with person.someSqlMethod as total %}{{ total }} object{{ total|pluralize }}{% endwith %}')\r\n\t\t\tt.is(\"4815162342 objects\", template.render(context));\r\n\t\t}\r\n\t]\r\n);"]}