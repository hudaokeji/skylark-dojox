{"version":3,"sources":["date/relative.js"],"names":["define","dojox","lang","ddl","i18n","drelative","getObject","del","dojo","delegate","ggb","_getGregorianBundle","fmt","format","_clearTime","date","Date","setHours","dateObject","options","today","relativeDate","diff","getTime","fmtOpts","locale","selector","weekCheck","datePattern","formatLength","getFullYear","bundle","normalizeLocale"],"mappings":";;;;;;;AAAAA,QAAQ,KAAM,kBAAmB,mBAAoB,aAAc,SAASC,EAAOC,EAAMC,EAAKC,GAE9F,IAAIC,EAAYH,EAAKI,UAAU,iBAAiB,EAAML,GAerDM,EAAMC,KAAKC,SACXC,EAAMP,EAAIQ,oBACVC,EAAMT,EAAIU,OAEX,SAASC,EAAWC,GAGnB,OAFAA,EAAO,IAAIC,KAAKD,IACXE,SAAS,EAAG,EAAG,EAAG,GAChBF,EAgEP,OA7DDV,EAAUQ,OAAS,SAAiBK,EAAgCC,GAgCnE,IAAIC,EAAQN,GAFZK,EAAUA,OAEqBE,cAAgB,IAAIL,MAClDM,EAAOF,EAAMG,UAAYT,EAAWI,GAAYK,UAChDC,GAAWC,OAAQN,EAAQM,QAE5B,GAAY,IAATH,EAEF,OAAOV,EAAIM,EAAYX,EAAIiB,GAAUE,SAAU,UAC1C,GAAGJ,GAlDE,QAkDkBA,EAAO,IAA2B,IAAtBH,EAAQQ,UAEhD,OAAOf,EAAIM,EAAYX,EAAIiB,GAAUE,SAAU,OAAQE,YAAa,SAClE,IACAhB,EAAIM,EAAYX,EAAIiB,GAAUE,SAAU,OAAQG,aAAc,WAC3D,GAAGX,EAAWY,eAAiBV,EAAMU,cAAc,CAExD,IAAIC,EAASrB,EAAIN,EAAK4B,gBAAgBb,EAAQM,SAC9C,OAAOb,EAAIM,EAAYX,EAAIiB,GAC1BE,SAAU,OACVE,YAAaG,EAAO,0BAIrB,OAAOnB,EAAIM,EAAYX,EAAIiB,GAC1BE,SAAU,OACVG,aAAc,SACdJ,OAAQN,EAAQM,WAKXpB","file":"../../date/relative.js","sourcesContent":["define([\"..\", \"dojo/_base/lang\", \"dojo/date/locale\", \"dojo/i18n\"], function(dojox, lang, ddl, i18n){\r\n\r\nvar drelative = lang.getObject(\"date.relative\", true, dojox);\r\n\r\n/*=====\r\nvar __FormatOptions = {\r\n\t// locale: String\r\n\t//\t\toverride the locale used to determine formatting rules\r\n\t// relativeDate: Date\r\n\t//\t\tDate to calculate relation to (defaults to new Date())\r\n\t// weekCheck: boolean\r\n\t//\t\tWhether or not to display the day of week (defaults true)\r\n};\r\n=====*/\r\n\r\nvar DAY = 1000*60*60*24,\r\n\tSIX_DAYS = 6 * DAY,\r\n\tdel = dojo.delegate,\r\n\tggb = ddl._getGregorianBundle,\r\n\tfmt = ddl.format;\r\n\r\nfunction _clearTime(date){\r\n\tdate = new Date(date);\r\n\tdate.setHours(0, 0, 0, 0);\r\n\treturn date;\r\n}\r\n\r\ndrelative.format = function(/*Date*/dateObject, /*__FormatOptions?*/options){\r\n\t// summary:\r\n\t//\t\tFormat a Date object as a String, using locale-specific settings,\r\n\t//\t\trelative to the current date or some other date.\r\n\t//\r\n\t// description:\r\n\t//\t\tCreate a string from a Date object using the most significant information\r\n\t//\t\tand a known localized pattern.  This method formats both the date and\r\n\t//\t\ttime from dateObject.  Formatting patterns are chosen appropriate to\r\n\t//\t\tthe locale.\r\n\t//\r\n\t//\t\tIf the day portion of the date falls within the current date (or the\r\n\t//\t\trelativeDate option, if present), then the time will be all that\r\n\t//\t\tis displayed\r\n\t//\r\n\t//\t\tIf the day portion of the date falls within the past week (or the\r\n\t//\t\tweek preceding relativeDate, if present), then the display will show\r\n\t//\t\tday of week and time.  This functionality can be turned off by setting\r\n\t//\t\tweekCheck to false.\r\n\t//\r\n\t//\t\tIf the year portion of the date falls within the current year (or the\r\n\t//\t\tyear portion of relativeDate, if present), then the display will show\r\n\t//\t\tmonth and day.\r\n\t//\r\n\t//\t\tOtherwise, this function is equivalent to calling dojo.date.format with\r\n\t//\t\tformatLength of \"medium\"\r\n\t//\r\n\t// dateObject:\r\n\t//\t\tthe date and time to be formatted.\r\n\t\r\n\toptions = options || {};\r\n\t\r\n\tvar today = _clearTime(options.relativeDate || new Date()),\r\n\t\tdiff = today.getTime() - _clearTime(dateObject).getTime(),\r\n\t\tfmtOpts = {locale: options.locale};\r\n\t\r\n\tif(diff === 0){\r\n\t\t// today: 9:32 AM\r\n\t\treturn fmt(dateObject, del(fmtOpts, {selector: \"time\"}));\r\n\t}else if(diff <= SIX_DAYS && diff > 0 && options.weekCheck !== false){\r\n\t\t// within the last week: Mon 9:32 am\r\n\t\treturn fmt(dateObject, del(fmtOpts, {selector: \"date\", datePattern: \"EEE\"})) +\r\n\t\t\t\t\" \" +\r\n\t\t\t\tfmt(dateObject, del(fmtOpts, {selector: \"time\", formatLength: \"short\"}));\r\n\t}else if(dateObject.getFullYear() == today.getFullYear()){\r\n\t\t// this year: Nov 1\r\n\t\tvar bundle = ggb(i18n.normalizeLocale(options.locale));\r\n\t\treturn fmt(dateObject, del(fmtOpts, {\r\n\t\t\tselector: \"date\",\r\n\t\t\tdatePattern: bundle[\"dateFormatItem-MMMd\"]\r\n\t\t}));\r\n\t}else{\r\n\t\t// default: Jun 1, 2010\r\n\t\treturn fmt(dateObject, del(fmtOpts, {\r\n\t\t\tselector: \"date\",\r\n\t\t\tformatLength: \"medium\",\r\n\t\t\tlocale: options.locale\r\n\t\t}));\r\n\t}\r\n};\r\n\r\n\treturn drelative;\r\n});\r\n"]}