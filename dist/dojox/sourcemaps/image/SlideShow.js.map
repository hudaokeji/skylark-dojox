{"version":3,"sources":["image/SlideShow.js"],"names":["dojo","provide","require","declare","dijit","_Widget","_Templated","imageHeight","imageWidth","title","titleTemplate","noLink","loop","hasNav","images","pageSize","autoLoad","autoStart","fixedHeight","imageStore","linkAttr","imageLargeAttr","titleAttr","slideshowInterval","templateString","cache","_imageCounter","_tmpImage","_request","postCreate","this","inherited","arguments","img","document","createElement","setAttribute","connect","outerNode","evt","_showNav","e","_hideNav","style","width","_blankGif","largeNode","appendChild","_currentImage","_fitSize","_loadImage","hitch","_calcNavDimensions","navNode","setDataStore","dataStore","request","paramNames","reset","_this","query","start","count","onBegin","maxPhotos","mixin","forEach","attrName","onComplete","items","length","imageIndex","toggleSlideShow","showImage","fetch","orphan","hiddenNode","parentNode","removeChild","isInitialized","isImageLoaded","index","moveImageLoadingPointer","destroy","_slideId","_stop","showNextImage","inTimer","forceLoop","_timerCancelled","_startTimer","toggleClass","domNode","idx","_img","complete","handle","subscribe","getShowTopicName","info","setTimeout","unsubscribe","publish","url","widgetId","id","getLoadTopicName","callback","current","getElementsByTagName","showOrLoadIt","firstChild","fadeIn","node","duration","onEnd","a","b","c","tagName","toLowerCase","getAttribute","_navShowing","_setTitle","play","fadeOut","force","_getTopPadding","height","innerWrapper","_loadNextImage","callbackFn","pageStart","diff","loadIt","store","item","getValue","Image","div","create","link","href","target","_fitImage","attr","className","clearTimeout","removeClass","_prev","_next","byId","navPlay","_size","marginBox","navPrev","navNext","position","top","titleNode","innerHTML","string","substitute","total","Math","floor","_handleClick","navPlayPos","w","console","log","margin","h","_navAnim","stop","_overElement","element","m","pageX","pageY","bb","x","y"],"mappings":"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","file":"../../image/SlideShow.js","sourcesContent":["dojo.provide(\"dojox.image.SlideShow\");\r\n//\r\n// dojox.image.SlideShow courtesy Shane O Sullivan, licensed under a Dojo CLA\r\n// For a sample usage, see http://www.skynet.ie/~sos/photos.php\r\n//\r\n//\r\n//\tTODO: more cleanups\r\n//\r\ndojo.require(\"dojo.string\");\r\ndojo.require(\"dojo.fx\");\r\ndojo.require(\"dijit._Widget\");\r\ndojo.require(\"dijit._Templated\");\r\n\r\ndojo.declare(\"dojox.image.SlideShow\",\r\n\t[dijit._Widget, dijit._Templated],\r\n\t{\r\n\t// summary:\r\n\t//\t\tA Slideshow Widget\r\n\r\n\t// imageHeight: Number\r\n\t//\t\tThe maximum height of an image\r\n\timageHeight: 375,\r\n\t\r\n\t// imageWidth: Number\r\n\t//\t\tThe maximum width of an image.\r\n\timageWidth: 500,\r\n\r\n\t// title: String\r\n\t//\t\tThe initial title of the SlideShow\r\n\ttitle: \"\",\r\n\r\n\t// titleTemplate: String\r\n\t//\ta way to customize the wording in the title. supported parameters to be populated are:\r\n\t//\t\t${title} = the passed title of the image\r\n\t//\t\t${current} = the current index of the image\r\n\t//\t\t${total} = the total number of images in the SlideShow\r\n\t//\r\n\t//\tshould add more?\r\n\ttitleTemplate: '${title} <span class=\"slideShowCounterText\">(${current} of ${total})</span>',\r\n\r\n\t// noLink: Boolean\r\n\t//\tPrevents the slideshow from putting an anchor link around the displayed image\r\n\t//\tenables if true, though still will not link in absence of a url to link to\r\n\tnoLink: false,\r\n\r\n\t// loop: Boolean\r\n\t//\ttrue/false - make the slideshow loop\r\n\tloop: true,\r\n\r\n\t// hasNav: Boolean\r\n\t//\ttoggle to enable/disable the visual navigation controls\r\n\thasNav: true,\r\n\r\n\t// images: Array\r\n\t//\tContains the DOM nodes that individual images are stored in when loaded or loading.\r\n\timages: [],\r\n\t\r\n\t// pageSize: Number\r\n\t//\tThe number of images to request each time.\r\n\tpageSize: 20,\r\n\t\t\r\n\t// autoLoad: Boolean\r\n\t//\tIf true, then images are preloaded, before the user navigates to view them.\r\n\t//\tIf false, an image is not loaded until the user views it.\r\n\tautoLoad: true,\r\n\r\n\t// autoStart: Boolean\r\n\t//\tIf true, the SlideShow begins playing immediately\r\n\tautoStart: false,\r\n\t\r\n\t// fixedHeight: Boolean\r\n\t//\tIf true, the widget does not resize itself to fix the displayed image.\r\n\tfixedHeight: false,\r\n\r\n\t// imageStore: Object\r\n\t//\tImplementation of the dojo/data/api/Read API, which provides data on the images\r\n\t//\tto be displayed.\r\n\timageStore: null,\r\n\t\t\r\n\t// linkAttr: String\r\n\t//\tDefines the name of the attribute to request from the store to retrieve the\r\n\t//\tURL to link to from an image, if any.\r\n\tlinkAttr: \"link\",\r\n\t\r\n\t// imageLargeAttr: String\r\n\t//\tDefines the name of the attribute to request from the store to retrieve the\r\n\t//\tURL to the image.\r\n\timageLargeAttr: \"imageUrl\",\r\n\t\r\n\t// titleAttr: String\r\n\t//\tDefines the name of the attribute to request from the store to retrieve the\r\n\t//\ttitle of the picture, if any.\r\n\ttitleAttr: \"title\",\r\n\r\n\t// slideshowInterval: Number\r\n\t//\tTime, in seconds, between image transitions during a slideshow.\r\n\tslideshowInterval: 3,\r\n\t\r\n\ttemplateString: dojo.cache(\"dojox.image\", \"resources/SlideShow.html\"),\r\n\t\r\n\t// _imageCounter: Number\r\n\t//\tA counter to keep track of which index image is to be loaded next\r\n\t_imageCounter: 0,\r\n\t\r\n\t// _tmpImage: DomNode\r\n\t//\tThe temporary image to show when a picture is loading.\r\n\t_tmpImage: null,\r\n\t\r\n\t// _request: Object\r\n\t//\tImplementation of the dojo/data/api/Request API, which defines the query\r\n\t//\tparameters for accessing the store.\r\n\t_request: null,\r\n\r\n\tpostCreate: function(){\r\n\t\t// summary:\r\n\t\t//\t\tInitializes the widget, sets up listeners and shows the first image\r\n\t\tthis.inherited(arguments);\r\n\t\tvar img = document.createElement(\"img\");\r\n\r\n\t\t// FIXME: should API be to normalize an image to fit in the specified height/width?\r\n\t\timg.setAttribute(\"width\", this.imageWidth);\r\n\t\timg.setAttribute(\"height\", this.imageHeight);\r\n\r\n\t\tif(this.hasNav){\r\n\t\t\tdojo.connect(this.outerNode, \"onmouseover\", this, function(evt){\r\n\t\t\t\ttry{ this._showNav();}\r\n\t\t\t\tcatch(e){} //TODO: remove try/catch\r\n\t\t\t});\r\n\t\t\tdojo.connect(this.outerNode, \"onmouseout\", this, function(evt){\r\n\t\t\t\ttry{ this._hideNav(evt);}\r\n\t\t\t\tcatch(e){} //TODO: remove try/catch\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\tthis.outerNode.style.width = this.imageWidth + \"px\";\r\n\r\n\t\timg.setAttribute(\"src\", this._blankGif);\r\n\t\tvar _this = this;\r\n\t\t\r\n\t\tthis.largeNode.appendChild(img);\r\n\t\tthis._tmpImage = this._currentImage = img;\r\n\t\tthis._fitSize(true);\r\n\t\t\r\n\t\tthis._loadImage(0, dojo.hitch(this, \"showImage\", 0));\r\n\t\tthis._calcNavDimensions();\r\n\t\tdojo.style(this.navNode, \"opacity\", 0);\r\n\t},\r\n\r\n\tsetDataStore: function(dataStore, request, /*optional*/paramNames){\r\n\t\t// summary:\r\n\t\t//\t\tSets the data store and request objects to read data from.\r\n\t\t// dataStore:\r\n\t\t//\t\tAn implementation of the dojo/data/api/Read API. This accesses the image\r\n\t\t//\t\tdata.\r\n\t\t// request:\r\n\t\t//\t\tAn implementation of the dojo/data/api/Request API. This specifies the\r\n\t\t//\t\tquery and paging information to be used by the data store\r\n\t\t// paramNames:\r\n\t\t//\t\tAn object defining the names of the item attributes to fetch from the\r\n\t\t//\t\tdata store.  The three attributes allowed are 'linkAttr', 'imageLargeAttr' and 'titleAttr'\r\n\t\tthis.reset();\r\n\t\tvar _this = this;\r\n\r\n\t\tthis._request = {\r\n\t\t\tquery: {},\r\n\t\t\tstart: request.start || 0,\r\n\t\t\tcount: request.count || this.pageSize,\r\n\t\t\tonBegin: function(count, request){\r\n\t\t\t\t// FIXME: fires too often?!?\r\n\t\t\t\t_this.maxPhotos = count;\r\n\t\t\t}\r\n\t\t};\r\n\t\tif(request.query){\r\n\t\t\tdojo.mixin(this._request.query, request.query);\r\n\t\t}\r\n\t\tif(paramNames){\r\n\t\t\tdojo.forEach([\"imageLargeAttr\", \"linkAttr\", \"titleAttr\"], function(attrName){\r\n\t\t\t\tif(paramNames[attrName]){\r\n\t\t\t\t\tthis[attrName] = paramNames[attrName];\r\n\t\t\t\t}\r\n\t\t\t}, this);\r\n\t\t}\r\n\t\r\n\t\tvar _complete = function(items){\r\n\t\t\t// FIXME: onBegin above used to work for maxPhotos:\r\n\t\t\t_this.maxPhotos = items.length;\r\n\t\t\t_this._request.onComplete = null;\r\n\t\t\tif(_this.autoStart){\r\n\t\t\t\t_this.imageIndex = -1;\r\n\t\t\t\t_this.toggleSlideShow();\r\n\t\t\t} else {\r\n\t\t\t\t_this.showImage(0);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t};\r\n\r\n\t\tthis.imageStore = dataStore;\r\n\t\tthis._request.onComplete = _complete;\r\n\t\tthis._request.start = 0;\r\n\t\tthis.imageStore.fetch(this._request);\r\n\t},\r\n\r\n\treset: function(){\r\n\t\t// summary:\r\n\t\t//\t\tResets the widget to its initial state\r\n\t\t// description:\r\n\t\t//\t\tRemoves all previously loaded images, and clears all caches.\r\n\t\tdojo.query(\"> *\", this.largeNode).orphan();\r\n\t\tthis.largeNode.appendChild(this._tmpImage);\r\n\t\t\r\n\t\tdojo.query(\"> *\", this.hiddenNode).orphan();\r\n\t\tdojo.forEach(this.images, function(img){\r\n\t\t\tif(img && img.parentNode){ img.parentNode.removeChild(img); }\r\n\t\t});\r\n\t\tthis.images = [];\r\n\t\tthis.isInitialized = false;\r\n\t\tthis._imageCounter = 0;\r\n\t},\r\n\r\n\tisImageLoaded: function(index){\r\n\t\t// summary:\r\n\t\t//\t\tReturns true if image at the specified index is loaded, false otherwise.\r\n\t\t// index:\r\n\t\t//\t\tThe number index in the data store to check if it is loaded.\r\n\t\treturn this.images && this.images.length > index && this.images[index];\r\n\t},\r\n\r\n\tmoveImageLoadingPointer: function(index){\r\n\t\t// summary:\r\n\t\t//\t\tIf 'autoload' is true, this tells the widget to start loading\r\n\t\t//\t\timages from the specified pointer.\r\n\t\t// index:\r\n\t\t//\t\tThe number index in the data store to start loading images from.\r\n\t\tthis._imageCounter = index;\r\n\t},\r\n\t\r\n\tdestroy: function(){\r\n\t\t// summary:\r\n\t\t//\t\tCleans up the widget when it is being destroyed\r\n\t\tif(this._slideId) { this._stop(); }\r\n\t\tthis.inherited(arguments);\r\n\t},\r\n\r\n\tshowNextImage: function(inTimer, forceLoop){\r\n\t\t// summary:\r\n\t\t//\t\tChanges the image being displayed to the next image in the data store\r\n\t\t// inTimer: Boolean\r\n\t\t//\t\tIf true, a slideshow is active, otherwise the slideshow is inactive.\r\n\t\tif(inTimer && this._timerCancelled){ return false; }\r\n\t\t\r\n\t\tif(this.imageIndex + 1 >= this.maxPhotos){\r\n\t\t\tif(inTimer && (this.loop || forceLoop)){\r\n\t\t\t\tthis.imageIndex = -1;\r\n\t\t\t}else{\r\n\t\t\t\tif(this._slideId){ this._stop(); }\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.showImage(this.imageIndex + 1, dojo.hitch(this,function(){\r\n\t\t\tif(inTimer){ this._startTimer(); }\r\n\t\t}));\r\n\t\treturn true;\r\n\t},\r\n\r\n\ttoggleSlideShow: function(){\r\n\t\t// summary:\r\n\t\t//\t\tSwitches the slideshow mode on and off.\r\n\t\t\r\n\t\t// If the slideshow is already running, stop it.\r\n\t\tif(this._slideId){\r\n\t\t\tthis._stop();\r\n\t\t}else{\r\n\t\t\tdojo.toggleClass(this.domNode,\"slideShowPaused\");\r\n\t\t\tthis._timerCancelled = false;\r\n\t\t\tvar idx = this.imageIndex;\r\n\r\n\t\t\tif(idx < 0 || (this.images[idx] && this.images[idx]._img.complete)){\r\n\t\t\t\tvar success = this.showNextImage(true, true);\r\n\r\n\t\t\t\tif(!success){\r\n\t\t\t\t\tthis._stop();\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\tvar handle = dojo.subscribe(this.getShowTopicName(), dojo.hitch(this, function(info){\r\n\t\t\t\t\tsetTimeout(dojo.hitch(this, function(){\r\n\t\t\t\t\t\tif(info.index == idx){\r\n\t\t\t\t\t\t\tvar success = this.showNextImage(true, true);\r\n\t\t\t\t\t\t\tif(!success){\r\n\t\t\t\t\t\t\t\tthis._stop();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdojo.unsubscribe(handle);\r\n\t\t\t\t\t\t}}),\r\n\t\t\t\t\t\tthis.slideshowInterval * 1000);\r\n\t\t\t\t}));\r\n\t\t\t\tdojo.publish(this.getShowTopicName(),\r\n\t\t\t\t  [{index: idx,\ttitle: \"\", url: \"\"}]);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tgetShowTopicName: function(){\r\n\t\t// summary:\r\n\t\t//\t\tReturns the topic id published to when an image is shown\r\n\t\t// description:\r\n\t\t//\t\tThe information published is: index, title and url\r\n\t\treturn (this.widgetId || this.id) + \"/imageShow\";\r\n\t},\r\n\r\n\tgetLoadTopicName: function(){\r\n\t\t// summary:\r\n\t\t//\t\tReturns the topic id published to when an image finishes loading.\r\n\t\t// description:\r\n\t\t//\t\tThe information published is the index position of the image loaded.\r\n\t\treturn (this.widgetId ? this.widgetId : this.id) + \"/imageLoad\";\r\n\t},\r\n\r\n\tshowImage: function(index, /* Function? */callback){\r\n\t\t// summary:\r\n\t\t//\t\tShows the image at index 'index'.\r\n\t\t// index: Number\r\n\t\t//\t\tThe position of the image in the data store to display\r\n\t\t// callback: Function\r\n\t\t//\t\tOptional callback function to call when the image has finished displaying.\r\n\r\n\t\tif(!callback && this._slideId){\r\n\t\t\tthis.toggleSlideShow();\r\n\t\t}\r\n\t\tvar _this = this;\r\n\t\tvar current = this.largeNode.getElementsByTagName(\"div\");\r\n\t\tthis.imageIndex = index;\r\n\r\n\t\tvar showOrLoadIt = function() {\r\n\t\t\t//If the image is already loaded, then show it.\r\n\t\t\tif(_this.images[index]){\r\n\t\t\t\twhile(_this.largeNode.firstChild){\r\n\t\t\t\t\t_this.largeNode.removeChild(_this.largeNode.firstChild);\r\n\t\t\t\t}\r\n\t\t\t\tdojo.style(_this.images[index],\"opacity\", 0);\r\n\t\t\t\t_this.largeNode.appendChild(_this.images[index]);\r\n\t\t\t\t_this._currentImage = _this.images[index]._img;\r\n\t\t\t\t_this._fitSize();\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\tvar onEnd = function(a,b,c){\r\n\r\n\t\t\t\t\tvar img = _this.images[index].firstChild;\r\n\t\t\t\t\tif(img.tagName.toLowerCase() != \"img\"){ img = img.firstChild; }\r\n\t\t\t\t\tvar title = img.getAttribute(\"title\") || \"\";\r\n\t\t\t\t\tif(_this._navShowing){\r\n\t\t\t\t\t\t_this._showNav(true);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdojo.publish(_this.getShowTopicName(), [{\r\n\t\t\t\t\t\tindex: index,\r\n\t\t\t\t\t\ttitle: title,\r\n\t\t\t\t\t\turl: img.getAttribute(\"src\")\r\n\t\t\t\t\t}]);\r\n\r\n        \t\t\t\tif(callback) {\r\n        \t\t\t\t\tcallback(a,b,c);\r\n        \t\t\t\t}\r\n\t\t\t\t\t_this._setTitle(title);\r\n\t        \t\t};\r\n\t\t\t\t\r\n\t\t\t\tdojo.fadeIn({\r\n\t\t\t\t\tnode: _this.images[index],\r\n\t\t\t\t\tduration: 300,\r\n\t\t\t\t\tonEnd: onEnd\r\n\t\t\t\t}).play();\r\n\t\t\t\t\r\n\t\t\t}else{\r\n\t\t\t\t//If the image is not loaded yet, load it first, then show it.\r\n\t\t\t\t_this._loadImage(index, function(){\r\n\t\t\t\t\t_this.showImage(index, callback);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t//If an image is currently showing, fade it out, then show\r\n\t\t//the new image. Otherwise, just show the new image.\r\n\t\tif(current && current.length > 0){\r\n\t\t\tdojo.fadeOut({\r\n\t\t\t\tnode: current[0],\r\n\t\t\t\tduration: 300,\r\n\t\t\t\tonEnd: function(){\r\n\t\t\t\t\t_this.hiddenNode.appendChild(current[0]);\r\n\t\t\t\t\tshowOrLoadIt();\r\n\t\t\t\t}\r\n\t\t\t}).play();\r\n\t\t}else{\r\n\t\t\tshowOrLoadIt();\r\n\t\t}\r\n\t},\r\n\t\r\n\t_fitSize: function(force){\r\n\t\t// summary:\r\n\t\t//\t\tFits the widget size to the size of the image being shown,\r\n\t\t//\t\tor centers the image, depending on the value of 'fixedHeight'\r\n\t\t// force: Boolean\r\n\t\t//\t\tIf true, the widget is always resized, regardless of the value of 'fixedHeight'\r\n\t\tif(!this.fixedHeight || force){\r\n\t\t\tvar height = (this._currentImage.height + (this.hasNav ? 20:0));\r\n\t\t\tdojo.style(this.innerWrapper, \"height\", height + \"px\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tdojo.style(this.largeNode, \"paddingTop\", this._getTopPadding() + \"px\");\r\n\t},\r\n\t\r\n\t_getTopPadding: function(){\r\n\t\t// summary:\r\n\t\t//\t\tReturns the padding to place at the top of the image to center it vertically.\r\n\t\tif(!this.fixedHeight){ return 0; }\r\n\t\treturn (this.imageHeight - this._currentImage.height) / 2;\r\n\t},\r\n\t\r\n\t_loadNextImage: function(){\r\n\t\t// summary:\r\n\t\t//\t\tLoad the next unloaded image.\r\n\r\n\t\tif(!this.autoLoad){\r\n\t\t\treturn;\r\n\t\t}\r\n\t\twhile(this.images.length >= this._imageCounter && this.images[this._imageCounter]){\r\n\t\t\tthis._imageCounter++;\r\n\t\t}\r\n\t\tthis._loadImage(this._imageCounter);\r\n\t},\r\n\t\r\n\t_loadImage: function(index, callbackFn){\r\n\t\t// summary:\r\n\t\t//\t\tLoad image at specified index\r\n\t\t// description:\r\n\t\t//\t\tThis function loads the image at position 'index' into the\r\n\t\t//\t\tinternal cache of images.  This does not cause the image to be displayed.\r\n\t\t// index:\r\n\t\t//\t\tThe position in the data store to load an image from.\r\n\t\t// callbackFn:\r\n\t\t//\t\tAn optional function to execute when the image has finished loading.\r\n\r\n\t\tif(this.images[index] || !this._request) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tvar pageStart = index - (index % (this._request.count || this.pageSize));\r\n\r\n\t\tthis._request.start = pageStart;\r\n\r\n\t\tthis._request.onComplete = function(items){\r\n\t\t\tvar diff = index - pageStart;\r\n\t\t\t\r\n\t\t\tif(items && items.length > diff){\r\n\t\t\t\tloadIt(items[diff]);\r\n\t\t\t}else{ /* Squelch - console.log(\"Got an empty set of items\"); */ }\r\n\t\t}\r\n\r\n\t\tvar _this = this;\r\n\t\tvar store = this.imageStore;\r\n\t\tvar loadIt = function(item){\r\n\t\t\tvar url = _this.imageStore.getValue(item, _this.imageLargeAttr);\r\n\t\t\t\r\n\t\t\tvar img = new Image();\t// when creating img with \"createElement\" IE doesnt has width and height, so use the Image object\r\n\t\t\tvar div = dojo.create(\"div\", {\r\n\t\t\t\tid: _this.id + \"_imageDiv\" + index\r\n\t\t\t});\r\n\t\t\tdiv._img = img;\r\n\r\n\t\t\tvar link = _this.imageStore.getValue(item,_this.linkAttr);\r\n\t\t\tif(!link || _this.noLink){\r\n\t\t\t\tdiv.appendChild(img);\r\n\t\t\t}else{\r\n\t\t\t\tvar a = dojo.create(\"a\", {\r\n\t\t\t\t\t\"href\": link,\r\n\t\t\t\t\t\"target\": \"_blank\"\r\n\t\t\t\t}, div);\r\n\t\t\t\ta.appendChild(img);\r\n\t\t\t}\r\n\r\n\t\t\tdojo.connect(img, \"onload\", function(){\r\n\t\t\t\tif(store != _this.imageStore){\r\n\t\t\t\t\t// If the store has changed, ignore this load event.\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t_this._fitImage(img);\r\n\t\t\t\tdojo.attr(div, {\"width\": _this.imageWidth, \"height\": _this.imageHeight});\r\n\t\t\t\t\r\n\t\t\t\t// make a short timeout to prevent IE6/7 stack overflow at line 0 ~ still occuring though for first image\r\n\t\t\t\tdojo.publish(_this.getLoadTopicName(), [index]);\r\n\r\n\t\t\t\tsetTimeout(function(){_this._loadNextImage();}, 1);\r\n\t\t\t\tif(callbackFn){ callbackFn(); }\r\n\t\t\t});\r\n\t\t\t_this.hiddenNode.appendChild(div);\r\n\r\n\t\t\tvar titleDiv = dojo.create(\"div\", {\r\n\t\t\t\tclassName: \"slideShowTitle\"\r\n\t\t\t}, div);\r\n\r\n\t\t\t_this.images[index] = div;\r\n\t\t\tdojo.attr(img, \"src\", url);\r\n\t\t\t\r\n\t\t\tvar title = _this.imageStore.getValue(item, _this.titleAttr);\r\n\t\t\tif(title){ dojo.attr(img, \"title\", title); }\r\n\t\t}\r\n\t\tthis.imageStore.fetch(this._request);\r\n\t},\r\n\r\n\t_stop: function(){\r\n\t\t// summary:\r\n\t\t//\t\tStops a running slide show.\r\n\t\tif(this._slideId){ clearTimeout(this._slideId); }\r\n\t\tthis._slideId = null;\r\n\t\tthis._timerCancelled = true;\r\n\t\tdojo.removeClass(this.domNode,\"slideShowPaused\");\r\n\t},\r\n\r\n\t_prev: function(){\r\n\t\t// summary:\r\n\t\t//\t\tShow the previous image.\r\n\r\n\t\t// FIXME: either pull code from showNext/prev, or call it here\r\n\t\tif(this.imageIndex < 1){ return; }\r\n\t\tthis.showImage(this.imageIndex - 1);\r\n\t},\r\n\r\n\t_next: function(){\r\n\t\t// summary:\r\n\t\t//\t\tShow the next image\r\n\t\tthis.showNextImage();\r\n\t},\r\n\r\n\t_startTimer: function(){\r\n\t\t// summary:\r\n\t\t//\t\tStarts a timeout to show the next image when a slide show is active\r\n\t\tvar id = this.id;\r\n\t\tthis._slideId = setTimeout(function(){\r\n\t\t\tdijit.byId(id).showNextImage(true);\r\n\t\t}, this.slideshowInterval * 1000);\r\n\t},\r\n\t\r\n\t_calcNavDimensions: function() {\r\n\t\t// summary:\r\n\t\t//\t\tCalculates the dimensions of the navigation controls\r\n\t\tdojo.style(this.navNode, \"position\", \"absolute\");\r\n\t\t\r\n\t\t//Place the navigation controls far off screen\r\n\t\tdojo.style(this.navNode, \"top\", \"-10000px\");\r\n\t\t\r\n\t\tdojo.style(this.navPlay, 'marginLeft', 0);\r\n\t\t\r\n\t\tthis.navPlay._size = dojo.marginBox(this.navPlay);\r\n\t\tthis.navPrev._size = dojo.marginBox(this.navPrev);\r\n\t\tthis.navNext._size = dojo.marginBox(this.navNext);\r\n\t\t\r\n\t\tdojo.style(this.navNode, {\"position\": \"\", top: \"\"});\r\n\t},\r\n\r\n\t_setTitle: function(title){\r\n\t\t// summary:\r\n\t\t//\t\tSets the title to the image being displayed\r\n\t\t// title: String\r\n\t\t//\t\tThe String title of the image\r\n\r\n\t\tthis.titleNode.innerHTML = dojo.string.substitute(this.titleTemplate,{\r\n\t\t\ttitle: title,\r\n\t\t\tcurrent: 1 + this.imageIndex,\r\n\t\t\ttotal: this.maxPhotos || \"\"\r\n\t\t});\r\n\t},\r\n\t\r\n\t_fitImage: function(img) {\r\n\t\t// summary:\r\n\t\t//\t\tEnsures that the image width and height do not exceed the maximum.\r\n\t\t// img: Node\r\n\t\t//\t\tThe image DOM node to optionally resize\r\n\t\tvar width = img.width;\r\n\t\tvar height = img.height;\r\n\t\t\r\n\t\tif(width > this.imageWidth){\r\n\t\t\theight = Math.floor(height * (this.imageWidth / width));\r\n\t\t\timg.height = height;\r\n\t\t\timg.width = width = this.imageWidth;\r\n\t\t}\r\n\t\tif(height > this.imageHeight){\r\n\t\t\twidth = Math.floor(width * (this.imageHeight / height));\r\n\t\t\timg.height = this.imageHeight;\r\n\t\t\timg.width = width;\r\n\t\t}\r\n\t},\r\n\t\r\n\t_handleClick: function(/* Event */e){\r\n\t\t// summary:\r\n\t\t//\t\tPerforms navigation on the images based on users mouse clicks\r\n\t\t// e:\r\n\t\t//\t\tAn Event object\r\n\t\tswitch(e.target){\r\n\t\t\tcase this.navNext: this._next(); break;\r\n\t\t\tcase this.navPrev: this._prev(); break;\r\n\t\t\tcase this.navPlay: this.toggleSlideShow(); break;\r\n\t\t}\r\n\t},\r\n\t\r\n\t_showNav: function(force){\r\n\t\t// summary:\r\n\t\t//\t\tShows the navigation controls\r\n\t\t// force: Boolean\r\n\t\t//\t\tIf true, the navigation controls are repositioned even if they are\r\n\t\t//\t\tcurrently visible.\r\n\t\tif(this._navShowing && !force){return;}\r\n\t\tthis._calcNavDimensions();\r\n\t\tdojo.style(this.navNode, \"marginTop\", \"0px\");\r\n\t\t\r\n\t\t\r\n\t\tvar navPlayPos = dojo.style(this.navNode, \"width\")/2 - this.navPlay._size.w/2 - this.navPrev._size.w;\r\n\t\tconsole.log('navPlayPos = ' + dojo.style(this.navNode, \"width\")/2 + ' - ' + this.navPlay._size.w + '/2 - '\r\n\t\t\t\t+ this.navPrev._size.w);\r\n\t\t\r\n\t\tdojo.style(this.navPlay, \"marginLeft\", navPlayPos + \"px\");\r\n\t\tvar wrapperSize = dojo.marginBox(this.outerNode);\r\n\t\t\r\n\t\tvar margin = this._currentImage.height - this.navPlay._size.h - 10 + this._getTopPadding();\r\n\t\t\r\n\t\tif(margin > this._currentImage.height){margin += 10;}\r\n\t\tdojo[this.imageIndex < 1 ? \"addClass\":\"removeClass\"](this.navPrev, \"slideShowCtrlHide\");\r\n\t\tdojo[this.imageIndex + 1 >= this.maxPhotos ? \"addClass\":\"removeClass\"](this.navNext, \"slideShowCtrlHide\");\r\n\t\r\n\t\tvar _this = this;\r\n\t\tif(this._navAnim) {\r\n\t\t\tthis._navAnim.stop();\r\n\t\t}\r\n\t\tif(this._navShowing){ return; }\r\n\t\tthis._navAnim = dojo.fadeIn({\r\n\t\t\tnode: this.navNode,\r\n\t\t\tduration: 300,\r\n\t\t\tonEnd: function(){ _this._navAnim = null; }\r\n\t\t});\r\n\t\tthis._navAnim.play();\r\n\t\tthis._navShowing = true;\r\n\t},\r\n\t\r\n\t_hideNav: function(/* Event */e){\r\n\t\t// summary:\r\n\t\t//\t\tHides the navigation controls\r\n\t\t// e: Event\r\n\t\t//\t\tThe DOM Event that triggered this function\r\n\t\tif(!e || !this._overElement(this.outerNode, e)){\r\n\t\t\tvar _this = this;\r\n\t\t\tif(this._navAnim){\r\n\t\t\t\tthis._navAnim.stop();\r\n\t\t\t}\r\n\t\t\tthis._navAnim = dojo.fadeOut({\r\n\t\t\t\tnode: this.navNode,\r\n\t\t\t\tduration:300,\r\n\t\t\t\tonEnd: function(){ _this._navAnim = null; }\r\n\t\t\t});\r\n\t\t\tthis._navAnim.play();\r\n\t\t\tthis._navShowing = false;\r\n\t\t}\r\n\t},\r\n\t\r\n\t_overElement: function(/*DomNode*/element, /*Event*/e){\r\n\t\t// summary:\r\n\t\t//\t\tReturns whether the mouse is over the passed element.\r\n\t\t//\t\tElement must be display:block (ie, not a `<span>`)\r\n\t\t\r\n\t\t//When the page is unloading, if this method runs it will throw an\r\n\t\t//exception.\r\n\t\tif(typeof(dojo) == \"undefined\"){ return false; }\r\n\t\telement = dojo.byId(element);\r\n\t\tvar m = { x: e.pageX, y: e.pageY };\r\n\t\tvar bb = dojo.position(element, true);\r\n\r\n\t\treturn (m.x >= bb.x\r\n\t\t\t&& m.x <= (bb.x + bb.w)\r\n\t\t\t&& m.y >= bb.y\r\n\t\t\t&& m.y <= (top + bb.h)\r\n\t\t);\t//\tboolean\r\n\t}\r\n});\r\n"]}