{"version":3,"sources":["charting/action2d/_IndicatorElement.js"],"names":["define","lang","array","declare","Indicator","has","getXYCoordinates","v","values","data","c2","c1","x","y","length","_IndicatorElement","constructor","chart","kwArgs","this","inter","_updateVisibility","cp","limit","attr","axis","_hAxis","_vAxis","scale","getWindowScale","setAxisWindow","name","getWindowOffset","_noDirty","render","_initTrack","_trackMove","_updateIndicator","pageCoord","_tracker","setTimeout","hitch","stopTrack","clearTimeout","isDirty","plot","opt","vertical","offset","labelFunc","index","fixed","precision","coords","fillFunc","delegate","labels","secondCoord","onChange","hAxis","vAxis","inherited","arguments","coordinates","_updateCoordinates","_data","forEach","value","push","_renderText","g","text","t","start","end","label","cp1","cp2","_checkXCoords","tmp","getAxis","hn","vn","hb","getScaler","bounds","vb","n","cd2","cd1","toData","o","from","min","toPage","to","max","autoScroll","mouseOver","_snapData","cd","i","r","px","py","getSeries","series","l","m","cleanGroup","creator","group","moveToFront","dirty","extend","isRightToLeft","dim","width","offsets"],"mappings":"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","file":"../../../charting/action2d/_IndicatorElement.js","sourcesContent":["define([\"dojo/_base/lang\", \"dojo/_base/array\", \"dojo/_base/declare\", \"../plot2d/Indicator\",\r\n        \"dojo/has\", \"../plot2d/common\", \"../axis2d/common\", \"dojox/gfx\"], \r\n\tfunction(lang, array, declare, Indicator, has){\r\n\r\n\tvar getXYCoordinates = function(v, values, data){\r\n\t\tvar c2, c1 = v?{ x: values[0], y : data[0][0] } :\r\n\t\t\t\t\t   { x : data[0][0], y : values[0] };\r\n\t\tif(values.length > 1){\r\n\t\t\tc2 = v?{ x: values[1], y : data[1][0] } :\r\n\t\t\t\t   { x : data[1][0], y : values[1] };\r\n\t\t}\r\n\t\treturn [c1, c2];\r\n\t};\r\n\r\n\tvar _IndicatorElement = declare(\"dojox.charting.action2d._IndicatorElement\", Indicator, {\r\n\t\t// summary:\r\n\t\t//\t\tInternal element used by indicator actions.\r\n\t\t// tags:\r\n\t\t//\t\tprivate\r\n\t\tconstructor: function(chart, kwArgs){\r\n\t\t\tif(!kwArgs){ kwArgs = {}; }\r\n\t\t\tthis.inter = kwArgs.inter;\r\n\t\t},\r\n\t\t_updateVisibility: function(cp, limit, attr){\r\n\t\t\tvar axis = attr==\"x\"?this._hAxis:this._vAxis;\r\n\t\t\tvar scale = axis.getWindowScale();\r\n\t\t\tthis.chart.setAxisWindow(axis.name, scale, axis.getWindowOffset() + (cp[attr] - limit[attr]) / scale);\r\n\t\t\tthis._noDirty = true;\r\n\t\t\tthis.chart.render();\r\n\t\t\tthis._noDirty = false;\r\n\t\t\tthis._initTrack();\r\n\t\t},\r\n\t\t_trackMove: function(){\r\n\t\t\t// let's update the selector\r\n\t\t\tthis._updateIndicator(this.pageCoord);\r\n\t\t\t// if we reached that point once, then we don't stop until mouse up\r\n \t\t\t// use a recursive setTimeout to avoid intervals that might get backed up\r\n\t\t\tthis._tracker = setTimeout(lang.hitch(this, this._trackMove), 100);\r\n\t\t},\r\n\t\t_initTrack: function(){\r\n\t\t\tif(!this._tracker){\r\n\t\t\t\tthis._tracker = setTimeout(lang.hitch(this, this._trackMove), 500);\r\n\t\t\t}\r\n\t\t},\r\n\t\tstopTrack: function(){\r\n\t\t\tif(this._tracker){\r\n\t\t\t\tclearTimeout(this._tracker);\r\n\t\t\t\tthis._tracker = null;\r\n\t\t\t}\r\n\t\t},\r\n\t\trender: function(){\r\n\t\t\tif(!this.isDirty()){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar inter = this.inter, plot = inter.plot, v = inter.opt.vertical;\r\n\r\n\t\t\tthis.opt.offset = inter.opt.offset || (v?{ x:0 , y: 5}: { x: 5, y: 0});\r\n\r\n\t\t\tif(inter.opt.labelFunc){\r\n\t\t\t\t// adapt to indicator labelFunc format\r\n\t\t\t\tthis.opt.labelFunc = function(index, values, data, fixed, precision){\r\n\t\t\t\t\tvar coords = getXYCoordinates(v, values, data);\r\n\t\t\t\t\treturn inter.opt.labelFunc(coords[0], coords[1], fixed, precision);\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tif(inter.opt.fillFunc){\r\n\t\t\t\t// adapt to indicator fillFunc format\r\n\t\t\t\tthis.opt.fillFunc = function(index, values, data){\r\n\t\t\t\t\tvar coords = getXYCoordinates(v, values, data);\r\n\t\t\t\t\treturn inter.opt.fillFunc(coords[0], coords[1]);\r\n\t\t\t\t};\r\n\t\t\t}\r\n\r\n\t\t\tthis.opt = lang.delegate(inter.opt, this.opt);\r\n\r\n\t\t\tif(!this.pageCoord){\r\n\t\t\t\tthis.opt.values = null;\r\n\t\t\t\tthis.inter.onChange({});\r\n\t\t\t}else{\r\n\t\t\t\t// let's create a fake coordinate to not block parent render method\r\n\t\t\t\t// actual coordinate will be computed in _updateCoordinates\r\n\t\t\t\tthis.opt.values = [];\r\n\t\t\t\tthis.opt.labels = this.secondCoord?\"trend\":\"markers\";\r\n\t\t\t}\r\n\r\n\t\t\t// take axis on the interactor plot and forward them onto the indicator plot\r\n\t\t\tthis.hAxis = plot.hAxis;\r\n\t\t\tthis.vAxis = plot.vAxis;\r\n\r\n\t\t\tthis.inherited(arguments);\r\n\t\t},\r\n\t\t_updateIndicator: function(){\r\n\t\t\tvar coordinates = this._updateCoordinates(this.pageCoord, this.secondCoord);\r\n\t\t\tif(coordinates.length > 1){\r\n\t\t\t\tvar v = this.opt.vertical;\r\n\t\t\t\tthis._data= [];\r\n\t\t\t\tthis.opt.values = [];\r\n\t\t\t\tarray.forEach(coordinates, function(value){\r\n\t\t\t\t\tif(value){\r\n\t\t\t\t\t\tthis.opt.values.push(v?value.x:value.y);\r\n\t\t\t\t\t\tthis._data.push([v?value.y:value.x]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}, this);\r\n\t\t\t}else{\r\n\t\t\t\tthis.inter.onChange({});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.inherited(arguments);\r\n\t\t},\r\n\t\t_renderText: function(g, text, t, x, y, index, values, data){\r\n\t\t\t// render only if labels is true\r\n\t\t\tif(this.inter.opt.labels){\r\n\t\t\t\tthis.inherited(arguments);\r\n\t\t\t}\r\n\t\t\t// send the event in all cases\r\n\t\t\tvar coords = getXYCoordinates(this.opt.vertical, values, data);\r\n\t\t\tthis.inter.onChange({\r\n\t\t\t\tstart: coords[0],\r\n\t\t\t\tend: coords[1],\r\n\t\t\t\tlabel: text\r\n\t\t\t});\r\n\t\t},\r\n\t\t_updateCoordinates: function(cp1, cp2){\r\n\t\t\t// chart mirroring starts\r\n\t\t\tif(has(\"dojo-bidi\")){\r\n\t\t\t\tthis._checkXCoords(cp1, cp2);\r\n\t\t\t}\r\n\t\t\t// chart mirroring ends\r\n\t\t\tvar inter = this.inter, plot = inter.plot, v = inter.opt.vertical;\r\n\t\t\tvar hAxis = this.chart.getAxis(plot.hAxis), vAxis = this.chart.getAxis(plot.vAxis);\r\n\t\t\tvar hn = hAxis.name, vn = vAxis.name, hb = hAxis.getScaler().bounds, vb = vAxis.getScaler().bounds;\r\n\t\t\tvar attr = v?\"x\":\"y\", n = v?hn:vn, bounds = v?hb:vb;\r\n\r\n\t\t\t// sort data point\r\n\t\t\tif(cp2){\r\n\t\t\t\tvar tmp;\r\n\t\t\t\tif(v){\r\n\t\t\t\t\tif(cp1.x > cp2.x){\r\n\t\t\t\t\t\ttmp = cp2;\r\n\t\t\t\t\t\tcp2 = cp1;\r\n\t\t\t\t\t\tcp1 = tmp;\r\n\t\t\t\t\t}\r\n\t\t\t\t}else{\r\n\t\t\t\t\tif(cp1.y > cp2.y){\r\n\t\t\t\t\t\ttmp = cp2;\r\n\t\t\t\t\t\tcp2 = cp1;\r\n\t\t\t\t\t\tcp1 = tmp;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar cd1 = plot.toData(cp1), cd2;\r\n\t\t\tif(cp2){\r\n\t\t\t\tcd2 = plot.toData(cp2);\r\n\t\t\t}\r\n\r\n\t\t\tvar o = {};\r\n\t\t\to[hn] = hb.from;\r\n\t\t\to[vn] = vb.from;\r\n\t\t\tvar min = plot.toPage(o);\r\n\t\t\to[hn] = hb.to;\r\n\t\t\to[vn] = vb.to;\r\n\t\t\tvar max = plot.toPage(o);\r\n\r\n\t\t\tif(cd1[n] < bounds.from){\r\n\t\t\t\t// do not autoscroll if dual indicator\r\n\t\t\t\tif(!cd2 && inter.opt.autoScroll && !inter.opt.mouseOver){\r\n\t\t\t\t\tthis._updateVisibility(cp1, min, attr);\r\n\t\t\t\t\treturn [];\r\n\t\t\t\t}else{\r\n\t\t\t\t\tif(inter.opt.mouseOver){\r\n\t\t\t\t\t\treturn[];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcp1[attr] = min[attr];\r\n\t\t\t\t}\r\n\t\t\t\t// cp1 might have changed, let's update cd1\r\n\t\t\t\tcd1 = plot.toData(cp1);\r\n\t\t\t}else if(cd1[n] > bounds.to){\r\n\t\t\t\tif(!cd2 && inter.opt.autoScroll && !inter.opt.mouseOver){\r\n\t\t\t\t\tthis._updateVisibility(cp1, max, attr);\r\n\t\t\t\t\treturn [];\r\n\t\t\t\t}else{\r\n\t\t\t\t\tif(inter.opt.mouseOver){\r\n\t\t\t\t\t\treturn[];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcp1[attr] = max[attr];\r\n\t\t\t\t}\r\n\t\t\t\t// cp1 might have changed, let's update cd1\r\n\t\t\t\tcd1 = plot.toData(cp1);\r\n\t\t\t}\r\n\r\n\t\t\tvar c1 = this._snapData(cd1, attr, v), c2;\r\n\r\n\t\t\tif(c1.y == null){\r\n\t\t\t\t// we have no data for that point let's just return\r\n\t\t\t\treturn [];\r\n\t\t\t}\r\n\r\n\t\t\tif(cp2){\r\n\t\t\t\tif(cd2[n] < bounds.from){\r\n\t\t\t\t\tcp2[attr] = min[attr];\r\n\t\t\t\t\tcd2 = plot.toData(cp2);\r\n\t\t\t\t}else if(cd2[n] > bounds.to){\r\n\t\t\t\t\tcp2[attr] = max[attr];\r\n\t\t\t\t\tcd2 = plot.toData(cp2);\r\n\t\t\t\t}\r\n\t\t\t\tc2 = this._snapData(cd2, attr, v);\r\n\t\t\t\tif(c2.y == null){\r\n\t\t\t\t\t// we have no data for that point let's pretend we have a single touch point\r\n\t\t\t\t\tc2 = null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn [c1, c2];\r\n\t\t},\r\n\t\t_snapData: function(cd, attr, v){\r\n\t\t\t// we need to find which actual data point is \"close\" to the data value\r\n\t\t\tvar data = this.chart.getSeries(this.inter.opt.series).data;\r\n\t\t\t// let's consider data are sorted because anyway rendering will be \"weird\" with unsorted data\r\n\t\t\t// i is an index in the array, which is different from a x-axis value even for index based data\r\n\t\t\tvar i, r, l = data.length;\r\n\t\t\t// first let's find which data index we are in\r\n\t\t\tfor (i = 0; i < l; ++i){\r\n\t\t\t\tr = data[i];\r\n\t\t\t\tif(r == null){\r\n\t\t\t\t\t// move to next item\r\n\t\t\t\t}else if(typeof r == \"number\"){\r\n\t\t\t\t\tif(i + 1 > cd[attr]){\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}else if(r[attr] > cd[attr]){\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar x, y, px, py;\r\n\t\t\tif(typeof r == \"number\"){\r\n\t\t\t\tx = i+1;\r\n\t\t\t\ty = r;\r\n\t\t\t\tif(i > 0){\r\n\t\t\t\t\tpx = i;\r\n\t\t\t\t\tpy = data[i-1];\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\tx = r.x;\r\n\t\t\t\ty = r.y;\r\n\t\t\t\tif(i > 0){\r\n\t\t\t\t\tpx = data[i-1].x;\r\n\t\t\t\t\tpy = data[i-1].y;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(i > 0){\r\n\t\t\t\tvar m = v?(x+px)/2:(y+py)/2;\r\n\t\t\t\tif(cd[attr]<=m){\r\n\t\t\t\t\tx = px;\r\n\t\t\t\t\ty = py;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn {x: x, y: y};\r\n\t\t},\r\n\t\tcleanGroup: function(creator){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tClean any elements (HTML or GFX-based) out of our group, and create a new one.\r\n\t\t\t// creator: dojox/gfx/Surface?\r\n\t\t\t//\t\tAn optional surface to work with.\r\n\t\t\t// returns: dojox/charting/Element\r\n\t\t\t//\t\tA reference to this object for functional chaining.\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\t// we always want to be above regular plots and not clipped\r\n\t\t\tthis.group.moveToFront();\r\n\t\t\treturn this;\t//\tdojox/charting/Element\r\n\t\t},\r\n\t\tisDirty: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tReturn whether or not this plot needs to be redrawn.\r\n\t\t\t// returns: Boolean\r\n\t\t\t//\t\tIf this plot needs to be rendered, this will return true.\r\n\t\t\treturn !this._noDirty && (this.dirty || this.inter.plot.isDirty());\r\n\t\t}\r\n\t});\r\n\tif(has(\"dojo-bidi\")){\r\n\t\t_IndicatorElement.extend({\r\n\t\t\t_checkXCoords: function(cp1, cp2){\r\n\t\t\t\tif(this.chart.isRightToLeft()){\r\n\t\t\t\t\tif(cp1){\r\n\t\t\t\t\t\tcp1.x = this.chart.dim.width + (this.chart.offsets.l - this.chart.offsets.r) - cp1.x;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(cp2){\r\n\t\t\t\t\t\tcp2.x = this.chart.dim.width + (this.chart.offsets.l - this.chart.offsets.r) - cp2.x;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\t\t\t\r\n\t\t\t}\t\t\t\r\n\t\t});\r\n\t}\r\n\treturn _IndicatorElement;\r\n});\r\n"]}