{"version":3,"sources":["treemap/DrillDownUp.js"],"names":["define","lang","event","declare","on","domGeom","domConstruct","domStyle","fx","tap","postCreate","this","inherited","arguments","own","domNode","hitch","_onDoubleClick","doubletap","e","renderer","_getRendererFromTarget","target","item","_isLeaf","parentItem","itemToRenderer","getIdentity","rootItem","drillUp","drillDown","stop","removeChild","parent","_getRenderer","set","validateRendering","place","finalBox","position","corner","getMarginBox","animateProperty","node","duration","properties","left","end","x","l","top","y","t","height","h","width","w","onAnimate","values","box","getContentBox","_layoutGroupContent","level","onEnd","play","parentNode","spanInfo","zIndex","get","box2"],"mappings":"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","file":"../../treemap/DrillDownUp.js","sourcesContent":["define([\"dojo/_base/lang\", \"dojo/_base/event\", \"dojo/_base/declare\", \"dojo/on\", \"dojo/dom-geometry\", \"dojo/dom-construct\",\r\n\t\"dojo/dom-style\", \"dojo/_base/fx\", \"dojo/has!touch?dojox/gesture/tap\"],\r\n\tfunction(lang, event, declare, on, domGeom, domConstruct, domStyle, fx, tap){\r\n\r\n\treturn declare(\"dojox.treemap.DrillDownUp\", null, {\r\n\t\t// summary:\r\n\t\t//\t\tSpecializes TreeMap to support drill down and up operations.\r\n\r\n\t\tpostCreate: function(){\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\tthis.own(on(this.domNode, \"dblclick\", lang.hitch(this, this._onDoubleClick)));\r\n\t\t\tif(tap){\r\n\t\t\t\tthis.own(on(this.domNode, tap.doubletap, lang.hitch(this, this._onDoubleClick)));\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_onDoubleClick: function(e){\r\n\t\t\tvar renderer = this._getRendererFromTarget(e.target);\r\n\t\t\tif(renderer.item){\r\n\t\t\t\tvar item = renderer.item;\r\n\t\t\t\tif(this._isLeaf(item)){\r\n\t\t\t\t\t// walk up\r\n\t\t\t\t\titem = renderer.parentItem;\r\n\t\t\t\t\trenderer = this.itemToRenderer[this.getIdentity(item)];\r\n\t\t\t\t\t// our leaf parent is the root, we can't do much...\r\n\t\t\t\t\tif(renderer == null){\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// Drill up\r\n\t\t\t\tif(this.rootItem == item){\r\n\t\t\t\t\tthis.drillUp(renderer);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis.drillDown(renderer);\r\n\t\t\t\t}\r\n\t\t\t\tevent.stop(e);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tdrillUp: function(renderer){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tDrill up from the given renderer.\r\n\t\t\t// renderer: DomNode\r\n\t\t\t//\t\tThe item renderer.\r\n\t\t\tvar item = renderer.item;\r\n\r\n\t\t\t// Remove the current rootItem renderer\r\n\t\t\t// rebuild the tree map\r\n\t\t\t// and animate the old renderer before deleting it.\r\n\r\n\t\t\tthis.domNode.removeChild(renderer);\r\n\t\t\tvar parent = this._getRenderer(item).parentItem;\r\n\t\t\tthis.set(\"rootItem\", parent);\r\n\t\t\tthis.validateRendering(); // Must call this to create the treemap now\r\n\r\n\t\t\t// re-add the old renderer to show the animation\r\n\t\t\tdomConstruct.place(renderer, this.domNode);\r\n\r\n\t\t\tdomStyle.set(renderer, \"zIndex\", 40);\r\n\r\n\t\t\tvar finalBox = domGeom.position(this._getRenderer(item), true);\r\n\t\t\tvar corner = domGeom.getMarginBox(this.domNode);\r\n\r\n\t\t\tfx.animateProperty({\r\n\t\t\t\tnode: renderer, duration: 500, properties: {\r\n\t\t\t\t\tleft: {\r\n\t\t\t\t\t\tend: finalBox.x - corner.l\r\n\t\t\t\t\t}, top: {\r\n\t\t\t\t\t\tend: finalBox.y - corner.t\r\n\t\t\t\t\t}, height: {\r\n\t\t\t\t\t\tend: finalBox.h\r\n\t\t\t\t\t}, width: {\r\n\t\t\t\t\t\tend: finalBox.w\r\n\t\t\t\t\t}\r\n\t\t\t\t}, onAnimate: lang.hitch(this, function(values){\r\n\t\t\t\t\tvar box = domGeom.getContentBox(renderer);\r\n\t\t\t\t\tthis._layoutGroupContent(renderer, box.w, box.h, renderer.level + 1, false, true);\r\n\t\t\t\t}), onEnd: lang.hitch(this, function(){\r\n\t\t\t\t\tthis.domNode.removeChild(renderer);\r\n\t\t\t\t})\r\n\t\t\t}).play();\r\n\t\t},\r\n\r\n\t\tdrillDown: function(renderer){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tDrill up from the given renderer.\r\n\t\t\t// renderer: DomNode\r\n\t\t\t//\t\tThe item renderer.\r\n\t\t\tvar box = domGeom.getMarginBox(this.domNode);\r\n\t\t\tvar item = renderer.item;\r\n\r\n\t\t\t// Set the new root item into the rootPanel to make it appear on top\r\n\t\t\t// of the other nodes, and keep the same global location\r\n\t\t\tvar parentNode = renderer.parentNode;\r\n\t\t\tvar spanInfo = domGeom.position(renderer, true);\r\n\t\t\tparentNode.removeChild(renderer);\r\n\t\t\tdomConstruct.place(renderer, this.domNode);\r\n\t\t\tdomStyle.set(renderer, {\r\n\t\t\t\tleft: (spanInfo.x - box.l)+ \"px\", top: (spanInfo.y - box.t)+ \"px\"\r\n\t\t\t});\r\n\t\t\tvar zIndex = domStyle.get(renderer, \"zIndex\");\r\n\t\t\tdomStyle.set(renderer, \"zIndex\", 40);\r\n\r\n\t\t\tfx.animateProperty({\r\n\t\t\t\tnode: renderer, duration: 500, properties: {\r\n\t\t\t\t\tleft: {\r\n\t\t\t\t\t\tend: box.l\r\n\t\t\t\t\t}, top: {\r\n\t\t\t\t\t\tend: box.t\r\n\t\t\t\t\t}, height: {\r\n\t\t\t\t\t\tend: box.h\r\n\t\t\t\t\t}, width: {\r\n\t\t\t\t\t\tend: box.w\r\n\t\t\t\t\t}\r\n\t\t\t\t}, onAnimate: lang.hitch(this, function(values){\r\n\t\t\t\t\tvar box2 = domGeom.getContentBox(renderer);\r\n\t\t\t\t\tthis._layoutGroupContent(renderer, box2.w, box2.h, renderer.level + 1, false);\r\n\t\t\t\t}), onEnd: lang.hitch(this, function(){\r\n\t\t\t\t\tdomStyle.set(renderer, \"zIndex\", zIndex);\r\n\t\t\t\t\tthis.set(\"rootItem\", item);\r\n\t\t\t\t})\r\n\t\t\t}).play();\r\n\t\t}\r\n\t});\r\n});"]}