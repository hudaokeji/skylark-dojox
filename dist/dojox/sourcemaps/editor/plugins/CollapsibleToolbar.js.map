{"version":3,"sources":["editor/plugins/CollapsibleToolbar.js"],"names":["define","dojo","dijit","dojox","_Widget","_TemplatedMixin","_Plugin","CollapsibleToolbarButton","declare","templateString","title","buttonClass","text","textClass","onClick","e","CollapsibleToolbar","_myWidgets","setEditor","editor","this","_constructContainer","strings","i18n","getLocalization","container","create","style","width","tabindex","class","tbody","row","openTd","closeTd","menuTd","m","collapseButton","collapse","place","domNode","expandButton","expand","push","toolbar","menu","connect","_onClose","stopEvent","size","marginBox","resize","h","isIE","header","className","footer","focus","firstChild","_onOpen","destroy","inherited","arguments","length","pop","_CollapsibleToolbarButton","subscribe","_scopeName","o","plugin","args","name","toLowerCase"],"mappings":"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","file":"../../../editor/plugins/CollapsibleToolbar.js","sourcesContent":["define([\r\n\t\"dojo\",\r\n\t\"dijit\",\r\n\t\"dojox\",\r\n\t\"dijit/_Widget\",\r\n\t\"dijit/_TemplatedMixin\",\r\n\t\"dijit/_editor/_Plugin\",\r\n\t\"dijit/form/Button\",\r\n\t\"dijit/focus\",\r\n\t\"dojo/_base/connect\",\r\n\t\"dojo/_base/declare\",\r\n\t\"dojo/i18n\",\r\n\t\"dojo/i18n!dojox/editor/plugins/nls/CollapsibleToolbar\"\r\n], function(dojo, dijit, dojox, _Widget, _TemplatedMixin, _Plugin) {\r\n\r\nvar CollapsibleToolbarButton = dojo.declare(\"dojox.editor.plugins._CollapsibleToolbarButton\", [_Widget, _TemplatedMixin], {\r\n\t// summary:\r\n\t//\t\tSimple internal widget for representing a clickable button for expand/collapse\r\n\t//\t\twith A11Y support.\r\n\t// tags:\r\n\t//\t\tprivate\r\n\ttemplateString: \"<div tabindex='0' role='button' title='${title}' class='${buttonClass}' \" +\r\n\t\t\"dojoAttachEvent='ondijitclick: onClick'><span class='${textClass}'>${text}</span></div>\",\r\n\r\n\r\n\t// title [public] String\r\n\t//\t\tThe text to read by a screen reader that gets button focus.\r\n\ttitle: \"\",\r\n\r\n\t// buttonClass [public] String\r\n\t//\t\tThe classname to apply to the expand/collapse button.\r\n\tbuttonClass: \"\",\r\n\r\n\t// text [public] String\r\n\t//\t\tThe text to use as expand/collapse in A11Y mode.\r\n\ttext: \"\",\r\n\t\r\n\t// textClass [public] String\r\n\t//\t\tThe classname to apply to the expand/collapse text.\r\n\ttextClass: \"\",\r\n\r\n\tonClick: function(e){\r\n\t\t// summary:\r\n\t\t//\t\tSimple synthetic event to listen for dijit click events (mouse or keyboard)\r\n\t}\r\n});\r\n\r\nvar CollapsibleToolbar = dojo.declare(\"dojox.editor.plugins.CollapsibleToolbar\", _Plugin, {\r\n\t// summary:\r\n\t//\t\tThis plugin provides a weappable toolbar container to allow expand/collapse\r\n\t//\t\tof the editor toolbars.  This plugin should be registered first in most cases to\r\n\t//\t\tavoid conflicts in toolbar construction.\r\n\r\n\t// _myWidgets: [private] Array\r\n\t//\t\tContainer for widgets I allocate that will need to be destroyed.\r\n\t_myWidgets: null,\r\n\r\n\tsetEditor: function(editor){\r\n\t\t// summary:\r\n\t\t//\t\tOver-ride for the setting of the editor.\r\n\t\t// editor: Object\r\n\t\t//\t\tThe editor to configure for this plugin to use.\r\n\t\tthis.editor = editor;\r\n\t\tthis._constructContainer();\r\n\t},\r\n\r\n\t_constructContainer: function(){\r\n\t\t// summary:\r\n\t\t//\t\tInternal function to construct a wrapper for the toolbar/header that allows\r\n\t\t//\t\tit to expand and collapse.  It effectively builds a containing table,\r\n\t\t//\t\twhich handles the layout nicely and gets BIDI support by default.\r\n\t\t// tags:\r\n\t\t//\t\tprivate\r\n\t\tvar strings = dojo.i18n.getLocalization(\"dojox.editor.plugins\", \"CollapsibleToolbar\");\r\n\t\tthis._myWidgets = [];\r\n\t\t\r\n\t\t// Build the containers.\r\n\t\tvar container = dojo.create(\"table\", {style: { width: \"100%\" }, tabindex: -1, \"class\": \"dojoxCollapsibleToolbarContainer\"});\r\n\t\tvar tbody = dojo.create(\"tbody\", {tabindex: -1}, container);\r\n\t\tvar row = dojo.create(\"tr\", {tabindex: -1}, tbody);\r\n\t\tvar openTd = dojo.create(\"td\", {\"class\": \"dojoxCollapsibleToolbarControl\", tabindex: -1}, row);\r\n\t\tvar closeTd = dojo.create(\"td\", {\"class\": \"dojoxCollapsibleToolbarControl\",  tabindex: -1}, row);\r\n\t\tvar menuTd = dojo.create(\"td\", {style: { width: \"100%\" }, tabindex: -1}, row);\r\n\t\tvar m = dojo.create(\"span\", {style: { width: \"100%\" }, tabindex: -1}, menuTd);\r\n\r\n\t\tvar collapseButton = new CollapsibleToolbarButton({\r\n\t\t\tbuttonClass: \"dojoxCollapsibleToolbarCollapse\",\r\n\t\t\ttitle: strings.collapse,\r\n\t\t\ttext: \"-\",\r\n\t\t\ttextClass: \"dojoxCollapsibleToolbarCollapseText\"\r\n\t\t});\r\n\t\tdojo.place(collapseButton.domNode, openTd);\r\n\t\tvar expandButton = new CollapsibleToolbarButton({\r\n\t\t\tbuttonClass: \"dojoxCollapsibleToolbarExpand\",\r\n\t\t\ttitle: strings.expand,\r\n\t\t\ttext: \"+\",\r\n\t\t\ttextClass: \"dojoxCollapsibleToolbarExpandText\"\r\n\t\t});\r\n\t\tdojo.place(expandButton.domNode, closeTd);\r\n\r\n\t\tthis._myWidgets.push(collapseButton);\r\n\t\tthis._myWidgets.push(expandButton);\r\n\r\n\t\t// Attach everything in now.\r\n\t\tdojo.style(closeTd, \"display\", \"none\");\r\n\t\tdojo.place(container, this.editor.toolbar.domNode, \"after\");\r\n\t\tdojo.place(this.editor.toolbar.domNode, m);\r\n\r\n\t\tthis.openTd = openTd;\r\n\t\tthis.closeTd = closeTd;\r\n\t\tthis.menu = m;\r\n\r\n\t\t// Establish the events to handle open/close.\r\n\t\tthis.connect(collapseButton, \"onClick\", \"_onClose\");\r\n\t\tthis.connect(expandButton, \"onClick\", \"_onOpen\");\r\n\t},\r\n\r\n\t_onClose: function(e){\r\n\t\t// summary:\r\n\t\t//\t\tInternal function for handling a click event that will close the toolbar.\r\n\t\t// e:\r\n\t\t//\t\tThe click event.\r\n\t\t// tags:\r\n\t\t//\t\tprivate\r\n\t\tif(e){ dojo.stopEvent(e); }\r\n\t\tvar size = dojo.marginBox(this.editor.domNode);\r\n\t\tdojo.style(this.openTd, \"display\", \"none\");\r\n\t\tdojo.style(this.closeTd, \"display\", \"\");\r\n\t\tdojo.style(this.menu, \"display\", \"none\");\r\n\t\tthis.editor.resize({h: size.h});\r\n\t\t// work around IE rendering glitch in a11y mode.\r\n\t\tif(dojo.isIE){\r\n\t\t\tthis.editor.header.className = this.editor.header.className;\r\n\t\t\tthis.editor.footer.className = this.editor.footer.className;\r\n\t\t}\r\n\t\tdijit.focus(this.closeTd.firstChild);\r\n\t},\r\n\r\n\t_onOpen: function(e) {\r\n\t\t// summary:\r\n\t\t//\t\tInternal function for handling a click event that will open the toolbar.\r\n\t\t// e:\r\n\t\t//\t\tThe click event.\r\n\t\t// tags:\r\n\t\t//\t\tprivate\r\n\t\tif(e){ dojo.stopEvent(e); }\r\n\t\tvar size = dojo.marginBox(this.editor.domNode);\r\n\t\tdojo.style(this.closeTd, \"display\", \"none\");\r\n\t\tdojo.style(this.openTd, \"display\", \"\");\r\n\t\tdojo.style(this.menu, \"display\", \"\");\r\n\t\tthis.editor.resize({h: size.h});\r\n\t\t // work around IE rendering glitch in a11y mode.\r\n\t\tif(dojo.isIE){\r\n\t\t\tthis.editor.header.className = this.editor.header.className;\r\n\t\t\tthis.editor.footer.className = this.editor.footer.className;\r\n\t\t}\r\n\t\tdijit.focus(this.openTd.firstChild);\r\n\t},\r\n\r\n\tdestroy: function(){\r\n\t\t// summary:\r\n\t\t//\t\tOver-ride of destroy method for cleanup.\r\n\t\tthis.inherited(arguments);\r\n\t\tif(this._myWidgets){\r\n\t\t\twhile(this._myWidgets.length){\r\n\t\t\t\tthis._myWidgets.pop().destroy();\r\n\t\t\t}\r\n\t\t\tdelete this._myWidgets;\r\n\t\t}\r\n\t}\r\n});\r\n\r\n// For monkey patching\r\nCollapsibleToolbar._CollapsibleToolbarButton = CollapsibleToolbarButton;\r\n\r\n// Register this plugin.\r\ndojo.subscribe(dijit._scopeName + \".Editor.getPlugin\",null,function(o){\r\n\tif(o.plugin){ return; }\r\n\tvar name = o.args.name.toLowerCase();\r\n\tif(name === \"collapsibletoolbar\"){\r\n\t\to.plugin = new CollapsibleToolbar({});\r\n\t}\r\n});\r\n\r\nreturn CollapsibleToolbar;\r\n\r\n});\r\n"]}