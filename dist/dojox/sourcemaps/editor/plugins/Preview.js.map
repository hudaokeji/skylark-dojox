{"version":3,"sources":["editor/plugins/Preview.js"],"names":["define","dojo","dijit","dojox","_Plugin","Preview","declare","useDefaultCommand","styles","stylesheets","iconClassPrefix","_initButton","this","_nlsResources","i18n","getLocalization","button","form","Button","label","showLabel","iconClass","tabIndex","onClick","hitch","setEditor","editor","updateState","set","get","_preview","i","content","head","length","win","window","open","document","write","close","e","console","warn","subscribe","_scopeName","o","plugin","args","name","toLowerCase"],"mappings":";;;;;;;AAAAA,QACC,OACA,QACA,QACA,wBACA,oBACA,qBACA,qBACA,YACA,8CACE,SAASC,EAAMC,EAAOC,EAAOC,GAEhC,IAAIC,EAAUJ,EAAKK,QAAQ,+BAAgCF,GAO1DG,mBAAmB,EAInBC,OAAQ,GAIRC,YAAa,KAIbC,gBAAiB,4BAEjBC,YAAa,WAGZC,KAAKC,cAAgBZ,EAAKa,KAAKC,gBAAgB,uBAAwB,WACvEH,KAAKI,OAAS,IAAId,EAAMe,KAAKC,QAC5BC,MAAOP,KAAKC,cAAuB,QACnCO,WAAW,EACXC,UAAWT,KAAKF,gBAAkB,IAAME,KAAKF,gBAAkB,UAC/DY,SAAU,KACVC,QAAStB,EAAKuB,MAAMZ,KAAM,eAI5Ba,UAAW,SAASC,GAKnBd,KAAKc,OAASA,EACdd,KAAKD,eAGNgB,YAAa,WAGZf,KAAKI,OAAOY,IAAI,WAAYhB,KAAKiB,IAAI,cAGtCC,SAAU,WAKT,IACC,IAEIC,EAFAC,EAAUpB,KAAKc,OAAOG,IAAI,SAC1BI,EAAO,4EAGX,GAAGrB,KAAKH,YACP,IAAIsB,EAAI,EAAGA,EAAInB,KAAKH,YAAYyB,OAAQH,IACvCE,GAAQ,oDAAsDrB,KAAKH,YAAYsB,GAAK,OAGnFnB,KAAKJ,SACPyB,GAAS,cAAgBrB,KAAKJ,OAAS,cAExCwB,EAAU,qBAAuBC,EAAO,wBAA0BD,EAAU,uBAC5E,IAAIG,EAAMC,OAAOC,KAAK,iBAAkBzB,KAAKC,cAAuB,QAAG,2CACvEsB,EAAIG,SAASD,OACbF,EAAIG,SAASC,MAAMP,GACnBG,EAAIG,SAASE,QAEb,MAAMC,GACNC,QAAQC,KAAKF,OAiBhB,OAXAxC,EAAK2C,UAAU1C,EAAM2C,WAAa,oBAAoB,KAAK,SAASC,GAChEA,EAAEC,QAEO,YADDD,EAAEE,KAAKC,KAAKC,gBAEtBJ,EAAEC,OAAS,IAAI1C,GACdG,OAAS,WAAYsC,EAAEE,KAAMF,EAAEE,KAAKxC,OAAO,GAC3CC,YAAc,gBAAiBqC,EAAEE,KAAOF,EAAEE,KAAKvC,YAAY,UAKvDJ","file":"../../../editor/plugins/Preview.js","sourcesContent":["define([\r\n\t\"dojo\",\r\n\t\"dijit\",\r\n\t\"dojox\",\r\n\t\"dijit/_editor/_Plugin\",\r\n\t\"dijit/form/Button\",\r\n\t\"dojo/_base/connect\",\r\n\t\"dojo/_base/declare\",\r\n\t\"dojo/i18n\",\r\n\t\"dojo/i18n!dojox/editor/plugins/nls/Preview\"\r\n], function(dojo, dijit, dojox, _Plugin) {\r\n\r\nvar Preview = dojo.declare(\"dojox.editor.plugins.Preview\", _Plugin, {\r\n\t// summary:\r\n\t//\t\tThis plugin provides Preview capability to the editor.  When\r\n\t//\t\tclicked, the document in the editor frame will displayed in a separate\r\n\t//\t\twindow/tab\r\n\r\n\t// Over-ride indicating that the command processing is done all by this plugin.\r\n\tuseDefaultCommand: false,\r\n\r\n\t// styles: [public] String\r\n\t//\t\tA string of CSS styles to apply to the previewed content, if any.\r\n\tstyles: \"\",\r\n\r\n\t// stylesheets: [public] Array\r\n\t//\t\tAn array of stylesheets to import into the preview, if any.\r\n\tstylesheets: null,\r\n\r\n\t// iconClassPrefix: [const] String\r\n\t//\t\tThe CSS class name for the button node icon.\r\n\ticonClassPrefix: \"dijitAdditionalEditorIcon\",\r\n\r\n\t_initButton: function(){\r\n\t\t// summary:\r\n\t\t//\t\tOver-ride for creation of the preview button.\r\n\t\tthis._nlsResources = dojo.i18n.getLocalization(\"dojox.editor.plugins\", \"Preview\");\r\n\t\tthis.button = new dijit.form.Button({\r\n\t\t\tlabel: this._nlsResources[\"preview\"],\r\n\t\t\tshowLabel: false,\r\n\t\t\ticonClass: this.iconClassPrefix + \" \" + this.iconClassPrefix + \"Preview\",\r\n\t\t\ttabIndex: \"-1\",\r\n\t\t\tonClick: dojo.hitch(this, \"_preview\")\r\n\t\t});\r\n\t},\r\n\r\n\tsetEditor: function(editor){\r\n\t\t// summary:\r\n\t\t//\t\tOver-ride for the setting of the editor.\r\n\t\t// editor: Object\r\n\t\t//\t\tThe editor to configure for this plugin to use.\r\n\t\tthis.editor = editor;\r\n\t\tthis._initButton();\r\n\t},\r\n\r\n\tupdateState: function(){\r\n\t\t// summary:\r\n\t\t//\t\tOver-ride for button state control for disabled to work.\r\n\t\tthis.button.set(\"disabled\", this.get(\"disabled\"));\r\n\t},\r\n\t\r\n\t_preview: function(){\r\n\t\t// summary:\r\n\t\t//\t\tFunction to trigger previewing of the editor document\r\n\t\t// tags:\r\n\t\t//\t\tprivate\r\n\t\ttry{\r\n\t\t\tvar content = this.editor.get(\"value\");\r\n\t\t\tvar head = \"\\t\\t<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>\\n\";\r\n\t\t\tvar i;\r\n\t\t\t// Apply the stylesheets, then apply the styles.\r\n\t\t\tif(this.stylesheets){\r\n\t\t\t\tfor(i = 0; i < this.stylesheets.length; i++){\r\n\t\t\t\t\thead += \"\\t\\t<link rel='stylesheet' type='text/css' href='\" + this.stylesheets[i] + \"'>\\n\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(this.styles){\r\n\t\t\t\thead += (\"\\t\\t<style>\" + this.styles + \"</style>\\n\");\r\n\t\t\t}\r\n\t\t\tcontent = \"<html>\\n\\t<head>\\n\" + head + \"\\t</head>\\n\\t<body>\\n\" + content + \"\\n\\t</body>\\n</html>\";\r\n\t\t\tvar win = window.open(\"javascript: ''\", this._nlsResources[\"preview\"], \"status=1,menubar=0,location=0,toolbar=0\");\r\n\t\t\twin.document.open();\r\n\t\t\twin.document.write(content);\r\n\t\t\twin.document.close();\r\n\r\n\t\t}catch(e){\r\n\t\t\tconsole.warn(e);\r\n\t\t}\r\n\t}\r\n});\r\n\r\n// Register this plugin.\r\ndojo.subscribe(dijit._scopeName + \".Editor.getPlugin\",null,function(o){\r\n\tif(o.plugin){ return; }\r\n\tvar name = o.args.name.toLowerCase();\r\n\tif(name === \"preview\"){\r\n\t\to.plugin = new Preview({\r\n\t\t\tstyles: (\"styles\" in o.args)?o.args.styles:\"\",\r\n\t\t\tstylesheets: (\"stylesheets\" in o.args)? o.args.stylesheets:null\r\n\t\t});\r\n\t}\r\n});\r\n\r\nreturn Preview;\r\n\r\n});\r\n"]}