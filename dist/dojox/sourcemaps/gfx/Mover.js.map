{"version":3,"sources":["gfx/Mover.js"],"names":["define","lang","arr","declare","on","touch","event","constructor","shape","e","host","this","lastX","clientX","lastY","clientY","h","d","document","firstEvent","move","hitch","events","release","onMoveStart","onMouseMove","x","y","onMove","dx","dy","stop","onFirstMove","pop","remove","destroy","forEach","handle","onMoveStop"],"mappings":";;;;;;;AAAAA,QAAQ,kBAAkB,mBAAoB,qBAAsB,UAAW,aAAc,oBAC3F,SAASC,EAAMC,EAAKC,EAASC,EAAIC,EAAOC,GACzC,OAAOH,EAAQ,kBAAmB,MACjCI,YAAa,SAASC,EAAOC,EAAGC,GAY/BC,KAAKH,MAAQA,EACbG,KAAKC,MAAQH,EAAEI,QACfF,KAAKG,MAAQL,EAAEM,QACf,IAAIC,EAAIL,KAAKD,KAAOA,EAAMO,EAAIC,SAC7BC,EAAaf,EAAGa,EAAGZ,EAAMe,KAAMnB,EAAKoB,MAAMV,KAAM,gBACjDA,KAAKW,QACJlB,EAAGa,EAAGZ,EAAMe,KAAMnB,EAAKoB,MAAMV,KAAM,gBACnCP,EAAGa,EAAGZ,EAAMkB,QAAStB,EAAKoB,MAAMV,KAAM,YAEtCP,EAAGa,EAAG,YAAehB,EAAKoB,MAAMf,EAAO,SACvCF,EAAGa,EAAG,cAAehB,EAAKoB,MAAMf,EAAO,SACvCa,GAGEH,GAAKA,EAAEQ,aACTR,EAAEQ,YAAYb,OAIhBc,YAAa,SAAShB,GAKrB,IAAIiB,EAAIjB,EAAEI,QACNc,EAAIlB,EAAEM,QACVJ,KAAKD,KAAKkB,OAAOjB,MAAOkB,GAAIH,EAAIf,KAAKC,MAAOkB,GAAIH,EAAIhB,KAAKG,QACzDH,KAAKC,MAAQc,EACbf,KAAKG,MAAQa,EACbrB,EAAMyB,KAAKtB,IAGZuB,YAAa,WAGZrB,KAAKD,KAAKsB,YAAYrB,MACtBA,KAAKW,OAAOW,MAAMC,UAEnBC,QAAS,WAGRjC,EAAIkC,QAAQzB,KAAKW,OAAQ,SAASe,GACjCA,EAAOH,WAGR,IAAIlB,EAAIL,KAAKD,KACVM,GAAKA,EAAEsB,YACTtB,EAAEsB,WAAW3B,MAGdA,KAAKW,OAASX,KAAKH,MAAQ","file":"../../gfx/Mover.js","sourcesContent":["define([\"dojo/_base/lang\",\"dojo/_base/array\", \"dojo/_base/declare\", \"dojo/on\", \"dojo/touch\", \"dojo/_base/event\"],\r\n  function(lang, arr, declare, on, touch, event){\r\n\treturn declare(\"dojox.gfx.Mover\", null, {\r\n\t\tconstructor: function(shape, e, host){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tan object, which makes a shape follow the mouse,\r\n\t\t\t//\t\tused as a default mover, and as a base class for custom movers\r\n\t\t\t// shape: dojox/gfx.Shape\r\n\t\t\t//\t\ta shape object to be moved\r\n\t\t\t// e: Event\r\n\t\t\t//\t\ta mouse event, which started the move;\r\n\t\t\t//\t\tonly clientX and clientY properties are used\r\n\t\t\t// host: Object?\r\n\t\t\t//\t\tobject which implements the functionality of the move,\r\n\t\t\t//\t\t and defines proper events (onMoveStart and onMoveStop)\r\n\t\t\tthis.shape = shape;\r\n\t\t\tthis.lastX = e.clientX;\r\n\t\t\tthis.lastY = e.clientY;\r\n\t\t\tvar h = this.host = host, d = document,\r\n\t\t\t\tfirstEvent = on(d, touch.move, lang.hitch(this, \"onFirstMove\"));\r\n\t\t\tthis.events = [\r\n\t\t\t\ton(d, touch.move, lang.hitch(this, \"onMouseMove\")),\r\n\t\t\t\ton(d, touch.release, lang.hitch(this, \"destroy\")),\r\n\t\t\t\t// cancel text selection and text dragging\r\n\t\t\t\ton(d, \"dragstart\",   lang.hitch(event, \"stop\")),\r\n\t\t\t\ton(d, \"selectstart\", lang.hitch(event, \"stop\")),\r\n\t\t\t\tfirstEvent\r\n\t\t\t];\r\n\t\t\t// notify that the move has started\r\n\t\t\tif(h && h.onMoveStart){\r\n\t\t\t\th.onMoveStart(this);\r\n\t\t\t}\r\n\t\t},\r\n\t\t// mouse event processors\r\n\t\tonMouseMove: function(e){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tevent processor for onmousemove\r\n\t\t\t// e: Event\r\n\t\t\t//\t\tmouse event\r\n\t\t\tvar x = e.clientX;\r\n\t\t\tvar y = e.clientY;\r\n\t\t\tthis.host.onMove(this, {dx: x - this.lastX, dy: y - this.lastY});\r\n\t\t\tthis.lastX = x;\r\n\t\t\tthis.lastY = y;\r\n\t\t\tevent.stop(e);\r\n\t\t},\r\n\t\t// utilities\r\n\t\tonFirstMove: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tit is meant to be called only once\r\n\t\t\tthis.host.onFirstMove(this);\r\n\t\t\tthis.events.pop().remove();\r\n\t\t},\r\n\t\tdestroy: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tstops the move, deletes all references, so the object can be garbage-collected\r\n\t\t\tarr.forEach(this.events, function(handle){\r\n\t\t\t\thandle.remove();\r\n\t\t\t});\r\n\t\t\t// undo global settings\r\n\t\t\tvar h = this.host;\r\n\t\t\tif(h && h.onMoveStop){\r\n\t\t\t\th.onMoveStop(this);\r\n\t\t\t}\r\n\t\t\t// destroy objects\r\n\t\t\tthis.events = this.shape = null;\r\n\t\t}\r\n\t});\r\n});\r\n"]}