{"version":3,"sources":["gfx/svgext.js"],"names":["define","dom","array","win","gfx","svg","svgext","toIgnore","primitives","tag","children","Shape","extend","addRenderingOption","option","value","this","rawNode","setAttribute","setFilter","filter","removeAttribute","id","_base","_getUniqueId","filterNode","byId","p","ownerDocument","createElementNS","xmlns","forEach","buildFilterPrimitivesDOM","primitive","parentNode","node","appendChild","f","surface","_getParentSurface","defNode","getFilter"],"mappings":";;;;;;;AAAAA,QACC,WACA,mBACA,oBACA,UACA,SACA,SAASC,EAAKC,EAAOC,EAAKC,EAAKC,GAU/B,IAAIC,EAASF,EAAIE,UACbC,GACHC,WAAW,KACXC,IAAI,KACJC,SAAS,MA2MV,OAzFAL,EAAIM,MAAMC,QACTC,mBAAoB,SAAmBC,EAAkBC,GASxD,OADAC,KAAKC,QAAQC,aAAaJ,EAAQC,GAC3BC,MAGRG,UAAW,SAA0CC,GAyCpD,IAAIA,EAGH,OAFAJ,KAAKC,QAAQI,gBAAgB,UAC7BL,KAAKI,OAAS,KACPJ,KAERA,KAAKI,OAASA,EACdA,EAAOE,GAAKF,EAAOE,IAAMlB,EAAImB,MAAMC,eACnC,IAAIC,EAAaxB,EAAIyB,KAAKN,EAAOE,IACjC,IAAIG,EAAW,CAGd,IAAI,IAAIE,KAFRF,EAAaT,KAAKC,QAAQW,cAAcC,gBAAgBxB,EAAIyB,MAAMzB,IAAK,WAC5Da,aAAa,cAAe,kBAC1BE,EACPO,KAAKpB,GACTkB,EAAWP,aAAaS,EAAGP,EAAOO,IAGpCzB,EAAM6B,QAAQX,EAAOZ,WAAY,SAASmB,IArL7C,SAASK,EAAyBC,EAAWC,GAC5C,IAAIC,EAAQD,EAAWN,cAAcC,gBAAgBxB,EAAIyB,MAAMzB,IAAK4B,EAAUxB,KAE9E,IAAI,IAAIkB,KADRO,EAAWE,YAAYD,GACVF,EACPN,KAAKpB,GACT4B,EAAKjB,aAAaS,EAAGM,EAAUN,IAMjC,OAHGM,EAAUvB,UACZR,EAAM6B,QAAQE,EAAUvB,SAAU,SAAS2B,GAAGL,EAAyBK,EAAGF,KAEpEA,EA2KJH,CAAyBL,EAAGF,KAE7B,IAAIa,EAAUtB,KAAKuB,oBACnB,GAAGD,EACSA,EAAQE,QACdJ,YAAYX,GAInB,OADAT,KAAKC,QAAQC,aAAa,SAAU,QAAQE,EAAOE,GAAG,KAC/CN,MAGRyB,UAAW,WAGV,OAAOzB,KAAKI,UAGPd","file":"../../gfx/svgext.js","sourcesContent":["define([\r\n\t\"dojo/dom\",\r\n\t\"dojo/_base/array\",\r\n\t\"dojo/_base/window\",\r\n\t\"./_base\",\r\n\t\"./svg\"], \r\n\tfunction(dom, array, win, gfx, svg){\r\n\r\n\t/*=====\r\n\treturn {\r\n\t\t// summary:\r\n\t\t//\t\tA module that adds svg-specific features to the gfx api. You should require this module\r\n\t\t//\t\twhen your application specifically targets the SVG renderer.\r\n\t}\r\n\t=====*/\r\n\r\n\tvar svgext = gfx.svgext = {};\r\n\tvar toIgnore = {\r\n\t\tprimitives:null,\r\n\t\ttag:null,\r\n\t\tchildren:null\r\n\t};\r\n\r\n\tfunction buildFilterPrimitivesDOM(primitive, parentNode){\r\n\t\tvar node =  parentNode.ownerDocument.createElementNS(svg.xmlns.svg, primitive.tag);\r\n\t\tparentNode.appendChild(node);\r\n\t\tfor(var p in primitive){\r\n\t\t\tif(!(p in toIgnore)){\r\n\t\t\t\tnode.setAttribute(p, primitive[p]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(primitive.children){\r\n\t\t\tarray.forEach(primitive.children, function(f){buildFilterPrimitivesDOM(f, node);});\r\n\t\t}\r\n\t\treturn node;\r\n\t}\r\n\r\n\t/*=====\r\n\tdeclare(\"dojox.gfx.svgext.__FilterPrimitiveArgs\", null, {\r\n\t\t// summary:\r\n\t\t//\t\tRepresents an SVG filter primitive.\r\n\t\t// description:\r\n\t\t//\t\tIn addition to the following properties, a FilterPrimitiveArgs should define the properties specific to\r\n\t\t//\t\tthis primitive, as defined by the SVG spec.\r\n\t\t// example:\r\n\t\t//\t\tDefine a simple feGaussianBlur primitive:\r\n\t\t//\t|\tvar blurPrimitive = {\r\n\t\t//\t|\t\t\"tag\": \"feGaussianBlur\",\r\n\t\t//\t|\t\t\"in\": \"SourceAlpha\",\r\n\t\t//\t|\t\t\"stdDeviation\":\"4\",\r\n\t\t//\t|\t\t\"result\":\"blur\"\r\n\t\t//\t|\t};\r\n\t\t//\r\n\t\t// example:\r\n\t\t//\t\tDefine a feSpecularLighting primitive with one fePointLight child\r\n\t\t//\t|\tvar lighting = {\r\n\t\t//\t|\t\t\"tag\": \"feSpecularLighting\",\r\n\t\t//\t|\t\t\"in\":\"blur\",\r\n\t\t//\t|\t\t\"surfaceScale\":5,\r\n\t\t//\t|\t\t\"specularConstant\":.75,\r\n\t\t//\t|\t\t\"specularExponent\":20,\r\n\t\t//\t|\t\t\"lighting-color\":\"#bbbbbb\",\r\n\t\t//\t|\t\t\"result\":\"specOut\"\r\n\t\t//\t|\t\t\"children\": [\r\n\t\t//\t|\t\t\t\"tag\": \"fePointLight\"\r\n\t\t//\t|\t\t\t\"x\":-5000,\r\n\t\t//\t|\t\t\t\"y\":-10000,\r\n\t\t//\t|\t\t\t\"z\":20000\r\n\t\t//\t|\t\t]\r\n\t\t//\t|\t};\r\n\r\n\t\t// tag: String?\r\n\t\t//\t\tThe type of the primitive, as specified by the SVG spec (http://www.w3.org/TR/SVG/filters.html)\r\n\t\ttag: null,\r\n\r\n\t\t// children: dojox.gfx.svgext.__FilterPrimitiveArgs[]?\r\n\t\t//\t\tAn array of child primitives, if any.\r\n\t\tchildren: null\r\n\t});\r\n\t=====*/\r\n\r\n\r\n\t/*=====\r\n\tdeclare(\"dojox.gfx.svgext.__FilterArgs\", null, {\r\n\t\t// summary:\r\n\t\t//\t\tThe filter arguments passed to the dojox/gfx/svgext/Shape.setFilter method.\r\n\t\t// description:\r\n\t\t//\t\tAn object defining the properties of a SVG Filter.\r\n\t\t// example:\r\n\t\t//\t\tDefine a drop shadow filter:\r\n\t\t//\t|\tvar filter = {\r\n\t\t//\t|\t\t\"id\": \"fastSmallDropShadow\",\r\n\t\t//\t|\t\t\"x\": \"-10%\",\r\n\t\t//\t|\t\t\"y\": \"-10%\",\r\n\t\t//\t|\t\t\"width\": \"125%\",\r\n\t\t//\t|\t\t\"height\": \"125%\",\r\n\t\t//\t|\t\t\"primitives\": [{\r\n\t\t//\t|\t\t\t\"tag\": \"feColorMatrix\",\r\n\t\t//\t|\t\t\t\"in\": \"SourceAlpha\",\r\n\t\t//\t|\t\t\t\"type\": \"matrix\",\r\n\t\t//\t|\t\t\t\"result\": \"grey\",\r\n\t\t//\t|\t\t\t\"values\": \"0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0,0,0,0.7,0\"\r\n\t\t//\t|\t\t},{\r\n\t\t//\t|\t\t\t\"tag\": \"feOffset\",\r\n\t\t//\t|\t\t\t\"dx\": 3,\r\n\t\t//\t|\t\t\t\"dy\": 3,\r\n\t\t//\t|\t\t\t\"result\": \"offsetBlur\"\r\n\t\t//\t|\t\t},{\r\n\t\t//\t|\t\t\t\"tag\": \"feMerge\",\r\n\t\t//\t|\t\t\t\"children\":[{\r\n\t\t//\t|\t\t\t\t\"tag\": \"feMergeNode\",\r\n\t\t//\t|\t\t\t\t\"in\": \"offsetBlur\"\r\n\t\t//\t|\t\t\t},{\r\n\t\t//\t|\t\t\t\t\"tag\": \"feMergeNode\",\r\n\t\t//\t|\t\t\t\t\"in\": \"SourceGraphic\"\r\n\t\t//\t|\t\t\t}]\r\n\t\t//\t|\t\t}]\r\n\t\t//\t|\t};\r\n\r\n\r\n\t\t// id: String?\r\n\t\t//\t\tThe filter identifier. If none is provided, a generated id will be used.\r\n\t\tid: null,\r\n\r\n\t\t// filterUnits: String?\r\n\t\t//\t\tThe coordinate system of the filter. Default is \"userSpaceOnUse\".\r\n\t\tfilterUnits: \"userSpaceOnUse\",\r\n\r\n\t\t// primitives: dojox.gfx.svgext.__FilterPrimitiveArgs[]\r\n\t\t//\t\tAn array of filter primitives that define this filter.\r\n\t\tprimitives: []\r\n\t});\r\n\t=====*/\r\n\r\n\tsvg.Shape.extend({\r\n\t\taddRenderingOption: function(/*String*/option, /*String*/value){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tAdds the specified SVG rendering option on this shape.\r\n\t\t\t// option: String\r\n\t\t\t//\t\tThe name of the rendering option to add to this shape, as specified by the\r\n\t\t\t//\t\tSVG specification (http://www.w3.org/TR/SVG/painting.html#RenderingProperties)\r\n\t\t\t// value: String\r\n\t\t\t//\t\tthe option value.\r\n\t\t\tthis.rawNode.setAttribute(option, value);\r\n\t\t\treturn this; // self\r\n\t\t},\r\n\r\n\t\tsetFilter: function(/*dojox.gfx.svgext.__FilterArgs*/filter){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tSets the specified SVG Filter on this shape.\r\n\t\t\t// filter: dojox.gfx.svgext.__FilterArgs\r\n\t\t\t//\t\tAn object that defines the filter properties. Note that in order to make the creation of such filter\r\n\t\t\t//\t\teasier, the dojox/gfx/filters module defines both a simple API to easily create filter objects and\r\n\t\t\t//\t\talso a set of predefined filters like drop shadows, blurs, textures effects (among others).\r\n\t\t\t// example:\r\n\t\t\t//\t\tSets a drop shadow filter:\r\n\t\t\t//\t|\tvar filter = {\r\n\t\t\t//\t|\t\t\"id\": \"fastSmallDropShadow\",\r\n\t\t\t//\t|\t\t\"x\": \"-10%\",\r\n\t\t\t//\t|\t\t\"y\": \"-10%\",\r\n\t\t\t//\t|\t\t\"width\": \"125%\",\r\n\t\t\t//\t|\t\t\"height\": \"125%\",\r\n\t\t\t//\t|\t\t\"primitives\": [{\r\n\t\t\t//\t|\t\t\t\"tag\": \"feColorMatrix\",\r\n\t\t\t//\t|\t\t\t\"in\": \"SourceAlpha\",\r\n\t\t\t//\t|\t\t\t\"type\": \"matrix\",\r\n\t\t\t//\t|\t\t\t\"result\": \"grey\",\r\n\t\t\t//\t|\t\t\t\"values\": \"0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0,0,0,0.7,0\"\r\n\t\t\t//\t|\t\t},{\r\n\t\t\t//\t|\t\t\t\"tag\": \"feOffset\",\r\n\t\t\t//\t|\t\t\t\"dx\": 3,\r\n\t\t\t//\t|\t\t\t\"dy\": 3,\r\n\t\t\t//\t|\t\t\t\"result\": \"offsetBlur\"\r\n\t\t\t//\t|\t\t},{\r\n\t\t\t//\t|\t\t\t\"tag\": \"feMerge\",\r\n\t\t\t//\t|\t\t\t\"in\": \"offsetBlur\",\r\n\t\t\t//\t|\t\t\t\"in2\": \"SourceGraphic\"\r\n\t\t\t//\t|\t\t}]\r\n\t\t\t//\t|\t};\r\n\t\t\t//\t|\tvar shape = surface.createRect().setFilter(filter);\r\n\t\t\t//\r\n\t\t\t// example:\r\n\t\t\t//\t\tSets a predefined filter from the dojox/gfx/filters module:\r\n\t\t\t//\t|\trequire([\"dojox/gfx/filters\",\"dojox/gfx/svgext\",...], function(filters, svgext){\r\n\t\t\t//\t|\t\t...\r\n\t\t\t//\t|\t\tvar filter = filters.textures.paper({\"id\":\"myFilter\",\"x\":0,\"y\":0,\"width\":100,\"height\":100});\r\n\t\t\t//\t|\t\tvar shape = surface.createRect().setFilter(filter);\r\n\r\n\t\t\tif(!filter){\r\n\t\t\t\tthis.rawNode.removeAttribute(\"filter\");\r\n\t\t\t\tthis.filter = null;\r\n\t\t\t\treturn this;\r\n\t\t\t}\r\n\t\t\tthis.filter = filter;\r\n\t\t\tfilter.id = filter.id || gfx._base._getUniqueId();\r\n\t\t\tvar filterNode = dom.byId(filter.id);\r\n\t\t\tif(!filterNode){\r\n\t\t\t\tfilterNode = this.rawNode.ownerDocument.createElementNS(svg.xmlns.svg, \"filter\");\r\n\t\t\t\tfilterNode.setAttribute(\"filterUnits\", \"userSpaceOnUse\");\r\n\t\t\t\tfor(var p in filter){\r\n\t\t\t\t\tif(!(p in toIgnore)){\r\n\t\t\t\t\t\tfilterNode.setAttribute(p, filter[p]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tarray.forEach(filter.primitives, function(p){\r\n\t\t\t\t\tbuildFilterPrimitivesDOM(p, filterNode);\r\n\t\t\t\t});\r\n\t\t\t\tvar surface = this._getParentSurface();\r\n\t\t\t\tif(surface){\r\n\t\t\t\t\tvar defs = surface.defNode;\r\n\t\t\t\t\tdefs.appendChild(filterNode);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.rawNode.setAttribute(\"filter\", \"url(#\"+filter.id+\")\");\r\n\t\t\treturn this;\r\n\t\t},\r\n\r\n\t\tgetFilter: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tGets the shape SVG Filter.\r\n\t\t\treturn this.filter;\r\n\t\t}\r\n\t});\r\n\treturn svgext;\r\n});\r\n"]}