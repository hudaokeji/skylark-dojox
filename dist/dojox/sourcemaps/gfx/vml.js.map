{"version":3,"sources":["gfx/vml.js"],"names":["define","lang","declare","arr","Color","has","config","dom","domGeom","kernel","g","gs","pathLib","arcLib","gradient","m","vml","xmlns","document","namespaces","add","vmlElems","i","l","s","createStyleSheet","length","addRule","text_alignment","start","middle","end","_parseFloat","str","match","parseInt","parseFloat","_bool","t","true","_reparentEvents","dst","src","name","substr","toLowerCase","Shape","setFill","fill","this","fillStyle","rawNode","filled","f","fo","a","type","matrix","_getRealMatrix","bbox","getBoundingBox","tbbox","_getRealBBox","getTransformedBoundingBox","makeParameters","defaultLinearGradient","project","x","y","width","height","colors","offset","toFixed","push","normalizeColor","color","toHex","value","join","method","angle","_radToDeg","on","defaultRadialGradient","style","left","top","w","h","c","isNaN","r","forEach","v","q","p","blendColors","pop","focusposition","cx","cy","focussize","defaultPattern","size","px2pt","alignShape","position","origin","opacity","ownerDocument","createElement","alphaFilter","filters","Math","round","fillcolor","setStroke","stroke","strokeStyle","stroked","isArray","defaultStroke","rn","strokecolor","toCss","strokeweight","endcap","_translate","_capMap","cap","joinstyle","miterlimit","dashstyle","butt","_capMapReversed","flat","dict","_applyTransform","skew","childNodes","tagName","mt","xx","xy","yx","yy","floor","dx","dy","clip","setClip","_setDimensions","setRawNode","__gfxObject__","_moveToFront","parentNode","appendChild","_moveToBack","n","firstChild","insertBefore","swapNode","parentMatrix","Matrix2D","inherited","arguments","nodeStyle","clipt","multiplyRectangle","pt","multiplyPoint","Group","constructor","Container","_init","call","children","_updateParentMatrix","rs","bs","bgNode","coordsize","offx","offy","destroy","clear","prototype","apply","nodeType","Rect","setShape","newShape","shape","min","parent","before","lastChild","removeChild","node","arcsize","display","indexOf","max","setTransform","Ellipse","rx","ry","Circle","Line","setAttribute","path","x1","y1","x2","y2","Polyline","points","closed","Array","_normalizePoints","attr","Image","multiply","normalize","filter","ps","M11","M12","M21","M22","Dx","Dy","Text","fontStyle","_alignment","align","tag","textPathOk","decoration","rotated","kerning","string","text","_setFont","font","makeFontString","normalizedLength","getTextWidth","_display","_width","pt2px","currentStyle","Path","getAttribute","vmlPath","lastControl","_updateWithSegment","segment","last","clone","renderers","action","_pathVmlToSvgMap","qb","e","M","L","H","V","C","S","Q","T","A","Z","z","_addArgs","from","upto","args","_adjustRelCrd","step","result","j","_adjustRelPos","_moveToA","_moveToR","_lineToA","_lineToR","_hLineToA","_hLineToR","_vLineToA","_vLineToR","_curveToA","lc","_curveToR","_smoothCurveToA","_smoothCurveToR","_qCurveToA","_qCurveToR","_qSmoothCurveToA","_qSmoothCurveToR","_arcTo","relative","arcAsBezier","_updateBBox","_closePath","_confirmSegmented","TextPath","defaultTextPath","defaultFont","setText","newText","_setText","setFont","newFont","splitFontString","Surface","setDimensions","cs","clipNode","_parent","getDimensions","createSurface","pos","byId","_nodes","coordorigin","b","fixVmlAdd","getParent","oldParent","remove","object","o","global","getShape","getFont","getFill","getStroke","silently","_moveChildToFront","_moveChildToBack","Creator","createGroup","createObject","createImage","image","doc","img","createRect","rect","shapeType","rawShape","_overrideSize","extend","fixTarget","event","gfxElement","gfxTarget","target"],"mappings":"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","file":"../../gfx/vml.js","sourcesContent":["define([\"dojo/_base/lang\", \"dojo/_base/declare\", \"dojo/_base/array\", \"dojo/_base/Color\", \"dojo/_base/sniff\",\r\n\t\t\"dojo/_base/config\", \"dojo/dom\", \"dojo/dom-geometry\", \"dojo/_base/kernel\",\r\n\t\t\"./_base\", \"./shape\", \"./path\", \"./arc\", \"./gradient\", \"./matrix\"],\r\nfunction(lang, declare, arr, Color, has, config, dom, domGeom, kernel, g, gs, pathLib, arcLib, gradient, m){\r\n\tvar vml = g.vml = {\r\n\t\t// summary:\r\n\t\t//\t\tThis the default graphics rendering bridge for IE6-7.\r\n\t\t//\t\tThis renderer is very slow.  For best performance on IE6-8, use Silverlight plugin.\r\n\t\t//\t\tIE9+ defaults to the standard W3C SVG renderer.\r\n\r\n\t\t// TODO: Everything exported from this file should be inside these braces.\r\n\t\t// For now, I'll just put the declarations needed for documentation.\r\n\r\n\t\t// xmlns: String\r\n\t\t//\t\ta VML's namespace\r\n\r\n\t\t// text_alignment: Object\r\n\t\t//\t\tmapping from SVG alignment to VML alignment\r\n\t};\r\n\r\n\tvml.xmlns = \"urn:schemas-microsoft-com:vml\";\r\n\r\n\tdocument.namespaces.add(\"v\", vml.xmlns);\r\n\tvar vmlElems = [\"*\", \"group\", \"roundrect\", \"oval\", \"shape\", \"rect\", \"imagedata\", \"path\", \"textpath\", \"text\"],\r\n\t\ti = 0, l = 1, s = document.createStyleSheet();\r\n\tif(has(\"ie\") >= 8){\r\n\t\ti = 1;\r\n\t\tl = vmlElems.length;\r\n\t}\r\n\tfor (; i < l; ++i) {\r\n\t\ts.addRule(\"v\\\\:\" + vmlElems[i], \"behavior:url(#default#VML); display:inline-block\");\r\n\t}\r\n\r\n\tvml.text_alignment = {start: \"left\", middle: \"center\", end: \"right\"};\r\n\r\n\tvml._parseFloat = function(str) {\r\n\t\t// summary:\r\n\t\t//\t\ta helper function to parse VML-specific floating-point values\r\n\t\t// str: String\r\n\t\t//\t\ta representation of a floating-point number\r\n\t\treturn str.match(/^\\d+f$/i) ? parseInt(str) / 65536 : parseFloat(str);\t// Number\r\n\t};\r\n\r\n\tvml._bool = {\"t\": 1, \"true\": 1};\r\n\r\n\tvml._reparentEvents = function(dst, src){\r\n\t\tfor(var name in src){\r\n\t\t\tif(name.substr(0, 2).toLowerCase() == \"on\"){\r\n\t\t\t\tdst[name] = src[name];\r\n\t\t\t\tsrc[name] = null;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tvml.Shape = declare(\"dojox.gfx.vml.Shape\", gs.Shape, {\r\n\t\t// summary:\r\n\t\t//\t\tVML-specific implementation of dojox/gfx/shape.Shape methods\r\n\r\n\t\tsetFill: function(fill){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tsets a fill object (VML)\r\n\t\t\t// fill: Object\r\n\t\t\t//\t\ta fill object\r\n\t\t\t//\t\t(see dojox/gfx.defaultLinearGradient,\r\n\t\t\t//\t\tdojox/gfx.defaultRadialGradient,\r\n\t\t\t//\t\tdojox/gfx.defaultPattern,\r\n\t\t\t//\t\tor dojo/_base/Color)\r\n\r\n\t\t\tif(!fill){\r\n\t\t\t\t// don't fill\r\n\t\t\t\tthis.fillStyle = null;\r\n\t\t\t\tthis.rawNode.filled = \"f\";\r\n\t\t\t\treturn this;\r\n\t\t\t}\r\n\t\t\tvar i, f, fo, a, s;\r\n\t\t\tif(typeof fill == \"object\" && \"type\" in fill){\r\n\t\t\t\t// gradient\r\n\t\t\t\tswitch(fill.type){\r\n\t\t\t\t\tcase \"linear\":\r\n\t\t\t\t\t\tvar matrix = this._getRealMatrix(), bbox = this.getBoundingBox(),\r\n\t\t\t\t\t\t\ttbbox = this._getRealBBox ? this._getRealBBox() : this.getTransformedBoundingBox();\r\n\t\t\t\t\t\ts = [];\r\n\t\t\t\t\t\tif(this.fillStyle !== fill){\r\n\t\t\t\t\t\t\tthis.fillStyle = g.makeParameters(g.defaultLinearGradient, fill);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tf = g.gradient.project(matrix, this.fillStyle,\r\n\t\t\t\t\t\t\t\t{x: bbox.x, y: bbox.y},\r\n\t\t\t\t\t\t\t\t{x: bbox.x + bbox.width, y: bbox.y + bbox.height},\r\n\t\t\t\t\t\t\t\ttbbox[0], tbbox[2]);\r\n\t\t\t\t\t\ta = f.colors;\r\n\t\t\t\t\t\tif(a[0].offset.toFixed(5) != \"0.00000\"){\r\n\t\t\t\t\t\t\ts.push(\"0 \" + g.normalizeColor(a[0].color).toHex());\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor(i = 0; i < a.length; ++i){\r\n\t\t\t\t\t\t\ts.push(a[i].offset.toFixed(5) + \" \" + g.normalizeColor(a[i].color).toHex());\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ti = a.length - 1;\r\n\t\t\t\t\t\tif(a[i].offset.toFixed(5) != \"1.00000\"){\r\n\t\t\t\t\t\t\ts.push(\"1 \" + g.normalizeColor(a[i].color).toHex());\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfo = this.rawNode.fill;\r\n\t\t\t\t\t\tfo.colors.value = s.join(\";\");\r\n\t\t\t\t\t\tfo.method = \"sigma\";\r\n\t\t\t\t\t\tfo.type = \"gradient\";\r\n\t\t\t\t\t\tfo.angle = (270 - m._radToDeg(f.angle)) % 360;\r\n\t\t\t\t\t\tfo.on = true;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"radial\":\r\n\t\t\t\t\t\tf = g.makeParameters(g.defaultRadialGradient, fill);\r\n\t\t\t\t\t\tthis.fillStyle = f;\r\n\t\t\t\t\t\tvar l = parseFloat(this.rawNode.style.left),\r\n\t\t\t\t\t\t\tt = parseFloat(this.rawNode.style.top),\r\n\t\t\t\t\t\t\tw = parseFloat(this.rawNode.style.width),\r\n\t\t\t\t\t\t\th = parseFloat(this.rawNode.style.height),\r\n\t\t\t\t\t\t\tc = isNaN(w) ? 1 : 2 * f.r / w;\r\n\t\t\t\t\t\ta = [];\r\n\t\t\t\t\t\t// add a color at the offset 0 (1 in VML coordinates)\r\n\t\t\t\t\t\tif(f.colors[0].offset > 0){\r\n\t\t\t\t\t\t\ta.push({offset: 1, color: g.normalizeColor(f.colors[0].color)});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// massage colors\r\n\t\t\t\t\t\tarr.forEach(f.colors, function(v, i){\r\n\t\t\t\t\t\t\ta.push({offset: 1 - v.offset * c, color: g.normalizeColor(v.color)});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\ti = a.length - 1;\r\n\t\t\t\t\t\twhile(i >= 0 && a[i].offset < 0){ --i; }\r\n\t\t\t\t\t\tif(i < a.length - 1){\r\n\t\t\t\t\t\t\t// correct excessive colors\r\n\t\t\t\t\t\t\tvar q = a[i], p = a[i + 1];\r\n\t\t\t\t\t\t\tp.color = Color.blendColors(q.color, p.color, q.offset / (q.offset - p.offset));\r\n\t\t\t\t\t\t\tp.offset = 0;\r\n\t\t\t\t\t\t\twhile(a.length - i > 2) a.pop();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// set colors\r\n\t\t\t\t\t\ti = a.length - 1, s = [];\r\n\t\t\t\t\t\tif(a[i].offset > 0){\r\n\t\t\t\t\t\t\ts.push(\"0 \" + a[i].color.toHex());\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor(; i >= 0; --i){\r\n\t\t\t\t\t\t\ts.push(a[i].offset.toFixed(5) + \" \" + a[i].color.toHex());\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfo = this.rawNode.fill;\r\n\t\t\t\t\t\tfo.colors.value = s.join(\";\");\r\n\t\t\t\t\t\tfo.method = \"sigma\";\r\n\t\t\t\t\t\tfo.type = \"gradientradial\";\r\n\t\t\t\t\t\tif(isNaN(w) || isNaN(h) || isNaN(l) || isNaN(t)){\r\n\t\t\t\t\t\t\tfo.focusposition = \"0.5 0.5\";\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tfo.focusposition = ((f.cx - l) / w).toFixed(5) + \" \" + ((f.cy - t) / h).toFixed(5);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfo.focussize = \"0 0\";\r\n\t\t\t\t\t\tfo.on = true;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"pattern\":\r\n\t\t\t\t\t\tf = g.makeParameters(g.defaultPattern, fill);\r\n\t\t\t\t\t\tthis.fillStyle = f;\r\n\t\t\t\t\t\tfo = this.rawNode.fill;\r\n\t\t\t\t\t\tfo.type = \"tile\";\r\n\t\t\t\t\t\tfo.src = f.src;\r\n\t\t\t\t\t\tif(f.width && f.height){\r\n\t\t\t\t\t\t\t// in points\r\n\t\t\t\t\t\t\tfo.size.x = g.px2pt(f.width);\r\n\t\t\t\t\t\t\tfo.size.y = g.px2pt(f.height);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfo.alignShape = \"f\";\r\n\t\t\t\t\t\tfo.position.x = 0;\r\n\t\t\t\t\t\tfo.position.y = 0;\r\n\t\t\t\t\t\tfo.origin.x = f.width  ? f.x / f.width  : 0;\r\n\t\t\t\t\t\tfo.origin.y = f.height ? f.y / f.height : 0;\r\n\t\t\t\t\t\tfo.on = true;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tthis.rawNode.fill.opacity = 1;\r\n\t\t\t\treturn this;\r\n\t\t\t}\r\n\t\t\t// color object\r\n\t\t\tthis.fillStyle = g.normalizeColor(fill);\r\n\t\t\tfo = this.rawNode.fill;\r\n\t\t\tif(!fo){\r\n\t\t\t\tfo = this.rawNode.ownerDocument.createElement(\"v:fill\");\r\n\t\t\t}\r\n\t\t\tfo.method = \"any\";\r\n\t\t\tfo.type = \"solid\";\r\n\t\t\tfo.opacity = this.fillStyle.a;\r\n\t\t\tvar alphaFilter = this.rawNode.filters[\"DXImageTransform.Microsoft.Alpha\"];\r\n\t\t\tif(alphaFilter){\r\n\t\t\t\talphaFilter.opacity = Math.round(this.fillStyle.a * 100);\r\n\t\t\t}\r\n\t\t\tthis.rawNode.fillcolor = this.fillStyle.toHex();\r\n\t\t\tthis.rawNode.filled = true;\r\n\t\t\treturn this;\t// self\r\n\t\t},\r\n\r\n\t\tsetStroke: function(stroke){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tsets a stroke object (VML)\r\n\t\t\t// stroke: Object\r\n\t\t\t//\t\ta stroke object\r\n\t\t\t//\t\t(see dojox/gfx.defaultStroke)\r\n\r\n\t\t\tif(!stroke){\r\n\t\t\t\t// don't stroke\r\n\t\t\t\tthis.strokeStyle = null;\r\n\t\t\t\tthis.rawNode.stroked = \"f\";\r\n\t\t\t\treturn this;\r\n\t\t\t}\r\n\t\t\t// normalize the stroke\r\n\t\t\tif(typeof stroke == \"string\" || lang.isArray(stroke) || stroke instanceof Color){\r\n\t\t\t\tstroke = {color: stroke};\r\n\t\t\t}\r\n\t\t\tvar s = this.strokeStyle = g.makeParameters(g.defaultStroke, stroke);\r\n\t\t\ts.color = g.normalizeColor(s.color);\r\n\t\t\t// generate attributes\r\n\t\t\tvar rn = this.rawNode;\r\n\t\t\trn.stroked = true;\r\n\t\t\trn.strokecolor = s.color.toCss();\r\n\t\t\trn.strokeweight = s.width + \"px\";\t// TODO: should we assume that the width is always in pixels?\r\n\t\t\tif(rn.stroke) {\r\n\t\t\t\trn.stroke.opacity = s.color.a;\r\n\t\t\t\trn.stroke.endcap = this._translate(this._capMap, s.cap);\r\n\t\t\t\tif(typeof s.join == \"number\") {\r\n\t\t\t\t\trn.stroke.joinstyle = \"miter\";\r\n\t\t\t\t\trn.stroke.miterlimit = s.join;\r\n\t\t\t\t}else{\r\n\t\t\t\t\trn.stroke.joinstyle = s.join;\r\n\t\t\t\t\t// rn.stroke.miterlimit = s.width;\r\n\t\t\t\t}\r\n\t\t\t\trn.stroke.dashstyle = s.style == \"none\" ? \"Solid\" : s.style;\r\n\t\t\t}\r\n\t\t\treturn this;\t// self\r\n\t\t},\r\n\r\n\t\t_capMap: { butt: 'flat' },\r\n\t\t_capMapReversed: { flat: 'butt' },\r\n\r\n\t\t_translate: function(dict, value) {\r\n\t\t\treturn (value in dict) ? dict[value] : value;\r\n\t\t},\r\n\r\n\t\t_applyTransform: function() {\r\n\t\t\tvar matrix = this._getRealMatrix();\r\n\t\t\tif(matrix){\r\n\t\t\t\tvar skew = this.rawNode.skew;\r\n\t\t\t\tif(typeof skew == \"undefined\"){\r\n\t\t\t\t\tfor(var i = 0; i < this.rawNode.childNodes.length; ++i){\r\n\t\t\t\t\t\tif(this.rawNode.childNodes[i].tagName == \"skew\"){\r\n\t\t\t\t\t\t\tskew = this.rawNode.childNodes[i];\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(skew){\r\n\t\t\t\t\tskew.on = \"f\";\r\n\t\t\t\t\tvar mt = matrix.xx.toFixed(8) + \" \" + matrix.xy.toFixed(8) + \" \" +\r\n\t\t\t\t\t\tmatrix.yx.toFixed(8) + \" \" + matrix.yy.toFixed(8) + \" 0 0\",\r\n\t\t\t\t\t\toffset = Math.floor(matrix.dx).toFixed() + \"px \" + Math.floor(matrix.dy).toFixed() + \"px\",\r\n\t\t\t\t\t\ts = this.rawNode.style,\r\n\t\t\t\t\t\tl = parseFloat(s.left),\r\n\t\t\t\t\t\tt = parseFloat(s.top),\r\n\t\t\t\t\t\tw = parseFloat(s.width),\r\n\t\t\t\t\t\th = parseFloat(s.height);\r\n\t\t\t\t\tif(isNaN(l)) l = 0;\r\n\t\t\t\t\tif(isNaN(t)) t = 0;\r\n\t\t\t\t\tif(isNaN(w) || !w) w = 1;\r\n\t\t\t\t\tif(isNaN(h) || !h) h = 1;\r\n\t\t\t\t\tvar origin = (-l / w - 0.5).toFixed(8) + \" \" + (-t / h - 0.5).toFixed(8);\r\n\t\t\t\t\tskew.matrix =  mt;\r\n\t\t\t\t\tskew.origin = origin;\r\n\t\t\t\t\tskew.offset = offset;\r\n\t\t\t\t\tskew.on = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(this.fillStyle && this.fillStyle.type == \"linear\"){\r\n\t\t\t\tthis.setFill(this.fillStyle);\r\n\t\t\t}\r\n\t\t\tif(this.clip){\r\n\t\t\t\tthis.setClip(this.clip);\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t},\r\n\r\n\t\t_setDimensions: function(width, height){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tsets the width and height of the rawNode,\r\n\t\t\t//\t\tif the surface size has been changed\r\n\t\t\t// width: String\r\n\t\t\t//\t\twidth in pixels\r\n\t\t\t// height: String\r\n\t\t\t//\t\theight in pixels\r\n\r\n\t\t\t// default implementation does nothing\r\n\t\t\treturn this; // self\r\n\t\t},\r\n\r\n\t\tsetRawNode: function(rawNode){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tassigns and clears the underlying node that will represent this\r\n\t\t\t//\t\tshape. Once set, transforms, gradients, etc, can be applied.\r\n\t\t\t//\t\t(no fill & stroke by default)\r\n\t\t\trawNode.stroked = \"f\";\r\n\t\t\trawNode.filled  = \"f\";\r\n\t\t\tthis.rawNode = rawNode;\r\n\t\t\tthis.rawNode.__gfxObject__ = this;\r\n\t\t},\r\n\r\n\t\t// move family\r\n\r\n\t\t_moveToFront: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tmoves a shape to front of its parent's list of shapes (VML)\r\n\t\t\tthis.rawNode.parentNode.appendChild(this.rawNode);\r\n\t\t\treturn this;\r\n\t\t},\r\n\t\t_moveToBack: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tmoves a shape to back of its parent's list of shapes (VML)\r\n\t\t\tvar r = this.rawNode, p = r.parentNode, n = p.firstChild;\r\n\t\t\tp.insertBefore(r, n);\r\n\t\t\tif(n.tagName == \"rect\"){\r\n\t\t\t\t// surface has a background rectangle, which position should be preserved\r\n\t\t\t\tn.swapNode(r);\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t},\r\n\r\n\t\t_getRealMatrix: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\treturns the cumulative (\"real\") transformation matrix\r\n\t\t\t//\t\tby combining the shape's matrix with its parent's matrix\r\n\t\t\treturn this.parentMatrix ? new m.Matrix2D([this.parentMatrix, this.matrix]) : this.matrix;\t// dojox/gfx/matrix.Matrix2D\r\n\t\t},\r\n\t\t\r\n\t\tsetClip: function(clip){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tsets the clipping area of this shape.\r\n\t\t\t// description:\r\n\t\t\t//\t\tThis method overrides the dojox/gfx/shape.Shape.setClip() method. Only rectangular geometry is supported.\r\n\t\t\t// clip: Object\r\n\t\t\t//\t\tan object that defines the clipping geometry, or null to remove clip.\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\tvar nodeStyle = this.rawNode.style;\r\n\t\t\tif(!clip){\r\n\t\t\t\t// remove clip\r\n\t\t\t\tnodeStyle.position = \"absolute\";\r\n\t\t\t    nodeStyle.clip = \"rect(0px \"+nodeStyle.width+\" \"+nodeStyle.height+\" 0px)\";\r\n\t\t\t}else{\r\n\t\t\t\tif(\"width\" in clip){\r\n\t\t\t\t\tvar matrix = this._getRealMatrix(),\r\n\t\t\t\t\t\tl = parseFloat(nodeStyle.left),\r\n\t\t\t\t\t\tt = parseFloat(nodeStyle.top);\r\n\t\t\t\t\tif(isNaN(l)) l = 0;\r\n\t\t\t\t\tif(isNaN(t)) t = 0;\r\n\t\t\t\t\t// transform the clip with the shape transform to compute the correct w/h (e.g. after a scale)\r\n\t\t\t\t\tvar clipt = m.multiplyRectangle(matrix, clip);\r\n\t\t\t\t\tvar pt = m.multiplyPoint(matrix, {x:l,y:t});\r\n\t\t\t\t\t// clip property is relative to the elt border box\r\n\t\t\t\t\tnodeStyle.clip = \"rect(\" + Math.round(clipt.y-pt.y) + \"px \" + Math.round(clipt.x-pt.x + clipt.width ) + \"px \" + \r\n\t\t\t\t\t\t\t\t\t\t\tMath.round(clipt.y-pt.y + clipt.height ) + \"px \" + Math.round(clipt.x -pt.x) + \"px)\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn this;\r\n \t\t}\r\n\t});\r\n\r\n\t  vml.Group = declare(\"dojox.gfx.vml.Group\", vml.Shape, {\r\n\t\t// summary:\r\n\t\t//\t\ta group shape (VML), which can be used\r\n\t\t//\t\tto logically group shapes (e.g, to propagate matricies)\r\n\t\tconstructor: function(){\r\n\t\t\tgs.Container._init.call(this);\r\n\t\t},\r\n\t\t// apply transformation\r\n\t\t_applyTransform: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tapplies a transformation matrix to a group\r\n\t\t\tvar matrix = this._getRealMatrix();\r\n\t\t\tfor(var i = 0; i < this.children.length; ++i){\r\n\t\t\t\tthis.children[i]._updateParentMatrix(matrix);\r\n\t\t\t}\r\n\t\t\tif(this.clip){\r\n\t\t\t\tthis.setClip(this.clip);\r\n\t\t\t}\r\n\t\t\treturn this;\t// self\r\n\t\t},\r\n\t\t_setDimensions: function(width, height){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tsets the width and height of the rawNode,\r\n\t\t\t//\t\tif the surface size has been changed\r\n\t\t\t// width: String\r\n\t\t\t//\t\twidth in pixels\r\n\t\t\t// height: String\r\n\t\t\t//\t\theight in pixels\r\n\t\t\tvar r = this.rawNode, rs = r.style,\r\n\t\t\t\tbs = this.bgNode.style;\r\n\t\t\trs.width = width;\r\n\t\t\trs.height = height;\r\n\t\t\tr.coordsize = width + \" \" + height;\r\n\t\t\tbs.width = width;\r\n\t\t\tbs.height = height;\r\n\t\t\tfor(var i = 0; i < this.children.length; ++i){\r\n\t\t\t\tthis.children[i]._setDimensions(width, height);\r\n\t\t\t}\r\n\t\t\treturn this; // self\r\n\t\t},\r\n\t\tsetClip: function(clip){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tsets the clipping area of this shape.\r\n\t\t\t// description:\r\n\t\t\t//\t\tThis method overrides the dojox/gfx/shape.Shape.setClip() method.\r\n\t\t\t// clip: Object\r\n\t\t\t//\t\tan object that defines the clipping geometry, or null to remove clip.\r\n\r\n\t\t\tthis.clip = clip;\r\n\t\t\tvar nodeStyle = this.rawNode.style;\r\n\t\t\tif(!clip){\r\n\t\t\t\t// remove clip\r\n\t\t\t\tnodeStyle.position = \"absolute\";\r\n\t\t\t    nodeStyle.clip = \"rect(0px \"+nodeStyle.width+\" \"+nodeStyle.height+\" 0px)\";\r\n\t\t\t}else if(\"width\" in clip){\r\n\t\t\t\tvar matrix = this._getRealMatrix();\r\n\t\t\t\t// transform the clip with group transform\r\n\t\t\t\tvar clipt = m.multiplyRectangle(matrix, clip);\r\n\t\t\t\t// vml feature :-( ): if the group rawNode bbox x/y are < 0,\r\n\t\t\t\t// need to adjust clip accordingly\r\n\t\t\t\tvar bbox = this.getBoundingBox();\r\n\t\t\t\tbbox = bbox ? m.multiplyRectangle(matrix, bbox) : null;\r\n\t\t\t\tvar offx = bbox && bbox.x < 0 ? bbox.x : 0,\r\n\t\t\t\t\toffy = bbox && bbox.y < 0 ? bbox.y : 0;\r\n\t\t\t\tnodeStyle.position = \"absolute\";\r\n\t\t\t\tnodeStyle.clip = \"rect(\" + \r\n\t\t\t\t\tMath.round(clipt.y - offy) + \"px \" + \r\n\t\t\t\t\tMath.round(clipt.x + clipt.width - offx) + \"px \" + \r\n\t\t\t\t\tMath.round(clipt.y + clipt.height - offy)  + \"px \" + \r\n\t\t\t\t\tMath.round(clipt.x - offx) + \"px)\";\r\n\t\t\t}\r\n\t\t\treturn this;\r\n \t\t},\r\n\t\tdestroy: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tReleases all internal resources owned by this shape. Once this method has been called,\r\n\t\t\t//\t\tthe instance is considered disposed and should not be used anymore.\r\n\t\t\tthis.clear(true);\r\n\t\t\t// avoid this.inherited\r\n\t\t\tvml.Shape.prototype.destroy.apply(this, arguments);\r\n\t\t}\r\n\t});\r\n\tvml.Group.nodeType = \"group\";\r\n\r\n\t  vml.Rect = declare(\"dojox.gfx.vml.Rect\", [vml.Shape, gs.Rect], {\r\n\t\t// summary:\r\n\t\t//\t\ta rectangle shape (VML)\r\n\t\tsetShape: function(newShape){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tsets a rectangle shape object (VML)\r\n\t\t\t// newShape: Object\r\n\t\t\t//\t\ta rectangle shape object\r\n\t\t\tvar shape = this.shape = g.makeParameters(this.shape, newShape);\r\n\t\t\tthis.bbox = null;\r\n\t\t\tvar r = Math.min(1, (shape.r / Math.min(parseFloat(shape.width), parseFloat(shape.height)))).toFixed(8);\r\n\t\t\t// a workaround for the VML's arcsize bug: cannot read arcsize of an instantiated node\r\n\t\t\tvar parent = this.rawNode.parentNode, before = null;\r\n\t\t\tif(parent){\r\n\t\t\t\tif(parent.lastChild !== this.rawNode){\r\n\t\t\t\t\tfor(var i = 0; i < parent.childNodes.length; ++i){\r\n\t\t\t\t\t\tif(parent.childNodes[i] === this.rawNode){\r\n\t\t\t\t\t\t\tbefore = parent.childNodes[i + 1];\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tparent.removeChild(this.rawNode);\r\n\t\t\t}\r\n\t\t\tif(has(\"ie\") > 7){\r\n\t\t\t\tvar node = this.rawNode.ownerDocument.createElement(\"v:roundrect\");\r\n\t\t\t\tnode.arcsize = r;\r\n\t\t\t\tnode.style.display = \"inline-block\";\r\n\t\t\t\tvml._reparentEvents(node, this.rawNode);\r\n\t\t\t\tthis.rawNode = node;\r\n\t\t\t\tthis.rawNode.__gfxObject__ = this;\r\n\t\t\t}else{\r\n\t\t\t\tthis.rawNode.arcsize = r;\r\n\t\t\t}\r\n\t\t\tif(parent){\r\n\t\t\t\tif(before){\r\n\t\t\t\t\tparent.insertBefore(this.rawNode, before);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tparent.appendChild(this.rawNode);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar style = this.rawNode.style;\r\n\t\t\tstyle.left   = shape.x.toFixed();\r\n\t\t\tstyle.top    = shape.y.toFixed();\r\n\t\t\tstyle.width  = (typeof shape.width == \"string\" && shape.width.indexOf(\"%\") >= 0)  ? shape.width  : Math.max(shape.width.toFixed(),0);\r\n\t\t\tstyle.height = (typeof shape.height == \"string\" && shape.height.indexOf(\"%\") >= 0) ? shape.height : Math.max(shape.height.toFixed(),0);\r\n\t\t\t// set all necessary styles, which are lost by VML (yes, it's a VML's bug)\r\n\t\t\treturn this.setTransform(this.matrix).setFill(this.fillStyle).setStroke(this.strokeStyle);\t// self\r\n\t\t}\r\n\t});\r\n\tvml.Rect.nodeType = \"roundrect\"; // use a roundrect so the stroke join type is respected\r\n\r\n\tvml.Ellipse = declare(\"dojox.gfx.vml.Ellipse\", [vml.Shape, gs.Ellipse], {\r\n\t\t// summary:\r\n\t\t//\t\tan ellipse shape (VML)\r\n\t\tsetShape: function(newShape){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tsets an ellipse shape object (VML)\r\n\t\t\t// newShape: Object\r\n\t\t\t//\t\tan ellipse shape object\r\n\t\t\tvar shape = this.shape = g.makeParameters(this.shape, newShape);\r\n\t\t\tthis.bbox = null;\r\n\t\t\tvar style = this.rawNode.style;\r\n\t\t\tstyle.left   = (shape.cx - shape.rx).toFixed();\r\n\t\t\tstyle.top    = (shape.cy - shape.ry).toFixed();\r\n\t\t\tstyle.width  = (shape.rx * 2).toFixed();\r\n\t\t\tstyle.height = (shape.ry * 2).toFixed();\r\n\t\t\treturn this.setTransform(this.matrix);\t// self\r\n\t\t}\r\n\t});\r\n\tvml.Ellipse.nodeType = \"oval\";\r\n\r\n\tvml.Circle = declare(\"dojox.gfx.vml.Circle\", [vml.Shape, gs.Circle], {\r\n\t\t// summary:\r\n\t\t//\t\ta circle shape (VML)\r\n\t\tsetShape: function(newShape){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tsets a circle shape object (VML)\r\n\t\t\t// newShape: Object\r\n\t\t\t//\t\ta circle shape object\r\n\t\t\tvar shape = this.shape = g.makeParameters(this.shape, newShape);\r\n\t\t\tthis.bbox = null;\r\n\t\t\tvar style = this.rawNode.style;\r\n\t\t\tstyle.left   = (shape.cx - shape.r).toFixed();\r\n\t\t\tstyle.top    = (shape.cy - shape.r).toFixed();\r\n\t\t\tstyle.width  = (shape.r * 2).toFixed();\r\n\t\t\tstyle.height = (shape.r * 2).toFixed();\r\n\t\t\treturn this;\t// self\r\n\t\t}\r\n\t});\r\n\tvml.Circle.nodeType = \"oval\";\r\n\r\n\tvml.Line = declare(\"dojox.gfx.vml.Line\", [vml.Shape, gs.Line], {\r\n\t\t// summary:\r\n\t\t//\t\ta line shape (VML)\r\n\t\tconstructor: function(rawNode){\r\n\t\t\tif(rawNode) rawNode.setAttribute(\"dojoGfxType\", \"line\");\r\n\t\t},\r\n\t\tsetShape: function(newShape){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tsets a line shape object (VML)\r\n\t\t\t// newShape: Object\r\n\t\t\t//\t\ta line shape object\r\n\t\t\tvar shape = this.shape = g.makeParameters(this.shape, newShape);\r\n\t\t\tthis.bbox = null;\r\n\t\t\tthis.rawNode.path.v = \"m\" + shape.x1.toFixed() + \" \" + shape.y1.toFixed() +\r\n\t\t\t\t\"l\" + shape.x2.toFixed() + \" \" + shape.y2.toFixed() + \"e\";\r\n\t\t\treturn this.setTransform(this.matrix);\t// self\r\n\t\t}\r\n\t});\r\n\tvml.Line.nodeType = \"shape\";\r\n\r\n\tvml.Polyline = declare(\"dojox.gfx.vml.Polyline\", [vml.Shape, gs.Polyline], {\r\n\t\t// summary:\r\n\t\t//\t\ta polyline/polygon shape (VML)\r\n\t\tconstructor: function(rawNode){\r\n\t\t\tif(rawNode) rawNode.setAttribute(\"dojoGfxType\", \"polyline\");\r\n\t\t},\r\n\t\tsetShape: function(points, closed){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tsets a polyline/polygon shape object (VML)\r\n\t\t\t// points: Object|Array\r\n\t\t\t//\t\ta polyline/polygon shape object, or an array of points\r\n\t\t\t// closed: Boolean?\r\n\t\t\t//\t\tif true, close the polyline explicitly\r\n\t\t\tif(points && points instanceof Array){\r\n\t\t\t\tthis.shape = g.makeParameters(this.shape, { points: points });\r\n\t\t\t\tif(closed && this.shape.points.length) this.shape.points.push(this.shape.points[0]);\r\n\t\t\t}else{\r\n\t\t\t\tthis.shape = g.makeParameters(this.shape, points);\r\n\t\t\t}\r\n\t\t\tthis.bbox = null;\r\n\t\t\tthis._normalizePoints();\r\n\t\t\tvar attr = [], p = this.shape.points;\r\n\t\t\tif(p.length > 0){\r\n\t\t\t\tattr.push(\"m\");\r\n\t\t\t\tattr.push(p[0].x.toFixed(), p[0].y.toFixed());\r\n\t\t\t\tif(p.length > 1){\r\n\t\t\t\t\tattr.push(\"l\");\r\n\t\t\t\t\tfor(var i = 1; i < p.length; ++i){\r\n\t\t\t\t\t\tattr.push(p[i].x.toFixed(), p[i].y.toFixed());\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tattr.push(\"e\");\r\n\t\t\tthis.rawNode.path.v = attr.join(\" \");\r\n\t\t\treturn this.setTransform(this.matrix);\t// self\r\n\t\t}\r\n\t});\r\n\tvml.Polyline.nodeType = \"shape\";\r\n\r\n\tvml.Image = declare(\"dojox.gfx.vml.Image\", [vml.Shape, gs.Image], {\r\n\t\t// summary:\r\n\t\t//\t\tan image (VML)\r\n\t\tsetShape: function(newShape){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tsets an image shape object (VML)\r\n\t\t\t// newShape: Object\r\n\t\t\t//\t\tan image shape object\r\n\t\t\tvar shape = this.shape = g.makeParameters(this.shape, newShape);\r\n\t\t\tthis.bbox = null;\r\n\t\t\tthis.rawNode.firstChild.src = shape.src;\r\n\t\t\treturn this.setTransform(this.matrix);\t// self\r\n\t\t},\r\n\t\t_applyTransform: function() {\r\n\t\t\tvar matrix = this._getRealMatrix(),\r\n\t\t\t\trawNode = this.rawNode,\r\n\t\t\t\ts = rawNode.style,\r\n\t\t\t\tshape = this.shape;\r\n\t\t\tif(matrix){\r\n\t\t\t\tmatrix = m.multiply(matrix, {dx: shape.x, dy: shape.y});\r\n\t\t\t}else{\r\n\t\t\t\tmatrix = m.normalize({dx: shape.x, dy: shape.y});\r\n\t\t\t}\r\n\t\t\tif(matrix.xy == 0 && matrix.yx == 0 && matrix.xx > 0 && matrix.yy > 0){\r\n\t\t\t\t// special case to avoid filters\r\n\t\t\t\ts.filter = \"\";\r\n\t\t\t\ts.width  = Math.floor(matrix.xx * shape.width);\r\n\t\t\t\ts.height = Math.floor(matrix.yy * shape.height);\r\n\t\t\t\ts.left   = Math.floor(matrix.dx);\r\n\t\t\t\ts.top    = Math.floor(matrix.dy);\r\n\t\t\t}else{\r\n\t\t\t\tvar ps = rawNode.parentNode.style;\r\n\t\t\t\ts.left   = \"0px\";\r\n\t\t\t\ts.top    = \"0px\";\r\n\t\t\t\ts.width  = ps.width;\r\n\t\t\t\ts.height = ps.height;\r\n\t\t\t\tmatrix = m.multiply(matrix,\r\n\t\t\t\t\t{xx: shape.width / parseInt(s.width), yy: shape.height / parseInt(s.height)});\r\n\t\t\t\tvar f = rawNode.filters[\"DXImageTransform.Microsoft.Matrix\"];\r\n\t\t\t\tif(f){\r\n\t\t\t\t\tf.M11 = matrix.xx;\r\n\t\t\t\t\tf.M12 = matrix.xy;\r\n\t\t\t\t\tf.M21 = matrix.yx;\r\n\t\t\t\t\tf.M22 = matrix.yy;\r\n\t\t\t\t\tf.Dx = matrix.dx;\r\n\t\t\t\t\tf.Dy = matrix.dy;\r\n\t\t\t\t}else{\r\n\t\t\t\t\ts.filter = \"progid:DXImageTransform.Microsoft.Matrix(M11=\" + matrix.xx +\r\n\t\t\t\t\t\t\", M12=\" + matrix.xy + \", M21=\" + matrix.yx + \", M22=\" + matrix.yy +\r\n\t\t\t\t\t\t\", Dx=\" + matrix.dx + \", Dy=\" + matrix.dy + \")\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn this; // self\r\n\t\t},\r\n\t\t_setDimensions: function(width, height){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tsets the width and height of the rawNode,\r\n\t\t\t//\t\tif the surface size has been changed\r\n\t\t\t// width: String\r\n\t\t\t//\t\twidth in pixels\r\n\t\t\t// height: String\r\n\t\t\t//\t\theight in pixels\r\n\r\n\t\t\tvar r = this.rawNode, f = r.filters[\"DXImageTransform.Microsoft.Matrix\"];\r\n\t\t\tif(f){\r\n\t\t\t\tvar s = r.style;\r\n\t\t\t\ts.width  = width;\r\n\t\t\t\ts.height = height;\r\n\t\t\t\treturn this._applyTransform(); // self\r\n\t\t\t}\r\n\t\t\treturn this;\t// self\r\n\t\t}\r\n\t});\r\n\tvml.Image.nodeType = \"rect\";\r\n\r\n\tvml.Text = declare(\"dojox.gfx.vml.Text\", [vml.Shape, gs.Text], {\r\n\t\t// summary:\r\n\t\t//\t\tan anchored text (VML)\r\n\t\tconstructor: function(rawNode){\r\n\t\t\tif(rawNode){rawNode.setAttribute(\"dojoGfxType\", \"text\");}\r\n\t\t\tthis.fontStyle = null;\r\n\t\t},\r\n\t\t_alignment: {start: \"left\", middle: \"center\", end: \"right\"},\r\n\t\tsetShape: function(newShape){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tsets a text shape object (VML)\r\n\t\t\t// newShape: Object\r\n\t\t\t//\t\ta text shape object\r\n\t\t\tthis.shape = g.makeParameters(this.shape, newShape);\r\n\t\t\tthis.bbox = null;\r\n\t\t\tvar r = this.rawNode, s = this.shape, x = s.x, y = s.y.toFixed(), path;\r\n\t\t\tswitch(s.align){\r\n\t\t\t\tcase \"middle\":\r\n\t\t\t\t\tx -= 5;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"end\":\r\n\t\t\t\t\tx -= 10;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tpath = \"m\" + x.toFixed() + \",\" + y + \"l\" + (x + 10).toFixed() + \",\" + y + \"e\";\r\n\t\t\t// find path and text path\r\n\t\t\tvar p = null, t = null, c = r.childNodes;\r\n\t\t\tfor(var i = 0; i < c.length; ++i){\r\n\t\t\t\tvar tag = c[i].tagName;\r\n\t\t\t\tif(tag == \"path\"){\r\n\t\t\t\t\tp = c[i];\r\n\t\t\t\t\tif(t) break;\r\n\t\t\t\t}else if(tag == \"textpath\"){\r\n\t\t\t\t\tt = c[i];\r\n\t\t\t\t\tif(p) break;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(!p){\r\n\t\t\t\tp = r.ownerDocument.createElement(\"v:path\");\r\n\t\t\t\tr.appendChild(p);\r\n\t\t\t}\r\n\t\t\tif(!t){\r\n\t\t\t\tt = r.ownerDocument.createElement(\"v:textpath\");\r\n\t\t\t\tr.appendChild(t);\r\n\t\t\t}\r\n\t\t\tp.v = path;\r\n\t\t\tp.textPathOk = true;\r\n\t\t\tt.on = true;\r\n\t\t\tvar a = vml.text_alignment[s.align];\r\n\t\t\tt.style[\"v-text-align\"] = a ? a : \"left\";\r\n\t\t\tt.style[\"text-decoration\"] = s.decoration;\r\n\t\t\tt.style[\"v-rotate-letters\"] = s.rotated;\r\n\t\t\tt.style[\"v-text-kern\"] = s.kerning;\r\n\t\t\tt.string = s.text;\r\n\t\t\treturn this.setTransform(this.matrix);\t// self\r\n\t\t},\r\n\t\t_setFont: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tsets a font object (VML)\r\n\t\t\tvar f = this.fontStyle, c = this.rawNode.childNodes;\r\n\t\t\tfor(var i = 0; i < c.length; ++i){\r\n\t\t\t\tif(c[i].tagName == \"textpath\"){\r\n\t\t\t\t\tc[i].style.font = g.makeFontString(f);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.setTransform(this.matrix);\r\n\t\t},\r\n\t\t_getRealMatrix: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\treturns the cumulative (\"real\") transformation matrix\r\n\t\t\t//\t\tby combining the shape's matrix with its parent's matrix;\r\n\t\t\t//\t\tit makes a correction for a font size\r\n\t\t\tvar matrix = this.inherited(arguments);\r\n\t\t\t// It appears that text is always aligned vertically at a middle of x-height (???).\r\n\t\t\t// It is impossible to obtain these metrics from VML => I try to approximate it with\r\n\t\t\t// more-or-less util value of 0.7 * FontSize, which is typical for European fonts.\r\n\t\t\tif(matrix){\r\n\t\t\t\tmatrix = m.multiply(matrix,\r\n\t\t\t\t\t{dy: -g.normalizedLength(this.fontStyle ? this.fontStyle.size : \"10pt\") * 0.35});\r\n\t\t\t}\r\n\t\t\treturn matrix;\t// dojox/gfx/matrix.Matrix2D\r\n\t\t},\r\n\t\tgetTextWidth: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tget the text width, in px\r\n\t\t\tvar rawNode = this.rawNode, _display = rawNode.style.display;\r\n\t\t\trawNode.style.display = \"inline\";\r\n\t\t\tvar _width = g.pt2px(parseFloat(rawNode.currentStyle.width));\r\n\t\t\trawNode.style.display = _display;\r\n\t\t\treturn _width;\r\n\t\t}\r\n\t});\r\n\tvml.Text.nodeType = \"shape\";\r\n\r\n\tvml.Path = declare(\"dojox.gfx.vml.Path\", [vml.Shape, pathLib.Path], {\r\n\t\t// summary:\r\n\t\t//\t\ta path shape (VML)\r\n\t\tconstructor: function(rawNode){\r\n\t\t\tif(rawNode && !rawNode.getAttribute(\"dojoGfxType\")){\r\n\t\t\t\trawNode.setAttribute(\"dojoGfxType\", \"path\");\r\n\t\t\t}\r\n\t\t\tthis.vmlPath = \"\";\r\n\t\t\tthis.lastControl = {};\r\n\t\t},\r\n\t\t_updateWithSegment: function(segment){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tupdates the bounding box of path with new segment\r\n\t\t\t// segment: Object\r\n\t\t\t//\t\ta segment\r\n\t\t\tvar last = lang.clone(this.last);\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\tif(arguments.length > 1){ return; } // skip transfomed bbox calculations\r\n\t\t\t// add a VML path segment\r\n\t\t\tvar path = this[this.renderers[segment.action]](segment, last);\r\n\t\t\tif(typeof this.vmlPath == \"string\"){\r\n\t\t\t\tthis.vmlPath += path.join(\"\");\r\n\t\t\t\tthis.rawNode.path.v = this.vmlPath + \" r0,0 e\";\r\n\t\t\t}else{\r\n\t\t\t\tArray.prototype.push.apply(this.vmlPath, path); //FIXME: why not push()?\r\n\t\t\t}\r\n\t\t},\r\n\t\tsetShape: function(newShape){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tforms a path using a shape (VML)\r\n\t\t\t// newShape: Object\r\n\t\t\t//\t\ta VML path string or a path object (see dojox/gfx.defaultPath)\r\n\t\t\tthis.vmlPath = [];\r\n\t\t\tthis.lastControl.type = \"\";\t// no prior control point\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\tthis.vmlPath = this.vmlPath.join(\"\");\r\n\t\t\tthis.rawNode.path.v = this.vmlPath + \" r0,0 e\";\r\n\t\t\treturn this;\r\n\t\t},\r\n\t\t_pathVmlToSvgMap: {m: \"M\", l: \"L\", t: \"m\", r: \"l\", c: \"C\", v: \"c\", qb: \"Q\", x: \"z\", e: \"\"},\r\n\t\t// VML-specific segment renderers\r\n\t\trenderers: {\r\n\t\t\tM: \"_moveToA\", m: \"_moveToR\",\r\n\t\t\tL: \"_lineToA\", l: \"_lineToR\",\r\n\t\t\tH: \"_hLineToA\", h: \"_hLineToR\",\r\n\t\t\tV: \"_vLineToA\", v: \"_vLineToR\",\r\n\t\t\tC: \"_curveToA\", c: \"_curveToR\",\r\n\t\t\tS: \"_smoothCurveToA\", s: \"_smoothCurveToR\",\r\n\t\t\tQ: \"_qCurveToA\", q: \"_qCurveToR\",\r\n\t\t\tT: \"_qSmoothCurveToA\", t: \"_qSmoothCurveToR\",\r\n\t\t\tA: \"_arcTo\", a: \"_arcTo\",\r\n\t\t\tZ: \"_closePath\", z: \"_closePath\"\r\n\t\t},\r\n\t\t_addArgs: function(path, segment, from, upto){\r\n\t\t\tvar n = segment instanceof Array ? segment : segment.args;\r\n\t\t\tfor(var i = from; i < upto; ++i){\r\n\t\t\t\tpath.push(\" \", n[i].toFixed());\r\n\t\t\t}\r\n\t\t},\r\n\t\t_adjustRelCrd: function(last, segment, step){\r\n\t\t\tvar n = segment instanceof Array ? segment : segment.args, l = n.length,\r\n\t\t\t\tresult = new Array(l), i = 0, x = last.x, y = last.y;\r\n\t\t\tif(typeof x != \"number\"){\r\n\t\t\t\t// there is no last coordinate =>\r\n\t\t\t\t// treat the first pair as an absolute coordinate\r\n\t\t\t\tresult[0] = x = n[0];\r\n\t\t\t\tresult[1] = y = n[1];\r\n\t\t\t\ti = 2;\r\n\t\t\t}\r\n\t\t\tif(typeof step == \"number\" && step != 2){\r\n\t\t\t\tvar j = step;\r\n\t\t\t\twhile(j <= l){\r\n\t\t\t\t\tfor(; i < j; i += 2){\r\n\t\t\t\t\t\tresult[i] = x + n[i];\r\n\t\t\t\t\t\tresult[i + 1] = y + n[i + 1];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tx = result[j - 2];\r\n\t\t\t\t\ty = result[j - 1];\r\n\t\t\t\t\tj += step;\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\tfor(; i < l; i += 2){\r\n\t\t\t\t\tresult[i] = (x += n[i]);\r\n\t\t\t\t\tresult[i + 1] = (y += n[i + 1]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t},\r\n\t\t_adjustRelPos: function(last, segment){\r\n\t\t\tvar n = segment instanceof Array ? segment : segment.args, l = n.length,\r\n\t\t\t\tresult = new Array(l);\r\n\t\t\tfor(var i = 0; i < l; ++i){\r\n\t\t\t\tresult[i] = (last += n[i]);\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t},\r\n\t\t_moveToA: function(segment){\r\n\t\t\tvar p = [\" m\"], n = segment instanceof Array ? segment : segment.args, l = n.length;\r\n\t\t\tthis._addArgs(p, n, 0, 2);\r\n\t\t\tif(l > 2){\r\n\t\t\t\tp.push(\" l\");\r\n\t\t\t\tthis._addArgs(p, n, 2, l);\r\n\t\t\t}\r\n\t\t\tthis.lastControl.type = \"\";\t// no control point after this primitive\r\n\t\t\treturn p;\r\n\t\t},\r\n\t\t_moveToR: function(segment, last){\r\n\t\t\treturn this._moveToA(this._adjustRelCrd(last, segment));\r\n\t\t},\r\n\t\t_lineToA: function(segment){\r\n\t\t\tvar p = [\" l\"], n = segment instanceof Array ? segment : segment.args;\r\n\t\t\tthis._addArgs(p, n, 0, n.length);\r\n\t\t\tthis.lastControl.type = \"\";\t// no control point after this primitive\r\n\t\t\treturn p;\r\n\t\t},\r\n\t\t_lineToR: function(segment, last){\r\n\t\t\treturn this._lineToA(this._adjustRelCrd(last, segment));\r\n\t\t},\r\n\t\t_hLineToA: function(segment, last){\r\n\t\t\tvar p = [\" l\"], y = \" \" + last.y.toFixed(),\r\n\t\t\t\tn = segment instanceof Array ? segment : segment.args, l = n.length;\r\n\t\t\tfor(var i = 0; i < l; ++i){\r\n\t\t\t\tp.push(\" \", n[i].toFixed(), y);\r\n\t\t\t}\r\n\t\t\tthis.lastControl.type = \"\";\t// no control point after this primitive\r\n\t\t\treturn p;\r\n\t\t},\r\n\t\t_hLineToR: function(segment, last){\r\n\t\t\treturn this._hLineToA(this._adjustRelPos(last.x, segment), last);\r\n\t\t},\r\n\t\t_vLineToA: function(segment, last){\r\n\t\t\tvar p = [\" l\"], x = \" \" + last.x.toFixed(),\r\n\t\t\t\tn = segment instanceof Array ? segment : segment.args, l = n.length;\r\n\t\t\tfor(var i = 0; i < l; ++i){\r\n\t\t\t\tp.push(x, \" \", n[i].toFixed());\r\n\t\t\t}\r\n\t\t\tthis.lastControl.type = \"\";\t// no control point after this primitive\r\n\t\t\treturn p;\r\n\t\t},\r\n\t\t_vLineToR: function(segment, last){\r\n\t\t\treturn this._vLineToA(this._adjustRelPos(last.y, segment), last);\r\n\t\t},\r\n\t\t_curveToA: function(segment){\r\n\t\t\tvar p = [], n = segment instanceof Array ? segment : segment.args, l = n.length,\r\n\t\t\t\tlc = this.lastControl;\r\n\t\t\tfor(var i = 0; i < l; i += 6){\r\n\t\t\t\tp.push(\" c\");\r\n\t\t\t\tthis._addArgs(p, n, i, i + 6);\r\n\t\t\t}\r\n\t\t\tlc.x = n[l - 4];\r\n\t\t\tlc.y = n[l - 3];\r\n\t\t\tlc.type = \"C\";\r\n\t\t\treturn p;\r\n\t\t},\r\n\t\t_curveToR: function(segment, last){\r\n\t\t\treturn this._curveToA(this._adjustRelCrd(last, segment, 6));\r\n\t\t},\r\n\t\t_smoothCurveToA: function(segment, last){\r\n\t\t\tvar p = [], n = segment instanceof Array ? segment : segment.args, l = n.length,\r\n\t\t\t\tlc = this.lastControl, i = 0;\r\n\t\t\tif(lc.type != \"C\"){\r\n\t\t\t\tp.push(\" c\");\r\n\t\t\t\tthis._addArgs(p, [last.x, last.y], 0, 2);\r\n\t\t\t\tthis._addArgs(p, n, 0, 4);\r\n\t\t\t\tlc.x = n[0];\r\n\t\t\t\tlc.y = n[1];\r\n\t\t\t\tlc.type = \"C\";\r\n\t\t\t\ti = 4;\r\n\t\t\t}\r\n\t\t\tfor(; i < l; i += 4){\r\n\t\t\t\tp.push(\" c\");\r\n\t\t\t\tthis._addArgs(p, [\r\n\t\t\t\t\t2 * last.x - lc.x,\r\n\t\t\t\t\t2 * last.y - lc.y\r\n\t\t\t\t], 0, 2);\r\n\t\t\t\tthis._addArgs(p, n, i, i + 4);\r\n\t\t\t\tlc.x = n[i];\r\n\t\t\t\tlc.y = n[i + 1];\r\n\t\t\t}\r\n\t\t\treturn p;\r\n\t\t},\r\n\t\t_smoothCurveToR: function(segment, last){\r\n\t\t\treturn this._smoothCurveToA(this._adjustRelCrd(last, segment, 4), last);\r\n\t\t},\r\n\t\t_qCurveToA: function(segment){\r\n\t\t\tvar p = [], n = segment instanceof Array ? segment : segment.args, l = n.length,\r\n\t\t\t\tlc = this.lastControl;\r\n\t\t\tfor(var i = 0; i < l; i += 4){\r\n\t\t\t\tp.push(\" qb\");\r\n\t\t\t\tthis._addArgs(p, n, i, i + 4);\r\n\t\t\t}\r\n\t\t\tlc.x = n[l - 4];\r\n\t\t\tlc.y = n[l - 3];\r\n\t\t\tlc.type = \"Q\";\r\n\t\t\treturn p;\r\n\t\t},\r\n\t\t_qCurveToR: function(segment, last){\r\n\t\t\treturn this._qCurveToA(this._adjustRelCrd(last, segment, 4));\r\n\t\t},\r\n\t\t_qSmoothCurveToA: function(segment, last){\r\n\t\t\tvar p = [], n = segment instanceof Array ? segment : segment.args, l = n.length,\r\n\t\t\t\tlc = this.lastControl, i = 0;\r\n\t\t\tif(lc.type != \"Q\"){\r\n\t\t\t\tp.push(\" qb\");\r\n\t\t\t\tthis._addArgs(p, [\r\n\t\t\t\t\tlc.x = last.x,\r\n\t\t\t\t\tlc.y = last.y\r\n\t\t\t\t], 0, 2);\r\n\t\t\t\tlc.type = \"Q\";\r\n\t\t\t\tthis._addArgs(p, n, 0, 2);\r\n\t\t\t\ti = 2;\r\n\t\t\t}\r\n\t\t\tfor(; i < l; i += 2){\r\n\t\t\t\tp.push(\" qb\");\r\n\t\t\t\tthis._addArgs(p, [\r\n\t\t\t\t\tlc.x = 2 * last.x - lc.x,\r\n\t\t\t\t\tlc.y = 2 * last.y - lc.y\r\n\t\t\t\t], 0, 2);\r\n\t\t\t\tthis._addArgs(p, n, i, i + 2);\r\n\t\t\t}\r\n\t\t\treturn p;\r\n\t\t},\r\n\t\t_qSmoothCurveToR: function(segment, last){\r\n\t\t\treturn this._qSmoothCurveToA(this._adjustRelCrd(last, segment, 2), last);\r\n\t\t},\r\n\t\t_arcTo: function(segment, last){\r\n\t\t\tvar p = [], n = segment.args, l = n.length, relative = segment.action == \"a\";\r\n\t\t\tfor(var i = 0; i < l; i += 7){\r\n\t\t\t\tvar x1 = n[i + 5], y1 = n[i + 6];\r\n\t\t\t\tif(relative){\r\n\t\t\t\t\tx1 += last.x;\r\n\t\t\t\t\ty1 += last.y;\r\n\t\t\t\t}\r\n\t\t\t\tvar result = arcLib.arcAsBezier(\r\n\t\t\t\t\tlast, n[i], n[i + 1], n[i + 2],\r\n\t\t\t\t\tn[i + 3] ? 1 : 0, n[i + 4] ? 1 : 0,\r\n\t\t\t\t\tx1, y1\r\n\t\t\t\t);\r\n\t\t\t\tfor(var j = 0; j < result.length; ++j){\r\n\t\t\t\t\tp.push(\" c\");\r\n\t\t\t\t\tvar t = result[j];\r\n\t\t\t\t\tthis._addArgs(p, t, 0, t.length);\r\n\t\t\t\t\tthis._updateBBox(t[0], t[1]);\r\n\t\t\t\t\tthis._updateBBox(t[2], t[3]);\r\n\t\t\t\t\tthis._updateBBox(t[4], t[5]);\r\n\t\t\t\t}\r\n\t\t\t\tlast.x = x1;\r\n\t\t\t\tlast.y = y1;\r\n\t\t\t}\r\n\t\t\tthis.lastControl.type = \"\";\t// no control point after this primitive\r\n\t\t\treturn p;\r\n\t\t},\r\n\t\t_closePath: function(){\r\n\t\t\tthis.lastControl.type = \"\";\t// no control point after this primitive\r\n\t\t\treturn [\"x\"];\r\n\t\t},\r\n\t\t_getRealBBox: function(){ \r\n\t\t\t//\tsummary: \r\n\t\t\t//\t\treturns an array of four points or null \r\n\t\t\t//\t\tThis is called by setFill, which actually creates the path, so we want to avoid \r\n\t\t\t//\t\tduping the path repeatedly in the shape by clearing the path before re-add. \r\n\t\t\tthis._confirmSegmented(); \r\n\t\t\tif(this.tbbox){ \r\n\t\t\t\treturn this.tbbox;\t// Array \r\n\t\t\t} \r\n\t\t\tif(typeof this.shape.path == \"string\"){ \r\n\t\t\t\tthis.shape.path = \"\"; \r\n\t\t\t} \r\n\t\t\treturn this.inherited(arguments); \r\n\t\t} \t\t\r\n\t});\r\n\tvml.Path.nodeType = \"shape\";\r\n\r\n\tvml.TextPath = declare(\"dojox.gfx.vml.TextPath\", [vml.Path, pathLib.TextPath], {\r\n\t\t// summary:\r\n\t\t//\t\ta textpath shape (VML)\r\n\t\tconstructor: function(rawNode){\r\n\t\t\tif(rawNode){rawNode.setAttribute(\"dojoGfxType\", \"textpath\");}\r\n\t\t\tthis.fontStyle = null;\r\n\t\t\tif(!(\"text\" in this)){\r\n\t\t\t\tthis.text = lang.clone(g.defaultTextPath);\r\n\t\t\t}\r\n\t\t\tif(!(\"fontStyle\" in this)){\r\n\t\t\t\tthis.fontStyle = lang.clone(g.defaultFont);\r\n\t\t\t}\r\n\t\t},\r\n\t\tsetText: function(newText){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tsets a text to be drawn along the path\r\n\t\t\tthis.text = g.makeParameters(this.text,\r\n\t\t\t\ttypeof newText == \"string\" ? {text: newText} : newText);\r\n\t\t\tthis._setText();\r\n\t\t\treturn this;\t// self\r\n\t\t},\r\n\t\tsetFont: function(newFont){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tsets a font for text\r\n\t\t\tthis.fontStyle = typeof newFont == \"string\" ?\r\n\t\t\t\tg.splitFontString(newFont) :\r\n\t\t\t\tg.makeParameters(g.defaultFont, newFont);\r\n\t\t\tthis._setFont();\r\n\t\t\treturn this;\t// self\r\n\t\t},\r\n\r\n\t\t_setText: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tsets a text shape object (VML)\r\n\t\t\tthis.bbox = null;\r\n\t\t\tvar r = this.rawNode, s = this.text,\r\n\t\t\t\t// find path and text path\r\n\t\t\t\tp = null, t = null, c = r.childNodes;\r\n\t\t\tfor(var i = 0; i < c.length; ++i){\r\n\t\t\t\tvar tag = c[i].tagName;\r\n\t\t\t\tif(tag == \"path\"){\r\n\t\t\t\t\tp = c[i];\r\n\t\t\t\t\tif(t) break;\r\n\t\t\t\t}else if(tag == \"textpath\"){\r\n\t\t\t\t\tt = c[i];\r\n\t\t\t\t\tif(p) break;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(!p){\r\n\t\t\t\tp = this.rawNode.ownerDocument.createElement(\"v:path\");\r\n\t\t\t\tr.appendChild(p);\r\n\t\t\t}\r\n\t\t\tif(!t){\r\n\t\t\t\tt = this.rawNode.ownerDocument.createElement(\"v:textpath\");\r\n\t\t\t\tr.appendChild(t);\r\n\t\t\t}\r\n\t\t\tp.textPathOk = true;\r\n\t\t\tt.on = true;\r\n\t\t\tvar a = vml.text_alignment[s.align];\r\n\t\t\tt.style[\"v-text-align\"] = a ? a : \"left\";\r\n\t\t\tt.style[\"text-decoration\"] = s.decoration;\r\n\t\t\tt.style[\"v-rotate-letters\"] = s.rotated;\r\n\t\t\tt.style[\"v-text-kern\"] = s.kerning;\r\n\t\t\tt.string = s.text;\r\n\t\t},\r\n\t\t_setFont: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tsets a font object (VML)\r\n\t\t\tvar f = this.fontStyle, c = this.rawNode.childNodes;\r\n\t\t\tfor(var i = 0; i < c.length; ++i){\r\n\t\t\t\tif(c[i].tagName == \"textpath\"){\r\n\t\t\t\t\tc[i].style.font = g.makeFontString(f);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\tvml.TextPath.nodeType = \"shape\";\r\n\r\n\tvml.Surface = declare(\"dojox.gfx.vml.Surface\", gs.Surface, {\r\n\t\t// summary:\r\n\t\t//\t\ta surface object to be used for drawings (VML)\r\n\t\tconstructor: function(){\r\n\t\t\tgs.Container._init.call(this);\r\n\t\t},\r\n\t\tdestroy: function(){\r\n\t\t\tthis.clear(true); \r\n\t\t\tthis.inherited(arguments);\r\n\t\t},\r\n\t\tsetDimensions: function(width, height){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tsets the width and height of the rawNode\r\n\t\t\t// width: String\r\n\t\t\t//\t\twidth of surface, e.g., \"100px\"\r\n\t\t\t// height: String\r\n\t\t\t//\t\theight of surface, e.g., \"100px\"\r\n\t\t\tthis.width  = g.normalizedLength(width);\t// in pixels\r\n\t\t\tthis.height = g.normalizedLength(height);\t// in pixels\r\n\t\t\tif(!this.rawNode) return this;\r\n\t\t\tvar cs = this.clipNode.style,\r\n\t\t\t\tr = this.rawNode, rs = r.style,\r\n\t\t\t\tbs = this.bgNode.style,\r\n\t\t\t\tps = this._parent.style, i;\r\n\t\t\tps.width = width;\r\n\t\t\tps.height = height;\r\n\t\t\tcs.width  = width;\r\n\t\t\tcs.height = height;\r\n\t\t\tcs.clip = \"rect(0px \" + width + \"px \" + height + \"px 0px)\";\r\n\t\t\trs.width = width;\r\n\t\t\trs.height = height;\r\n\t\t\tr.coordsize = width + \" \" + height;\r\n\t\t\tbs.width = width;\r\n\t\t\tbs.height = height;\r\n\t\t\tfor(i = 0; i < this.children.length; ++i){\r\n\t\t\t\tthis.children[i]._setDimensions(width, height);\r\n\t\t\t}\r\n\t\t\treturn this;\t// self\r\n\t\t},\r\n\t\tgetDimensions: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\treturns an object with properties \"width\" and \"height\"\r\n\t\t\tvar t = this.rawNode ? {\r\n\t\t\t\twidth:  g.normalizedLength(this.rawNode.style.width),\r\n\t\t\t\theight: g.normalizedLength(this.rawNode.style.height)} : null;\r\n\t\t\tif(t.width  <= 0){ t.width  = this.width; }\r\n\t\t\tif(t.height <= 0){ t.height = this.height; }\r\n\t\t\treturn t;\t// Object\r\n\t\t}\r\n\t});\r\n\r\n\tvml.createSurface = function(parentNode, width, height){\r\n\t\t// summary:\r\n\t\t//\t\tcreates a surface (VML)\r\n\t\t// parentNode: Node\r\n\t\t//\t\ta parent node\r\n\t\t// width: String|Number\r\n\t\t//\t\twidth of surface, e.g., \"100px\" or 100\r\n\t\t// height: String|NUmber\r\n\t\t//\t\theight of surface, e.g., \"100px\" or 100\r\n\t\t// returns:\r\n\t\t//     newly created surface\r\n\r\n\t\tif(!width && !height){\r\n\t\t\tvar pos = domGeom.position(parentNode);\r\n\t\t\twidth  = width  || pos.w;\r\n\t\t\theight = height || pos.h;\r\n\t\t}\r\n\t\tif(typeof width == \"number\"){\r\n\t\t\twidth = width + \"px\";\r\n\t\t}\r\n\t\tif(typeof height == \"number\"){\r\n\t\t\theight = height + \"px\";\r\n\t\t}\r\n\r\n\t\tvar s = new vml.Surface(), p = dom.byId(parentNode),\r\n\t\t\tc = s.clipNode = p.ownerDocument.createElement(\"div\"),\r\n\t\t\tr = s.rawNode = p.ownerDocument.createElement(\"v:group\"),\r\n\t\t\tcs = c.style, rs = r.style;\r\n\r\n\t\tif(has(\"ie\") > 7){\r\n\t\t\trs.display = \"inline-block\";\r\n\t\t}\r\n\r\n\t\ts._parent = p;\r\n\t\ts._nodes.push(c);\t// other elements will be deleted as parts of \"c\"\r\n\r\n\t\tp.style.width  = width;\r\n\t\tp.style.height = height;\r\n\r\n\t\tcs.position = \"absolute\";\r\n\t\tcs.width  = width;\r\n\t\tcs.height = height;\r\n\t\tcs.clip = \"rect(0px \" + width + \" \" + height + \" 0px)\";\r\n\t\trs.position = \"absolute\";\r\n\t\trs.width  = width;\r\n\t\trs.height = height;\r\n\t\tr.coordsize = (width === \"100%\" ? width : parseFloat(width)) + \" \" +\r\n\t\t\t(height === \"100%\" ? height : parseFloat(height));\r\n\t\tr.coordorigin = \"0 0\";\r\n\r\n\t\t// create a background rectangle, which is required to show all other shapes\r\n\t\tvar b = s.bgNode = r.ownerDocument.createElement(\"v:rect\"), bs = b.style;\r\n\t\tbs.left = bs.top = 0;\r\n\t\tbs.width  = rs.width;\r\n\t\tbs.height = rs.height;\r\n\t\tb.filled = b.stroked = \"f\";\r\n\r\n\t\tr.appendChild(b);\r\n\t\tc.appendChild(r);\r\n\t\tp.appendChild(c);\r\n\r\n\t\ts.width  = g.normalizedLength(width);\t// in pixels\r\n\t\ts.height = g.normalizedLength(height);\t// in pixels\r\n\r\n\t\treturn s;\t// dojox/gfx/shape.Surface\r\n\t};\r\n\r\n\t// Extenders\r\n\t\r\n\t// copied from dojox/gfx/utils\r\n\tfunction forEach(object, f, o){\r\n\t\to = o || kernel.global;\r\n\t\tf.call(o, object);\r\n\t\tif(object instanceof g.Surface || object instanceof g.Group){\r\n\t\t\tarr.forEach(object.children, function(shape){\r\n\t\t\t\tforEach(shape, f, o);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tvar addPatch9624 = function(shape){\r\n\t\tif(this != shape.getParent()){\r\n\t\t\t// cleanup from old parent\r\n\t\t\tvar oldParent = shape.getParent();\r\n\t\t\tif(oldParent) { oldParent.remove(shape); }\r\n\t\t\t// then move the raw node\r\n\t\t\tthis.rawNode.appendChild(shape.rawNode);\r\n\t\t\tC.add.apply(this, arguments);\r\n\t\t\t// reapply visual attributes (slow..)\r\n\t\t\tforEach(this, function(s){\r\n\t\t\t\tif (typeof(s.getFont) == 'function'){ // text shapes need to be completely refreshed\r\n\t\t\t\t\ts.setShape(s.getShape());\r\n\t\t\t\t\ts.setFont(s.getFont());\r\n\t\t\t\t}\r\n\t\t\t\tif (typeof(s.setFill) == 'function'){ // if setFill is available a setStroke should be safe to assume also\r\n\t\t\t\t\ts.setFill(s.getFill());\r\n\t\t\t\t\ts.setStroke(s.getStroke());\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn this;\t// self\r\n\t};\r\n\t\r\n\tvar add15 = function(shape){\r\n\t\tif(this != shape.getParent()){\r\n\t\t\tthis.rawNode.appendChild(shape.rawNode);\r\n\t\t\tif(!shape.getParent()){ \r\n\t\t\t\t// reapply visual attributes \r\n\t\t\t\tshape.setFill(shape.getFill()); \r\n\t\t\t\tshape.setStroke(shape.getStroke()); \r\n\t\t\t} \r\n\t\t\tC.add.apply(this, arguments);\r\n\t\t}\r\n\t\treturn this;\t// self\r\n\t};\r\n\r\n\tvar C = gs.Container, Container = {\r\n\t\tadd: config.fixVmlAdd === true ? addPatch9624 : add15,\r\n\t\tremove: function(shape, silently){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tremove a shape from a group/surface\r\n\t\t\t// shape: dojox/gfx/shape.Shape\r\n\t\t\t//\t\ta VML shape object\r\n\t\t\t// silently: Boolean?\r\n\t\t\t//\t\tif true, regenerate a picture\r\n\t\t\tif(this == shape.getParent()){\r\n\t\t\t\tif(this.rawNode == shape.rawNode.parentNode){\r\n\t\t\t\t\tthis.rawNode.removeChild(shape.rawNode);\r\n\t\t\t\t}\r\n\t\t\t\tC.remove.apply(this, arguments);\r\n\t\t\t}\r\n\t\t\treturn this;\t// self\r\n\t\t},\r\n\t\tclear: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tremoves all shapes from a group/surface\r\n\t\t\tvar r = this.rawNode;\r\n\t\t\twhile(r.firstChild != r.lastChild){\r\n\t\t\t\tif(r.firstChild != this.bgNode){\r\n\t\t\t\t\tr.removeChild(r.firstChild);\r\n\t\t\t\t}\r\n\t\t\t\tif(r.lastChild != this.bgNode){\r\n\t\t\t\t\tr.removeChild(r.lastChild);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn C.clear.apply(this, arguments);\r\n\t\t},\r\n\t\tgetBoundingBox: C.getBoundingBox,\r\n\t\t_moveChildToFront: C._moveChildToFront,\r\n\t\t_moveChildToBack:  C._moveChildToBack\r\n\t};\r\n\r\n\tvar Creator = {\r\n\t\t// summary:\r\n\t\t//\t\tVML shape creators\r\n\t\tcreateGroup: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tcreates a VML group shape\r\n\t\t\tvar node = this.createObject(vml.Group, null);\t// dojox/gfx.Group\r\n\t\t\t// create a background rectangle, which is required to show all other shapes\r\n\t\t\tvar r = node.rawNode.ownerDocument.createElement(\"v:rect\");\r\n\t\t\tr.style.left = r.style.top = 0;\r\n\t\t\tr.style.width  = node.rawNode.style.width;\r\n\t\t\tr.style.height = node.rawNode.style.height;\r\n\t\t\tr.filled = r.stroked = \"f\";\r\n\t\t\tnode.rawNode.appendChild(r);\r\n\t\t\tnode.bgNode = r;\r\n\t\t\treturn node;\t// dojox/gfx.Group\r\n\t\t},\r\n\t\tcreateImage: function(image){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tcreates a VML image shape\r\n\t\t\t// image: Object\r\n\t\t\t//\t\tan image object (see dojox/gfx.defaultImage)\r\n\t\t\tif(!this.rawNode) return null;\r\n\t\t\tvar shape = new vml.Image(),\r\n\t\t\t\tdoc = this.rawNode.ownerDocument,\r\n\t\t\t\tnode = doc.createElement('v:rect');\r\n\t\t\tnode.stroked = \"f\";\r\n\t\t\tnode.style.width  = this.rawNode.style.width;\r\n\t\t\tnode.style.height = this.rawNode.style.height;\r\n\t\t\tvar img  = doc.createElement('v:imagedata');\r\n\t\t\tnode.appendChild(img);\r\n\t\t\tshape.setRawNode(node);\r\n\t\t\tthis.rawNode.appendChild(node);\r\n\t\t\tshape.setShape(image);\r\n\t\t\tthis.add(shape);\r\n\t\t\treturn shape;\t// dojox/gfx/shape.Image\r\n\t\t},\r\n\t\tcreateRect: function(rect){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tcreates a rectangle shape\r\n\t\t\t// rect: Object\r\n\t\t\t//\t\ta path object (see dojox/gfx.defaultRect)\r\n\t\t\tif(!this.rawNode) return null;\r\n\t\t\tvar shape = new vml.Rect,\r\n\t\t\t\tnode = this.rawNode.ownerDocument.createElement(\"v:roundrect\");\r\n\t\t\tif(has(\"ie\") > 7){\r\n\t\t\t\tnode.style.display = \"inline-block\";\r\n\t\t\t}\r\n\t\t\tshape.setRawNode(node);\r\n\t\t\tthis.rawNode.appendChild(node);\r\n\t\t\tshape.setShape(rect);\r\n\t\t\tthis.add(shape);\r\n\t\t\treturn shape;\t// dojox/gfx.Rect\r\n\t\t},\r\n\t\tcreateObject: function(shapeType, rawShape) {\r\n\t\t\t// summary:\r\n\t\t\t//\t\tcreates an instance of the passed shapeType class\r\n\t\t\t// shapeType: Function\r\n\t\t\t//\t\ta class constructor to create an instance of\r\n\t\t\t// rawShape: Object\r\n\t\t\t//\t\tproperties to be passed in to the classes \"setShape\" method\r\n\t\t\t// overrideSize: Boolean\r\n\t\t\t//\t\tset the size explicitly, if true\r\n\t\t\tif(!this.rawNode) return null;\r\n\t\t\tvar shape = new shapeType(),\r\n\t\t\t\tnode = this.rawNode.ownerDocument.createElement('v:' + shapeType.nodeType);\r\n\t\t\tshape.setRawNode(node);\r\n\t\t\tthis.rawNode.appendChild(node);\r\n\t\t\tswitch(shapeType){\r\n\t\t\t\tcase vml.Group:\r\n\t\t\t\tcase vml.Line:\r\n\t\t\t\tcase vml.Polyline:\r\n\t\t\t\tcase vml.Image:\r\n\t\t\t\tcase vml.Text:\r\n\t\t\t\tcase vml.Path:\r\n\t\t\t\tcase vml.TextPath:\r\n\t\t\t\t\tthis._overrideSize(node);\r\n\t\t\t}\r\n\t\t\tshape.setShape(rawShape);\r\n\t\t\tthis.add(shape);\r\n\t\t\treturn shape;\t// dojox/gfx/shape.Shape\r\n\t\t},\r\n\t\t_overrideSize: function(node){\r\n\t\t\tvar s = this.rawNode.style, w = s.width, h = s.height;\r\n\t\t\tnode.style.width  = w;\r\n\t\t\tnode.style.height = h;\r\n\t\t\tnode.coordsize = parseInt(w) + \" \" + parseInt(h);\r\n\t\t}\r\n\t};\r\n\r\n\tlang.extend(vml.Group, Container);\r\n\tlang.extend(vml.Group, gs.Creator);\r\n\tlang.extend(vml.Group, Creator);\r\n\r\n\tlang.extend(vml.Surface, Container);\r\n\tlang.extend(vml.Surface, gs.Creator);\r\n\tlang.extend(vml.Surface, Creator);\r\n\r\n\t// Mouse/Touch event\r\n\tvml.fixTarget = function(event, gfxElement){\r\n\t\t// summary:\r\n\t\t//\t\tAdds the gfxElement to event.gfxTarget if none exists. This new\r\n\t\t//\t\tproperty will carry the GFX element associated with this event.\r\n\t\t// event: Object \r\n\t\t//\t\tThe current input event (MouseEvent or TouchEvent)\r\n\t\t// gfxElement: Object\r\n\t\t//\t\tThe GFX target element\r\n\t\tif (!event.gfxTarget) {\r\n\t\t\tevent.gfxTarget = event.target.__gfxObject__;\r\n\t\t}\r\n\t\treturn true;\r\n\t};\r\n\t\r\n\treturn vml;\r\n});\r\n"]}