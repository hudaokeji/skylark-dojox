{"version":3,"sources":["form/FileInput.js"],"names":["define","declare","kernel","fx","domAttr","domClass","template","FormWidget","Templated","experimental","label","cancelText","name","templateString","startup","this","_listener","connect","fileInput","_keyListener","postCreate","_matchValue","inputNode","value","cancelNode","style","visibility","fadeIn","node","duration","play","setLabel","cssClass","titleNode","innerHTML","reset","e","disconnect","domNode","removeChild","fadeOut","document","createElement","setAttribute","id","add","appendChild"],"mappings":";;;;;;;AAAAA,QACC,qBACA,oBACA,gBACA,gBACA,iBACA,uCACA,yBACA,oBAED,SAASC,EAASC,EAAQC,EAAIC,EAASC,EAAUC,EAAUC,EAAYC,GAGvE,OAFAN,EAAOO,aAAa,wBAEbR,EAAQ,uBAAwBM,GAYtCG,MAAO,aAIPC,WAAY,SAIZC,KAAM,aAENC,eAAgBP,EAEhBQ,QAAS,WAGRC,KAAKC,UAAYD,KAAKE,QAAQF,KAAKG,UAAU,WAAW,eACxDH,KAAKI,aAAeJ,KAAKE,QAAQF,KAAKG,UAAU,UAAU,gBAK3DE,WAAY,aAEZC,YAAa,WAGZN,KAAKO,UAAUC,MAAQR,KAAKG,UAAUK,MACnCR,KAAKO,UAAUC,QACjBR,KAAKS,WAAWC,MAAMC,WAAa,UACnCvB,EAAGwB,QAASC,KAAMb,KAAKS,WAAYK,SAAS,MAAOC,SAIrDC,SAAU,SAAoBrB,EAAmBsB,GAGhDjB,KAAKkB,UAAUC,UAAYxB,GAG5ByB,MAAO,SAAmBC,GAIzBrB,KAAKsB,WAAWtB,KAAKC,WACrBD,KAAKsB,WAAWtB,KAAKI,cAClBJ,KAAKG,WACPH,KAAKuB,QAAQC,YAAYxB,KAAKG,WAE/Bf,EAAGqC,SAAUZ,KAAMb,KAAKS,WAAYK,SAAS,MAAOC,OAGpDf,KAAKG,UAAYuB,SAASC,cAAc,SAIxC3B,KAAKG,UAAUyB,aAAa,OAAO,QACnC5B,KAAKG,UAAUyB,aAAa,KAAM5B,KAAK6B,IACvC7B,KAAKG,UAAUyB,aAAa,OAAQ5B,KAAKH,MACzCP,EAASwC,IAAI9B,KAAKG,UAAU,sBAC5BH,KAAKuB,QAAQQ,YAAY/B,KAAKG,WAE9BH,KAAKI,aAAeJ,KAAKE,QAAQF,KAAKG,UAAW,UAAW,eAC5DH,KAAKC,UAAYD,KAAKE,QAAQF,KAAKG,UAAW,WAAY,eAC1DH,KAAKO,UAAUC,MAAQ","file":"../../form/FileInput.js","sourcesContent":["define([\r\n\t\"dojo/_base/declare\",\r\n\t\"dojo/_base/kernel\",\r\n\t\"dojo/_base/fx\",\r\n\t\"dojo/dom-attr\",\r\n\t\"dojo/dom-class\",\r\n\t\"dojo/text!./resources/FileInput.html\",\r\n\t\"dijit/form/_FormWidget\",\r\n\t\"dijit/_Templated\"\r\n],\r\nfunction(declare, kernel, fx, domAttr, domClass, template, FormWidget, Templated){\r\nkernel.experimental(\"dojox.form.FileInput\");\r\n\r\nreturn declare(\"dojox.form.FileInput\", FormWidget,\r\n\t{\r\n\t// summary:\r\n\t//\t\tA styled input type=\"file\"\r\n\t//\r\n\t// description:\r\n\t//\t\tA input type=\"file\" form widget, with a button for uploading to be styled via css,\r\n\t//\t\ta cancel button to clear selection, and FormWidget mixin to provide standard dijit.form.Form\r\n\t//\t\tsupport (FIXME: maybe not fully implemented)\r\n\r\n\t// label: String\r\n\t//\t\tthe title text of the \"Browse\" button\r\n\tlabel: \"Browse ...\",\r\n\r\n\t// cancelText: String\r\n\t//\t\tthe title of the \"Cancel\" button\r\n\tcancelText: \"Cancel\",\r\n\r\n\t// name: String\r\n\t//\t\tugh, this should be pulled from this.domNode\r\n\tname: \"uploadFile\",\r\n\r\n\ttemplateString: template,\r\n\r\n\tstartup: function(){\r\n\t\t// summary:\r\n\t\t//\t\tlisten for changes on our real file input\r\n\t\tthis._listener = this.connect(this.fileInput,\"onchange\",\"_matchValue\");\r\n\t\tthis._keyListener = this.connect(this.fileInput,\"onkeyup\",\"_matchValue\");\r\n\t},\r\n\r\n\t//get rid of the this.connect in _FormWidget.postCreate to allow IE to show\r\n\t//the file picker dialog properly\r\n\tpostCreate: function(){},\r\n\r\n\t_matchValue: function(){\r\n\t\t// summary:\r\n\t\t//\t\tset the content of the upper input based on the semi-hidden file input\r\n\t\tthis.inputNode.value = this.fileInput.value;\r\n\t\tif(this.inputNode.value){\r\n\t\t\tthis.cancelNode.style.visibility = \"visible\";\r\n\t\t\tfx.fadeIn({ node: this.cancelNode, duration:275 }).play();\r\n\t\t}\r\n\t},\r\n\r\n\tsetLabel: function(/*String*/ label, /*String?*/ cssClass){\r\n\t\t// summary:\r\n\t\t//\t\tmethod to allow use to change button label\r\n\t\tthis.titleNode.innerHTML = label;\r\n\t},\r\n\r\n\treset: function(/*Event*/ e){\r\n\t\t// summary:\r\n\t\t//\t\ton click of cancel button, since we can't clear the input because of\r\n\t\t//\t\tsecurity reasons, we destroy it, and add a new one in it's place.\r\n\t\tthis.disconnect(this._listener);\r\n\t\tthis.disconnect(this._keyListener);\r\n\t\tif(this.fileInput){\r\n\t\t\tthis.domNode.removeChild(this.fileInput);\r\n\t\t}\r\n\t\tfx.fadeOut({ node: this.cancelNode, duration:275 }).play();\r\n\r\n\t\t// should we use cloneNode()? can we?\r\n\t\tthis.fileInput = document.createElement('input');\r\n\t\t// domAttr.set(this.fileInput,{\r\n\t\t//\t\t\"type\":\"file\", \"id\":this.id, \"name\": this.name\r\n\t\t//});\r\n\t\tthis.fileInput.setAttribute(\"type\",\"file\");\r\n\t\tthis.fileInput.setAttribute(\"id\", this.id);\r\n\t\tthis.fileInput.setAttribute(\"name\", this.name);\r\n\t\tdomClass.add(this.fileInput,\"dijitFileInputReal\");\r\n\t\tthis.domNode.appendChild(this.fileInput);\r\n\r\n\t\tthis._keyListener = this.connect(this.fileInput, \"onkeyup\", \"_matchValue\");\r\n\t\tthis._listener = this.connect(this.fileInput, \"onchange\", \"_matchValue\");\r\n\t\tthis.inputNode.value = \"\";\r\n\t}\r\n\r\n});\r\n\r\n});\r\n"]}