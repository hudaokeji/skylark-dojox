{"version":3,"sources":["form/BusyButton.js"],"names":["define","lang","domAttr","domClass","Button","DropDownButton","ComboButton","i18n","nlsLoading","declare","_BusyButtonMixin","isBusy","busyLabel","timeout","useIcon","postMixInProperties","this","inherited","arguments","getLocalization","loadingState","postCreate","_label","containerNode","innerHTML","_initTimeout","makeBusy","_disableHandle","remove","defer","set","setLabel","cancel","_timeout","clearTimeout","resetTimeout","setTimeout","hitch","undefined","content","label","firstChild","removeChild","appendChild","document","createTextNode","showLabel","get","domNode","titleNode","title","trim","innerText","textContent","node","Image","src","_blankGif","id","add","_onClick","e","BusyButton"],"mappings":";;;;;;;AAAAA,QACC,kBACA,gBACA,iBACA,oBACA,4BACA,yBACA,YACA,8BACA,sBACE,SAASC,EAAMC,EAASC,EAAUC,EAAQC,EAAgBC,EAAaC,EAAMC,EAAYC,GAE5F,IAAIC,EAAmBD,EAAQ,8BAA+B,MAG7DE,QAAQ,EAIRC,UAAW,GAEXC,QAAS,KAITC,SAAS,EAETC,oBAAqB,WACpBC,KAAKC,UAAUC,WACXF,KAAKJ,YACRI,KAAKJ,UAAYL,EAAKY,gBAAgB,QAAS,UAAWH,KAAKf,MAAMmB,eAIvEC,WAAY,WAGXL,KAAKC,UAAUC,WACfF,KAAKM,OAASN,KAAKO,cAAcC,UACjCR,KAAKS,aAAeT,KAAKH,QAGtBG,KAAKL,QACPK,KAAKU,YAIPA,SAAU,WAGTV,KAAKL,QAAS,EAIXK,KAAKW,gBACPX,KAAKW,eAAeC,SAErBZ,KAAKW,eAAiBX,KAAKa,MAAM,WAChCb,KAAKc,IAAI,YAAY,KAGtBd,KAAKe,SAASf,KAAKJ,UAAWI,KAAKH,UAGpCmB,OAAQ,WAIJhB,KAAKW,gBACPX,KAAKW,eAAeC,SAErBZ,KAAKc,IAAI,YAAY,GACrBd,KAAKL,QAAS,EACdK,KAAKe,SAASf,KAAKM,QAChBN,KAAKiB,UAAWC,aAAalB,KAAKiB,UACrCjB,KAAKH,QAAUG,KAAKS,cAGrBU,aAAc,SAAiBtB,GAG3BG,KAAKiB,UACPC,aAAalB,KAAKiB,UAIhBpB,EACFG,KAAKiB,SAAWG,WAAWnC,EAAKoC,MAAMrB,KAAM,WAC3CA,KAAKgB,WACFnB,QACeyB,GAAXzB,GAAoC,IAAZA,GAChCG,KAAKgB,UAIPD,SAAU,SAAoBQ,EAAiB1B,GAS9C,IAFAG,KAAKwB,MAAQD,EAEPvB,KAAKO,cAAckB,YACxBzB,KAAKO,cAAcmB,YAAY1B,KAAKO,cAAckB,YAiBnD,GAfAzB,KAAKO,cAAcoB,YAAYC,SAASC,eAAe7B,KAAKwB,QAEvC,GAAlBxB,KAAK8B,WAAuB5C,EAAQ6C,IAAI/B,KAAKgC,QAAS,WACxDhC,KAAKiC,UAAUC,MAAMjD,EAAKkD,KAAKnC,KAAKO,cAAc6B,WAAapC,KAAKO,cAAc8B,aAAe,KAK/FxC,EACFG,KAAKmB,aAAatB,GAElBG,KAAKH,QAAU,KAIbG,KAAKF,SAAWE,KAAKL,OAAO,CAC9B,IAAI2C,EAAO,IAAIC,MACfD,EAAKE,IAAMxC,KAAKyC,UAChBvD,EAAQ4B,IAAIwB,EAAM,KAAMtC,KAAK0C,GAAG,SAChCvD,EAASwD,IAAIL,EAAM,uBACnBtC,KAAKO,cAAcoB,YAAYW,KAIjCM,SAAU,SAASC,GAKd7C,KAAKL,SACRK,KAAKC,UAAUC,WACfF,KAAKU,eAKJoC,EAAarD,EAAQ,yBAA0BL,EAAQM,OAY3D,OAFAD,EAAQ,8BAA+BH,EAAaI,OACpDD,EAAQ,iCAAkCJ,EAAgBK,OACnDoD","file":"../../form/BusyButton.js","sourcesContent":["define([\r\n\t\"dojo/_base/lang\",\r\n\t\"dojo/dom-attr\",\r\n\t\"dojo/dom-class\",\r\n\t\"dijit/form/Button\",\r\n\t\"dijit/form/DropDownButton\",\r\n\t\"dijit/form/ComboButton\",\r\n\t\"dojo/i18n\",\r\n\t\"dojo/i18n!dijit/nls/loading\",\r\n\t\"dojo/_base/declare\"\r\n], function(lang, domAttr, domClass, Button, DropDownButton, ComboButton, i18n, nlsLoading, declare){\r\n\r\nvar _BusyButtonMixin = declare(\"dojox.form._BusyButtonMixin\", null, {\r\n\r\n\t// isBusy: Boolean\r\n\tisBusy: false,\r\n\r\n\t// busyLabel: String\r\n\t//\t\ttext while button is busy\r\n\tbusyLabel: \"\",\r\n\r\n\ttimeout: null, // timeout, should be controlled by xhr call\r\n\r\n\t// useIcon: Boolean\r\n\t//\t\tuse a busy icon\r\n\tuseIcon: true,\r\n\r\n\tpostMixInProperties: function(){\r\n\t\tthis.inherited(arguments);\r\n\t\tif(!this.busyLabel){\r\n\t\t\tthis.busyLabel = i18n.getLocalization(\"dijit\", \"loading\", this.lang).loadingState;\r\n\t\t}\r\n\t},\r\n\r\n\tpostCreate: function(){\r\n\t\t// summary:\r\n\t\t//\t\tstores initial label and timeout for reference\r\n\t\tthis.inherited(arguments);\r\n\t\tthis._label = this.containerNode.innerHTML;\r\n\t\tthis._initTimeout = this.timeout;\r\n\r\n\t\t// for initial busy buttons\r\n\t\tif(this.isBusy){\r\n\t\t\tthis.makeBusy();\r\n\t\t}\r\n\t},\r\n\r\n\tmakeBusy: function(){\r\n\t\t// summary:\r\n\t\t//\t\tsets state from idle to busy\r\n\t\tthis.isBusy = true;\r\n\r\n\t\t// Webkit does not submit the form if the submit button is disabled when\r\n\t\t// clicked ( https://bugs.webkit.org/show_bug.cgi?id=14443 ), so disable the button later\r\n\t\tif(this._disableHandle) {\r\n\t\t\tthis._disableHandle.remove();\r\n\t\t}\r\n\t\tthis._disableHandle = this.defer(function() {\r\n\t\t\tthis.set(\"disabled\", true);\r\n\t\t});\r\n\r\n\t\tthis.setLabel(this.busyLabel, this.timeout);\r\n\t},\r\n\r\n\tcancel: function(){\r\n\t\t// summary:\r\n\t\t//\t\tif no timeout is set or for other reason the user can put the button back\r\n\t\t//\t\tto being idle\r\n\t\tif(this._disableHandle) {\r\n\t\t\tthis._disableHandle.remove();\r\n\t\t}\r\n\t\tthis.set(\"disabled\", false);\r\n\t\tthis.isBusy = false;\r\n\t\tthis.setLabel(this._label);\r\n\t\tif(this._timeout){\tclearTimeout(this._timeout); }\r\n\t\tthis.timeout = this._initTimeout;\r\n\t},\r\n\r\n\tresetTimeout: function(/*Int*/ timeout){\r\n\t\t// summary:\r\n\t\t//\t\tto reset existing timeout and setting a new timeout\r\n\t\tif(this._timeout){\r\n\t\t\tclearTimeout(this._timeout);\r\n\t\t}\r\n\r\n\t\t// new timeout\r\n\t\tif(timeout){\r\n\t\t\tthis._timeout = setTimeout(lang.hitch(this, function(){\r\n\t\t\t\tthis.cancel();\r\n\t\t\t}), timeout);\r\n\t\t}else if(timeout == undefined || timeout === 0){\r\n\t\t\tthis.cancel();\r\n\t\t}\r\n\t},\r\n\r\n\tsetLabel: function(/*String*/ content, /*Int*/ timeout){\r\n\t\t// summary:\r\n\t\t//\t\tsetting a label and optional timeout of the labels state\r\n\r\n\t\t// this.inherited(arguments); FIXME: throws an Unknown runtime error\r\n\r\n\t\t// Begin IE hack\r\n\t\tthis.label = content;\r\n\t\t// remove children\r\n\t\twhile(this.containerNode.firstChild){\r\n\t\t\tthis.containerNode.removeChild(this.containerNode.firstChild);\r\n\t\t}\r\n\t\tthis.containerNode.appendChild(document.createTextNode(this.label));\r\n\r\n\t\tif(this.showLabel == false && !domAttr.get(this.domNode, \"title\")){\r\n\t\t\tthis.titleNode.title=lang.trim(this.containerNode.innerText || this.containerNode.textContent || '');\r\n\t\t}\r\n\t\t// End IE hack\r\n\r\n\t\t// setting timeout\r\n\t\tif(timeout){\r\n\t\t\tthis.resetTimeout(timeout);\r\n\t\t}else{\r\n\t\t\tthis.timeout = null;\r\n\t\t}\r\n\r\n\t\t// create optional busy image\r\n\t\tif(this.useIcon && this.isBusy){\r\n\t\t\tvar node = new Image();\r\n\t\t\tnode.src = this._blankGif;\r\n\t\t\tdomAttr.set(node, \"id\", this.id+\"_icon\");\r\n\t\t\tdomClass.add(node, \"dojoxBusyButtonIcon\");\r\n\t\t\tthis.containerNode.appendChild(node);\r\n\t\t}\r\n\t},\r\n\r\n\t_onClick: function(e){\r\n\t\t// summary:\r\n\t\t//\t\ton button click the button state gets changed\r\n\r\n\t\t// only do something if button is not busy\r\n\t\tif(!this.isBusy){\r\n\t\t\tthis.inherited(arguments);\t// calls onClick()\r\n\t\t\tthis.makeBusy();\r\n\t\t}\r\n\t}\r\n});\r\n\r\nvar BusyButton = declare(\"dojox.form.BusyButton\", [Button, _BusyButtonMixin], {\r\n\t// summary:\r\n\t//\t\tBusyButton is a simple widget which provides implementing more\r\n\t//\t\tuser friendly form submission.\r\n\t// description:\r\n\t//\t\tWhen a form gets submitted by a user, many times it is recommended to disable\r\n\t//\t\tthe submit buttons to prevent double submission. BusyButton provides a simple set\r\n\t//\t\tof features for this purpose\r\n\r\n});\r\ndeclare(\"dojox.form.BusyComboButton\", [ComboButton, _BusyButtonMixin], {});\r\ndeclare(\"dojox.form.BusyDropDownButton\", [DropDownButton, _BusyButtonMixin], {});\r\nreturn BusyButton;\r\n});\r\n"]}