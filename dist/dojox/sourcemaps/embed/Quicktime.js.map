{"version":3,"sources":["embed/Quicktime.js"],"names":["define","dojo","lang","has","windowUtil","domUtil","domConstruct","qtMarkup","installed","qtVersion","major","minor","rev","__def__","width","height","redirect","keyBase","keyCount","getQTMarkup","getObject","prep","kwArgs","mixin","clone","testing","path","id","console","error","o","ActiveXObject","undefined","v","QuickTimeVersion","toString","p","i","substring","IsQuickTimeAvailable","e","markup","s","params","navigator","plugins","l","length","name","indexOf","Quicktime","node","place","minSupported","available","supported","version","initialized","onInitialize","byId","create","body","innerHTML","dom","document","setTimeout","c","style","top","left","overflow","position","getVer","qt","n","GetQuickTimeVersion","split","parseInt","destroy","setObject"],"mappings":"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","file":"../../embed/Quicktime.js","sourcesContent":["define([\r\n\t\"dojo/_base/kernel\",\r\n\t\"dojo/_base/lang\",\r\n\t\"dojo/_base/sniff\",\r\n\t\"dojo/_base/window\",\r\n\t\"dojo/dom\",\r\n\t\"dojo/dom-construct\",\r\n\t\"dojo/domReady!\" // fixes doc.readyState in Fx<=3.5\r\n], function (dojo, lang, has, windowUtil, domUtil, domConstruct) {\r\n\t// module:\r\n\t//\t\tdojox/embed/Quicktime\r\n\t// summary:\r\n\t//\t\tBase functionality to insert a QuickTime movie\r\n\t//\t\tinto a document on the fly.\r\n\r\n\tvar qtMarkup,\r\n\t\tqtVersion = { major: 0, minor: 0, rev: 0 },\r\n\t\tinstalled,\r\n\t\t__def__ = {\r\n\t\t\twidth: 320,\r\n\t\t\theight: 240,\r\n\t\t\tredirect: null\r\n\t\t},\r\n\t\tkeyBase = \"dojox-embed-quicktime-\",\r\n\t\tkeyCount = 0,\r\n\t\tgetQTMarkup = 'This content requires the <a href=\"http://www.apple.com/quicktime/download/\" title=\"Download and install QuickTime.\">QuickTime plugin</a>.',\r\n\t\tembed = dojo.getObject(\"dojox.embed\", true);\r\n\r\n\t//\t*** private methods *********************************************************\r\n\tfunction prep(kwArgs){\r\n\t\tkwArgs = dojo.mixin(lang.clone(__def__), kwArgs || {});\r\n\t\tif(!(\"path\" in kwArgs) && !kwArgs.testing){\r\n\t\t\tconsole.error(\"dojox.embed.Quicktime(ctor):: no path reference to a QuickTime movie was provided.\");\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tif(kwArgs.testing){\r\n\t\t\tkwArgs.path = \"\";\r\n\t\t}\r\n\t\tif(!(\"id\" in kwArgs)){\r\n\t\t\tkwArgs.id = keyBase + keyCount++;\r\n\t\t}\r\n\t\treturn kwArgs;\r\n\t}\r\n\r\n\tif(has(\"ie\")){\r\n\t\tinstalled = (function(){\r\n\t\t\ttry{\r\n\t\t\t\tvar o = new ActiveXObject(\"QuickTimeCheckObject.QuickTimeCheck.1\");\r\n\t\t\t\tif(o!==undefined){\r\n\t\t\t\t\t//\tpull the qt version too\r\n\t\t\t\t\tvar v = o.QuickTimeVersion.toString(16);\r\n\t\t\t\t\tfunction p(i){ return (v.substring(i, i+1)-0) || 0; }\r\n\t\t\t\t\tqtVersion = {\r\n\t\t\t\t\t\tmajor: p(0),\r\n\t\t\t\t\t\tminor: p(1),\r\n\t\t\t\t\t\trev: p(2)\r\n\t\t\t\t\t};\r\n\t\t\t\t\treturn o.IsQuickTimeAvailable(0);\r\n\t\t\t\t}\r\n\t\t\t} catch(e){ }\r\n\t\t\treturn false;\r\n\t\t})();\r\n\r\n\t\tqtMarkup = function(kwArgs){\r\n\t\t\tif(!installed){ return { id: null, markup: getQTMarkup }; }\r\n\t\t\t\r\n\t\t\tkwArgs = prep(kwArgs);\r\n\t\t\tif(!kwArgs){ return null; }\r\n\t\t\tvar s = '<object classid=\"clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B\" '\r\n\t\t\t\t+ 'codebase=\"http://www.apple.com/qtactivex/qtplugin.cab#version=6,0,2,0\" '\r\n\t\t\t\t+ 'id=\"' + kwArgs.id + '\" '\r\n\t\t\t\t+ 'width=\"' + kwArgs.width + '\" '\r\n\t\t\t\t+ 'height=\"' + kwArgs.height + '\">'\r\n\t\t\t\t+ '<param name=\"src\" value=\"' + kwArgs.path + '\"/>';\r\n\t\t\tfor(var p in kwArgs.params||{}){\r\n\t\t\t\ts += '<param name=\"' + p + '\" value=\"' + kwArgs.params[p] + '\"/>';\r\n\t\t\t}\r\n\t\t\ts += '</object>';\r\n\t\t\treturn { id: kwArgs.id, markup: s };\r\n\t\t}\r\n\t} else {\r\n\t\tinstalled = (function(){\r\n\t\t\tfor(var i=0, p=navigator.plugins, l=p.length; i<l; i++){\r\n\t\t\t\tif(p[i].name.indexOf(\"QuickTime\")>-1){\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t})();\r\n\r\n\t\tqtMarkup = function(kwArgs){\r\n\t\t\tif(!installed){ return { id: null, markup: getQTMarkup }; }\r\n\r\n\t\t\tkwArgs = prep(kwArgs);\r\n\t\t\tif(!kwArgs){ return null; }\r\n\t\t\tvar s = '<embed type=\"video/quicktime\" src=\"' + kwArgs.path + '\" '\r\n\t\t\t\t+ 'id=\"' + kwArgs.id + '\" '\r\n\t\t\t\t+ 'name=\"' + kwArgs.id + '\" '\r\n\t\t\t\t+ 'pluginspage=\"www.apple.com/quicktime/download\" '\r\n\t\t\t\t+ 'enablejavascript=\"true\" '\r\n\t\t\t\t+ 'width=\"' + kwArgs.width + '\" '\r\n\t\t\t\t+ 'height=\"' + kwArgs.height + '\"';\r\n\t\t\tfor(var p in kwArgs.params||{}){\r\n\t\t\t\ts += ' ' + p + '=\"' + kwArgs.params[p] + '\"';\r\n\t\t\t}\r\n\t\t\ts += '></embed>';\r\n\t\t\treturn { id: kwArgs.id, markup: s };\r\n\t\t}\r\n\t}\r\n\r\n\t/*=====\r\n\tvar __QTArgs = {\r\n\t\t// path: String\r\n\t\t//\t\tThe URL of the movie to embed.\r\n\t\t// id: String?\r\n\t\t//\t\tA unique key that will be used as the id of the created markup.  If you don't\r\n\t\t//\t\tprovide this, a unique key will be generated.\r\n\t\t// width: Number?\r\n\t\t//\t\tThe width of the embedded movie; the default value is 320px.\r\n\t\t// height: Number?\r\n\t\t//\t\tThe height of the embedded movie; the default value is 240px\r\n\t\t// params: Object?\r\n\t\t//\t\tA set of key/value pairs that you want to define in the resultant markup.\r\n\t\t// redirect: String?\r\n\t\t//\t\tA url to redirect the browser to if the current QuickTime version is not supported.\r\n\t};\r\n\t=====*/\r\n\r\n\tvar Quicktime=function(/* __QTArgs */kwArgs, /* DOMNode */node){\r\n\t\t// summary:\r\n\t\t//\t\tReturns a reference to the HTMLObject/HTMLEmbed that is created to\r\n\t\t//\t\tplace the movie in the document.  You can use this either with or\r\n\t\t//\t\twithout the new operator.  Note that with any other DOM manipulation,\r\n\t\t//\t\tyou must wait until the document is finished loading before trying\r\n\t\t//\t\tto use this.\r\n\t\t//\r\n\t\t// example:\r\n\t\t//\t\tEmbed a QuickTime movie in a document using the new operator, and get a reference to it.\r\n\t\t//\t|\tvar movie = new dojox.embed.Quicktime({\r\n\t\t//\t|\t\tpath: \"path/to/my/movie.mov\",\r\n\t\t//\t|\t\twidth: 400,\r\n\t\t//\t|\t\theight: 300\r\n\t\t//\t|\t}, myWrapperNode);\r\n\t\t//\r\n\t\t// example:\r\n\t\t//\t\tEmbed a movie in a document without using the new operator.\r\n\t\t//\t|\tvar movie = dojox.embed.Quicktime({\r\n\t\t//\t|\t\tpath: \"path/to/my/movie.mov\",\r\n\t\t//\t|\t\twidth: 400,\r\n\t\t//\t|\t\theight: 300\r\n\t\t//\t|\t}, myWrapperNode);\r\n\r\n\t\treturn Quicktime.place(kwArgs, node);\t//\tHTMLObject\r\n\t};\r\n\r\n\tdojo.mixin(Quicktime, {\r\n\t\t// summary:\r\n\t\t//\t\tA singleton object used internally to get information\r\n\t\t//\t\tabout the QuickTime player available in a browser, and\r\n\t\t//\t\tas the factory for generating and placing markup in a\r\n\t\t//\t\tdocument.\r\n\t\t//\r\n\t\t// minSupported: Number\r\n\t\t//\t\tThe minimum supported version of the QuickTime Player, defaults to\r\n\t\t//\t\t6.\r\n\t\t// available: Boolean\r\n\t\t//\t\tWhether or not QuickTime is available.\r\n\t\t// supported: Boolean\r\n\t\t//\t\tWhether or not the QuickTime Player installed is supported by\r\n\t\t//\t\tdojox.embed.\r\n\t\t// version: Object\r\n\t\t//\t\tThe version of the installed QuickTime Player; takes the form of\r\n\t\t//\t\t{ major, minor, rev }.  To get the major version, you'd do this:\r\n\t\t//\t\tvar v=dojox.embed.Quicktime.version.major;\r\n\t\t// initialized: Boolean\r\n\t\t//\t\tWhether or not the QuickTime engine is available for use.\r\n\t\t// onInitialize: Function\r\n\t\t//\t\tA stub you can connect to if you are looking to fire code when the\r\n\t\t//\t\tengine becomes available.  A note: do NOT use this stub to embed\r\n\t\t//\t\ta movie in your document; this WILL be fired before DOMContentLoaded\r\n\t\t//\t\tis fired, and you will get an error.  You should use dojo.addOnLoad\r\n\t\t//\t\tto place your movie instead.\r\n\r\n\t\tminSupported: 6,\r\n\t\tavailable: installed,\r\n\t\tsupported: installed,\r\n\t\tversion: qtVersion,\r\n\t\tinitialized: false,\r\n\t\tonInitialize: function(){\r\n\t\t\tQuicktime.initialized = true;\r\n\t\t},\t//\tstub function to let you know when this is ready\r\n\r\n\t\tplace: function(kwArgs, node){\r\n\t\t\tvar o = qtMarkup(kwArgs);\r\n\r\n\t\t\tif(!(node = domUtil.byId(node))){\r\n\t\t\t\tnode=domConstruct.create(\"div\", { id:o.id+\"-container\" }, windowUtil.body());\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(o){\r\n\t\t\t\tnode.innerHTML = o.markup;\r\n\t\t\t\tif(o.id){\r\n\t\t\t\t\treturn has(\"ie\") ? dom.byId(o.id) : document[o.id];\t//\tQuickTimeObject\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn null;\t//\tQuickTimeObject\r\n\t\t}\r\n\t});\r\n\r\n\t//\tgo get the info\r\n\tif(!has(\"ie\")){\r\n\t\tvar id = \"-qt-version-test\",\r\n\t\t\to = qtMarkup({ testing:true , width:4, height:4 }),\r\n\t\t\tc = 10, // counter to prevent infinite looping\r\n\t\t\ttop = \"-1000px\",\r\n\t\t\twidthHeight = \"1px\";\r\n\r\n\t\tfunction getVer(){\r\n\t\t\tsetTimeout(function(){\r\n\t\t\t\tvar qt = document[o.id],\r\n\t\t\t\t\tn = domUtil.byId(id);\r\n\r\n\t\t\t\tif(qt){\r\n\t\t\t\t\ttry{\r\n\t\t\t\t\t\tvar v = qt.GetQuickTimeVersion().split(\".\");\r\n\t\t\t\t\t\tQuicktime.version = { major: parseInt(v[0]||0), minor: parseInt(v[1]||0), rev: parseInt(v[2]||0) };\r\n\t\t\t\t\t\tif((Quicktime.supported = v[0])){\r\n\t\t\t\t\t\t\tQuicktime.onInitialize();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tc = 0;\r\n\t\t\t\t\t} catch(e){\r\n\t\t\t\t\t\tif(c--){\r\n\t\t\t\t\t\t\tgetVer();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(!c && n){ domConstruct.destroy(n); }\r\n\t\t\t}, 20);\r\n\t\t}\r\n\r\n\t\tdomConstruct.create(\"div\", {\r\n\t\t\tinnerHTML: o.markup,\r\n\t\t\tid: id,\r\n\t\t\tstyle: { top:top, left:0, width:widthHeight, height:widthHeight, overflow:\"hidden\", position:\"absolute\" }\r\n\t\t}, windowUtil.body());\r\n\t\tgetVer();\r\n\t}else if(has(\"ie\") && installed){\r\n\t\t// we already know if IE has QuickTime installed, but we need this to seem like a callback.\r\n\t\tsetTimeout(function(){\r\n\t\t\tQuicktime.onInitialize();\r\n\t\t}, 10);\r\n\t}\r\n\r\n\tlang.setObject(\"dojox.embed.Quicktime\", Quicktime);\r\n\r\n\treturn Quicktime;\r\n});\r\n"]}