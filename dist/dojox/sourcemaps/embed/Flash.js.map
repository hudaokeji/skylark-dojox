{"version":3,"sources":["embed/Flash.js"],"names":["define","lang","unload","array","query","has","dom","on","win","stringUtil","fMarkup","fVersion","minimumVersion","keyBase","keyCount","_baseKwArgs","expressInstall","width","height","swLiveConnect","allowScriptAccess","allowNetworking","style","redirect","prep","kwArgs","delegate","id","console","error","p","path","vars","a","push","encodeURIComponent","params","FlashVars","join","s","escape","String","markup","testVersion","testObj","ActiveXObject","e","v","GetVariable","split","major","parseInt","minor","rev","addOnWindowUnload","warn","dummy","reverse","forEach","i","flashVars","window","location","protocol","plugin","navigator","plugins","description","replace","Flash","node","href","toLowerCase","indexOf","Error","this","available","movie","domNode","byId","setTimeout","hitch","init","onError","extend","onReady","onLoad","msg","_onload","clearInterval","_poller","_pollCount","_pollMax","destroy","pollTime","initialized","place","doc","setInterval","PercentLoaded","_destroy","removeChild","test","movieName","document","embeds","mixin","minSupported","supported","required","minimumRequired","version","onInitialize","__ie_markup__","proxy","obj","methods","Array","item","eval","CallFunction","map","arguments","__flash__toXML","apply","o","createElement","body","appendChild","innerHTML","setObject"],"mappings":"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","file":"../../embed/Flash.js","sourcesContent":["define([\r\n\t\"dojo/_base/lang\",\r\n\t\"dojo/_base/unload\",\r\n\t\"dojo/_base/array\",\r\n\t\"dojo/query\",\r\n\t\"dojo/has\",\r\n\t\"dojo/dom\",\r\n\t\"dojo/on\",\r\n\t\"dojo/window\",\r\n\t\"dojo/string\"\r\n], function(lang,unload,array,query,has,dom,on,win,stringUtil) {\r\n\r\n\t// module:\r\n\t//\t\tdojox/embed/Flash\r\n\t// summary:\r\n\t//\t\tBase functionality to insert a flash movie into\r\n\t//\t\ta document on the fly.\r\n\t// example:\r\n\t//\t|\tvar movie=new Flash({ args }, containerNode);\r\n\r\n\r\n\tvar fMarkup, fVersion;\r\n\tvar minimumVersion = 9; // anything below this will throw an error (may overwrite)\r\n\tvar keyBase = \"dojox-embed-flash-\", keyCount=0;\r\n\tvar _baseKwArgs = {\r\n\t\texpressInstall: false,\r\n\t\twidth: 320,\r\n\t\theight: 240,\r\n\t\tswLiveConnect: \"true\",\r\n\t\tallowScriptAccess: \"sameDomain\",\r\n\t\tallowNetworking:\"all\",\r\n\t\tstyle: null,\r\n\t\tredirect: null\r\n\t};\r\n\r\n\tfunction prep(kwArgs){\r\n\t\tkwArgs = lang.delegate(_baseKwArgs, kwArgs);\r\n\r\n\t\tif(!(\"path\" in kwArgs)){\r\n\t\t\tconsole.error(\"dojox.embed.Flash(ctor):: no path reference to a Flash movie was provided.\");\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tif(!(\"id\" in kwArgs)){\r\n\t\t\tkwArgs.id = (keyBase + keyCount++);\r\n\t\t}\r\n\t\treturn kwArgs;\r\n\t}\r\n\r\n\tif(has('ie')) {\r\n\t\tfMarkup = function(kwArgs){\r\n\t\t\tkwArgs = prep(kwArgs);\r\n\t\t\tif(!kwArgs){ return null; }\r\n\r\n\t\t\tvar p;\r\n\t\t\tvar path = kwArgs.path;\r\n\t\t\tif(kwArgs.vars){\r\n\t\t\t\tvar a = [];\r\n\t\t\t\tfor(p in kwArgs.vars){\r\n\t\t\t\t\ta.push(encodeURIComponent(p) + '=' + encodeURIComponent(kwArgs.vars[p]));\r\n\t\t\t\t}\r\n\t\t\t\tkwArgs.params.FlashVars = a.join(\"&\");\r\n\t\t\t\tdelete kwArgs.vars;\r\n\t\t\t}\r\n\t\t\tvar s = '<object id=\"' + stringUtil.escape(String(kwArgs.id)) + '\" '\r\n\t\t\t\t+ 'classid=\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\" '\r\n\t\t\t\t+ 'width=\"' + stringUtil.escape(String(kwArgs.width)) + '\" '\r\n\t\t\t\t+ 'height=\"' + stringUtil.escape(String(kwArgs.height)) + '\"'\r\n\t\t\t\t+ ((kwArgs.style)?' style=\"' + stringUtil.escape(String(kwArgs.style)) + '\"':'')\r\n\t\t\t\t+ '>'\r\n\t\t\t\t+ '<param name=\"movie\" value=\"' + stringUtil.escape(String(path)) + '\" />';\r\n\t\t\tif(kwArgs.params){\r\n\t\t\t\tfor(p in kwArgs.params){\r\n\t\t\t\t\ts += '<param name=\"' + stringUtil.escape(p) + '\" value=\"' + stringUtil.escape(String(kwArgs.params[p])) + '\" />';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\ts += '</object>';\r\n\t\t\treturn { id: kwArgs.id, markup: s };\r\n\t\t};\r\n\r\n\t\tfVersion = (function(){\r\n\t\t\tvar testVersion = 10, testObj = null;\r\n\t\t\twhile(!testObj && testVersion > 7){\r\n\t\t\t\ttry {\r\n\t\t\t\t\ttestObj = new ActiveXObject(\"ShockwaveFlash.ShockwaveFlash.\" + testVersion--);\r\n\t\t\t\t}catch(e){ }\r\n\t\t\t}\r\n\t\t\tif(testObj){\r\n\t\t\t\tvar v = testObj.GetVariable(\"$version\").split(\" \")[1].split(\",\");\r\n\t\t\t\treturn {\r\n\t\t\t\t\tmajor: (v[0]!=null) ? parseInt(v[0]) : 0,\r\n\t\t\t\t\tminor: (v[1]!=null) ? parseInt(v[1]) : 0,\r\n\t\t\t\t\trev: (v[2]!=null) ? parseInt(v[2]) : 0\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\treturn { major: 0, minor: 0, rev: 0 };\r\n\t\t})();\r\n\r\n\t\t//\tattach some cleanup for IE, thanks to deconcept :)\r\n\t\tunload.addOnWindowUnload(function(){\r\n\t\t\tconsole.warn('***************UNLOAD');\r\n\t\t\tvar dummy = function(){};\r\n\t\t\tvar objs = query(\"object\").\r\n\t\t\t\treverse().\r\n\t\t\t\tstyle(\"display\", \"none\").\r\n\t\t\t\tforEach(function(i){\r\n\t\t\t\t\tfor(var p in i){\r\n\t\t\t\t\t\tif((p != \"FlashVars\") && typeof i[p] == \"function\"){\r\n\t\t\t\t\t\t\ttry{\r\n\t\t\t\t\t\t\t\ti[p] = dummy;\r\n\t\t\t\t\t\t\t}catch(e){}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t});\r\n\r\n\t} else {\r\n\t\t//\t*** Sane browsers branch ******************************************************************\r\n\t\tfMarkup = function(kwArgs){\r\n\t\t\tkwArgs = prep(kwArgs);\r\n\t\t\tif(!kwArgs){ return null; }\r\n\r\n\t\t\tvar p;\r\n\t\t\tvar path = kwArgs.path;\r\n\t\t\tif(kwArgs.vars){\r\n\t\t\t\tvar a = [];\r\n\t\t\t\tfor(p in kwArgs.vars){\r\n\t\t\t\t\ta.push(encodeURIComponent(p) + '=' + encodeURIComponent(kwArgs.vars[p]));\r\n\t\t\t\t}\r\n\t\t\t\tkwArgs.params.flashVars = a.join(\"&\");\r\n\t\t\t\tdelete kwArgs.vars;\r\n\t\t\t}\r\n\t\t\tvar s = '<embed type=\"application/x-shockwave-flash\" '\r\n\t\t\t\t+ 'src=\"' + stringUtil.escape(String(path)) + '\" '\r\n\t\t\t\t+ 'id=\"' + stringUtil.escape(String(kwArgs.id)) + '\" '\r\n\t\t\t\t+ 'width=\"' + stringUtil.escape(String(kwArgs.width)) + '\" '\r\n\t\t\t\t+ 'height=\"' + stringUtil.escape(String(kwArgs.height)) + '\"'\r\n\t\t\t\t+ ((kwArgs.style)?' style=\"' + stringUtil.escape(String(kwArgs.style)) + '\" ':'')\r\n\r\n\t\t\t\t+ 'pluginspage=\"' + window.location.protocol + '//www.adobe.com/go/getflashplayer\" ';\r\n\t\t\tif(kwArgs.params){\r\n\t\t\t\tfor(p in kwArgs.params){\r\n\t\t\t\t\ts += ' ' + stringUtil.escape(p) + '=\"' + stringUtil.escape(String(kwArgs.params[p])) + '\"';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\ts += ' />';\r\n\t\t\treturn { id: kwArgs.id, markup: s };\r\n\t\t};\r\n\r\n\t\tfVersion=(function(){\r\n\t\t\tvar plugin = navigator.plugins[\"Shockwave Flash\"];\r\n\t\t\tif(plugin && plugin.description){\r\n\t\t\t\tvar v = plugin.description.replace(/([a-zA-Z]|\\s)+/, \"\").replace(/(\\s+r|\\s+b[0-9]+)/, \".\").split(\".\");\r\n\t\t\t\treturn {\r\n\t\t\t\t\tmajor: (v[0]!=null) ? parseInt(v[0]) : 0,\r\n\t\t\t\t\tminor: (v[1]!=null) ? parseInt(v[1]) : 0,\r\n\t\t\t\t\trev: (v[2]!=null) ? parseInt(v[2]) : 0\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\treturn { major: 0, minor: 0, rev: 0 };\r\n\t\t})();\r\n\t}\r\n\r\n\r\n/*=====\r\nvar __flashArgs = {\r\n\t// path: String\r\n\t//\t\tThe URL of the movie to embed.\r\n\t// id: String?\r\n\t//\t\tA unique key that will be used as the id of the created markup.  If you don't\r\n\t//\t\tprovide this, a unique key will be generated.\r\n\t// width: Number?\r\n\t//\t\tThe width of the embedded movie; the default value is 320px.\r\n\t// height: Number?\r\n\t//\t\tThe height of the embedded movie; the default value is 240px\r\n\t// minimumVersion: Number?\r\n\t//\t\tThe minimum targeted version of the Flash Player (defaults to 9)\r\n\t// style: String?\r\n\t//\t\tAny CSS style information (i.e. style=\"background-color:transparent\") you want\r\n\t//\t\tto define on the markup.\r\n\t// params: Object?\r\n\t//\t\tA set of key/value pairs that you want to define in the resultant markup.\r\n\t// vars: Object?\r\n\t//\t\tA set of key/value pairs that the Flash movie will interpret as FlashVars.\r\n\t// expressInstall: Boolean?\r\n\t//\t\tWhether or not to include any kind of expressInstall info. Default is false.\r\n\t// redirect: String?\r\n\t//\t\tA url to redirect the browser to if the current Flash version is not supported.\r\n};\r\n=====*/\r\n\r\n\t//\tthe main entry point\r\n\tvar Flash = function(/*__flashArgs*/ kwArgs, /*DOMNode*/ node){\r\n\t\t// summary:\r\n\t\t//\t\tCreate a wrapper object around a Flash movie; this is the DojoX equivilent\r\n\t\t//\t\tto SWFObject.\r\n\t\t//\r\n\t\t// description:\r\n\t\t//\t\tCreates a wrapper object around a Flash movie.  Wrapper object will\r\n\t\t//\t\tinsert the movie reference in node; when the browser first starts\r\n\t\t//\t\tgrabbing the movie, onReady will be fired; when the movie has finished\r\n\t\t//\t\tloading, it will fire onLoad.\r\n\t\t//\r\n\t\t//\t\tIf your movie uses ExternalInterface, you should use the onLoad event\r\n\t\t//\t\tto do any kind of proxy setup (see dojox.embed.Flash.proxy); this seems\r\n\t\t//\t\tto be the only consistent time calling EI methods are stable (since the\r\n\t\t//\t\tFlash movie will shoot several methods into the window object before\r\n\t\t//\t\tEI callbacks can be used properly).\r\n\t\t//\r\n\t\t// kwArgs: __flashArgs\r\n\t\t//\t\tThe various arguments that will be used to help define the Flash movie.\r\n\t\t// node: DomNode\r\n\t\t//\t\tThe node where the embed object will be placed\r\n\t\t//\r\n\t\t// example:\r\n\t\t//\t\tEmbed a flash movie in a document using the new operator, and get a reference to it.\r\n\t\t//\t|\tvar movie = new dojox.embed.Flash({\r\n\t\t//\t|\t\tpath: \"path/to/my/movie.swf\",\r\n\t\t//\t|\t\twidth: 400,\r\n\t\t//\t|\t\theight: 300\r\n\t\t//\t|\t}, myWrapperNode, \"testLoaded\");\r\n\t\t//\r\n\t\t// example:\r\n\t\t//\t\tEmbed a flash movie in a document without using the new operator.\r\n\t\t//\t|\tvar movie = dojox.embed.Flash({\r\n\t\t//\t|\t\tpath: \"path/to/my/movie.swf\",\r\n\t\t//\t|\t\twidth: 400,\r\n\t\t//\t|\t\theight: 300,\r\n\t\t//\t|\t\tstyle: \"position:absolute;top:0;left:0\"\r\n\t\t//\t|\t}, myWrapperNode, \"testLoaded\");\r\n\r\n\t\t// File can only be run from a server, due to SWF dependency.\r\n\t\tif(location.href.toLowerCase().indexOf(\"file://\")>-1){\r\n\t\t\tthrow new Error(\"dojox.embed.Flash can't be run directly from a file. To instatiate the required SWF correctly it must be run from a server, like localHost.\");\r\n\t\t}\r\n\r\n\t\t// available: Number\r\n\t\t//\t\tIf there is a flash player available, and if so what version.\r\n\t\tthis.available = fVersion.major;\r\n\r\n\t\t// minimumVersion: Number\r\n\t\t//\t\tThe minimum version of Flash required to run this movie.\r\n\t\tthis.minimumVersion = kwArgs.minimumVersion || minimumVersion;\r\n\r\n\t\t// id: String\r\n\t\t//\t\tThe id of the DOMNode to be used for this movie.  Can be used with dojo.byId to get a reference.\r\n\t\tthis.id = null;\r\n\r\n\t\t// movie: FlashObject\r\n\t\t//\t\tA reference to the movie itself.\r\n\t\tthis.movie = null;\r\n\r\n\t\t// domNode: DOMNode\r\n\t\t//\t\tA reference to the DOMNode that contains this movie.\r\n\t\tthis.domNode = null;\r\n\t\tif(node){\r\n\t\t\tnode = dom.byId(node);\r\n\t\t}\r\n\t\t// setTimeout Fixes #8743 - creating double SWFs\r\n\t\t// also allows time for code to attach to onError\r\n\t\tsetTimeout(lang.hitch(this, function(){\r\n\t\t\tif(kwArgs.expressInstall || this.available && this.available >= this.minimumVersion){\r\n\t\t\t\tif(kwArgs && node){\r\n\t\t\t\t\tthis.init(kwArgs, node);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis.onError(\"embed.Flash was not provided with the proper arguments.\");\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\tif(!this.available){\r\n\t\t\t\t\tthis.onError(\"Flash is not installed.\");\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis.onError(\"Flash version detected: \"+this.available+\" is out of date. Minimum required: \"+this.minimumVersion);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}), 100);\r\n\t};\r\n\r\n\tlang.extend(Flash, {\r\n\t\tonReady: function(/*HTMLObject*/ movie){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tStub function for you to attach to when the movie reference is first\r\n\t\t\t//\t\tpushed into the document.\r\n\t\t},\r\n\t\tonLoad: function(/*HTMLObject*/ movie){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tStub function for you to attach to when the movie has finished downloading\r\n\t\t\t//\t\tand is ready to be manipulated.\r\n\t\t},\r\n\t\tonError: function(msg){\r\n\r\n\t\t},\r\n\t\t_onload: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\tInternal. Cleans up before calling onLoad.\r\n\t\t\tclearInterval(this._poller);\r\n\t\t\tdelete this._poller;\r\n\t\t\tdelete this._pollCount;\r\n\t\t\tdelete this._pollMax;\r\n\t\t\tthis.onLoad(this.movie);\r\n\t\t},\r\n\t\tinit: function(/*__flashArgs*/ kwArgs, /*DOMNode?*/ node){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tInitialize (i.e. place and load) the movie based on kwArgs.\r\n\t\t\tthis.destroy();\t\t//\tensure we are clean first.\r\n\t\t\tnode = dom.byId(node || this.domNode);\r\n\t\t\tif(!node){ throw new Error(\"dojox.embed.Flash: no domNode reference has been passed.\"); }\r\n\r\n\t\t\t// vars to help determine load status\r\n\t\t\tvar p = 0, testLoaded=false;\r\n\t\t\tthis._poller = null; this._pollCount = 0; this._pollMax = 15; this.pollTime = 100;\r\n\r\n\t\t\tif(Flash.initialized){\r\n\r\n\t\t\t\tthis.id = Flash.place(kwArgs, node);\r\n\t\t\t\tthis.domNode = node;\r\n\r\n\t\t\t\tsetTimeout(lang.hitch(this, function(){\r\n\t\t\t\t\tthis.movie = this.byId(this.id, kwArgs.doc);\r\n\t\t\t\t\tthis.onReady(this.movie);\r\n\r\n\t\t\t\t\tthis._poller = setInterval(lang.hitch(this, function(){\r\n\r\n\t\t\t\t\t\t// catch errors if not quite ready.\r\n\t\t\t\t\t\ttry{\r\n\t\t\t\t\t\t\tp = this.movie.PercentLoaded();\r\n\t\t\t\t\t\t}catch(e){\r\n\t\t\t\t\t\t\tconsole.warn(\"this.movie.PercentLoaded() failed\", e, this.movie);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif(p == 100){\r\n\t\t\t\t\t\t\t// if percent = 100, movie is fully loaded and we're communicating\r\n\t\t\t\t\t\t\tthis._onload();\r\n\r\n\t\t\t\t\t\t}else if(p==0 && this._pollCount++ > this._pollMax){\r\n\t\t\t\t\t\t\t// after several attempts, we're not past zero.\r\n\t\t\t\t\t\t\tclearInterval(this._poller);\r\n\t\t\t\t\t\t\tthrow new Error(\"Building SWF failed.\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}), this.pollTime);\r\n\t\t\t\t}), 1);\r\n\t\t\t}\r\n\t\t},\r\n\t\t_destroy: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tKill the movie and reset all the properties of this object.\r\n\t\t\ttry{\r\n\t\t\t\tthis.domNode.removeChild(this.movie);\r\n\t\t\t}catch(e){}\r\n\t\t\tthis.id = this.movie = this.domNode = null;\r\n\t\t},\r\n\t\tdestroy: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tPublic interface for destroying all the properties in this object.\r\n\t\t\t//\t\tWill also clean all proxied methods.\r\n\t\t\tif(!this.movie){ return; }\r\n\r\n\t\t\t//\tremove any proxy functions\r\n\t\t\tvar test = lang.delegate({\r\n\t\t\t\tid: true,\r\n\t\t\t\tmovie: true,\r\n\t\t\t\tdomNode: true,\r\n\t\t\t\tonReady: true,\r\n\t\t\t\tonLoad: true\r\n\t\t\t});\r\n\t\t\tfor(var p in this){\r\n\t\t\t\tif(!test[p]){\r\n\t\t\t\t\tdelete this[p];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t//\tpoll the movie\r\n\t\t\tif(this._poller){\r\n\t\t\t\t//\twait until onLoad to destroy\r\n\t\t\t\ton(this, \"Load\", this, \"_destroy\");\r\n\t\t\t} else {\r\n\t\t\t\tthis._destroy();\r\n\t\t\t}\r\n\t\t},\r\n\t\tbyId: function (movieName, doc){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tGets Flash movie by id.\r\n\t\t\t// description:\r\n\t\t\t//\t\tProbably includes methods for outdated\r\n\t\t\t//\t\tbrowsers, but this should catch all cases.\r\n\t\t\t// movieName: String\r\n\t\t\t//\t\tThe name of the SWF\r\n\t\t\t// doc: Object\r\n\t\t\t//\t\tThe document, if not current window\r\n\t\t\t//\t\t(not fully supported)\r\n\t\t\t// example:\r\n\t\t\t//\t|\tvar movie = dojox.embed.Flash.byId(\"myId\");\r\n\r\n\t\t\tdoc = doc || document;\r\n\t\t\tif(doc.embeds[movieName]){\r\n\t\t\t\treturn doc.embeds[movieName];\r\n\t\t\t}\r\n\t\t\tif(doc[movieName]){\r\n\t\t\t\treturn doc[movieName];\r\n\t\t\t}\r\n\t\t\tif(window[movieName]){\r\n\t\t\t\treturn window[movieName];\r\n\t\t\t}\r\n\t\t\tif(document[movieName]){\r\n\t\t\t\treturn document[movieName];\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\t});\r\n\r\n\t//\texpose information through the constructor function itself.\r\n\tlang.mixin(Flash, {\r\n\t\t// summary:\r\n\t\t//\t\tA singleton object used internally to get information\r\n\t\t//\t\tabout the Flash player available in a browser, and\r\n\t\t//\t\tas the factory for generating and placing markup in a\r\n\t\t//\t\tdocument.\r\n\t\t//\r\n\t\t// minSupported: Number\r\n\t\t//\t\tThe minimum supported version of the Flash Player, defaults to 8.\r\n\t\t// available: Number\r\n\t\t//\t\tUsed as both a detection (i.e. if(dojox.embed.Flash.available){ })\r\n\t\t//\t\tand as a variable holding the major version of the player installed.\r\n\t\t// supported: Boolean\r\n\t\t//\t\tWhether or not the Flash Player installed is supported by dojox.embed.\r\n\t\t// version: Object\r\n\t\t//\t\tThe version of the installed Flash Player; takes the form of\r\n\t\t//\t\t{ major, minor, rev }.  To get the major version, you'd do this:\r\n\t\t//\t\tvar v=dojox.embed.Flash.version.major;\r\n\t\t// initialized: Boolean\r\n\t\t//\t\tWhether or not the Flash engine is available for use.\r\n\t\t// onInitialize: Function\r\n\t\t//\t\tA stub you can connect to if you are looking to fire code when the\r\n\t\t//\t\tengine becomes available.  A note: DO NOT use this event to\r\n\t\t//\t\tplace a movie in a document; it will usually fire before DOMContentLoaded\r\n\t\t//\t\tis fired, and you will get an error.  Use dojo.addOnLoad instead.\r\n\t\tminSupported : 8,\r\n\t\tavailable: fVersion.major,\r\n\t\tsupported: (fVersion.major >= fVersion.required),\r\n\t\tminimumRequired: fVersion.required,\r\n\t\tversion: fVersion,\r\n\t\tinitialized: false,\r\n\t\tonInitialize: function(){\r\n\t\t\tFlash.initialized = true;\r\n\t\t},\r\n\t\t__ie_markup__: function(kwArgs){\r\n\t\t\treturn fMarkup(kwArgs);\r\n\t\t},\r\n\t\tproxy: function(/*Flash*/ obj, /*Array|String*/ methods){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tCreate the set of passed methods on the Flash object\r\n\t\t\t//\t\tso that you can call that object directly, as opposed to having to\r\n\t\t\t//\t\tdelve into the internal movie to do this.  Intended to make working\r\n\t\t\t//\t\twith Flash movies that use ExternalInterface much easier to use.\r\n\t\t\t//\r\n\t\t\t// example:\r\n\t\t\t//\t\tCreate \"setMessage\" and \"getMessage\" methods on foo.\r\n\t\t\t//\t|\tvar foo = new Flash(args, someNode);\r\n\t\t\t//\t|\tdojo.connect(foo, \"onLoad\", lang.hitch(foo, function(){\r\n\t\t\t//\t|\t\tFlash.proxy(this, [ \"setMessage\", \"getMessage\" ]);\r\n\t\t\t//\t|\t\tthis.setMessage(\"Flash.proxy is pretty cool...\");\r\n\t\t\t//\t|\t\tconsole.log(this.getMessage());\r\n\t\t\t//\t|\t}));\r\n\t\t\tarray.forEach((methods instanceof Array ? methods : [ methods ]), function(item){\r\n\t\t\t\tthis[item] = lang.hitch(this, function(){\r\n\t\t\t\t\treturn (function(){\r\n\t\t\t\t\t\treturn eval(this.movie.CallFunction(\r\n\t\t\t\t\t\t\t'<invoke name=\"' + item + '\" returntype=\"javascript\">'\r\n\t\t\t\t\t\t\t+ '<arguments>'\r\n\t\t\t\t\t\t\t+ array.map(arguments, function(item){\r\n\t\t\t\t\t\t\t\t// FIXME:\r\n\t\t\t\t\t\t\t\t//\t\tinvestigate if __flash__toXML will\r\n\t\t\t\t\t\t\t\t//\t\taccept direct application via map()\r\n\t\t\t\t\t\t\t\t//\t\t(e.g., does it ignore args past the\r\n\t\t\t\t\t\t\t\t//\t\tfirst? or does it blow up?)\r\n\t\t\t\t\t\t\t\treturn __flash__toXML(item);\r\n\t\t\t\t\t\t\t}).join(\"\")\r\n\t\t\t\t\t\t\t+ '</arguments>'\r\n\t\t\t\t\t\t\t+ '</invoke>'\r\n\t\t\t\t\t\t));\r\n\t\t\t\t\t}).apply(this, arguments||[]);\r\n\t\t\t\t});\r\n\t\t\t}, obj);\r\n\t\t}\r\n\t});\r\n\r\n\tFlash.place = function(kwArgs, node){\r\n\t\tvar o = fMarkup(kwArgs);\r\n\t\tnode = dom.byId(node);\r\n\t\tif(!node){\r\n\t\t\tnode = win.doc.createElement(\"div\");\r\n\t\t\tnode.id = o.id+\"-container\";\r\n\t\t\twin.body().appendChild(node);\r\n\t\t}\r\n\t\tif(o){\r\n\t\t\tnode.innerHTML = o.markup;\r\n\t\t\treturn o.id;\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\tFlash.onInitialize();\r\n\r\n\tlang.setObject(\"dojox.embed.Flash\", Flash);\r\n\r\n\treturn Flash;\r\n});\r\n"]}