/**
 * dojox - A version of dojox.js framework that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/dojox/
 * @license MIT
 */
define(["require","dojo/_base/kernel","dojo/_base/lang","dojo/_base/declare","dojo/_base/config","dojo/_base/window","dojo/Evented","dojo/Deferred","dojo/when","dojo/has","dojo/on","dojo/ready","dojo/dom-construct","dojo/dom-attr","./utils/model","./utils/nls","./module/lifecycle","./utils/hash","./utils/constraints","./utils/config"],function(require,t,e,o,i,s,r,a,n,d,l,h,c,p,f,u,m,w,v,g){d.add("app-log-api",(i.app||{}).debugApp);var j=o(r,{constructor:function(t,e){o.safeMixin(this,t),this.params=t,this.id=t.id,this.defaultView=t.defaultView,this.controllers=[],this.children={},this.loadedModels={},this.loadedStores={},this.setDomNode(c.create("div",{id:this.id+"_Root",style:"width:100%; height:100%; overflow-y:hidden; overflow-x:hidden;"})),e.appendChild(this.domNode)},createDataStore:function(t){if(t.stores)for(var o in t.stores)if("_"!==o.charAt(0)){var i=t.stores[o].type?t.stores[o].type:"dojo/store/Memory",s={};t.stores[o].params&&e.mixin(s,t.stores[o].params);try{var r=require(i)}catch(t){throw new Error(i+" must be listed in the dependencies")}if(s.data&&e.isString(s.data)&&(s.data=e.getObject(s.data)),t.stores[o].observable){try{var a=require("dojo/store/Observable")}catch(t){throw new Error("dojo/store/Observable must be listed in the dependencies")}t.stores[o].store=a(new r(s))}else t.stores[o].store=new r(s);this.loadedStores[o]=t.stores[o].store}},createControllers:function(t){if(t){for(var o=[],i=0;i<t.length;i++)o.push(t[i]);var s,r=new a;try{s=require.on?require.on("error",function(t){r.isResolved()||r.isRejected()||(r.reject("load controllers error."),s&&s.remove())}):null,require(o,function(){r.resolve.call(r,arguments),s&&s.remove()})}catch(t){r.reject(t),s&&s.remove()}var d=new a;return n(r,e.hitch(this,function(){for(var t=0;t<arguments[0].length;t++)this.controllers.push(new arguments[0][t](this).bind());d.resolve(this)}),function(){d.reject("load controllers error.")}),d}},trigger:function(e,o){t.deprecated("dojox.app.Application.trigger","Use dojox.app.Application.emit instead","2.0"),this.emit(e,o)},start:function(){this.createDataStore(this.params);var t,o=new a;try{t=f(this.params.models,this,this)}catch(t){return o.reject(t),o.promise}n(t,e.hitch(this,function(t){this.loadedModels=e.isArray(t)?t[0]:t,this.setupControllers(),n(u(this.params),e.hitch(this,function(t){t&&e.mixin(this.nls={},t),this.startup()}))}),function(){o.reject("load model error.")})},setDomNode:function(t){var e=this.domNode;this.domNode=t,this.emit("app-domNode",{oldNode:e,newNode:t})},setupControllers:function(){var t=window.location.hash;this._startView=w.getTarget(t,this.defaultView),this._startParams=w.getParams(t)},startup:function(){this.selectedChildren={};var t=this.createControllers(this.params.controllers);this.hasOwnProperty("constraint")?v.register(this.params.constraints):this.constraint="center";var o=function(){this.emit("app-load",{viewId:this.defaultView,initLoad:!0,params:this._startParams,callback:e.hitch(this,function(){this.emit("app-transition",{viewId:this.defaultView,forceTransitionNone:!0,opts:{params:this._startParams}}),this.defaultView!==this._startView&&this.emit("app-transition",{viewId:this._startView,opts:{params:this._startParams}}),this.setStatus(this.lifecycle.STARTED)})})};n(t,e.hitch(this,function(){this.template?this.emit("app-init",{app:this,name:this.name,type:this.type,parent:this,templateString:this.templateString,controller:this.controller,callback:e.hitch(this,function(t){this.setDomNode(t.domNode),o.call(this)})}):o.call(this)}))}});function b(t,e){var i;(t=g.configProcessHas(t)).loaderConfig||(t.loaderConfig={}),t.loaderConfig.paths||(t.loaderConfig.paths={}),t.loaderConfig.paths.app||("/"!=(i=window.location.pathname).charAt(i.length)&&((i=i.split("/")).pop(),i=i.join("/")),t.loaderConfig.paths.app=i),require(t.loaderConfig),t.modules||(t.modules=[]),t.modules.push("./module/lifecycle");var r=t.modules.concat(t.dependencies?t.dependencies:[]);t.template&&(0==(i=t.template).indexOf("./")&&(i="app/"+i),r.push("dojo/text!"+i)),require(r,function(){for(var i=[j],r=0;r<t.modules.length;r++)i.push(arguments[r]);if(t.template)var a={templateString:arguments[arguments.length-1]};App=o(i,a),h(function(){var i=new App(t,e||s.body());d("app-log-api")?i.log=function(){var t="";try{for(var e=0;e<arguments.length-1;e++)t+=arguments[e];console.log(t,arguments[arguments.length-1])}catch(t){}}:i.log=function(){},i.transitionToView=function(t,e,o){var i={bubbles:!0,cancelable:!0,detail:e,triggerEvent:o||null};l.emit(t,"startTransition",i)},i.setStatus(i.lifecycle.STARTING);var r=i.id;window[r]&&o.safeMixin(i,window[r]),window[r]=i,i.start()})})}return function(t,e){if(!t)throw new Error("App Config Missing");t.validate?require(["dojox/json/schema","dojox/json/ref","dojo/text!dojox/application/schema/application.json"],function(o,i){(o=dojox.json.ref.resolveJson(o)).validate(t,i)&&b(t,e)}):b(t,e)}});
//# sourceMappingURL=../sourcemaps/app/main.js.map
