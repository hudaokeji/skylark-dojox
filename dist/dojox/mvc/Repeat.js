/**
 * dojox - A version of dojox.js framework that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/dojox/
 * @license MIT
 */
define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/sniff","dojo/_base/window","dojo/dom","dojo/dom-construct","dojo/_base/array","dojo/query","dojo/when","dijit/registry","./_Container"],function(e,t,i,d,s,n,r,o,h,a,l){return e("dojox.mvc.Repeat",l,{index:0,useParent:"",removeRepeatNode:!1,children:null,_relTargetProp:"children",startup:function(){if(this.removeRepeatNode){t.isFunction(this.getParent)&&this.getParent()&&(this.select=this.getParent().select,this.onCheckStateChanged=this.getParent().onCheckStateChanged)}this.inherited(arguments),this._setChildrenAttr(this.children)},postscript:function(e,t){if(this.useParent&&s.byId(this.useParent)?this.srcNodeRef=s.byId(this.useParent):this.srcNodeRef=s.byId(t),this.srcNodeRef){var i=this._attachTemplateNodes?"inlineTemplateString":"templateString";""==this[i]&&(this[i]=this.srcNodeRef.innerHTML);try{this.srcNodeRef.innerHTML=""}catch(e){for(;this.srcNodeRef.firstChild;)this.srcNodeRef.removeChild(this.srcNodeRef.firstChild)}}this.inherited(arguments)},_setChildrenAttr:function(e){var t=this.children;this._set("children",e),this.binding!=e&&this.set("ref",e),!this._started||this._builtOnce&&t==e||(this._builtOnce=!0,this._buildContained(e))},_buildContained:function(e){if(e){this.useParent&&s.byId(this.useParent)&&(this.srcNodeRef=s.byId(this.useParent)),this._destroyBody(),this._updateAddRemoveWatch(e);var r=[],o=this._attachTemplateNodes?"inlineTemplateString":"templateString";for(this.index=0;t.isFunction(e.get)?e.get(this.index):e[this.index];this.index++)r.push(this._exprRepl(this[o]));var l=this.containerNode||this.srcNodeRef||this.domNode;if(i("ie")&&/^(table|tbody)$/i.test(l.tagName)){(f=d.doc.createElement("div")).innerHTML="<table><tbody>"+r.join("")+"</tbody></table>";for(var c=f.getElementsByTagName("tbody")[0];c.firstChild;)l.appendChild(c.firstChild)}else if(i("ie")&&/^td$/i.test(l.tagName)){var f;(f=d.doc.createElement("div")).innerHTML="<table><tbody><tr>"+r.join("")+"</tr></tbody></table>";for(var m=f.getElementsByTagName("tr")[0];m.firstChild;)l.appendChild(m.firstChild)}else l.innerHTML=r.join("");this.srcNodeRef=l;var u=this;h(this._createBody(),function(){if(u.removeRepeatNode){var e=u.domNode;!u.savedParentId&&u.domNode.parentNode&&u.domNode.parentNode.id&&(u.savedParentId=u.domNode.parentNode.id);var t=s.byId(u.savedParentId);if(e&&e.children){for(var i=a.findWidgets(e),d=i.length;d>0;d--)if("dojox.mvc.Group"==i[d-1].declaredClass)for(var r=e.children[d-1].children.length,o=a.byId(t.id).select,h=r;h>0;h--)a.byId(e.children[d-1].id).select=o,n.place(e.children[d-1].removeChild(e.children[d-1].children[h-1]),t,"first");else n.place(e.removeChild(e.children[d-1]),t,"first");n.destroy(e)}}})}},_updateAddRemoveWatch:function(e){this._addRemoveWatch&&this._addRemoveWatch.unwatch();var i=this;this._addRemoveWatch=t.isFunction(e.watchElements)&&e.watchElements(function(e,t,d){t&&d&&!t.length&&!d.length||i._buildContained(i.children)})}})});
//# sourceMappingURL=../sourcemaps/mvc/Repeat.js.map
