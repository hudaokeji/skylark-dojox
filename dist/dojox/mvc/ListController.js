/**
 * dojox - A version of dojox.js framework that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/dojox/
 * @license MIT
 */
define(["dojo/_base/array","dojo/_base/lang","dojo/_base/declare","./ModelRefController"],function(r,e,t,s){function o(r){for(var e in{_listModelWatchHandle:1,_tableModelWatchHandle:1})r[e]&&(r[e].unwatch(),r[e]=null)}return t("dojox.mvc.ListController",s,{idProperty:"uniqueId",cursorId:null,cursorIndex:-1,cursor:null,model:null,_listModelWatchHandle:null,_tableModelWatchHandle:null,_refCursorProp:"cursor",_refModelProp:"cursor",destroy:function(){o(this),this.inherited(arguments)},set:function(t,s){var n,i,d,u=this[this._refCursorProp],l=this[this._refInModelProp];this.inherited(arguments),t==this._refCursorProp&&function(t,s,o){var n=t[t._refInModelProp];if(n&&s!==o)if(e.isArray(n)){var i=r.indexOf(n,o);i<0?(u=t.get("cursorIndex"))>=0&&u<n.length&&n.set(u,o):t.set("cursorIndex",i)}else{for(var d in n)if(n[d]==o)return void t.set("cursorIndex",d);var u;(u=t.get("cursorIndex"))&&n.set(u,o)}}(this,u,s),t==this._refInModelProp&&(i=l,d=s,o(n=this),d&&i!==d&&(d.watchElements?n._listModelWatchHandle=d.watchElements(function(r,e,t){if(e&&t){var s=n.get("cursorIndex");if(e&&s>=r&&s<r+e.length)return void n.set("cursorIndex",-1);(e.length||t.length)&&s>=r&&n.set(n._refCursorProp,n.get("cursor"))}else n.set(n._refCursorProp,n.get(n._refCursorProp))}):d.set&&d.watch&&(n.get("cursorIndex")<0&&n._set("cursorIndex",""),n._tableModelWatchHandle=d.watch(function(r,e,t){e!==t&&r==n.get("cursorIndex")&&n.set(n._refCursorProp,t)}))),n._setCursorIndexAttr(n.cursorIndex))},_setCursorIdAttr:function(r){var t=this.cursorId;this._set("cursorId",r);var s=this[this._refInModelProp];if(s&&t!==r)if(e.isArray(s)){for(var o=0;o<s.length;o++)if(s[o][this.idProperty]==r)return void this.set("cursorIndex",o);this._set("cursorIndex",-1)}else{for(var n in s)if(s[n][this.idProperty]==r)return void this.set("cursorIndex",n);this._set("cursorIndex","")}},_setCursorIndexAttr:function(r){this._set("cursorIndex",r),this[this._refInModelProp]&&(this.set(this._refCursorProp,this[this._refInModelProp][r]),this.set("cursorId",this[this._refInModelProp][r]&&this[this._refInModelProp][r][this.idProperty]))},hasControllerProperty:function(r){return this.inherited(arguments)||r==this._refCursorProp}})});
//# sourceMappingURL=../sourcemaps/mvc/ListController.js.map
