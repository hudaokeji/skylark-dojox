/**
 * dojox - A version of dojox.js framework that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/dojox/
 * @license MIT
 */
define(["dojo/_base/array","dojo/_base/config","dojo/_base/connect","dojo/_base/lang","dojo/_base/window","dojo/_base/kernel","dojo/dom","dojo/dom-class","dojo/dom-construct","dojo/domReady","dojo/ready","dojo/touch","dijit/registry","./sniff","./uacss"],function(e,i,t,n,o,d,r,a,l,s,c,u,m,b){var h=n.getObject("dojox.mobile",!0);if(o.doc.dojoClick=!0,b("touch")&&(b.add("clicks-prevented",!(b("android")>=4.1||10===b("ie")||!b("ie")&&b("trident")>6)),b("clicks-prevented")&&(h._sendClick=function(e,i){for(var t=e;t;t=t.parentNode)if(t.dojoClick)return;var n=o.doc.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,o.global,1,i.screenX,i.screenY,i.clientX,i.clientY),e.dispatchEvent(n)})),h.getScreenSize=function(){return{h:o.global.innerHeight||o.doc.documentElement.clientHeight,w:o.global.innerWidth||o.doc.documentElement.clientWidth}},h.updateOrient=function(){var e=h.getScreenSize();a.replace(o.doc.documentElement,e.h>e.w?"dj_portrait":"dj_landscape",e.h>e.w?"dj_landscape":"dj_portrait")},h.updateOrient(),h.tabletSize=500,h.detectScreenSize=function(e){var i,n,d=h.getScreenSize(),r=Math.min(d.w,d.h);r>=h.tabletSize&&(e||!this._sz||this._sz<h.tabletSize)?(i="phone",n="tablet"):r<h.tabletSize&&(e||!this._sz||this._sz>=h.tabletSize)&&(i="tablet",n="phone"),n&&(a.replace(o.doc.documentElement,"dj_"+n,"dj_"+i),t.publish("/dojox/mobile/screenSize/"+n,[d])),this._sz=r},h.detectScreenSize(),h.hideAddressBarWait="number"==typeof i.mblHideAddressBarWait?i.mblHideAddressBarWait:1500,h.hide_1=function(){scrollTo(0,1),h._hidingTimer=0==h._hidingTimer?200:2*h._hidingTimer,setTimeout(function(){h.isAddressBarHidden()||h._hidingTimer>h.hideAddressBarWait?(h.resizeAll(),h._hiding=!1):setTimeout(h.hide_1,h._hidingTimer)},50)},h.hideAddressBar=function(e){if(!h.disableHideAddressBar&&!h._hiding){h._hiding=!0,h._hidingTimer=b("ios")?200:0;var i=screen.availHeight;b("android")&&(0==(i=outerHeight/devicePixelRatio)&&(h._hiding=!1,setTimeout(function(){h.hideAddressBar()},200)),i<=innerHeight&&(i=outerHeight),b("android")<3&&(o.doc.documentElement.style.overflow=o.body().style.overflow="visible")),o.body().offsetHeight<i&&(o.body().style.minHeight=i+"px",h._resetMinHeight=!0),setTimeout(h.hide_1,h._hidingTimer)}},h.isAddressBarHidden=function(){return 1===pageYOffset},h.resizeAll=function(i,n){if(!h.disableResizeAll){t.publish("/dojox/mobile/resizeAll",[i,n]),t.publish("/dojox/mobile/beforeResizeAll",[i,n]),h._resetMinHeight&&(o.body().style.minHeight=h.getScreenSize().h+"px"),h.updateOrient(),h.detectScreenSize();var d=function(e){var i=e.getParent&&e.getParent();return!(i&&i.resize||!e.resize)},r=function(i){e.forEach(i.getChildren(),function(e){d(e)&&e.resize(),r(e)})};n?(n.resize&&n.resize(),r(n)):e.forEach(e.filter(m.toArray(),d),function(e){e.resize()}),t.publish("/dojox/mobile/afterResizeAll",[i,n])}},h.openWindow=function(e,i){o.global.open(e,i||"_blank")},h._detectWindowsTheme=function(){navigator.userAgent.match(/IEMobile\/10\.0/)&&l.create("style",{innerHTML:"@-ms-viewport {width: auto !important}"},o.doc.head);var e=function(){a.add(o.doc.documentElement,"windows_theme"),d.experimental("Dojo Mobile Windows theme","Behavior and appearance of the Windows theme are experimental.")},i=b("windows-theme");if(void 0===i){var t,n,r=function(i){return!(!i||-1===i.indexOf("/windows/"))&&(b.add("windows-theme",!0),e(),!0)},s=o.doc.styleSheets;for(t=0;t<s.length;t++)if(!s[t].href){var c=s[t].cssRules||s[t].imports;if(c)for(n=0;n<c.length;n++)if(r(c[n].href))return}var u=o.doc.getElementsByTagName("link");for(t=0;t<u.length;t++)if(r(u[t].href))return}else i&&e()},!1!==i.mblApplyPageStyles&&a.add(o.doc.documentElement,"mobile"),b("chrome")&&a.add(o.doc.documentElement,"dj_chrome"),o.global._no_dojo_dm){var f=o.global._no_dojo_dm;for(var g in f)h[g]=f[g];h.deviceTheme.setDm(h)}return b.add("mblAndroidWorkaround",!1!==i.mblAndroidWorkaround&&b("android")<3,void 0,!0),b.add("mblAndroid3Workaround",!1!==i.mblAndroid3Workaround&&b("android")>=3,void 0,!0),h._detectWindowsTheme(),h.setSelectable=function(e,i){var t,n;if(e=r.byId(e),b("ie")<=9)if(n=(t=e.getElementsByTagName("*")).length,i)for(e.removeAttribute("unselectable");n--;)t[n].removeAttribute("unselectable");else for(e.setAttribute("unselectable","on");n--;)"INPUT"!==t[n].tagName&&t[n].setAttribute("unselectable","on");else a.toggle(e,"unselectable",!i)},s(function(){a.add(o.body(),"mblBackground")}),c(function(){h.detectScreenSize(!0),!1!==i.mblAndroidWorkaroundButtonStyle&&b("android")&&l.create("style",{innerHTML:"BUTTON,INPUT[type='button'],INPUT[type='submit'],INPUT[type='reset'],INPUT[type='file']::-webkit-file-upload-button{-webkit-appearance:none;} audio::-webkit-media-controls-play-button,video::-webkit-media-controls-play-button{-webkit-appearance:media-play-button;} video::-webkit-media-controls-fullscreen-button{-webkit-appearance:media-fullscreen-button;}"},o.doc.head,"first"),b("mblAndroidWorkaround")&&l.create("style",{innerHTML:".mblView.mblAndroidWorkaround{position:absolute;top:-9999px !important;left:-9999px !important;}"},o.doc.head,"last");var e=h.resizeAll,n=-1!=navigator.appVersion.indexOf("Mobile")&&!(b("ios")>=7);(!1!==i.mblHideAddressBar&&n||!0===i.mblForceHideAddressBar)&&(h.hideAddressBar(),!0===i.mblAlwaysHideAddressBar&&(e=h.hideAddressBar));var d=b("ios")>=6;if((b("android")||d)&&void 0!==o.global.onorientationchange){var r,a,s,c=e;d?(a=o.doc.documentElement.clientWidth,s=o.doc.documentElement.clientHeight):(e=function(e){var i=t.connect(null,"onresize",null,function(e){t.disconnect(i),c(e)})},r=h.getScreenSize()),t.connect(null,"onresize",null,function(e){if(d){var i=o.doc.documentElement.clientWidth,t=o.doc.documentElement.clientHeight;i==a&&t!=s&&c(e),a=i,s=t}else{var n=h.getScreenSize();n.w==r.w&&Math.abs(n.h-r.h)>=100&&c(e),r=n}})}t.connect(null,void 0!==o.global.onorientationchange?"onorientationchange":"onresize",null,e),o.body().style.visibility="visible"}),h});
//# sourceMappingURL=../sourcemaps/mobile/common.js.map
