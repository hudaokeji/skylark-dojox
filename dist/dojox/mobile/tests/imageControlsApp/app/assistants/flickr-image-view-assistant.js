/**
 * dojox - A version of dojox.js framework that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/dojox/
 * @license MIT
 */
dojo.require("dojox.mobile.app.SceneAssistant"),dojo.declare("FlickrImageViewAssistant",dojox.mobile.app.SceneAssistant,{apiKey:"8c6803164dbc395fb7131c9d54843627",setup:function(){this.controller.parse();var t=this.viewer=dijit.byId("flickrImageView"),e=this;this.handlePhotoLoad=dojo.hitch(this,this.handlePhotoLoad);var i=this.controller.query(".loading")[0],o=dojo.connect(t,"onLoad",function(t,e,s){"center"==t&&(dojo.disconnect(o),dojo.destroy(i),i=null)}),s=this.controller.query(".report")[0];this.connect(t,"onChange",function(i){e.index+=i,e.index>0&&t.set("leftUrl",e.urls[e.index-1]),e.index<e.urls.length-1&&t.set("rightUrl",e.urls[e.index+1]),s.innerHTML=e.index+1+" of "+e.urls.length+" "+e.urls[e.index].title})},activate:function(t){switch(this.dataType=t&&t.type?t.type:"interesting",console.log("In main assistant activate, dataType = ",this.dataType,t),this.dataType){case"interesting":this.loadInteresting();break;case"group":this.loadGroup(t);break;case"data":this.useData(t.images,t.index||0)}},useData:function(t,e){this.urls=t,this.index=Math.min(t.length-1,Math.max(0,e)),this.index>0&&this.viewer.set("leftUrl",t[this.index-1]),this.viewer.set("centerUrl",t[this.index]),this.index<t.length&&this.viewer.set("rightUrl",t[this.index+1])},loadInteresting:function(){console.log("loading interesting");dojo.io.script.get({url:"http://api.flickr.com/services/rest/?method=flickr.interestingness.getList",content:{api_key:this.apiKey,format:"json"},jsonp:"jsoncallback"}).addBoth(this.handlePhotoLoad)},loadGroup:function(t){console.log("loading group ",t);dojo.io.script.get({url:"http://api.flickr.com/services/rest/?method=flickr.groups.pools.getPhotos",content:{api_key:this.apiKey,format:"json",group_id:t.nsid,per_page:20},jsonp:"jsoncallback"}).addBoth(this.handlePhotoLoad)},handlePhotoLoad:function(t){if(t&&t.photos&&t.photos.photo){for(var e,i=t.photos.photo,o=[],s=0;s<i.length;s++)e="http://farm"+i[s].farm+".static.flickr.com/"+i[s].server+"/"+i[s].id+"_"+i[s].secret,o.push({large:e+"_m.jpg",small:e+"_t.jpg",title:i[s].title});this.urls=o,this.index=0,this.viewer.set("centerUrl",o[0]),this.viewer.set("rightUrl",o[1])}else console.log("didn't get photos")}});
//# sourceMappingURL=../../../../../sourcemaps/mobile/tests/imageControlsApp/app/assistants/flickr-image-view-assistant.js.map
