/**
 * dojox - A version of dojox.js framework that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/dojox/
 * @license MIT
 */
dojo.provide("dojox.data.tests.stores.JsonQueryRestStore"),dojo.require("dojox.data.ClientFilter"),dojo.require("dojox.data.JsonQueryRestStore"),dojox.data.tests.stores.JsonQueryRestStore.error=function(e,r,t){r.errback(t)},testService=function(e){lastQuery=e;var r=new dojo.Deferred;return r.callback([{id:1,name:"Ball",price:5},{id:2,name:"Car",price:15},{id:3,name:"Truck",price:25},{id:4,name:"Hula Hoop",price:55}]),r},testService.servicePath="/testing",jsonStore=new dojox.data.JsonQueryRestStore({service:testService}),doh.register("dojox.data.tests.stores.JsonQueryRestStore",[{name:"Fetch using a query object",timeout:1e4,runTest:function(e){var r=new doh.Deferred;return jsonStore.fetch({query:{name:"Car"},onComplete:function(t,o){e.is(lastQuery,"[?(@.name='Car')]"),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.JsonQueryRestStore.error,doh,r)}),r}},{name:"Fetch+Sorting using a query object",timeout:1e4,runTest:function(e){var r=new doh.Deferred;return jsonStore.fetch({query:{name:"Car"},sort:[{attribute:"price"}],onComplete:function(t,o){e.is(lastQuery,"[?(@.name='Car')][/@['price']]"),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.JsonQueryRestStore.error,doh,r)}),r}},{name:"Fetch all items (and cache for the next tests)",timeout:1e4,runTest:function(e){var r=new doh.Deferred;return jsonStore.fetch({query:"",onComplete:function(t,o){testItems=t,console.log(t.length,t),e.is(4,t.length),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.JsonQueryRestStore.error,doh,r),queryOptions:{cache:!0}}),r}},{name:"Fetch using a query object",timeout:1e4,runTest:function(e){var r=new doh.Deferred;return lastQuery=null,jsonStore.fetch({query:{name:"Car"},onComplete:function(t,o){e.is(1,t.length),e.is(lastQuery,null),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.JsonQueryRestStore.error,doh,r)}),r}},{name:"Fetch using a JSONQuery",timeout:1e4,runTest:function(e){var r=new doh.Deferred;return lastQuery=null,jsonStore.fetch({query:"?name='Car'",onComplete:function(t,o){e.is(1,t.length),e.is(lastQuery,null),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.JsonQueryRestStore.error,doh,r)}),r}},{name:"Fetch using a JSONQuery with operator",timeout:1e4,runTest:function(e){var r=new doh.Deferred;return lastQuery=null,jsonStore.fetch({query:"[?price<20]",onComplete:function(t,o){e.is(2,t.length),e.is(lastQuery,null),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.JsonQueryRestStore.error,doh,r)}),r}},{name:"Fetch using a JSONQuery with operator and paging",timeout:1e4,runTest:function(e){var r=new doh.Deferred;return lastQuery=null,jsonStore.fetch({query:"?price<20",start:1,count:1,onComplete:function(t,o){e.is(1,t.length),e.is(lastQuery,null),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.JsonQueryRestStore.error,doh,r),queryOptions:{cache:!0}}),r}},{name:"Sorting",timeout:1e4,runTest:function(e){var r=new doh.Deferred;return lastQuery=null,jsonStore.fetch({sort:[{attribute:"name",descending:!0}],onComplete:function(t,o){e.is("Truck",t[0].name),e.is("Ball",t[3].name),e.is(lastQuery,null),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.JsonQueryRestStore.error,doh,r)}),r}},{name:"Sorting + Paging",timeout:1e4,runTest:function(e){jsonStore.jsonQueryPagination=!0;var r=new doh.Deferred;return lastQuery=null,jsonStore.fetch({sort:[{attribute:"name",descending:!0}],start:1,count:2,onBegin:function(r){e.is(r,4)},onComplete:function(t,o){e.is("Hula Hoop",t[0].name),e.is("Car",t[1].name),e.is(t.length,2),e.is(lastQuery,null),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.JsonQueryRestStore.error,doh,r)}),r}}]);
//# sourceMappingURL=../../../sourcemaps/data/tests/stores/JsonQueryRestStore.js.map
