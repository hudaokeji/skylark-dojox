/**
 * dojox - A version of dojox.js framework that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/dojox/
 * @license MIT
 */
dojo.provide("dojox.data.tests.stores.KeyValueStore"),dojo.require("dojox.data.KeyValueStore"),dojo.require("dojo.data.api.Read"),dojo.require("dojo.data.api.Identity"),dojox.data.tests.stores.KeyValueStore.getDatasource=function(e){var t={};if(dojo.isBrowser)t.url=require.toUrl("dojox/data/tests/stores/properties.js").toString();else{var o="/*[";o+='{ "year": "2007" },',o+='{ "nmonth": "12" },',o+='{ "month": "December" },',o+='{ "nday": "1" },',o+='{ "day": "Saturday" },',o+='{ "dayOfYear": "335" },',o+='{ "weekOfYear": "48" }',o+="]*/",t.data=o}return t},dojox.data.tests.stores.KeyValueStore.verifyItems=function(e,t,o,r){if(t.length!=r.length)return!1;for(var a=0;a<t.length;a++)if(e.getValue(t[a],o)!==r[a])return!1;return!0},dojox.data.tests.stores.KeyValueStore.error=function(e,t,o){for(i in o)console.log(o[i]);t.errback(o)},doh.register("dojox.data.tests.stores.KeyValueStore",[function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource("stores/properties.js"),o=new dojox.data.KeyValueStore(t),r=new doh.Deferred;return o.fetch({onComplete:function(t){e.assertTrue(7===t.length),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),r},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource(),o=new dojox.data.KeyValueStore(t),r=new doh.Deferred;return o.fetch({onComplete:function(t){e.assertTrue(7===t.length),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),r},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource(),o=new dojox.data.KeyValueStore(t),r=new doh.Deferred;return o.fetch({query:{key:"year"},onComplete:function(t,o){e.is(1,t.length),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),r},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource(),o=new dojox.data.KeyValueStore(t),r=new doh.Deferred,a=[!1,!1];try{o.fetch({query:{key:"year"},onComplete:function(t,o){a[0]=!0,e.is(1,t.length),a[0]&&a[1]&&r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),o.fetch({query:{key:"month"},onComplete:function(t,o){a[1]=!0,e.is(1,t.length),a[0]&&a[1]&&r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)})}catch(e){for(i in e)console.log(e[i])}return r},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource(),o=new dojox.data.KeyValueStore(t),r=new doh.Deferred,a=[!1,!1];return o.fetch({query:{key:"day"},onComplete:function(t,o){a[0]=!0,e.is(1,t.length),a[0]&&a[1]&&r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),o.fetchItemByIdentity({identity:"year",onItem:function(t){a[1]=!0,e.assertTrue(null!==t),e.is("year",o.getValue(t,"key")),e.is(2007,o.getValue(t,"value")),e.is(2007,o.getValue(t,"year")),a[0]&&a[1]&&r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),r},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource(),o=new dojox.data.KeyValueStore(t),r=new doh.Deferred;return count=0,o.fetch({onBegin:function(t,o){e.assertTrue(7===t)},onItem:function(t,r){e.assertTrue(o.isItem(t)),count++},onComplete:function(t,o){e.is(7,count),e.is(null,t),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),r},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource(),o=new dojox.data.KeyValueStore(t),r=new doh.Deferred;function a(t,r){e.is(5,t.length),r.start=3,r.count=1,r.onComplete=s,o.fetch(r)}function s(t,r){e.is(1,t.length),r.start=0,r.count=5,r.onComplete=n,o.fetch(r)}function n(t,r){e.is(5,t.length),r.start=2,r.count=20,r.onComplete=u,o.fetch(r)}function u(t,r){e.is(5,t.length),r.start=9,r.count=100,r.onComplete=d,o.fetch(r)}function d(t,r){e.is(0,t.length),r.start=2,r.count=20,r.onComplete=l,o.fetch(r)}function l(t,o){e.is(5,t.length),r.callback(!0)}return o.fetch({onComplete:function(t,r){e.is(7,t.length),r.start=1,r.count=5,r.onComplete=a,o.fetch(r)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),r},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource(),o=new dojox.data.KeyValueStore(t),r=new doh.Deferred;return o.fetch({query:{key:"year"},onComplete:function(t,a){e.assertEqual(t.length,1);var s=o.getLabel(t[0]);e.assertTrue(null!==s),e.assertEqual("year",s),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),r},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource(),o=new dojox.data.KeyValueStore(t),r=new doh.Deferred;return o.fetch({query:{key:"year"},onComplete:function(t,a){e.assertEqual(t.length,1);var s=o.getLabelAttributes(t[0]);e.assertTrue(dojo.isArray(s)),e.assertEqual("key",s[0]),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),r},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource("stores/movies.csv"),o=new dojox.data.KeyValueStore(t),r=new doh.Deferred;return o.fetchItemByIdentity({identity:"nday",onItem:function(t){e.assertTrue(null!==t),e.is("nday",o.getValue(t,"key")),e.is(1,o.getValue(t,"value")),e.is(1,o.getValue(t,"nday")),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),r},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource("stores/movies.csv"),o=new dojox.data.KeyValueStore(t),r=new doh.Deferred;return o.fetchItemByIdentity({identity:"day",onItem:function(t){e.assertTrue(null!==t),e.is("day",o.getValue(t,"key")),e.is("Saturday",o.getValue(t,"value")),e.is("Saturday",o.getValue(t,"day")),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),r},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource("stores/movies.csv"),o=new dojox.data.KeyValueStore(t),r=new doh.Deferred;return o.fetchItemByIdentity({identity:"dayOfYear",onItem:function(t){e.assertTrue(null!==t),e.is("dayOfYear",o.getValue(t,"key")),e.is(335,o.getValue(t,"value")),e.is(335,o.getValue(t,"dayOfYear")),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),r},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource("stores/movies.csv"),o=new dojox.data.KeyValueStore(t),r=new doh.Deferred;return o.fetchItemByIdentity({identity:"weekOfYear",onItem:function(t){e.assertTrue(null!==t),e.is("weekOfYear",o.getValue(t,"key")),e.is(48,o.getValue(t,"value")),e.is(48,o.getValue(t,"weekOfYear")),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),r},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource("stores/movies.csv"),o=new dojox.data.KeyValueStore(t),r=new doh.Deferred;return o.fetchItemByIdentity({identity:"year",onItem:function(t){e.assertTrue(null!==t);var a=o.getValues(t,"year");e.assertTrue(dojo.isArray(a)),e.is(1,a.length),e.is(2007,a[0]),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),r},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource("stores/movies.csv"),o=new dojox.data.KeyValueStore(t),r=new doh.Deferred;return o.fetchItemByIdentity({identity:"year",onItem:function(t){e.assertTrue(null!==t),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),r},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource("stores/movies.csv"),o=new dojox.data.KeyValueStore(t),r=new doh.Deferred;return o.fetchItemByIdentity({identity:"y3ar",onItem:function(t){e.assertTrue(null===t),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),r},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource("stores/movies.csv"),o=new dojox.data.KeyValueStore(t),r=new doh.Deferred;return o.fetchItemByIdentity({identity:"-1",onItem:function(t){e.assertTrue(null===t),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),r},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource("stores/movies.csv"),o=new dojox.data.KeyValueStore(t),r=new doh.Deferred;return o.fetchItemByIdentity({identity:"999999",onItem:function(t){e.assertTrue(null===t),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),r},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource("stores/movies.csv"),o=new dojox.data.KeyValueStore(t),r=new doh.Deferred;return o.fetch({onComplete:function(t,a){e.is(7,t.length),e.is(o.getIdentity(t[0]),"year"),e.is(o.getIdentity(t[1]),"nmonth"),e.is(o.getIdentity(t[2]),"month"),e.is(o.getIdentity(t[3]),"nday"),e.is(o.getIdentity(t[4]),"day"),e.is(o.getIdentity(t[5]),"dayOfYear"),e.is(o.getIdentity(t[6]),"weekOfYear"),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),r},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource("stores/movies.csv"),o=new dojox.data.KeyValueStore(t),r=new doh.Deferred;return o.fetchItemByIdentity({identity:"year",onItem:function(t){e.assertTrue(o.isItem(t)),e.assertEqual("key",o.getIdentityAttributes(t)),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),r},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource("stores/movies.csv"),o=new dojox.data.KeyValueStore(t),r=new doh.Deferred;return o.fetchItemByIdentity({identity:"year",onItem:function(t){e.assertTrue(o.isItem(t)),e.assertTrue(!o.isItem({})),e.assertTrue(!o.isItem({item:"not an item"})),e.assertTrue(!o.isItem("not an item")),e.assertTrue(!o.isItem(["not an item"])),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),r},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource("stores/movies.csv"),o=new dojox.data.KeyValueStore(t),r=new doh.Deferred;return o.fetchItemByIdentity({identity:"year",onItem:function(t){e.assertTrue(null!==t),e.assertTrue(o.hasAttribute(t,"key")),e.assertTrue(o.hasAttribute(t,"value")),e.assertTrue(o.hasAttribute(t,"year")),e.assertTrue(!o.hasAttribute(t,"Year")),e.assertTrue(!o.hasAttribute(t,"Nothing")),e.assertTrue(!o.hasAttribute(t,"Title"));var a=!1;try{o.hasAttribute(t,null)}catch(e){a=!0}e.assertTrue(a),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),r},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource("stores/movies.csv"),o=new dojox.data.KeyValueStore(t),r=new doh.Deferred;return o.fetchItemByIdentity({identity:"year",onItem:function(t){e.assertTrue(null!==t),e.assertTrue(o.containsValue(t,"year","2007")),e.assertTrue(o.containsValue(t,"value","2007")),e.assertTrue(o.containsValue(t,"key","year")),e.assertTrue(!o.containsValue(t,"Title","Alien2")),e.assertTrue(!o.containsValue(t,"Year","1979   ")),e.assertTrue(!o.containsValue(t,"Title",null));var a=!1;try{o.containsValue(t,null,"foo")}catch(e){a=!0}e.assertTrue(a),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),r},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource("stores/movies.csv"),o=new dojox.data.KeyValueStore(t),r=new doh.Deferred;return o.fetchItemByIdentity({identity:"year",onItem:function(t){e.assertTrue(null!==t),e.assertTrue(o.isItem(t));var a=o.getAttributes(t);e.is(3,a.length);for(var s=0;s<a.length;s++)e.assertTrue("year"===a[s]||"value"===a[s]||"key"===a[s]);r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),r},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource("stores/movies.csv"),o=new dojox.data.KeyValueStore(t),r=new doh.Deferred;return o.fetchItemByIdentity({identity:"nmonth",onItem:function(t){e.assertTrue(null!==t),e.assertTrue(o.isItem(t));var a=o.getAttributes(t);e.assertTrue(3===a.length),e.assertTrue("key"===a[0]),e.assertTrue("value"===a[1]),e.assertTrue("nmonth"===a[2]),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),r},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource("stores/movies.csv"),o=new dojox.data.KeyValueStore(t).getFeatures(),r=0;for(i in o)e.assertTrue("dojo.data.api.Read"===i||"dojo.data.api.Identity"===i),r++;e.assertTrue(2===r)},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource("stores/movies.csv"),o=new dojox.data.KeyValueStore(t),r=new doh.Deferred;return o.fetch({query:{key:"*month"},onComplete:function(t,a){e.is(2,t.length),e.assertTrue(dojox.data.tests.stores.KeyValueStore.verifyItems(o,t,"key",["nmonth","month"])),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),r},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource("stores/patterns.csv"),o=new dojox.data.KeyValueStore(t),r=new doh.Deferred;return o.fetch({query:{key:"*day"},onComplete:function(t,a){e.assertTrue(2===t.length),e.assertTrue(dojox.data.tests.stores.KeyValueStore.verifyItems(o,t,"value",["1","Saturday"])),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),r},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource("stores/patterns.csv"),o=new dojox.data.KeyValueStore(t),r=new doh.Deferred;return o.fetch({query:{value:"1*"},onComplete:function(t,a){e.is(2,t.length),e.assertTrue("12"===o.getValue(t[0],"value")),e.assertTrue("nmonth"===o.getValue(t[0],"key")),e.assertTrue("1"===o.getValue(t[1],"value")),e.assertTrue("nday"===o.getValue(t[1],"key")),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),r},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource("stores/patterns.csv"),o=new dojox.data.KeyValueStore(t),r=new doh.Deferred;return o.fetch({query:{key:"MONth"},queryOptions:{ignoreCase:!0},onComplete:function(t,a){e.is(1,t.length),e.assertTrue("December"===o.getValue(t[0],"value")),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),r},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource("stores/patterns.csv"),o=new dojox.data.KeyValueStore(t),r=new doh.Deferred;return o.fetch({query:{value:"DECEMberO"},queryOptions:{ignoreCase:!1},onComplete:function(t,o){e.is(0,t.length),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),r},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource("stores/patterns.csv"),o=new dojox.data.KeyValueStore(t),r=new doh.Deferred;return o.fetch({sort:[{attribute:"key"}],onComplete:function(t,a){e.is(7,t.length),e.assertTrue(dojox.data.tests.stores.KeyValueStore.verifyItems(o,t,"key",["day","dayOfYear","month","nday","nmonth","weekOfYear","year"])),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),r},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource("stores/patterns.csv"),o=new dojox.data.KeyValueStore(t),r=new doh.Deferred;return o.fetch({sort:[{attribute:"key",descending:!0}],onComplete:function(t,a){e.is(7,t.length),e.assertTrue(dojox.data.tests.stores.KeyValueStore.verifyItems(o,t,"key",["year","weekOfYear","nmonth","nday","month","dayOfYear","day"])),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),r},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource("stores/patterns.csv"),o=new dojox.data.KeyValueStore(t),r=new doh.Deferred;return o.fetch({sort:[{attribute:"key"},{attribute:"value",descending:!0}],onComplete:function(t,a){e.is(7,t.length),e.assertTrue(dojox.data.tests.stores.KeyValueStore.verifyItems(o,t,"key",["day","dayOfYear","month","nday","nmonth","weekOfYear","year"])),e.assertTrue(dojox.data.tests.stores.KeyValueStore.verifyItems(o,t,"value",["Saturday","335","December","1","12","48","2007"])),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),r},function(e){var t=dojox.data.tests.stores.KeyValueStore.getDatasource("stores/movies.csv"),o=new dojox.data.KeyValueStore(t);o.comparatorMap={},o.comparatorMap.key=function(e,t){var o=0;function r(e){if(void 0!==e)return e.slice(e.length-1)}var a=r(e),s=r(t);return a>s||void 0===a?o=1:(a<s||void 0===s)&&(o=-1),o};var r=new doh.Deferred;return o.fetch({sort:[{attribute:"key",descending:!0},{attribute:"value",descending:!0}],onComplete:function(t,a){var s=["day","nday","weekOfYear","dayOfYear","year","month","nmonth"];e.assertTrue(7===t.length);for(var n=!0,u=0;u<t.length;u++)if(o.getIdentity(t[u])!==s[u]){n=!1;break}e.assertTrue(n),r.callback(!0)},onError:dojo.partial(dojox.data.tests.stores.KeyValueStore.error,e,r)}),r},function(e){var t=new dojox.data.KeyValueStore(dojox.data.tests.stores.KeyValueStore.getDatasource("stores/movies.csv")),o=new dojo.data.api.Read,r=!0;for(i in o){if("_"!==i.toString().charAt(0))if("function"==typeof o[i]){console.log("Looking at function: ["+i+"]");var a=t[i];if("function"!=typeof a){console.log("Problem with function: ["+i+"].   Got value: "+a),r=!1;break}}}e.assertTrue(r)},function(e){var t=new dojox.data.KeyValueStore(dojox.data.tests.stores.KeyValueStore.getDatasource("stores/movies.csv")),o=new dojo.data.api.Identity,r=!0;for(i in o){if("_"!==i.toString().charAt(0))if("function"==typeof o[i])if(console.log("Looking at function: ["+i+"]"),"function"!=typeof t[i]){r=!1;break}}e.assertTrue(r)}]);
//# sourceMappingURL=../../../sourcemaps/data/tests/stores/KeyValueStore.js.map
