/**
 * dojox - A version of dojox.js framework that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/dojox/
 * @license MIT
 */
define(["dojo","dojox"],function(e,r){return e.declare("dojox.data.util.JsonQuery",null,{useFullIdInQueries:!1,_toJsonQuery:function(r,t){var n=!0,u=this;if(r.query&&"object"==typeof r.query){var o="[?(";!function t(i,y){var s=y.__id;if(s){var q={};q[u.idAttribute]=u.useFullIdInQueries?y.__id:y[u.idAttribute],y=q}for(var a in y){var c=y[a],f=i+(/^[a-zA-Z_][\w_]*$/.test(a)?"."+a:"["+e._escapeString(a)+"]");c&&"object"==typeof c?t(f,c):"*"!=c&&(o+=(n?"":"&")+f+(!s&&"string"==typeof c&&r.queryOptions&&r.queryOptions.ignoreCase?"~":"=")+(u.simplifiedQuery?encodeURIComponent(c):e.toJson(c)),n=!1)}}("@",r.query),n?o="":o+=")]",r.queryStr=o.replace(/\\"|"/g,function(e){return'"'==e?"'":e})}else r.query&&"*"!=r.query||(r.query="");var y=r.sort;if(y){for(r.queryStr=r.queryStr||("string"==typeof r.query?r.query:""),n=!0,i=0;i<y.length;i++)r.queryStr+=(n?"[":",")+(y[i].descending?"\\":"/")+"@["+e._escapeString(y[i].attribute)+"]",n=!1;r.queryStr+="]"}return t&&(r.start||r.count)&&(r.queryStr=(r.queryStr||("string"==typeof r.query?r.query:""))+"["+(r.start||"")+":"+(r.count?(r.start||0)+r.count:"")+"]"),"string"==typeof r.queryStr?(r.queryStr=r.queryStr.replace(/\\"|"/g,function(e){return'"'==e?"'":e}),r.queryStr):r.query},jsonQueryPagination:!0,fetch:function(e){return this._toJsonQuery(e,this.jsonQueryPagination),this.inherited(arguments)},isUpdateable:function(){return!0},matchesQuery:function(e,t){return t._jsonQuery=t._jsonQuery||r.json.query(this._toJsonQuery(t)),t._jsonQuery([e]).length},clientSideFetch:function(e,t){return e._jsonQuery=e._jsonQuery||r.json.query(this._toJsonQuery(e)),this.clientSidePaging(e,e._jsonQuery(t))},querySuperSet:function(e,r){return e.query?this.inherited(arguments):r.query}})});
//# sourceMappingURL=../../sourcemaps/data/util/JsonQuery.js.map
