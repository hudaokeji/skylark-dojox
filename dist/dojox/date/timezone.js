/**
 * dojox - A version of dojox.js framework that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/dojox/
 * @license MIT
 */
define(["dojo/_base/array","dojo/_base/config","dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","dojo/date","dojo/date/locale","dojo/request","dojo/request/handlers"],function(a,e,r,i,t,n,o,s,u){i.experimental("dojox.date.timezone");var c=1835,m=2038,f={},l={},d={},h={},A=e.timezoneLoadingScheme||"preloadAll",S=e.defaultZoneFile||("preloadAll"==A?["africa","antarctica","asia","australasia","backward","etcetera","europe","northamerica","pacificnew","southamerica"]:"northamerica");function p(a){a=a||{},l=t.mixin(l,a.zones||{}),h=t.mixin(h,a.rules||{})}function g(a){f[a]=!0,s.get(require.toUrl((e.timezoneFileBasePath||"dojox/date/zoneinfo")+"/"+a),{handleAs:"olson_zoneinfo",sync:!0}).then(p,function(a){throw console.error("Error loading zone file:",a),a})}u.register("olson_zoneinfo",function(a){for(var e=a.text.split("\n"),r=[],i=null,t=null,n={zones:{},rules:{}},o=0;o<e.length;o++){var s=e[o];if(s.match(/^\s/)&&(s="Zone "+i+s),(s=s.split("#")[0]).length>3)switch((r=s.split(/\s+/)).shift()){case"Zone":i=r.shift(),r[0]&&(n.zones[i]||(n.zones[i]=[]),n.zones[i].push(r));break;case"Rule":t=r.shift(),n.rules[t]||(n.rules[t]=[]),n.rules[t].push(r);break;case"Link":if(n.zones[r[1]])throw new Error("Error with Link "+r[1]);n.zones[r[1]]=r[0]}}return n});var z={jan:0,feb:1,mar:2,apr:3,may:4,jun:5,jul:6,aug:7,sep:8,oct:9,nov:10,dec:11},v={sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6},T={EST:"northamerica",MST:"northamerica",HST:"northamerica",EST5EDT:"northamerica",CST6CDT:"northamerica",MST7MDT:"northamerica",PST8PDT:"northamerica",America:"northamerica",Pacific:"australasia",Atlantic:"europe",Africa:"africa",Indian:"africa",Antarctica:"antarctica",Asia:"asia",Australia:"australasia",Europe:"europe",WET:"europe",CET:"europe",MET:"europe",EET:"europe"},b={"Pacific/Honolulu":"northamerica","Atlantic/Bermuda":"northamerica","Atlantic/Cape_Verde":"africa","Atlantic/St_Helena":"africa","Indian/Kerguelen":"antarctica","Indian/Chagos":"asia","Indian/Maldives":"asia","Indian/Christmas":"australasia","Indian/Cocos":"australasia","America/Danmarkshavn":"europe","America/Scoresbysund":"europe","America/Godthab":"europe","America/Thule":"europe","Asia/Yekaterinburg":"europe","Asia/Omsk":"europe","Asia/Novosibirsk":"europe","Asia/Krasnoyarsk":"europe","Asia/Irkutsk":"europe","Asia/Yakutsk":"europe","Asia/Vladivostok":"europe","Asia/Sakhalin":"europe","Asia/Magadan":"europe","Asia/Kamchatka":"europe","Asia/Anadyr":"europe","Africa/Ceuta":"europe","America/Argentina/Buenos_Aires":"southamerica","America/Argentina/Cordoba":"southamerica","America/Argentina/Tucuman":"southamerica","America/Argentina/La_Rioja":"southamerica","America/Argentina/San_Juan":"southamerica","America/Argentina/Jujuy":"southamerica","America/Argentina/Catamarca":"southamerica","America/Argentina/Mendoza":"southamerica","America/Argentina/Rio_Gallegos":"southamerica","America/Argentina/Ushuaia":"southamerica","America/Aruba":"southamerica","America/La_Paz":"southamerica","America/Noronha":"southamerica","America/Belem":"southamerica","America/Fortaleza":"southamerica","America/Recife":"southamerica","America/Araguaina":"southamerica","America/Maceio":"southamerica","America/Bahia":"southamerica","America/Sao_Paulo":"southamerica","America/Campo_Grande":"southamerica","America/Cuiaba":"southamerica","America/Porto_Velho":"southamerica","America/Boa_Vista":"southamerica","America/Manaus":"southamerica","America/Eirunepe":"southamerica","America/Rio_Branco":"southamerica","America/Santiago":"southamerica","Pacific/Easter":"southamerica","America/Bogota":"southamerica","America/Curacao":"southamerica","America/Guayaquil":"southamerica","Pacific/Galapagos":"southamerica","Atlantic/Stanley":"southamerica","America/Cayenne":"southamerica","America/Guyana":"southamerica","America/Asuncion":"southamerica","America/Lima":"southamerica","Atlantic/South_Georgia":"southamerica","America/Paramaribo":"southamerica","America/Port_of_Spain":"southamerica","America/Montevideo":"southamerica","America/Caracas":"southamerica"},w={US:"S",Chatham:"S",NZ:"S",NT_YK:"S",Edm:"S",Salv:"S",Canada:"S",StJohns:"S",TC:"S",Guat:"S",Mexico:"S",Haiti:"S",Barb:"S",Belize:"S",CR:"S",Moncton:"S",Swift:"S",Hond:"S",Thule:"S",NZAQ:"S",Zion:"S",ROK:"S",PRC:"S",Taiwan:"S",Ghana:"GMT",SL:"WAT",Chicago:"S",Detroit:"S",Vanc:"S",Denver:"S",Halifax:"S",Cuba:"S",Indianapolis:"S",Starke:"S",Marengo:"S",Pike:"S",Perry:"S",Vincennes:"S",Pulaski:"S",Louisville:"S",CA:"S",Nic:"S",Menominee:"S",Mont:"S",Bahamas:"S",NYC:"S",Regina:"S",Resolute:"ES",DR:"S",Toronto:"S",Winn:"S"};function C(a){throw new Error('Timezone "'+a+'" is either incorrect, or not loaded in the timezone registry.')}function _(a){var e=a.match(/(\d+)(?::0*(\d*))?(?::0*(\d*))?([su])?$/);return e?(e[1]=parseInt(e[1],10),e[2]=e[2]?parseInt(e[2],10):0,e[3]=e[3]?parseInt(e[3],10):0,e):null}function I(a,e,r,i,t,n,o){return Date.UTC(a,e,r,i,t,n)+60*(o||0)*1e3}function k(a){return z[a.substr(0,3).toLowerCase()]}function y(a){var e=_(a);return null===e?0:-(e=(0===a.indexOf("-")?-1:1)*(1e3*(60*(60*e[1]+e[2])+e[3])))/60/1e3}function D(a,e,r){var i,t,o,s=k(a[3]),u=a[4],c=_(a[5]);if("u"==c[4]&&(r=0),!isNaN(u))return i=new Date(I(e,s,parseInt(u,10),c[1],c[2],c[3],r));if("last"==u.substr(0,4))return u=v[u.substr(4,3).toLowerCase()],i=new Date(I(e,s+1,1,c[1]-24,c[2],c[3],r)),0!==(o=u>(t=n.add(i,"minute",-r).getUTCDay())?u-t-7:u-t)&&(i=n.add(i,"hour",24*o)),i;if("undefined"!=(u=v[u.substr(0,3).toLowerCase()])){if(">="==a[4].substr(3,2))return i=new Date(I(e,s,parseInt(a[4].substr(5),10),c[1],c[2],c[3],r)),0!==(o=u<(t=n.add(i,"minute",-r).getUTCDay())?u-t+7:u-t)&&(i=n.add(i,"hour",24*o)),i;if("<="==u.substr(3,2))return i=new Date(I(e,s,parseInt(a[4].substr(5),10),c[1],c[2],c[3],r)),0!==(o=u>(t=n.add(i,"minute",-r).getUTCDay())?u-t-7:u-t)&&(i=n.add(i,"hour",24*o)),i}return null}function x(e,r){var i=[];return a.forEach(h[e[1]]||[],function(a){for(var t=0;t<2;t++)switch(a[t]){case"min":a[t]=c;break;case"max":a[t]=m;break;case"only":break;default:if(a[t]=parseInt(a[t],10),isNaN(a[t]))throw new Error("Invalid year found on rule")}"string"==typeof a[6]&&(a[6]=y(a[6])),(a[0]<=r&&a[1]>=r||a[0]==r&&"only"==a[1])&&i.push({r:a,d:D(a,r,e[0])})}),i}function E(e,r){for(var i=r,t=l[i];"string"==typeof t;)t=l[i=t];if(!t){if(!f.backward){g("backward");return E(e,r)}C(i)}d[r]||function(e,r){for(var i=d[e]=[],t=0;t<r.length;t++){var o=r[t],s=i[t]=[],u=null,f=null,l=[];"string"==typeof o[0]&&(o[0]=y(o[0])),0===t?s[0]=Date.UTC(c,0,1,0,0,0,0):(s[0]=i[t-1][1],u=r[t-1],l=(f=i[t-1])[2]);var h,A,S=new Date(s[0]).getUTCFullYear(),p=o[3]?parseInt(o[3],10):m,g=[];for(h=S;h<=p;h++)g=g.concat(x(o,h));for(g.sort(function(a,e){return n.compare(a.d,e.d)}),h=0;A=g[h];h++){var z=h>0?g[h-1]:null;A.r[5].indexOf("u")<0&&A.r[5].indexOf("s")<0&&(0===h&&t>0?l.length?A.d=n.add(A.d,"minute",l[l.length-1].r[6]):0===n.compare(new Date(f[1]),A.d,"date")?A.d=new Date(f[1]):A.d=n.add(A.d,"minute",y(u[1])):h>0&&(A.d=n.add(A.d,"minute",z.r[6])))}if(s[2]=g,o[3]){var v=parseInt(o[3],10),T=k(o[4]||"Jan"),b=parseInt(o[5]||"1",10),w=_(o[6]||"0"),C=s[1]=I(v,T,b,w[1],w[2],w[3],"u"==w[4]?0:o[0]);isNaN(C)&&(C=s[1]=D([0,0,0,o[4],o[5],o[6]||"0"],v,"u"==w[4]?0:o[0]).getTime());var E=a.filter(g,function(a,e){var r=e>0?60*g[e-1].r[6]*1e3:0;return a.d.getTime()<C+r});"u"!=w[4]&&"s"!=w[4]&&(E.length?s[1]+=60*E[E.length-1].r[6]*1e3:s[1]+=60*y(o[1])*1e3)}else s[1]=Date.UTC(m,11,31,23,59,59,999)}}(r,t);for(var o,s=d[r],u=e.getTime(),h=0;o=s[h];h++)if(u>=o[0]&&u<o[1])return{zone:t[h],range:s[h],idx:h};throw new Error('No Zone found for "'+r+'" on '+e)}t.setObject("dojox.date.timezone",{getTzInfo:function(a,e){if("lazyLoad"==A){var r=function a(e){var r=b[e];if(!r){var i=e.split("/")[0];if(!(r=T[i])){var t=l[e];if("string"==typeof t)return a(t);if(!f.backward)return g("backward"),a(e);C(e)}}return r}(e);if(!r)throw new Error("Not a valid timezone ID.");f[r]||g(r)}var i=E(a,e),t=i.zone[0],n=function(a,e){for(var r,i=-1,t=e.range[2]||[],n=a.getTime(),o=(e.range,0);r=t[o];o++)n>=r.d.getTime()&&(i=o);return i>=0?t[i].r:null}(a,i);return n?t+=n[6]:h[i.zone[1]]&&i.idx>0?t+=y(l[e][i.idx-1][1]):t+=y(i.zone[1]),{tzOffset:t,tzAbbr:function(a,e,r){var i,t=e.zone,n=t[2];if(n.indexOf("%s")>-1){var o;if(r)"-"==(o=r[7])&&(o="");else if(t[1]in w)o=w[t[1]];else if(e.idx>0){var s=l[a][e.idx-1][2];o=s.indexOf("%s")<0&&n.replace("%s","S")==s?"S":""}else o="";i=n.replace("%s",o)}else if(n.indexOf("/")>-1){var u=n.split("/");i=r?u[0===r[6]?0:1]:u[0]}else i=n;return i}(e,i,n)}},loadZoneData:function(a){p(a)},getAllZones:function(){var a=[];for(var e in l)a.push(e);return a.sort(),a}}),"string"==typeof S&&S&&(S=[S]),S instanceof Array&&a.forEach(S,g);var j=o.format,M=o._getZone;return o.format=function(a,e){if((e=e||{}).timezone&&!e._tzInfo&&(e._tzInfo=dojox.date.timezone.getTzInfo(a,e.timezone)),e._tzInfo){var r=a.getTimezoneOffset()-e._tzInfo.tzOffset;a=new Date(a.getTime()+60*r*1e3)}return j.call(this,a,e)},o._getZone=function(a,e,r){return r._tzInfo?e?r._tzInfo.tzAbbr:r._tzInfo.tzOffset:M.call(this,a,e,r)},dojox.date.timezone});
//# sourceMappingURL=../sourcemaps/date/timezone.js.map
