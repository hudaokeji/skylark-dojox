/**
 * dojox - A version of dojox.js framework that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/dojox/
 * @license MIT
 */
define(["dojo/_base/kernel","./entities","dojo/_base/array","dojo/_base/window","dojo/_base/sniff"],function(e,n,r,t,i){var a=e.getObject("dojox.html.format",!0);return a.prettyPrint=function(a,s,o,u,c){var f,p=[],l=0,h=[],g="\t",d="",v=[],m=/[=]([^"']+?)(\s|>)/g,b=/style=("[^"]*"|'[^']*'|\S*)/gi,j=/[\w-]+=("[^"]*"|'[^']*'|\S*)/gi;if(s&&s>0&&s<10)for(g="",f=0;f<s;f++)g+=" ";var T=t.doc.createElement("div");T.innerHTML=a;var w=n.encode,x=n.decode,L=T.ownerDocument.createElement("div"),y=function(){var e;for(e=0;e<l;e++)p.push(g)},A=function(){p.push("\n")},O=function(e){d+=w(e.nodeValue,u)},H=function(n){var r,t,i=n.split("\n");for(r=0;r<i.length;r++)i[r]=e.trim(i[r]);if(n=i.join(" "),""!==(n=e.trim(n))){var a=[];if(o&&o>0){var s=function(){var e,n="";for(e=0;e<l;e++)n+=g;return n.length}(),u=o;for(o>s&&(u-=s);n;)if(n.length>o){for(r=u;r>0&&" "!==n.charAt(r);r--);if(!r)for(r=u;r<n.length&&" "!==n.charAt(r);r++);var c=n.substring(0,r);if(c=e.trim(c),n=e.trim(n.substring(r==n.length?n.length:r+1,n.length)),c){for(t="",r=0;r<l;r++)t+=g;c=t+c+"\n"}a.push(c)}else{for(t="",r=0;r<l;r++)t+=g;n=t+n+"\n",a.push(n),n=null}return a.join("")}for(t="",r=0;r<l;r++)t+=g;return n=t+n+"\n"}return""},M=function(n){if(n){var r,t,i,a,s=0,o=(n=function(e){return e&&(e=(e=(e=(e=e.replace(/&quot;/gi,'"')).replace(/&gt;/gi,">")).replace(/&lt;/gi,"<")).replace(/&amp;/gi,"&")),e}(n)).split("\n"),u=[];for(r=0;r<o.length;r++){var c=o[r],f=c.indexOf("\n")>-1;if(c=e.trim(c)){var p=s;for(i=0;i<c.length;i++){var h=c.charAt(i);"{"===h?s++:"}"===h&&(p=--s)}for(a="",t=0;t<l+p;t++)a+=g;u.push(a+c+"\n")}else f&&0===r&&u.push("\n")}n=u.join("")}return n},N=function(n){var t=n.nodeName.toLowerCase(),i=e.trim(function(e){var n=e.cloneNode(!1);L.appendChild(n);var r=L.innerHTML;return L.innerHTML="",r}(n)),a=i.substring(0,i.indexOf(">")+1),s=[];a=(a=(a=a.replace(m,'="$1"$2')).replace(b,function(n){var t=n.substring(0,6),i=n.substring(6,n.length),a=i.charAt(0);i=(i=e.trim(i.substring(1,i.length-1))).split(";");var s=[];r.forEach(i,function(n){(n=e.trim(n))&&(n=n.substring(0,n.indexOf(":")).toLowerCase()+n.substring(n.indexOf(":"),n.length),s.push(n))}),i=(s=s.sort()).join("; ");var o=e.trim(i);return o&&";"!==o?t+a+(i+=";")+a:""})).replace(j,function(n){return s.push(e.trim(n)),""}),a="<"+t,(s=s.sort()).length&&(a+=" "+s.join(" ")),-1!=i.indexOf("</")?(h.push(t),a+=">"):(a+=c?" />":">",h.push(!1));var o=function(e){switch(e){case"a":case"b":case"strong":case"s":case"strike":case"i":case"u":case"em":case"sup":case"sub":case"span":case"font":case"big":case"cite":case"q":case"small":return!0;default:return!1}}(t);v.push(o),d&&!o&&(p.push(H(d)),d=""),o?d+=a:(y(),p.push(a),A(),l++)},C=function(){var e=v.pop();d&&!e&&(p.push(H(d)),d="");var n=h.pop();n?(n="</"+n+">",e?d+=n:(l--,y(),p.push(n),A())):l--},_=function(e){var n=x(e.nodeValue,u);y(),p.push("\x3c!--"),A(),l++,p.push(H(n)),l--,y(),p.push("--\x3e"),A()},E=function(n){var r,t=n.childNodes;if(t)for(r=0;r<t.length;r++){var a=t[r];if(1===a.nodeType){var s=e.trim(a.tagName.toLowerCase());if(i("ie")&&a.parentNode!=n)continue;if(s&&"/"===s.charAt(0))continue;if(N(a),"script"===s)p.push(M(a.innerHTML));else if("pre"===s){var o=a.innerHTML;i("mozilla")&&(o=(o=(o=o.replace("<br>","\n")).replace("<pre>","")).replace("</pre>","")),"\n"!==o.charAt(o.length-1)&&(o+="\n"),p.push(o)}else E(a);C()}else 3===a.nodeType||4===a.nodeType?O(a):8===a.nodeType&&_(a)}};return E(T),d&&(p.push(H(d)),d=""),p.join("")},a});
//# sourceMappingURL=../sourcemaps/html/format.js.map
