/**
 * dojox - A version of dojox.js framework that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/dojox/
 * @license MIT
 */
define(["./_base","dojo/_base/lang","dojo/_base/sniff","dojo/dom","dojo/_base/html","dojo/_base/array","./utils","./shape","./path","dojox/string/BidiEngine"],function(t,e,r,i,n,a,s,o,x,u){switch(e.getObject("dojox.gfx._gfxBidiSupport",!0),t.renderer){case"vml":t.isVml=!0;break;case"svg":t.isSvg=!0,t.svg.useSvgWeb&&(t.isSvgWeb=!0);break;case"silverlight":t.isSilverlight=!0;break;case"canvas":case"canvasWithEvents":t.isCanvas=!0}var f="‎",l="‪",c="‬",N="‏",h="‫",d=new u;e.extend(t.shape.Surface,{textDir:"",setTextDir:function(t){p(this,t)},getTextDir:function(){return this.textDir}}),e.extend(t.Group,{textDir:"",setTextDir:function(t){p(this,t)},getTextDir:function(){return this.textDir}}),e.extend(t.Text,{textDir:"",formatText:function(e,i){if(i&&e&&e.length>1){var n=i;if("auto"==n){if(t.isVml)return e;n=d.checkContextual(e)}if(t.isVml)return n!=d.checkContextual(e)?"rtl"==n?d.hasBidiChar(e)?N+N+e:d.bidiTransform(e,"IRNNN","ILNNN"):f+e:e;if(t.isSvgWeb)return"rtl"==n?d.bidiTransform(e,"IRNNN","ILNNN"):e;if(t.isSilverlight)return"rtl"==n?d.bidiTransform(e,"IRNNN","VLYNN"):d.bidiTransform(e,"ILNNN","VLYNN");if(t.isCanvas)return"rtl"==n?h+e+c:l+e+c;if(t.isSvg)return r("ff")<4?"rtl"==n?d.bidiTransform(e,"IRYNN","VLNNN"):d.bidiTransform(e,"ILYNN","VLNNN"):f+("rtl"==n?h:l)+e+c}return e},bidiPreprocess:function(t){return t}}),e.extend(t.TextPath,{textDir:"",formatText:function(e,i){if(i&&e&&e.length>1){var n=i;if("auto"==n){if(t.isVml)return e;n=d.checkContextual(e)}if(t.isVml)return n!=d.checkContextual(e)?"rtl"==n?d.hasBidiChar(e)?N+N+e:d.bidiTransform(e,"IRNNN","ILNNN"):f+e:e;if(t.isSvgWeb)return"rtl"==n?d.bidiTransform(e,"IRNNN","ILNNN"):e;t.isSvg&&(e=r("opera")||r("ff")>=4?f+("rtl"==n?h:l)+e+c:"rtl"==n?d.bidiTransform(e,"IRYNN","VLNNN"):d.bidiTransform(e,"ILYNN","VLNNN"))}return e},bidiPreprocess:function(t){return t&&"string"==typeof t&&(this.origText=t,t=this.formatText(t,this.textDir)),t}});var T=function(t,e,r,i){var n=t.prototype[e];t.prototype[e]=function(){var t;r&&(t=r.apply(this,arguments));var e=n.call(this,t);return i&&(e=i.call(this,e,arguments)),e}},v=function(t){return t&&(t.textDir&&(t.textDir=m(t.textDir)),t.text&&t.text instanceof Array&&(t.text=t.text.join(","))),!t||void 0==t.text&&!t.textDir||this.textDir==t.textDir&&t.text==this.origText||(this.origText=void 0!=t.text?t.text:this.origText,t.textDir&&(this.textDir=t.textDir),t.text=this.formatText(this.origText,this.textDir)),this.bidiPreprocess(t)};T(t.Text,"setShape",v,null),T(t.TextPath,"setText",v,null);var g=function(t){var r=e.clone(t);return r&&this.origText&&(r.text=this.origText),r};T(t.Text,"getShape",null,g),T(t.TextPath,"getText",null,g);var D=function(t,e){var r;return e&&e[0]&&(r=m(e[0])),t.setTextDir(r||this.textDir),t};T(t.Surface,"createGroup",null,D),T(t.Group,"createGroup",null,D);var b=function(t){if(t){var e=t.textDir?m(t.textDir):this.textDir;e&&(t.textDir=e)}return t};function p(e,r){var i=m(r);return i&&t.utils.forEach(e,function(e){(e instanceof t.Surface||e instanceof t.Group)&&(e.textDir=i),e instanceof t.Text&&e.setShape({textDir:i}),e instanceof t.TextPath&&e.setText({textDir:i})},e),e}function m(t){return t&&(t=t.toLowerCase(),a.indexOf(["ltr","rtl","auto"],t)<0)?null:t}return T(t.Surface,"createText",b,null),T(t.Surface,"createTextPath",b,null),T(t.Group,"createText",b,null),T(t.Group,"createTextPath",b,null),t.createSurface=function(e,r,a,s){var o=t[t.renderer].createSurface(e,r,a),x=m(s);return t.isSvgWeb?(o.textDir=x||n.style(i.byId(e),"direction"),o):((t.isVml||t.isSvg||t.isCanvas)&&(o.textDir=x||n.style(o.rawNode,"direction")),t.isSilverlight&&(o.textDir=x||n.style(o._nodes[1],"direction")),o)},t});
//# sourceMappingURL=../sourcemaps/gfx/_gfxBidiSupport.js.map
