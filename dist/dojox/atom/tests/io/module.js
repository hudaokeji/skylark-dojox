/**
 * dojox - A version of dojox.js framework that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/dojox/
 * @license MIT
 */
dojo.provide("dojox.atom.tests.io.module"),dojo.require("dojox.atom.io.model"),dojo.require("dojox.atom.io.Connection"),dojo.require("dojox.data.dom"),dojo.require("dojo.date.stamp"),dojo.require("dojo.date"),doh.register("dojox.atom.tests.io.module",[function(e){var t=document.createElement("div"),o=dojo.date.stamp.fromISOString("2007-08-06T20:00:00-04:00");t.innerHTML="  2007-08-06T20:00:00-04:00  ";var n=dojox.atom.io.model.util.createDate(t),a=dojo.date.compare(n,o);e.t(0===a)},function(e){var t=dojox.atom.io.model.util.escapeHtml('<html><head><title>This is a "Test Title"</title></head><body class="tundra">Woo hoo, this is an awesome & exciting test case!</body></html>');e.is("&lt;html&gt;&lt;head&gt;&lt;title&gt;This is a &quot;Test Title&quot;&lt;/title&gt;&lt;/head&gt;&lt;body class=&quot;tundra&quot;&gt;Woo hoo, this is an awesome &amp; exciting test case!&lt;/body&gt;&lt;/html&gt;",t)},function(e){var t=dojox.atom.io.model.util.unEscapeHtml("&lt;html&gt;&lt;head&gt;&lt;title&gt;This is a &quot;Test Title&quot;&lt;/title&gt;&lt;/head&gt;&lt;body class=&quot;tundra&quot;&gt;Woo hoo, this is an awesome &amp; exciting test case!&lt;/body&gt;&lt;/html&gt;");e.is('<html><head><title>This is a "Test Title"</title></head><body class="tundra">Woo hoo, this is an awesome & exciting test case!</body></html>',t),e.is("&lt;",dojox.atom.io.model.util.unEscapeHtml("&amp;lt;"))},function(e){var t=document.createElement("div");e.is("div",dojox.atom.io.model.util.getNodename(t).toLowerCase()),t=dojox.data.dom.createDocument("<root><first/><second/><third/></root>").firstChild,e.is("root",dojox.atom.io.model.util.getNodename(t));var o=t.firstChild;dojo.forEach(["first","second","third"],function(n){e.is(n,dojox.atom.io.model.util.getNodename(o)),t.removeChild(o),o=t.firstChild})},{name:"checkFeed",runTest:function(e){var t=new doh.Deferred;return(new dojox.atom.io.Connection).getFeed(dojo.moduleUrl("dojox.atom.tests.widget","samplefeed.xml").toString(),function(o){var n;e.is("Example.com",o.title.value),o.setTitle("Example.com Atom Feed","text"),e.is("Example.com Atom Feed",o.title.value),e.is("Example.com's Sample Feed",o.subtitle.value),e.is("Copyright Example.com",o.rights),e.is("http://example.com/samplefeed.xml",o.id),e.is(dojo.date.stamp.fromISOString("2007-08-07T20:00:00-05:00"),o.updated),o.addNamespace("http://www.test.com"),e.is({},o.name_spaces),o.addNamespace("","test"),e.is({},o.name_spaces),o.addNamespace("http://www.test.com","test"),e.is({test:"http://www.test.com"},o.name_spaces),e.is(null,o.authors),o.addAuthor("John"),o.addAuthor("Matt","matt@example.com"),o.addAuthor("Joe","joe@example.com","http://joe.example.com"),e.t(dojo.isArray(o.authors)),e.t(3===o.authors.length),e.is(null,o.contributors),o.addContributor("Sam"),o.addContributor("Dave","Dave@example.com"),o.addContributor("Harry","harry@example.com","http://harry.example.com"),e.t(dojo.isArray(o.contributors)),e.t(3===o.contributors.length),e.t(dojo.isArray(o.links)),e.t(2===o.links.length),o.removeLink("http://example.com/","alternate"),e.t(1===o.links.length),o.addLink("http://www.example.com/","alternate","en","Example.com","text/html"),e.t(2===o.links.length),o.addLink("http://test.example.com/","","en","Example.com","text/html"),e.t(3===o.links.length),o.removeBasicLinks(),e.t(2===o.links.length),e.is(null,o.categories),o.addCategory("scheme","term","label"),o.addCategory("scheme","term2","label2"),o.addCategory("scheme2","term","label"),e.t(dojo.isArray(o.categories)),e.t(3===o.categories.length);var a=o.getCategories("scheme");e.t(2===a.length),a=o.getCategories("scheme2"),e.t(1===a.length),o.removeCategories("scheme","term2"),e.t(2===o.categories.length),o.removeCategories("scheme","term"),e.t(1===o.categories.length),o.removeCategories("scheme2","term"),e.t(0===o.categories.length),e.is(null,o.extensions),e.is([],o.getExtensions()),o.addExtension("nameSpace","element",[],"A Test Element","sns"),o.addExtension("nameSpace","element2",[],"Another Test Element","sns"),o.addExtension("anotherNameSpace","element",[],"A Test Element","asns"),e.t(3===o.extensions.length),e.t(2===o.getExtensions("nameSpace").length),e.t(1===o.getExtensions("nameSpace","element").length),e.t(1===o.getExtensions("anotherNameSpace","element").length),e.t(2===o.getExtensions("sns").length),o.removeExtensions("anotherNameSpace","element"),o.removeExtensions("sns","element2"),e.t(0===o.getExtensions("anotherNameSpace").length),e.t(1===o.getExtensions("sns").length),e.t(o.accept("title")),e.t(o.accept("entry")),e.f(o.accept("workspace"));var r=o.getFirstEntry();e.f(null===r),e.t("http://example.com/samplefeed.xml/entry/1"===r.id),e.t(6===o.entries.length),o.removeEntry(r),e.t(5===o.entries.length),e.t(null===o.getEntry("http://example.com/samplefeed.xml/entry/1")),r=o.getFirstEntry(),e.t("http://example.com/samplefeed.xml/entry/2"===r.id),r=o.getEntry("http://example.com/samplefeed.xml/entry/4"),e.f(null===r),e.t("Test Entry #4"===r.title.value),r=new dojox.atom.io.model.Entry,e.e(Error,o,"addEntry",[r]),e.t(5===o.entries.length),r.id="http://example.com/samplefeed.xml/newentry/1",o.addEntry(r),e.t(6===o.entries.length);var l=[];for(n=2;n<5;n++)(r=new dojox.atom.io.model.Entry).id="http://example.com/samplefeed.xml/newentry/"+n,l.push(r);for(o.setEntries(l),e.t(9===o.entries.length),r=o.getSelfHref(),e.t("http://www.example.com/samplefeed.xml"===r),r=o.createEntry(),e.t("http://www.example.com/samplefeed.xml"===r.feedUrl),n=2;n<7;n++)r=o.getEntry("http://example.com/samplefeed.xml/entry/"+n),o.removeEntry(r);e.t(4===o.entries.length);var i='<?xml version="1.0" encoding="utf-8"?>\n<feed xmlns="http://www.w3.org/2005/Atom" xmlns:test="http://www.test.com">\n<id>http://example.com/samplefeed.xml</id>\n<title  type="text" >Example.com Atom Feed</title>\n<rights>Copyright Example.com</rights>\n';i+="<updated>"+dojo.date.stamp.toISOString(dojo.date.stamp.fromISOString("2007-08-07T20:00:00-05:00"))+"</updated>\n<subtitle  type=\"text\" >Example.com's Sample Feed</subtitle>\n<author>\n\t<name>John</name>\n</author>\n<author>\n\t<name>Matt</name>\n\t<email>matt@example.com</email>\n</author>\n<author>\n\t<name>Joe</name>\n\t<email>joe@example.com</email>\n\t<uri>http://joe.example.com</uri>\n</author>\n<contributor>\n\t<name>Sam</name>\n</contributor>\n<contributor>\n\t<name>Dave</name>\n\t<email>Dave@example.com</email>\n</contributor>\n<contributor>\n\t<name>Harry</name>\n\t<email>harry@example.com</email>\n\t<uri>http://harry.example.com</uri>\n</contributor>\n<sns:element xmlns='nameSpace'>A Test Element</sns:element>\n<entry>\n<id>http://example.com/samplefeed.xml/newentry/1</id>\n</entry>\n<entry>\n<id>http://example.com/samplefeed.xml/newentry/2</id>\n</entry>\n<entry>\n<id>http://example.com/samplefeed.xml/newentry/3</id>\n</entry>\n<entry>\n<id>http://example.com/samplefeed.xml/newentry/4</id>\n</entry>\n</feed>",e.t(o.toString()==i),t.callback(!0)},function(e){console.debug(e),t.errback("Feed fetching failed")}),t}},{name:"checkEntry",runTest:function(e){var t=new doh.Deferred;return(new dojox.atom.io.Connection).getFeed(dojo.moduleUrl("dojox.atom.tests.widget","samplefeedEdit.xml").toString(),function(o){e.is("Example.com",o.title.value);var n=o.createEntry(),a=n.getEditHref();e.t(null===a),a=(n=o.getFirstEntry()).getEditHref(),e.t(null===a),a=(n=o.getEntry("http://example.com/samplefeedEdit.xml/entry/10")).getEditHref(),e.t("http://example.com/samplefeedEdit.xml/entry/edit/10"===a),t.callback(!0)},function(){t.errback("Feed fetching failed")}),t}},{name:"checkXmlEntry",runTest:function(e){var t=new doh.Deferred;return(new dojox.atom.io.Connection).getFeed(dojo.moduleUrl("dojox.atom.tests.io","sampleFeedXMLContent.xml"),function(o){try{e.is("Example.com",o.title.value);var n=o.getFirstEntry();e.t("Test Entry #1"==n.title.value);var a=n.content.value;a=dojo.trim(a),e.t(0===a.indexOf("<rootNode ")),t.callback(!0)}catch(e){t.errback(e)}},function(){t.errback("Feed fetching failed")}),t}},{name:"checkEntry_preventCache",runTest:function(e){var t=new doh.Deferred;return new dojox.atom.io.Connection(!1,!0).getFeed(dojo.moduleUrl("dojox.atom.tests.widget","samplefeedEdit.xml").toString(),function(o){e.is("Example.com",o.title.value);var n=o.createEntry(),a=n.getEditHref();e.t(null===a),a=(n=o.getFirstEntry()).getEditHref(),e.t(null===a),a=(n=o.getEntry("http://example.com/samplefeedEdit.xml/entry/10")).getEditHref(),e.t("http://example.com/samplefeedEdit.xml/entry/edit/10"===a),t.callback(!0)},function(){t.errback("Feed fetching failed")}),t}},{name:"checkAtomIOGetFeedFail",runTest:function(e){var t=new doh.Deferred;return(new dojox.atom.io.Connection).getFeed(dojo.moduleUrl("dojox.atom.tests.widget","samplefee.xml").toString(),function(e){t.errback("Feed fetching succeeded when it should've failed")},function(o,n){e.t("Error"===o.name),e.t(404===o.status),t.callback(!0)}),t}},{name:"checkAtomIOGetFeedSuccess",runTest:function(e){var t=new doh.Deferred;return(new dojox.atom.io.Connection).getFeed(dojo.moduleUrl("dojox.atom.tests.widget","samplefeed.xml").toString(),function(o){e.t("Example.com"===o.title.value),t.callback(!0)},function(e,o){t.errback("Feed fetching failed")}),t}},{name:"checkAtomIOGetEntryFail",runTest:function(e){var t=new doh.Deferred;return(new dojox.atom.io.Connection).getEntry(dojo.moduleUrl("dojox.atom.tests.io","sampleEntr.xml").toString(),function(e){t.errback("Feed fetching succeeded when it should've failed")},function(o,n){e.t("Error"===o.name),e.t(404===o.status),t.callback(!0)}),t}},{name:"checkAtomIOGetEntrySuccess",runTest:function(e){var t=new doh.Deferred;return(new dojox.atom.io.Connection).getEntry(dojo.moduleUrl("dojox.atom.tests.io","sampleEntry.xml").toString(),function(o){e.t("Test Entry #1"===o.title.value),e.t("http://example.com/sampleEntry.xml/entry/1"===o.id),t.callback(!0)},function(e,o){t.errback("Feed fetching failed")}),t}},{name:"checkAtomIOGetEntryFeedSuccess",runTest:function(e){var t=new doh.Deferred;return(new dojox.atom.io.Connection).getEntry(dojo.moduleUrl("dojox.atom.tests.widget","samplefeed.xml").toString(),function(o){e.t("Test Entry #1"===o.title.value),e.t("http://example.com/samplefeed.xml/entry/1"===o.id),t.callback(!0)},function(e,o){t.errback("Feed fetching failed")}),t}},{name:"checkGetService",runTest:function(e){var t=new doh.Deferred;return(new dojox.atom.io.Connection).getService(dojo.moduleUrl("dojox.atom.tests.io","service.xml").toString(),function(o,n){var a=o.getCollection("http://example.com/feed");e.t("http://example.com/feed"===a[0].href),e.t("Test Collection"===a[0].title),t.callback(!0)},function(e,o){t.errback("Service fetching failed")}),t}},{name:"checkAtomIOUpdateEntrySuccess",timeout:5e3,runTest:function(e){var t=new doh.Deferred,o=new dojox.atom.io.Connection;return o.getEntry(dojo.moduleUrl("dojox.atom.tests.widget","samplefeed.xml").toString(),function(n){e.t("Test Entry #1"===n.title.value),e.t("http://example.com/samplefeed.xml/entry/1"===n.id),n.setEditHref(dojo.moduleUrl("dojox.atom.tests.io","app.php")),n.setTitle("<h1>New Editable Title!</h1>","xhtml"),o.updateEntry(n,function(o,n,a){e.t("<h1>New Editable Title!</h1>"===o.title.value),e.t("http://example.com/samplefeed.xml/entry/1"===o.id),t.callback(!0)},function(e,o){t.errback("Updating entry failed")})},function(e,o){t.errback("Feed fetching failed")}),t}},{name:"checkAtomIOUpdateEntryFail",timeout:5e3,runTest:function(e){var t=new doh.Deferred,o=new dojox.atom.io.Connection;return o.getEntry(dojo.moduleUrl("dojox.atom.tests.widget","samplefeed.xml").toString(),function(n){e.t("Test Entry #1"===n.title.value),e.t("http://example.com/samplefeed.xml/entry/1"===n.id),n.setEditHref(dojo.moduleUrl("dojox.atom.tests.io","appFail.php")),n.setTitle("<h1>New Editable Title!</h1>","xhtml"),o.updateEntry(n,function(e,o,n){t.errback("Updating entry succeeded")},function(e,o){t.callback(!0)})},function(e,o){t.errback("Updating entry failed.")}),t}},{name:"checkAtomIOAddEntrySuccess",timeout:5e3,runTest:function(e){var t=new doh.Deferred,o=new dojox.atom.io.model.Entry;return o.setTitle("Test Editable Entry #1","text"),o.addAuthor("Test Person","test@example.com"),o.content=new dojox.atom.io.model.Content("content","This is the content of my test new entry!",null,"text"),(new dojox.atom.io.Connection).addEntry(o,dojo.moduleUrl("dojox.atom.tests.io","app.php").toString(),function(o,n){e.t("Test Editable Entry #1"===o.title.value),e.t("http://example.com/samplefeed.xml/entry/10"===n),t.callback(!0)},function(e,o){t.errback("Adding entry failed.")}),t}},{name:"checkAtomIOAddEntryFail",timeout:5e3,runTest:function(e){var t=new doh.Deferred,o=new dojox.atom.io.model.Entry;return o.content=new dojox.atom.io.model.Content("content","This is the content of my test new entry!",null,"text"),(new dojox.atom.io.Connection).addEntry(o,dojo.moduleUrl("dojox.atom.tests.io","appFail.php").toString(),function(e,o){t.errback("Adding entry succeeded when it shouldn't!")},function(e,o){t.callback(!0)}),t}},{name:"checkAtomIODeleteEntrySuccess",timeout:5e3,runTest:function(e){var t=new doh.Deferred,o=new dojox.atom.io.Connection;return o.getEntry(dojo.moduleUrl("dojox.atom.tests.widget","samplefeed.xml").toString(),function(n){e.t("Test Entry #1"===n.title.value),e.t("http://example.com/samplefeed.xml/entry/1"===n.id),n.setEditHref(dojo.moduleUrl("dojox.atom.tests.io","app.php")),o.deleteEntry(n,function(e){e?t.callback(!0):t.errback("Deleting entry failed")},function(e,o){t.errback("Deleting entry failed")})},function(e,o){t.errback("Retrieving the entry failed.")}),t}},{name:"checkAtomIODeleteEntryFail",timeout:5e3,runTest:function(e){var t=new doh.Deferred,o=new dojox.atom.io.Connection;return o.getEntry(dojo.moduleUrl("dojox.atom.tests.widget","samplefeed.xml").toString(),function(n){e.t("Test Entry #1"===n.title.value),e.t("http://example.com/samplefeed.xml/entry/1"===n.id),n.setEditHref(dojo.moduleUrl("dojox.atom.tests.io","appFail.php")),o.deleteEntry(n,function(e){e?t.errback("Deleting entry succeeded but it shouldn't have"):t.errback("The callback was called but it shouldn't have")},function(e,o){t.callback(!0)})},function(e,o){t.errback("Retrieving the entry failed.")}),t}}]);
//# sourceMappingURL=../../../sourcemaps/atom/tests/io/module.js.map
