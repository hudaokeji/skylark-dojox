/**
 * dojox - A version of dojox.js framework that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/dojox/
 * @license MIT
 */
define(["dojo/_base/lang","dojo/fx/easing","dojo/_base/fx","dojo/dom","./_base","dojo/_base/connect","dojo/_base/html","dojo/_base/array","dojo/_base/Color"],function(e,s,t,n,r,o,i,a,u){r.animateTimeline=function(e,r){var a=new l(e.keys),u=t.animateProperty({node:n.byId(r||e.node),duration:e.duration||1e3,properties:a._properties,easing:s.linear,onAnimate:function(e){}});return o.connect(u,"onEnd",function(e){var s=u.curve.getValue(u.reversed?0:1);i.style(e,s)}),o.connect(u,"beforeBegin",function(){u.curve&&delete u.curve,u.curve=a,a.ani=u}),u};var l=function(s){this.keys=e.isArray(s)?this.flatten(s):s};return l.prototype.flatten=function(e){var t={},n={};return a.forEach(e,function(r,o){var i,a,l=(i=r.step,a=o,"from"==i?0:"to"==i?1:void 0===i?0==a?0:a/(e.length-1):.01*parseInt(i,10)),v=s[r.ease]||s.linear;for(var p in r)"step"!=p&&"ease"!=p&&"from"!=p&&"to"!=p&&(n[p]||(n[p]={steps:[],values:[],eases:[],ease:v},t[p]={},/#/.test(r[p])?t[p].units=n[p].units="isColor":t[p].units=n[p].units=/\D{1,}/.exec(r[p]).join("")),n[p].eases.push(s[r.ease||"linear"]),n[p].steps.push(l),"isColor"==t[p].units?n[p].values.push(new u(r[p])):n[p].values.push(parseInt(/\d{1,}/.exec(r[p]).join(""))),void 0===t[p].start?t[p].start=n[p].values[n[p].values.length-1]:t[p].end=n[p].values[n[p].values.length-1])}),this._properties=t,n},l.prototype.getValue=function(e){e=this.ani._reversed?1-e:e;var s={},t=this,n=function(e,s){return"isColor"!=t._properties[e].units?t.keys[e].values[s]+t._properties[e].units:t.keys[e].values[s].toCss()};for(var r in this.keys)for(var o=this.keys[r],i=0;i<o.steps.length;i++){var a=o.steps[i],l=o.steps[i+1],v=i<o.steps.length,p=o.eases[i]||function(e){return e};if(e==a){if(s[r]=n(r,i),!v||v&&this.ani._reversed)break}else if(e>a){if(v&&e<o.steps[i+1]){var f=o.values[i+1],d=o.values[i],c=1/(l-a)*(e-a);if(c=p(c),d instanceof u)s[r]=u.blendColors(d,f,c).toCss(!1);else{var h=f-d;s[r]=d+c*h+this._properties[r].units}break}s[r]=n(r,i)}else(v&&!this.ani._reversed||!v&&this.ani._reversed)&&(s[r]=n(r,i))}return s},r._Timeline=l,r});
//# sourceMappingURL=../sourcemaps/fx/Timeline.js.map
